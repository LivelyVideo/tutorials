(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
'use strict';

var _stockBroadcaster = require('@livelyvideo/stock-broadcaster');

var _stockBroadcaster2 = _interopRequireDefault(_stockBroadcaster);

var _stockLivePlayer = require('@livelyvideo/stock-live-player');

var _stockLivePlayer2 = _interopRequireDefault(_stockLivePlayer);

var _xhr = require('xhr');

var _xhr2 = _interopRequireDefault(_xhr);

var _textContent = require('text-content');

var _textContent2 = _interopRequireDefault(_textContent);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

/**
Set up the flash broadcaster.

Params:
	- html element
	- relative or absolute path to retrieve an access key, defined in server.js
	- driver options [webrtc driver will be coming soon]
			> affiliate: required, this is your company/affiliate name
			> flashWmode: sets the flashWmode attribute
			> gateway: will be used for webrtc to define path, this can be left null if not using webrtc
			> iceServers: will be used for webrtc, this can be left null if not using webrtc
			> preview: defaults to true, false if broadcast w/no preview
			> rtmpUrl: origin server, this can be left null if not using flash
			> tfSwfPath: path to thinflash swf, located in /dist for this demo, this can be left null if not using flash

Events:
	- ready - broadcaster has been set up
	- mute - audio input has been muted
	- unmute - audio input unmuted
	- start - broadcasting has begun
	- stop - broadcast has stopped
	- error - fatal error

I attached the stockBroadcaster to the window so it can be accessed from console.  It has the broadcaster on it, and the controls.

**/
var stockBroadcaster = new _stockBroadcaster2.default(document.querySelector('#broadcaster'), '/access-key', {
	affiliate: 'beta',
	tfSwfPath: '/thinDebug.swf',
	// can be used for beta servers
	// rtmpUrl: 'rtmp://uc-origin.livelyvideo.tv/origin',
	rtmpUrl: 'rtmp://ids6-ls.dev.caster.tv/origin',
	drivers: ['flash'],
	tfArgs: ['affiliate=beta', 'host=livelyvideo.tv']
});
stockBroadcaster.on('error', function () {
	for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
		args[_key] = arguments[_key];
	}

	console.error('error', args);
});
stockBroadcaster.setup();
window.stockBroadcaster = stockBroadcaster;

/**
Function to load the stock player, triggered later by a click event on <a> tags generated by the "get listings" button

Params:
	- html element
	- manifest url, returned by the listings endpoint located in server.js
	- player options
		> autoplay: [true] autoplays the stream when it loads
		> bitrate: [undefined] null for adaptive when available, desired kbps otherwise
		> drivers: ["mp4", "nativeHls", "jsHls", "flash", lodef"] driver priority
		> debug: [false] enables debug logging
		> recoverErrorCount: [10] Playback error count to recover the entire driver on
		> forceDrivers:	[false]
		> muted: whether or not the driver is muted
		> pollingInterval: [10000] ms timeout to wait before polling again
		> volume: [0.75] 0-1 volume
	- controls options
		> popout: popout options
		> popout[].url: url for popout
		> popout[].width: width for popout in px
		> popout[].height: height for popout in px

Events:
	- error emitted with all errors
	- exit-fullscreen
	- enter-fullscreen
	- bitrate-switch
	- select-driver
	- manifest
	- play
	- stop
	- pause
	- stall
	- progress
	- timeupdate
	- mute
	- unmute
	- volume
	- online
	- offline
	- estimated-bw
	- user-active
	- user-idle
**/
var stockPlayer = void 0;
function loadPlayer(manifest) {
	if (stockPlayer) {
		stockPlayer.destroy();
	}

	window.stockPlayer = stockPlayer = new _stockLivePlayer2.default(document.querySelector('#player'), manifest, {
		drivers: ['hlsjs', 'mediaSourceMp4', 'hls', 'flash'],
		hlsjsPath: 'http://dailymotion.github.io/hls.js/dist/hls.js',
		tfSwfPath: '/thinDebug.swf'
	});
}

/** Below is demo code **/

// retrieves listings from server.js
function getListings(cb) {
	(0, _xhr2.default)({
		method: 'GET',
		url: '/listings',
		json: true
	}, function (err, response, body) {
		if (err) {
			console.error(err);
			cb(err);
			return;
		}

		if (response.statusCode > 399) {
			console.error('unexpected status code', response.statusCode, body);
			cb(new Error(body));
			return;
		}

		cb(null, body);
	});
}

// create a button to load active listings and a div to contain them
var getListingsButton = document.createElement('button');
var resultsContainer = document.createElement('div');
var result = document.createElement('a');
result.setAttribute('href', '#');
(0, _textContent2.default)(getListingsButton, 'Load Listings');

// on click, empty div, retrieve listings, and render a tags for each listing
getListingsButton.onclick = function () {
	while (resultsContainer.children.length) {
		resultsContainer.children[0].remove();
	}

	getListings(function (err, body) {
		if (err) {
			return;
		}

		for (var i = 0; i < body.results.length; i++) {
			var entry = result.cloneNode();
			(0, _textContent2.default)(entry, body.results[i].userId);

			// for each listing, add a click listener to load that manifest.
			entry.onclick = function (manifest) {
				return function (e) {
					e.preventDefault();
					loadPlayer(manifest);
				};
			}(body.results[i].manifest);
			resultsContainer.appendChild(entry);
		}
	});
};
getListingsButton.onclick();

document.querySelector('.listings').appendChild(getListingsButton);
document.querySelector('.listings').appendChild(resultsContainer);

},{"@livelyvideo/stock-broadcaster":2,"@livelyvideo/stock-live-player":3,"text-content":8,"xhr":10}],2:[function(require,module,exports){
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.LivelyStockBroadcaster=t():e.LivelyStockBroadcaster=t()}(this,function(){return function(e){function t(n){if(r[n])return r[n].exports;var i=r[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var r={};return t.m=e,t.c=r,t.i=function(e){return e},t.d=function(e,t,r){Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=17)}([function(e,t){"use strict";function r(e,t){var r=document.createElement(e);return r.classList.add.apply(r.classList,t),r}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r},function(e,t){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function n(e){return"function"==typeof e}function i(e){return"number"==typeof e}function o(e){return"object"==typeof e&&null!==e}function s(e){return void 0===e}e.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(e){if(!i(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},r.prototype.emit=function(e){var t,r,i,a,c,u;if(this._events||(this._events={}),"error"===e&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;var l=new Error('Uncaught, unspecified "error" event. ('+t+")");throw l.context=t,l}if(r=this._events[e],s(r))return!1;if(n(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:a=Array.prototype.slice.call(arguments,1),r.apply(this,a)}else if(o(r))for(a=Array.prototype.slice.call(arguments,1),u=r.slice(),i=u.length,c=0;c<i;c++)u[c].apply(this,a);return!0},r.prototype.addListener=function(e,t){var i;if(!n(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,n(t.listener)?t.listener:t),this._events[e]?o(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,o(this._events[e])&&!this._events[e].warned&&(i=s(this._maxListeners)?r.defaultMaxListeners:this._maxListeners,i&&i>0&&this._events[e].length>i&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())),this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(e,t){function r(){this.removeListener(e,r),i||(i=!0,t.apply(this,arguments))}if(!n(t))throw TypeError("listener must be a function");var i=!1;return r.listener=t,this.on(e,r),this},r.prototype.removeListener=function(e,t){var r,i,s,a;if(!n(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(r=this._events[e],s=r.length,i=-1,r===t||n(r.listener)&&r.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(o(r)){for(a=s;a-- >0;)if(r[a]===t||r[a].listener&&r[a].listener===t){i=a;break}if(i<0)return this;1===r.length?(r.length=0,delete this._events[e]):r.splice(i,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},r.prototype.removeAllListeners=function(e){var t,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(r=this._events[e],n(r))this.removeListener(e,r);else if(r)for(;r.length;)this.removeListener(e,r[r.length-1]);return delete this._events[e],this},r.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?n(this._events[e])?[this._events[e]]:this._events[e].slice():[]},r.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(n(t))return 1;if(t)return t.length}return 0},r.listenerCount=function(e,t){return e.listenerCount(t)}},function(e,t){e.exports=function(e,t){var r=void 0!==e.textContent?"textContent":"innerText";return"undefined"!=typeof t&&(e[r]=t),e[r]}},function(e,t){function r(e){var t=n.call(e);return"[object Function]"===t||"function"==typeof e&&"[object RegExp]"!==t||"undefined"!=typeof window&&(e===window.setTimeout||e===window.alert||e===window.confirm||e===window.prompt)}e.exports=r;var n=Object.prototype.toString},function(e,t,r){!function(t,r){e.exports=r()}(this,function(){return function(e){function t(n){if(r[n])return r[n].exports;var i=r[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var r={};return t.m=e,t.c=r,t.i=function(e){return e},t.d=function(e,t,r){Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=9)}([function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={createBroadcast:function(){try{return this.getSwf().tfBroadcastCreate()}catch(e){return this.logError("broadcast","createBroadcast",[],"error initializing broadcast [err="+e+"]"),!1}},destroyBroadcast:function(e){try{this.getSwf().tfBroadcastDestroy(e)}catch(t){return this.logError("broadcast","destroyBroadcast",[e],"error destroying broadcast [err="+t+"]"),!1}return!0},connectToBroadcast:function(e,t,r){try{var n;(n=this.getSwf()).tfBroadcastConnect.apply(n,arguments)}catch(n){return this.logError("broadcast","connectToBroadcast",[e,t,r],"error connecting to broadcast [err="+n+"]"),!1}return!0},setVideoPath:function(e,t){try{this.getSwf().tfBroadcastConnect(e,null,t)}catch(r){return this.logError("broadcast","connectToVideo",[e,t],"error connecting to video [err="+r+"]"),!1}return!0},setStreamName:function(e,t){try{this.getSwf().tfBroadcastSetStreamName(e,t)}catch(r){return this.logError("broadcast","setStreamName",[e,t],"error setting stream name [err="+r+"]"),!1}return!0},broadcastAttachCamera:function(e,t){try{this.getSwf().tfBroadcastAttachCamera(e,t)}catch(r){return this.logError("broadcast","broadcastAttachCamera",[e,t],"error attaching camera to broadcast [err="+r+"]"),!1}return!0},broadcastAttachMicrophone:function(e,t){try{this.getSwf().tfBroadcastAttachMicrophone(e,t)}catch(r){return this.logError("broadcast","broadcastAttachMicrophone",[e,t],"error attaching mic to broadcast [err="+r+"]"),!1}return!0}}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={createCamera:function(){try{return this.getSwf().tfCameraCreate()}catch(e){return this.logError("camera","createCamera",[],"error creating camera [err="+e+"]"),!1}},destroyCamera:function(e){try{this.getSwf().tfCameraDestroy(e)}catch(t){return this.logError("camera","destroyCamera",[e],"error destroying camera [err="+t+"]"),!1}return!0},cameraSetQuality:function(e,t,r){try{this.getSwf().tfCameraSetQuality(e,t,r)}catch(n){return this.logError("Camera","cameraSetQuality",[e,t,r],"error setting camera quality [err="+n+"]"),!1}return!0},cameraSetMode:function(e,t,r,n,i){try{this.getSwf().tfCameraSetMode(e,t,r,n,i)}catch(o){return this.logError("camera","cameraSetMode",[e,t,r,n,i],"error setting camera mode [err="+o+"]"),!1}return!0},cameraSetKeyFrameInterval:function(e,t){try{this.getSwf().tfCameraSetKeyFrameInterval(e,t)}catch(r){return this.logError("camera","cameraSetKeyFrameInterval",[e,t],"error setting key frame interval [err="+r+"]"),!1}return!0},getProperty:function(e,t){try{this.getSwf().tfGetCameraProperty(e,t)}catch(r){return this.logError("camera","getProperty",[e,t],"cannot get property from Camera [err="+r+"]"),!1}return!0},cameraAttachToStage:function(e){try{this.getSwf().tfCameraAttachToStage(e)}catch(t){return this.logError("camera","cameraAttachToStage",[e],"error adding camera to stage [err="+t+"]"),!1}return!0},cameraDetachFromStage:function(e){try{this.getSwf().tfCameraDetachFromStage(e)}catch(t){return this.logError("camera","cameraDetachFromStage",[e],"error detaching camera from stage [err="+t+"]"),!1}return!0},cameraSetDisplayProperties:function(e,t){try{this.getSwf().tfCameraSetDisplayProperties(e,t)}catch(r){return this.logError("camera","cameraSetDisplayProperties",[e,t],"error set camera display properties [err="+r+"]"),!1}return!0}}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={createMicrophone:function(){try{return this.getSwf().tfMicrophoneCreate()}catch(e){return this.logError("microphone","createMicrophone",[],"error creating microphone [err="+e+"]"),!1}},setVolume:function(e,t){try{return this.getSwf().tfSetMicrophoneVolume(e,t)}catch(e){return this.logError("microphone","createMicrophone",[],"error creating microphone [err="+e+"]"),!1}},getVolume:function(e){try{return this.getSwf().tfGetMicrophoneVolume(e)}catch(e){return this.logError("microphone","createMicrophone",[],"error creating microphone [err="+e+"]"),!1}},destroyMicrophone:function(e){try{this.getSwf().tfMicrophoneDestroy(e)}catch(t){return this.logError("microphone","destroyMicrophone",[e],"error destroying microphone [err="+t+"]"),!1}return!0},micUseEchoSuppression:function(e,t){try{this.getSwf().tfMicrophoneSetUseEchoSuppression(e,t)}catch(r){return this.logError("microphone","micUseEchoSuppression",[e,t],"error setting suppression [err="+r+"]"),!1}return!0},getProperty:function(e,t){try{return this.getSwf().tfGetMicrophoneProperty(e,t)}catch(r){return this.logError("microphone","getProperty",[e,t],"cannot get property on Microphone"),!1}},setProperty:function(e,t,r){try{return this.getSwf().tfSetMicrophoneProperty(t,r)}catch(n){return this.logError("microphone","setProperty",[t,e,r],"cannot set property on microphone"),!1}}}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={playbackPlay:function(e,t){try{this.getSwf().tfPlaybackPlay(e,t)}catch(r){return this.logError("playback","playbackPlay",[e,t],"error playing video [err="+r+"]"),!1}return!0},setVolume:function(e,t){try{this.getSwf().tfPlaybackSetVolume(e,t)}catch(r){return this.logError("playback","setVolume",[e,t],"error setting volume [err="+r+"]"),!1}return!0},muteAudio:function(e,t){try{this.getSwf().tfPlaybackMute(e,t)}catch(r){return this.logError("playback","muteAudio",[e,t],"error muting audio [err="+r+"]"),!1}return!0},pausePlayback:function(e,t){try{this.getSwf().tfPlaybackPause(e,t)}catch(r){return this.logError("playback","pausePlayback",[e,t],"error pausing playback [err="+r+"]"),!1}return!0},pausePlaybackToggle:function(e){try{this.getSwf().tfPlaybackTogglePause(e)}catch(t){return this.logError("playback","pausePlaybackToggle",[e],"error pausing playback [err="+t+"]"),!1}return!0},createStream:function(e,t){try{this.getSwf().tfBroadcastCreateStream(e,t)}catch(t){return this.logError("playback","createStream",[e],"error creating stream [err="+t+"]"),!1}return!0},destroyStream:function(e,t){try{this.getSwf().tfBroadcastDestroyStream(e,t)}catch(r){return this.logError("playback","destroyStream",[e,t],"error destroying stream [err="+r+"]"),!1}return!0},setCurrentStreamIndex:function(e,t){try{this.getSwf().tfBroadcastSetCurrentStreamIndex(e,t)}catch(r){return this.logError("playback","setCurrentStreamIndex",[e,t],"error setting stream index [err="+r+"]"),!1}return!0},getNetStreamProperty:function(e,t){try{return this.getSwf().tfGetNetStreamProperty(e,t)}catch(r){return this.logError("playback","getNetStreamProperty",[e,t],"error getting NetStream property [err="+r+"]"),!1}},setNetStreamProperty:function(e,t,r){try{this.getSwf().tfSetNetStreamProperty(e,t,r)}catch(n){return this.logError("playback","setVideoProperties",[e,t,r],"error setting NetStream property [err="+n+"]"),!1}return!0},invokeNetStreamMethod:function(e,t){try{var r;(r=this.getSwf()).tfInvokeNetStreamMethod.apply(r,arguments)}catch(r){return this.logError("playback","invokeNetStreamMethod",[e,t],"error invoking NetStream method [err="+r+"]"),!1}return!0},setVideoProperties:function(e,t,r){try{var n;(n=this.getSwf()).tfSetVideoProperties.apply(n,arguments)}catch(n){return this.logError("playback","setVideoProperties",[e,t,r],"error setting video properties [err="+n+"]"),!1}return!0}}},function(e,t){"use strict";/**
 * @license ThinFlash
 * Copyright (c) 2014 Accretive Technology Group, Inc.  http://accretivetg.com
 * MIT Licensed  https://github.com/accretive/thinflash/blob/master/LICENSE
 */
var r={width:320,height:240,fps:15,favorArea:!0},n={bandwidth:144e3,quality:85},i={active:!1,pending:!1,dead:!0};e.exports={mode:r,quality:n,keyFrameInterval:60,status:i}},function(e,t){"use strict";/**
 * @license ThinFlash
 * Copyright (c) 2014 Accretive Technology Group, Inc.  http://accretivetg.com
 * MIT Licensed  https://github.com/accretive/thinflash/blob/master/LICENSE
 *
 * @file broadcastSettings.js - A FACTORY for providing a simple wrapper around
 * a broadcasts rtmp information.
 */
var r=[{name:"Modem (56K) wide",id:"9",mode:"160,90,12",keyframeinterval:"12",quality:"16384,0",level:"LEVEL_3",profile:"MAIN",ish264:"1",isdefault:"0"},{name:"ISDN (128K) wide",id:"10",mode:"320,180,12",keyframeinterval:"12",quality:"49152,0",level:"LEVEL_3",profile:"MAIN",ish264:"1",isdefault:"0"},{name:"DSL (256K) wide",id:"11",mode:"320,180,15",keyframeinterval:"15",quality:"65536,0",level:"LEVEL_3",profile:"MAIN",ish264:"1",isdefault:"0"},{name:"Cable (512K) wide",id:"12",mode:"320,180,24",keyframeinterval:"24",quality:"128000,0",level:"LEVEL_3",profile:"MAIN",ish264:"1",isdefault:"0"},{name:"HD (Low) wide",id:"13",mode:"640,360,24",keyframeinterval:"72",quality:"128000,30",level:"LEVEL_3",profile:"MAIN",ish264:"1",isdefault:"1"},{name:"HD (High) wide",id:"14",mode:"640,360,30",keyframeinterval:"150",quality:"128000,40",level:"LEVEL_3",profile:"MAIN",ish264:"1",isdefault:"0"},{name:"Modem (56K)",id:"15",mode:"160,120,12",keyframeinterval:"12",quality:"16384,0",level:"LEVEL_3",profile:"MAIN",ish264:"1",isdefault:"0"},{name:"ISDN (128K)",id:"16",mode:"320,240,12",keyframeinterval:"12",quality:"49152,0",level:"LEVEL_3",profile:"MAIN",ish264:"1",isdefault:"0"},{name:"DSL (256K)",id:"17",mode:"320,240,15",keyframeinterval:"15",quality:"65536,0",level:"LEVEL_3",profile:"MAIN",ish264:"1",isdefault:"0"},{name:"Cable (512K)",id:"18",mode:"320,240,24",keyframeinterval:"24",quality:"128000,0",level:"LEVEL_3",profile:"MAIN",ish264:"1",isdefault:"0"},{name:"HD (Low)",id:"19",mode:"640,480,24",keyframeinterval:"72",quality:"128000,30",level:"LEVEL_3",profile:"MAIN",ish264:"1",isdefault:"0"},{name:"HD (High)",id:"20",mode:"640,480,30",keyframeinterval:"150",quality:"128000,40",level:"LEVEL_3",profile:"MAIN",ish264:"1",isdefault:"0"}];e.exports={encoderSettings:r,preset:r[4]}},function(e,t){"use strict";/**
 * @license ThinFlash
 * Copyright (c) 2014 Accretive Technology Group, Inc.  http://accretivetg.com
 * MIT Licensed  https://github.com/accretive/thinflash/blob/master/LICENSE
 */
var r={active:!1,pending:!1,dead:!0};e.exports={useEchoSuppression:!1,status:r}},function(e,t){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function n(e){return"function"==typeof e}function i(e){return"number"==typeof e}function o(e){return"object"==typeof e&&null!==e}function s(e){return void 0===e}e.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(e){if(!i(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},r.prototype.emit=function(e){var t,r,i,a,c,u;if(this._events||(this._events={}),"error"===e&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;var l=new Error('Uncaught, unspecified "error" event. ('+t+")");throw l.context=t,l}if(r=this._events[e],s(r))return!1;if(n(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:a=Array.prototype.slice.call(arguments,1),r.apply(this,a)}else if(o(r))for(a=Array.prototype.slice.call(arguments,1),u=r.slice(),i=u.length,c=0;c<i;c++)u[c].apply(this,a);return!0},r.prototype.addListener=function(e,t){var i;if(!n(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,n(t.listener)?t.listener:t),this._events[e]?o(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,o(this._events[e])&&!this._events[e].warned&&(i=s(this._maxListeners)?r.defaultMaxListeners:this._maxListeners,i&&i>0&&this._events[e].length>i&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())),this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(e,t){function r(){this.removeListener(e,r),i||(i=!0,t.apply(this,arguments))}if(!n(t))throw TypeError("listener must be a function");var i=!1;return r.listener=t,this.on(e,r),this},r.prototype.removeListener=function(e,t){var r,i,s,a;if(!n(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(r=this._events[e],s=r.length,i=-1,r===t||n(r.listener)&&r.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(o(r)){for(a=s;a-- >0;)if(r[a]===t||r[a].listener&&r[a].listener===t){i=a;break}if(i<0)return this;1===r.length?(r.length=0,delete this._events[e]):r.splice(i,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},r.prototype.removeAllListeners=function(e){var t,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(r=this._events[e],n(r))this.removeListener(e,r);else if(r)for(;r.length;)this.removeListener(e,r[r.length-1]);return delete this._events[e],this},r.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?n(this._events[e])?[this._events[e]]:this._events[e].slice():[]},r.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(n(t))return 1;if(t)return t.length}return 0},r.listenerCount=function(e,t){return e.listenerCount(t)}},function(e,t,r){/*!    SWFObject v2.3.20120118 <http://github.com/swfobject/swfobject>
    is released under the MIT License <http://www.opensource.org/licenses/mit-license.php>
*/
!function(t,r){e.exports=r()}(this,function(){function e(){if(!X&&document.getElementsByTagName("body")[0]){try{var e,t=m("span");t.style.display="none",e=B.getElementsByTagName("body")[0].appendChild(t),e.parentNode.removeChild(e),e=null,t=null}catch(e){return}X=!0;for(var r=U.length,n=0;n<r;n++)U[n]()}}function t(e){X?e():U[U.length]=e}function r(e){if(typeof N.addEventListener!=M)N.addEventListener("load",e,!1);else if(typeof B.addEventListener!=M)B.addEventListener("load",e,!1);else if(typeof N.attachEvent!=M)g(N,"onload",e);else if("function"==typeof N.onload){var t=N.onload;N.onload=function(){t(),e()}}else N.onload=e}function n(){var e=B.getElementsByTagName("body")[0],t=m(j);t.setAttribute("style","visibility: hidden;"),t.setAttribute("type",I);var r=e.appendChild(t);if(r){var n=0;!function o(){if(typeof r.GetVariable!=M)try{var s=r.GetVariable("$version");s&&(s=s.split(" ")[1].split(","),J.pv=[b(s[0]),b(s[1]),b(s[2])])}catch(e){J.pv=[8,0,0]}else if(n<10)return n++,void setTimeout(o,10);e.removeChild(t),r=null,i()}()}else i()}function i(){var e=F.length;if(e>0)for(var t=0;t<e;t++){var r=F[t].id,n=F[t].callbackFn,i={success:!1,id:r};if(J.pv[0]>0){var u=y(r);if(u)if(!w(F[t].swfVersion)||J.wk&&J.wk<312)if(F[t].expressInstall&&s()){var l={};l.data=F[t].expressInstall,l.width=u.getAttribute("width")||"0",l.height=u.getAttribute("height")||"0",u.getAttribute("class")&&(l.styleclass=u.getAttribute("class")),u.getAttribute("align")&&(l.align=u.getAttribute("align"));for(var f={},h=u.getElementsByTagName("param"),p=h.length,d=0;d<p;d++)"movie"!=h[d].getAttribute("name").toLowerCase()&&(f[h[d].getAttribute("name")]=h[d].getAttribute("value"));a(l,f,r,n)}else c(u),n&&n(i);else E(r,!0),n&&(i.success=!0,i.ref=o(r),i.id=r,n(i))}else if(E(r,!0),n){var v=o(r);v&&typeof v.SetVariable!=M&&(i.success=!0,i.ref=v,i.id=v.id),n(i)}}}function o(e){var t=null,r=y(e);return r&&"OBJECT"===r.nodeName.toUpperCase()&&(t=typeof r.SetVariable!==M?r:r.getElementsByTagName(j)[0]||r),t}function s(){return!G&&w("6.0.65")&&(J.win||J.mac)&&!(J.wk&&J.wk<312)}function a(e,t,r,n){var i=y(r);if(r=v(r),G=!0,A=n||null,O={success:!1,id:r},i){"OBJECT"==i.nodeName.toUpperCase()?(k=u(i),L=null):(k=i,L=r),e.id=R,(typeof e.width==M||!/%$/.test(e.width)&&b(e.width)<310)&&(e.width="310"),(typeof e.height==M||!/%$/.test(e.height)&&b(e.height)<137)&&(e.height="137"),B.title=B.title.slice(0,47)+" - Flash Player Installation";var o=J.ie?"ActiveX":"PlugIn",s="MMredirectURL="+encodeURIComponent(N.location.toString().replace(/&/g,"%26"))+"&MMplayerType="+o+"&MMdoctitle="+B.title;if(typeof t.flashvars!=M?t.flashvars+="&"+s:t.flashvars=s,J.ie&&4!=i.readyState){var a=m("div");r+="SWFObjectNew",a.setAttribute("id",r),i.parentNode.insertBefore(a,i),i.style.display="none",p(i)}f(e,t,r)}}function c(e){if(J.ie&&4!=e.readyState){e.style.display="none";var t=m("div");e.parentNode.insertBefore(t,e),t.parentNode.replaceChild(u(e),t),p(e)}else e.parentNode.replaceChild(u(e),e)}function u(e){var t=m("div");if(J.win&&J.ie)t.innerHTML=e.innerHTML;else{var r=e.getElementsByTagName(j)[0];if(r){var n=r.childNodes;if(n)for(var i=n.length,o=0;o<i;o++)1==n[o].nodeType&&"PARAM"==n[o].nodeName||8==n[o].nodeType||t.appendChild(n[o].cloneNode(!0))}}return t}function l(e,t){var r=m("div");return r.innerHTML="<object classid='clsid:D27CDB6E-AE6D-11cf-96B8-444553540000'><param name='movie' value='"+e+"'>"+t+"</object>",r.firstChild}function f(e,t,r){var n,i=y(r);if(r=v(r),J.wk&&J.wk<312)return n;if(i){var o,s,a,c=m(J.ie?"div":j);typeof e.id==M&&(e.id=r);for(a in t)t.hasOwnProperty(a)&&"movie"!==a.toLowerCase()&&h(c,a,t[a]);J.ie&&(c=l(e.data,c.innerHTML));for(o in e)e.hasOwnProperty(o)&&(s=o.toLowerCase(),"styleclass"===s?c.setAttribute("class",e[o]):"classid"!==s&&"data"!==s&&c.setAttribute(o,e[o]));J.ie?H[H.length]=e.id:(c.setAttribute("type",I),c.setAttribute("data",e.data)),i.parentNode.replaceChild(c,i),n=c}return n}function h(e,t,r){var n=m("param");n.setAttribute("name",t),n.setAttribute("value",r),e.appendChild(n)}function p(e){var t=y(e);t&&"OBJECT"==t.nodeName.toUpperCase()&&(J.ie?(t.style.display="none",function e(){if(4==t.readyState){for(var r in t)"function"==typeof t[r]&&(t[r]=null);t.parentNode.removeChild(t)}else setTimeout(e,10)}()):t.parentNode.removeChild(t))}function d(e){return e&&e.nodeType&&1===e.nodeType}function v(e){return d(e)?e.id:e}function y(e){if(d(e))return e;var t=null;try{t=B.getElementById(e)}catch(e){}return t}function m(e){return B.createElement(e)}function b(e){return parseInt(e,10)}function g(e,t,r){e.attachEvent(t,r),K[K.length]=[e,t,r]}function w(e){e+="";var t=J.pv,r=e.split(".");return r[0]=b(r[0]),r[1]=b(r[1])||0,r[2]=b(r[2])||0,t[0]>r[0]||t[0]==r[0]&&t[1]>r[1]||t[0]==r[0]&&t[1]==r[1]&&t[2]>=r[2]}function _(e,t,r,n){var i=B.getElementsByTagName("head")[0];if(i){var o="string"==typeof r?r:"screen";if(n&&(C=null,T=null),!C||T!=o){var s=m("style");s.setAttribute("type","text/css"),s.setAttribute("media",o),C=i.appendChild(s),J.ie&&typeof B.styleSheets!=M&&B.styleSheets.length>0&&(C=B.styleSheets[B.styleSheets.length-1]),T=o}C&&(typeof C.addRule!=M?C.addRule(e,t):typeof B.createTextNode!=M&&C.appendChild(B.createTextNode(e+" {"+t+"}")))}}function E(e,t){if($){var r=t?"visible":"hidden",n=y(e);X&&n?n.style.visibility=r:"string"==typeof e&&_("#"+e,"visibility:"+r)}}function S(e){var t=/[\\\"<>\.;]/,r=null!=t.exec(e);return r&&typeof encodeURIComponent!=M?encodeURIComponent(e):e}var k,L,A,O,C,T,M="undefined",j="object",x="Shockwave Flash",P="ShockwaveFlash.ShockwaveFlash",I="application/x-shockwave-flash",R="SWFObjectExprInst",D="onreadystatechange",N=window,B=document,V=navigator,q=!1,U=[],F=[],H=[],K=[],X=!1,G=!1,$=!0,W=!1,J=function(){var e=typeof B.getElementById!=M&&typeof B.getElementsByTagName!=M&&typeof B.createElement!=M,t=V.userAgent.toLowerCase(),r=V.platform.toLowerCase(),n=r?/win/.test(r):/win/.test(t),i=r?/mac/.test(r):/mac/.test(t),o=!!/webkit/.test(t)&&parseFloat(t.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")),s="Microsoft Internet Explorer"===V.appName,a=[0,0,0],c=null;if(typeof V.plugins!=M&&typeof V.plugins[x]==j)c=V.plugins[x].description,c&&typeof V.mimeTypes!=M&&V.mimeTypes[I]&&V.mimeTypes[I].enabledPlugin&&(q=!0,s=!1,c=c.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),a[0]=b(c.replace(/^(.*)\..*$/,"$1")),a[1]=b(c.replace(/^.*\.(.*)\s.*$/,"$1")),a[2]=/[a-zA-Z]/.test(c)?b(c.replace(/^.*[a-zA-Z]+(.*)$/,"$1")):0);else if(typeof N.ActiveXObject!=M)try{var u=new ActiveXObject(P);u&&(c=u.GetVariable("$version"),c&&(s=!0,c=c.split(" ")[1].split(","),a=[b(c[0]),b(c[1]),b(c[2])]))}catch(e){}return{w3:e,pv:a,wk:o,ie:s,win:n,mac:i}}();return function(){J.w3&&((typeof B.readyState!=M&&("complete"===B.readyState||"interactive"===B.readyState)||typeof B.readyState==M&&(B.getElementsByTagName("body")[0]||B.body))&&e(),X||(typeof B.addEventListener!=M&&B.addEventListener("DOMContentLoaded",e,!1),J.ie&&(B.attachEvent(D,function t(){"complete"==B.readyState&&(B.detachEvent(D,t),e())}),N==top&&!function t(){if(!X){try{B.documentElement.doScroll("left")}catch(e){return void setTimeout(t,0)}e()}}()),J.wk&&!function t(){if(!X)return/loaded|complete/.test(B.readyState)?void e():void setTimeout(t,0)}()))}(),U[0]=function(){q?n():i()},function(){J.ie&&window.attachEvent("onunload",function(){for(var e=K.length,t=0;t<e;t++)K[t][0].detachEvent(K[t][1],K[t][2]);for(var r=H.length,n=0;n<r;n++)p(H[n]);for(var i in J)J[i]=null;if(J=null,"undefined"!=typeof swfobject){for(var o in swfobject)swfobject[o]=null;swfobject=null}})}(),{registerObject:function(e,t,r,n){if(J.w3&&e&&t){var i={};i.id=e,i.swfVersion=t,i.expressInstall=r,i.callbackFn=n,F[F.length]=i,E(e,!1)}else n&&n({success:!1,id:e})},getObjectById:function(e){if(J.w3)return o(e)},embedSWF:function(e,r,n,i,o,c,u,l,h,p){var d=v(r),y={success:!1,id:d};J.w3&&!(J.wk&&J.wk<312)&&e&&r&&n&&i&&o?(E(d,!1),t(function(){n+="",i+="";var t={};if(h&&typeof h===j)for(var v in h)t[v]=h[v];t.data=e,t.width=n,t.height=i;var m={};if(l&&typeof l===j)for(var b in l)m[b]=l[b];if(u&&typeof u===j)for(var g in u)if(u.hasOwnProperty(g)){var _=W?encodeURIComponent(g):g,S=W?encodeURIComponent(u[g]):u[g];typeof m.flashvars!=M?m.flashvars+="&"+_+"="+S:m.flashvars=_+"="+S}if(w(o)){var k=f(t,m,r);t.id==d&&E(d,!0),y.success=!0,y.ref=k,y.id=k.id}else{if(c&&s())return t.data=c,void a(t,m,r,p);E(d,!0)}p&&p(y)})):p&&p(y)},switchOffAutoHideShow:function(){$=!1},enableUriEncoding:function(e){W=typeof e===M||e},ua:J,getFlashPlayerVersion:function(){return{major:J.pv[0],minor:J.pv[1],release:J.pv[2]}},hasFlashPlayerVersion:w,createSWF:function(e,t,r){return J.w3?f(e,t,r):void 0},showExpressInstall:function(e,t,r,n){J.w3&&s()&&a(e,t,r,n)},removeSWF:function(e){J.w3&&p(e)},createCSS:function(e,t,r,n){J.w3&&_(e,t,r,n)},addDomLoadEvent:t,addLoadEvent:r,getQueryParamValue:function(e){var t=B.location.search||B.location.hash;if(t){if(/\?/.test(t)&&(t=t.split("?")[1]),null==e)return S(t);for(var r=t.split("&"),n=0;n<r.length;n++)if(r[n].substring(0,r[n].indexOf("="))==e)return S(r[n].substring(r[n].indexOf("=")+1))}return""},expressInstallCallback:function(){if(G){var e=y(R);e&&k&&(e.parentNode.replaceChild(k,e),L&&(E(L,!0),J.ie&&(k.style.display="block")),A&&A(O)),G=!1}},version:"2.3"}})},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),c=r(7),u=n(c),l=r(8),f=n(l),h=r(0),p=n(h),d=r(1),v=n(d),y=r(2),m=n(y),b=r(3),g=n(b),w=r(4),_=n(w),E=r(5),S=n(E),k=r(6),L=n(k),A="11.0.0",O="aiwswfbroadcast",C=0,T=function(e){function t(e,r,n){i(this,t);var s=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return s.el=e,s.accessKey=r,s.options=n,s.encodingSettings=n.encodingSettings||S.default.preset,s.origin=n.rtmpUrl,s.origin||s.emit("error","no origin supplied"),s.origin+="?host="+s.options.host,s.options.affiliate&&(s.origin+="&affiliate="+s.options.affiliate),s.id=C++,s.broadcastId=null,s.cameraId=null,s.microphoneId=null,s.swf=null,s.pollingTf=null,s.pollingTfAttempts=0,s.devicesAttempts=0,s.tfIsReadyCbs=[],s.render(),s.setupThinflash(function(){s.emit("ready")}),s}return s(t,e),a(t,[{key:"supportsDevices",value:function(){return!1}},{key:"supportsMute",value:function(){return!0}},{key:"supportsEncodingSettings",value:function(){return!0}},{key:"onceDevicesAreReady",value:function(e){var t=this;return this.devicesAttempts++,this.cameraId||(this.cameraId=this.cameraApi.createCamera()),this.microphoneId||this.createMicrophone(),this.cameraId&&this.microphoneId?void e():this.devicesAttempts>10?void this.emit("error","no devices"):void setTimeout(function(){t.onceDevicesAreReady(e)},200)}},{key:"onceTfIsReady",value:function(e){return this.swf&&this.swf.tfBroadcastCreate?void e():(this.tfIsReadyCbs.push(e),void this.pollTf())}},{key:"pollTf",value:function(){var e=this;this.pollingTf||(this.pollingTfAttempts=0,clearInterval(this.pollingTf),this.pollingTf=setInterval(function(){if(e.pollingTfAttempts++,e.pollingTfAttempts>30)return clearInterval(e.pollingTf),void e.emit("error","embedding swf timed out");if(e.swf&&e.swf.tfBroadcastCreate){clearInterval(e.pollingTf);for(var t=e.tfIsReadyCbs.shift();t;)t(),t=e.tfIsReadyCbs.shift()}},20))}},{key:"getDetails",value:function(){var e={state:this.state};if(this.broadcastId){var t=this.swf.tfGetNetStreamProperty(this.broadcastId,"info");e.droppedFrames=t.droppedFrames,e.kbps=.008*t.currentBytesPerSecond}return e}},{key:"destroy",value:function(){this.stop(),this.cameraApi.cameraDetachFromStage(this.cameraId),this.cameraApi.destroyCamera(this.cameraId),this.microphoneApi.destroyMicrophone(this.microphoneId),this.swf&&this.swf.remove()}},{key:"stop",value:function(e){var t=this;return this.cameraApi.cameraDetachFromStage(this.cameraId),this.cameraApi.destroyCamera(this.cameraId),this.cameraId=null,this.microphoneApi.destroyMicrophone(this.microphoneId),this.microphoneId=null,this.broadcastApi.destroyBroadcast(this.broadcastId)?(this.broadcastId=null,this.emit("stop"),void this.onceDevicesAreReady(function(){t.attachCamera(),e&&e()})):void this.emit("error","stop failed")}},{key:"attachCamera",value:function(){this.cameraApi.cameraSetMode(this.cameraId,_.default.mode.width,_.default.mode.height,_.default.mode.fps,_.default.mode.favorArea),this.cameraApi.cameraSetQuality(this.cameraId,this.encodingSettings.quality.split(",")[0],this.encodingSettings.quality.split(",")[1]),this.cameraApi.cameraSetKeyFrameInterval(this.cameraId,this.encodingSettings.keyframeinterval),this.options.preview&&this.cameraApi.cameraAttachToStage(this.cameraId)}},{key:"createMicrophone",value:function(){this.microphoneId=this.microphoneApi.createMicrophone(),this.microphoneApi.micUseEchoSuppression(this.microphoneId,L.default.useEchoSuppression)}},{key:"broadcast",value:function(e){var t=this;this.setupThinflash(function(){return t.broadcastId=t.broadcastApi.createBroadcast(),t.broadcastId?(t.once("BroadcastEvent",function(){t.broadcastApi.broadcastAttachCamera(t.broadcastId,t.cameraId),t.microphoneId&&t.broadcastApi.broadcastAttachMicrophone(t.broadcastId,t.microphoneId),t.emit("broadcasting"),e&&e()}),void t.broadcastApi.connectToBroadcast.apply(t.broadcastApi,[t.broadcastId,t.origin,t.accessKey].concat(t.options.tfArgs))):void t.emit("error","could not start broadcast")})}},{key:"enumerateDevices",value:function(){return null}},{key:"render",value:function(){this.obj=document.createElement("div"),this.el.appendChild(this.obj),this.obj.setAttribute("class","aiw-swf-container"),this.obj.setAttribute("id",O+"_"+this.id)}},{key:"setupThinflash",value:function(e){var t=this;if(this.swf)return void(e&&e());if(this.loading)return void setTimeout(this.setupThinflash.bind(this,e),50);window.tfSendToJavaScript=function(e,r,n){if(e===t.obj.getAttribute("id")){switch(n[1]){case"NetConnection.Connect.Closed":t.stop()}t.emit(r,n[1],n[0],n.slice(2))}},window.tfIsReady=function(){return!0};var r=function(e){var r=Object.create(e);return r.logError=function(){for(var e=arguments.length,r=Array(e),n=0;n<e;n++)r[n]=arguments[n];t.emit("tf-error",r)},r.getSwf=function(){return t.swf},r};this.broadcastApi=r(p.default),this.cameraApi=r(v.default),this.microphoneApi=r(m.default),this.playbackApi=r(g.default),f.default.embedSWF(this.options.tfSwfPath,this.obj.getAttribute("id"),"100%","100%",11,"/dist/expressInstall.swf",{tfID:this.obj.getAttribute("id")},{scale:"noscale",quality:"high",allowscriptaccess:"always",allowfullscreen:"true",wmode:"direct",align:"middle",salign:"TL",menu:"true",id:this.obj.getAttribute("id")},{id:this.obj.getAttribute("id"),class:"tf-content"},function(r){return t.swf=r.ref,t.swf?void t.onceTfIsReady(function(){t.onceDevicesAreReady(function(){t.attachCamera(),e&&e(r)})}):(t.emit("error","embedding swf failed"),void(e&&e()))})}},{key:"encodingSettings",set:function(e){var t=this;return e.quality&&"string"==typeof e.quality?isNaN(e.keyframeinterval)?void this.emit("error","encoder settings must include a keyframeinterval, must be a number"):"broadcasting"!==this.state?void(this.encodingSettingsValue=e):void this.stop(function(){t.encodingSettingsValue=e,t.broadcast()}):void this.emit("error","encoder settings must include a quality, must be a string")},get:function(){return this.encodingSettingsValue||S.default.preset}},{key:"mute",set:function(e){return!!this.microphoneId&&(e?this.microphoneApi.setVolume(this.microphoneId,0):this.microphoneApi.setVolume(this.microphoneId,60),this.emit(this.mute?"mute":"unmute"),this.mute)},get:function(){return!!this.microphoneId&&!this.microphoneApi.getVolume(this.microphoneId)}},{key:"state",get:function(){return this.broadcastId?"broadcasting":"stopped"}}],[{key:"isSupported",value:function(){return f.default.hasFlashPlayerVersion(A)}}]),t}(u.default);e.exports=T}])})},function(e,t,r){!function(t,r){e.exports=r()}(this,function(){return function(e){function t(n){if(r[n])return r[n].exports;var i=r[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var r={};return t.m=e,t.c=r,t.i=function(e){return e},t.d=function(e,t,r){Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=6)}([function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),c=r(5),u=n(c),l=r(1),f=n(l),h=r(2),p=n(h),d=r(3),v=n(d);r(4);var y={accessKey:null,affiliate:null,drivers:["flash","webrtc"],flashWmode:"transparent",gateway:null,host:null,iceServers:[],preview:!0,rtmpUrl:null,tfArgs:[],tfSwfPath:"",user:null},m=function(e){function t(e,r,n){i(this,t);var s=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));if(s.el=e,s.accessKey=r,s.options=(0,v.default)(n,y),!s.options.affiliate)throw new Error("affiliate required for broadcaster");if(!s.options.host)throw new Error("host required for broadcaster");s.drivers=[],s.currentDriver=null;for(var a=0;a<s.options.drivers.length;a++)s.options.drivers[a].isSupported()&&s.drivers.push(s.options.drivers[a]);return s.setup(),s}return s(t,e),a(t,[{key:"setup",value:function(){return this.drivers.length?(this.currentDriver=new this.drivers[0](this.el,this.accessKey,(0,v.default)(this.options)),void this.proxyEvents()):void this.emit(p.default.ERROR,f.default.NO_DRIVERS)}},{key:"broadcast",value:function(){var e=this;return this.currentDriver||this.setup(),this.currentDriver?void this.currentDriver.broadcast(function(){e.emit(p.default.START)}):void this.emit(p.default.NO_DRIVERS)}},{key:"proxyEvent",value:function(e){return function(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];this.emit.apply(this,[e].concat(r))}.bind(this)}},{key:"proxyEvents",value:function(){for(var e in p.default)this.currentDriver.on(p.default[e],this.proxyEvent(p.default[e]))}},{key:"destroy",value:function(){this.currentDriver&&this.currentDriver.destroy()}},{key:"stop",value:function(){var e=this;return this.currentDriver?void this.currentDriver.stop(function(){e.emit(p.default.STOP)}):void this.emit(p.default.ERROR,"cannot stop, no driver set")}},{key:"enumerateDevices",value:function(){return this.currentDriver?this.currentDriver.enumerateDevices?this.currentDriver.enumerateDevices():null:(this.emit(p.default.ERROR,"cannot get cameras, no driver set"),null)}},{key:"setCamera",value:function(e){return this.currentDriver?void this.currentDriver.setCamera(e):void this.emit(p.default.ERROR,"cannot set camera, no driver set")}},{key:"supportsEncodingSettings",value:function(){return!!this.currentDriver&&this.currentDriver.supportsEncodingSettings()}},{key:"supportsMute",value:function(){return!!this.currentDriver&&this.currentDriver.supportsMute()}},{key:"supportsDevices",value:function(){return!!this.currentDriver&&this.currentDriver.supportsDevices()}},{key:"mute",set:function(e){return this.currentDriver?(this.currentDriver.mute=e,this.currentDriver.mute):void this.emit(p.default.ERROR,"cannot set mute, no driver set")},get:function(){return this.currentDriver?this.currentDriver.mute:void this.emit(p.default.ERROR,"cannot get mute, no driver set")}},{key:"state",get:function(){return this.currentDriver?this.currentDriver.state:"uninitialized"}},{key:"encodingSettings",set:function(e){this.currentDriver&&this.this.currentDriver.supportsEncodingSettings()&&this.currentDriver.setEncodingSettings(e)}}]),t}(u.default);t.default=m},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={ELEMENT_REQUIRED:"element required",EMBED_SWF_FAILED:"embedding flash swf failed",GATEWAY_ERROR:"gateway error",GATEWAY_HANDLE_ERROR:"gateway create handle error",GATEWAY_REQUIRED:"gateway required",RTC_OFFER_FAILED:"rtc offer failed",SETUP_PEER_ANSWER_FAILED:"setup peer answer failed",NO_DRIVERS:"no supported drivers",NO_DEVICES:"no devices found",STOP_FAILED:"could not stop broadcast",ICE_SERVERS:"no valid ice servers"};t.default=r},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={UPDATE_STREAM:"update-local-stream",REMOVE_STREAM:"remove-local-stream",ERROR:"error",HANGUP:"hangup",JANUS:"janus",MUTE:"mute",UNMUTE:"unmute",BROADCASTING:"broadcasting",READY:"ready",START:"start",STOP:"stop"};t.default=r},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var r=e?Object.create(e):{};if(!t)return r;for(var n in t)"undefined"==typeof r[n]&&(r[n]=t[n]);return r}},function(e,t){"use strict";"function"!=typeof Object.create&&(Object.create=function(e){var t=function(){};return function(r,n){if(r!==Object(r)&&null!==r)throw TypeError("Argument must be an object, or null");t.prototype=r||{},n!==e&&Object.defineProperties(t.prototype,n);var i=new t;return t.prototype=null,i}}())},function(e,t){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function n(e){return"function"==typeof e}function i(e){return"number"==typeof e}function o(e){return"object"==typeof e&&null!==e}function s(e){return void 0===e}e.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(e){if(!i(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},r.prototype.emit=function(e){var t,r,i,a,c,u;if(this._events||(this._events={}),"error"===e&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;var l=new Error('Uncaught, unspecified "error" event. ('+t+")");throw l.context=t,l}if(r=this._events[e],s(r))return!1;if(n(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:a=Array.prototype.slice.call(arguments,1),r.apply(this,a)}else if(o(r))for(a=Array.prototype.slice.call(arguments,1),u=r.slice(),i=u.length,c=0;c<i;c++)u[c].apply(this,a);return!0},r.prototype.addListener=function(e,t){var i;if(!n(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,n(t.listener)?t.listener:t),this._events[e]?o(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,o(this._events[e])&&!this._events[e].warned&&(i=s(this._maxListeners)?r.defaultMaxListeners:this._maxListeners,i&&i>0&&this._events[e].length>i&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())),this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(e,t){function r(){this.removeListener(e,r),i||(i=!0,t.apply(this,arguments))}if(!n(t))throw TypeError("listener must be a function");var i=!1;return r.listener=t,this.on(e,r),this},r.prototype.removeListener=function(e,t){var r,i,s,a;if(!n(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(r=this._events[e],s=r.length,i=-1,r===t||n(r.listener)&&r.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(o(r)){for(a=s;a-- >0;)if(r[a]===t||r[a].listener&&r[a].listener===t){i=a;break}if(i<0)return this;1===r.length?(r.length=0,delete this._events[e]):r.splice(i,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},r.prototype.removeAllListeners=function(e){var t,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(r=this._events[e],n(r))this.removeListener(e,r);else if(r)for(;r.length;)this.removeListener(e,r[r.length-1]);return delete this._events[e],this},r.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?n(this._events[e])?[this._events[e]]:this._events[e].slice():[]},r.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(n(t))return 1;if(t)return t.length}return 0},r.listenerCount=function(e,t){return e.listenerCount(t)}},function(e,t,r){"use strict";"undefined"==typeof window?e.exports=function(){}:e.exports=r(0).default}])})},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),c=r(1),u=n(c),l=r(2),f=n(l),h=r(0),p=n(h),d=function(e){function t(e){i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.stock=e,r.el=(0,p.default)("div",["access_key"]),r.span=(0,p.default)("span",["access_key__key"]),r.regenerateEl=(0,p.default)("button",["access_key__regenerate"]),r.stock.bar.appendChild(r.el),r.stock.bar.appendChild(r.regenerateEl),(0,f.default)(r.el,"Access Key: "),r.el.appendChild(r.span),(0,f.default)(r.span,r.stock.accessKey),(0,f.default)(r.regenerateEl,"Reset key"),r.regenerateEl.onclick=function(){r.stock.regenerate()},r}return s(t,e),a(t,[{key:"destroy",value:function(){this.el.remove(),this.regenerateEl.remove()}}]),t}(u.default);t.default=d},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),c=r(1),u=n(c),l=r(2),f=n(l),h=r(0),p=n(h),d=function(e){function t(e){i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));r.stock=e,r.el=(0,p.default)("button",["broadcast"]),r.stock.bar.appendChild(r.el);var n=function(){"stopped"===r.stock.broadcaster.state?(r.el.classList.add("stopped"),(0,f.default)(r.el,"Broadcast")):(r.el.classList.remove("stopped"),(0,f.default)(r.el,"Stop"))};n();var s=function(){"stopped"===r.stock.broadcaster.state?r.stock.broadcaster.broadcast():r.stock.broadcaster.stop()};return e.broadcaster.on("start",n),e.broadcaster.on("stop",n),r.el.addEventListener("click",s),r}return s(t,e),a(t,[{key:"destroy",value:function(){this.el.remove()}}]),t}(u.default);t.default=d},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),c=r(1),u=n(c),l=r(2),f=n(l),h=r(0),p=n(h),d=function(e){function t(e){i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.stock=e,r.stock.broadcaster.on("error",r.updateError.bind(r)),r.el=(0,p.default)("div",["error"]),r.stock.bar.appendChild(r.el),r.stock.broadcaster.on("start",r.clearError.bind(r)),r.stock.broadcaster.on("error",r.updateError.bind(r)),r}return s(t,e),a(t,[{key:"clearError",value:function(){(0,f.default)(this.el,"")}},{key:"updateError",value:function(e){var t=void 0;switch(e){default:t="Unknown broadcast failure"}(0,f.default)(this.el,t)}},{key:"destroy",value:function(){this.stock.broadcaster.removeListener("error",this.updateError),this.el.remove()}}]),t}(u.default);t.default=d},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n);
}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),c=r(1),u=n(c),l=r(2),f=n(l),h=r(0),p=n(h),d=function(e){function t(e){i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));r.stock=e,r.el=(0,p.default)("button",["mute"]),r.stock.bar.appendChild(r.el),r.updateMuteButton();var n=function(){r.stock.broadcaster.mute=!r.stock.broadcaster.mute};return r.stock.broadcaster.on("mute",r.updateMuteButton.bind(r)),r.stock.broadcaster.on("unmute",r.updateMuteButton.bind(r)),r.el.addEventListener("click",n),r}return s(t,e),a(t,[{key:"updateMuteButton",value:function(){(0,f.default)(this.el,this.stock.broadcaster.mute?"Unmute":"Mute")}},{key:"destroy",value:function(){this.stock.broadcaster.removeListener("mute",this.updateMuteButton),this.stock.broadcaster.removeListener("unmute",this.updateMuteButton),this.el.remove()}}]),t}(u.default);t.default=d},function(e,t,r){"use strict";function n(e,t){for(var r=0;r<e.length;r++)t(e[r])}function i(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}function o(e,t,r){var n=e;return f(t)?(r=t,"string"==typeof e&&(n={uri:e})):n=p(t,{uri:e}),n.callback=r,n}function s(e,t,r){return t=o(e,t,r),a(t)}function a(e){function t(){4===f.readyState&&o()}function r(){var e=void 0;if(e=f.response?f.response:f.responseText||c(f),_)try{e=JSON.parse(e)}catch(e){}return e}function n(e){return clearTimeout(v),e instanceof Error||(e=new Error(""+(e||"Unknown XMLHttpRequest Error"))),e.statusCode=0,u(e,l)}function o(){if(!d){var t;clearTimeout(v),t=e.useXDR&&void 0===f.status?200:1223===f.status?204:f.status;var n=l,i=null;return 0!==t?(n={body:r(),statusCode:t,method:m,headers:{},url:y,rawRequest:f},f.getAllResponseHeaders&&(n.headers=h(f.getAllResponseHeaders()))):i=new Error("Internal XMLHttpRequest Error"),u(i,n,n.body)}}if("undefined"==typeof e.callback)throw new Error("callback argument missing");var a=!1,u=function(t,r,n){a||(a=!0,e.callback(t,r,n))},l={body:void 0,headers:{},statusCode:0,method:m,url:y,rawRequest:f},f=e.xhr||null;f||(f=e.cors||e.useXDR?new s.XDomainRequest:new s.XMLHttpRequest);var p,d,v,y=f.url=e.uri||e.url,m=f.method=e.method||"GET",b=e.body||e.data||null,g=f.headers=e.headers||{},w=!!e.sync,_=!1;if("json"in e&&(_=!0,g.accept||g.Accept||(g.Accept="application/json"),"GET"!==m&&"HEAD"!==m&&(g["content-type"]||g["Content-Type"]||(g["Content-Type"]="application/json"),b=JSON.stringify(e.json))),f.onreadystatechange=t,f.onload=o,f.onerror=n,f.onprogress=function(){},f.ontimeout=n,f.open(m,y,!w,e.username,e.password),w||(f.withCredentials=!!e.withCredentials),!w&&e.timeout>0&&(v=setTimeout(function(){d=!0,f.abort("timeout");var e=new Error("XMLHttpRequest timeout");e.code="ETIMEDOUT",n(e)},e.timeout)),f.setRequestHeader)for(p in g)g.hasOwnProperty(p)&&f.setRequestHeader(p,g[p]);else if(e.headers&&!i(e.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in e&&(f.responseType=e.responseType),"beforeSend"in e&&"function"==typeof e.beforeSend&&e.beforeSend(f),f.send(b),f}function c(e){if("document"===e.responseType)return e.responseXML;var t=204===e.status&&e.responseXML&&"parsererror"===e.responseXML.documentElement.nodeName;return""!==e.responseType||t?null:e.responseXML}function u(){}var l=r(12),f=r(3),h=r(13),p=r(16);e.exports=s,s.XMLHttpRequest=l.XMLHttpRequest||u,s.XDomainRequest="withCredentials"in new s.XMLHttpRequest?s.XMLHttpRequest:l.XDomainRequest,n(["get","put","post","patch","head","delete"],function(e){s["delete"===e?"del":e]=function(t,r,n){return r=o(t,r,n),r.method=e.toUpperCase(),a(r)}})},function(e,t,r){function n(e,t,r){if(!a(t))throw new TypeError("iterator must be a function");arguments.length<3&&(r=this),"[object Array]"===c.call(e)?i(e,t,r):"string"==typeof e?o(e,t,r):s(e,t,r)}function i(e,t,r){for(var n=0,i=e.length;n<i;n++)u.call(e,n)&&t.call(r,e[n],n,e)}function o(e,t,r){for(var n=0,i=e.length;n<i;n++)t.call(r,e.charAt(n),n,e)}function s(e,t,r){for(var n in e)u.call(e,n)&&t.call(r,e[n],n,e)}var a=r(3);e.exports=n;var c=Object.prototype.toString,u=Object.prototype.hasOwnProperty},function(e,t,r){(function(t){"undefined"!=typeof window?e.exports=window:"undefined"!=typeof t?e.exports=t:"undefined"!=typeof self?e.exports=self:e.exports={}}).call(t,r(15))},function(e,t,r){var n=r(14),i=r(11),o=function(e){return"[object Array]"===Object.prototype.toString.call(e)};e.exports=function(e){if(!e)return{};var t={};return i(n(e).split("\n"),function(e){var r=e.indexOf(":"),i=n(e.slice(0,r)).toLowerCase(),s=n(e.slice(r+1));"undefined"==typeof t[i]?t[i]=s:o(t[i])?t[i].push(s):t[i]=[t[i],s]}),t}},function(e,t){function r(e){return e.replace(/^\s*|\s*$/g,"")}t=e.exports=r,t.left=function(e){return e.replace(/^\s*/,"")},t.right=function(e){return e.replace(/\s*$/,"")}},function(e,t){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t){function r(){for(var e={},t=0;t<arguments.length;t++){var r=arguments[t];for(var i in r)n.call(r,i)&&(e[i]=r[i])}return e}e.exports=r;var n=Object.prototype.hasOwnProperty},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),c=r(1),u=n(c),l=r(5),f=n(l),h=r(4),p=n(h),d=r(10),v=n(d),y=r(0),m=n(y),b=r(9),g=n(b),w=r(6),_=n(w),E=r(7),S=n(E),k=r(8),L=n(k),A=["ready","mute","unmute","start","stop","error"],O=function(e){function t(e,r,n){i(this,t);var s=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));s.broadcasterEl=(0,m.default)("div",["broadcaster"]),s.bar=(0,m.default)("div",["control-bar"]),s.el=e,s.el.appendChild(s.broadcasterEl),s.el.appendChild(s.bar),s.accessKeyEndpoint=r,s.options=n,n.gateway&&(n.janusGateway=n.gateway),n.host||(n.host="livelyvideo.tv");for(var a=[],c=[],u=0;u<s.options.drivers.length;u++)switch(s.options.drivers[u]){case"flash":n.rtmpUrl||a.push("flash driver requires rtmpUrl"),c.push(p.default);break;case"webrtc":n.janusGateway||a.push("webrtc driver requires gateway"),n.rtmpUrl||a.push("webrtc driver requires rtmpUrl"),n.iceServers&&!n.iceServers.length&&a.push("webrtc requires ice servers");break;default:a.push("unknown driver "+s.options.drivers[u])}if(a.length)throw new Error(a.join(", "));return n.drivers=c,n.preview=!0,s.controls=[],s}return s(t,e),a(t,[{key:"destroy",value:function(){this.previewEl&&this.previewEl.remove(),this.bar.remove(),this.broadcaster&&this.broadcaster.destroy()}},{key:"destroyControls",value:function(){for(var e=0;e<this.controls.length;e++)this.controls[e].destroy()}},{key:"setupControls",value:function(){this.controls=[],this.controls.push(new g.default(this)),this.controls.push(new S.default(this)),this.controls.push(new _.default(this)),this.controls.push(new L.default(this))}},{key:"setup",value:function(e,t){var r=this,n=this.accessKeyEndpoint;if(t){var i=n.indexOf("?")===-1?"?":"&";n+=i+"regenerate=1"}this.destroyControls(),(0,v.default)({method:"GET",uri:n,json:!0},function(t,n,i){if(t)return r.emit("error","failed to get access key",t),void(e&&e(t));if(n.statusCode>399){var o=new Error(i);return r.emit("error","failed to get access key",o),void(e&&e(o))}r.accessKey=i.results.pvtKey,r.broadcaster=new f.default(r.broadcasterEl,r.accessKey,r.options);for(var s=function(e){r.broadcaster.on(A[e],function(){for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];n.unshift(A[e]),r.emit.apply(r,n)})},a=0;a<A.length;a++)s(a);r.setupControls(),r.emit("access-key",r.accessKey),e&&e()})}},{key:"regenerate",value:function(e){this.broadcaster&&this.broadcaster.destroy(),this.setup(e,!0)}}]),t}(u.default);t.default=O}])});
},{}],3:[function(require,module,exports){
(function (global){
!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.LivelyStockLivePlayer=e()}}(function(){var e;return function t(e,r,n){function i(s,a){if(!r[s]){if(!e[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(o)return o(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var c=r[s]={exports:{}};e[s][0].call(c.exports,function(t){var r=e[s][1][t];return i(r?r:t)},c,c.exports,t,e,r,n)}return r[s].exports}for(var o="function"==typeof require&&require,s=0;s<n.length;s++)i(n[s]);return i}({1:[function(e,t,r){"use strict";function n(e,t){var r=document.createElement(e);return r.classList.add.apply(r.classList,t),r}Object.defineProperty(r,"__esModule",{value:!0}),r["default"]=n},{}],2:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=e("events"),l=n(u),c=e("../create-element"),f=n(c),d=function(e){function t(e){i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.controls=e,r.livelyPlayer=e.livelyPlayer,r.bar=e.bar,r.el=f["default"]("div",["fullscreen"]),r.el.setAttribute("title","Full Screen"),r.bar.appendChild(r.el),r.el.addEventListener("click",r.toggleFullScreen.bind(r)),r}return s(t,e),a(t,[{key:"destroy",value:function(){this.el.remove()}},{key:"setIcon",value:function(){this.isFullscreen()?(this.el.classList.remove("fullscreen-exit"),this.el.classList.add("fullscreen-exit")):(this.el.classList.remove("fullscreen-exit"),this.el.classList.add("fullscreen-exit"))}},{key:"isFullscreen",value:function(){return!!(document.fullScreen||document.webkitIsFullScreen||document.mozFullScreen||document.msFullscreenElement||document.fullscreenElement)}},{key:"toggleFullScreen",value:function(){if(this.isFullscreen())return void(document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen());var e=this.livelyPlayer.el.parentNode;e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullScreen?e.webkitRequestFullScreen():e.msRequestFullscreen?e.msRequestFullscreen():this.livelyPlayer.el.webkitEnterFullscreen&&this.livelyPlayer.el.webkitEnterFullscreen()}}]),t}(l["default"]);r["default"]=d},{"../create-element":1,events:44}],3:[function(e,t,r){"use strict";function n(e){var t=void 0;if(e.getBoundingClientRect&&e.parentNode&&(t=e.getBoundingClientRect()),!t)return{top:0,left:0,right:0};var r=document.documentElement,n=document.body,i=r.clientTop||n.clientTop||0,o=r.clientLeft||n.clientLeft||0,s=window.pageYOffset||n.scrollTop,a=window.pageXOffset||n.scrollLeft,u=Math.floor(t.left+a-o);return{top:Math.floor(t.top+s-i),left:u,right:u+t.right}}Object.defineProperty(r,"__esModule",{value:!0}),r["default"]=n},{}],4:[function(e,t,r){"use strict";function n(e){var t=e.pageY,r=e.pageX;return e.changedTouches&&(t=e.changedTouches[0].pageY,r=e.changedTouches[0].pageX),{y:t,x:r}}Object.defineProperty(r,"__esModule",{value:!0}),r["default"]=n},{}],5:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=e("events"),l=n(u),c=e("@livelyvideo/player-core/lib/detect"),f=n(c),d=e("@livelyvideo/player-core/lib/get-default-options"),h=n(d),p=e("@livelyvideo/player-core/lib/logger"),v=n(p),y=e("./fullscreen"),m=n(y),g=e("./overlay"),b=n(g),w=e("./popout"),E=n(w),_=e("./playpause"),k=n(_),O=e("./progress"),P=n(O),T=e("./quality-selector"),R=n(T),L=e("./screen-interaction"),S=n(L),D=e("./volume"),I=n(D),A={controls:["overlay","playpause","fullscreen","popout","progress","quality-selector","volume"],popout:{url:"",width:480,height:280}},M=function(e){function t(e,r){i(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.el=e,n.bar=document.createElement("div"),n.controls=[],n.mobileControls=f["default"].any(),n.mobileControls&&n.el.classList.add("mobile"),n.el.classList.add("lvcontrols"),n.bar.classList.add("lvcontrols__bar"),n.el.appendChild(n.bar),n.options=h["default"](r,A),n.options.livelyPlayer&&n.attach(n.options.livelyPlayer),n}return s(t,e),a(t,[{key:"destroyControls",value:function(){for(var e=0;e<this.controls.length;e++)this.controls[e].destroy()}},{key:"destroy",value:function(){this.destroyControls(),this.bar.remove(),this.screenInteraction&&this.screenInteraction.destroy()}},{key:"attach",value:function(e){var t=this;this.livelyPlayer=e;for(var r=function(e){switch(e){case"fullscreen":t.controls.push(new m["default"](t));break;case"overlay":t.controls.push(new b["default"](t));break;case"playpause":t.controls.push(new k["default"](t));break;case"popout":t.controls.push(new E["default"](t));break;case"progress":t.controls.push(new P["default"](t));break;case"quality-selector":t.controls.push(new R["default"](t));break;case"volume":t.controls.push(new I["default"](t));break;default:v["default"].error("unrecognized control",e)}},n=0;n<this.options.controls.length;n++)r(this.options.controls[n]);this.screenInteraction=new S["default"](this.livelyPlayer.el),this.screenInteraction.on("user-active",function(){t.bar.classList.add("interacting")}),this.screenInteraction.on("user-idle",function(){t.bar.classList.remove("interacting")})}}]),t}(l["default"]);r["default"]=M},{"./fullscreen":2,"./overlay":6,"./playpause":7,"./popout":8,"./progress":9,"./quality-selector":10,"./screen-interaction":11,"./volume":12,"@livelyvideo/player-core/lib/detect":15,"@livelyvideo/player-core/lib/get-default-options":19,"@livelyvideo/player-core/lib/logger":20,events:44}],6:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=e("events"),l=n(u),c=e("../create-element"),f=n(c),d=function(e){function t(e){i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.controls=e,r.livelyPlayer=e.livelyPlayer,r.bar=e.bar,r.el=f["default"]("div",["big-button"]),r.el.setAttribute("title","Full Screen"),r.controls.el.appendChild(r.el),r.el.addEventListener("click",r.togglePlaying.bind(r)),r.livelyPlayer.on("play",r.setIcon.bind(r)),r.livelyPlayer.on("pause",r.setIcon.bind(r)),r.livelyPlayer.on("stop",r.setIcon.bind(r)),r.livelyPlayer.on("offline",r.setIcon.bind(r)),r}return s(t,e),a(t,[{key:"destroy",value:function(){this.el.remove()}},{key:"setIcon",value:function(){"offline"===this.livelyPlayer.getState()?(this.el.classList.remove("stopped"),this.el.classList.remove("playing"),this.el.classList.add("offline")):this.livelyPlayer.tryingToPlay?(this.el.classList.remove("stopped"),this.el.classList.remove("offline"),this.el.classList.add("playing")):(this.el.classList.remove("playing"),this.el.classList.remove("offline"),this.el.classList.add("stopped"))}},{key:"togglePlaying",value:function(){this.livelyPlayer.tryingToPlay?this.livelyPlayer.stop():this.livelyPlayer.play()}}]),t}(l["default"]);r["default"]=d},{"../create-element":1,events:44}],7:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=e("events"),l=n(u),c=e("../create-element"),f=n(c),d=function(e){function t(e){i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.controls=e,r.livelyPlayer=e.livelyPlayer,r.bar=e.bar,r.el=f["default"]("div",["play-button"]),r.el.setAttribute("title","Toggle play/pause"),r.bar.appendChild(r.el),r.el.addEventListener("click",r.togglePlaying.bind(r)),r.livelyPlayer.on("play",r.setIcon.bind(r)),r.livelyPlayer.on("pause",r.setIcon.bind(r)),r.livelyPlayer.on("stop",r.setIcon.bind(r)),r.setIcon(),r}return s(t,e),a(t,[{key:"destroy",value:function(){this.el.remove()}},{key:"setIcon",value:function(){this.livelyPlayer.tryingToPlay?(this.el.classList.remove("stopped"),this.el.classList.add("playing"),this.el.setAttribute("title","Pause")):(this.el.classList.remove("playing"),this.el.classList.add("stopped"),this.el.setAttribute("title","Play"))}},{key:"togglePlaying",value:function(){this.livelyPlayer.tryingToPlay?this.livelyPlayer.vod?this.livelyPlayer.pause():this.livelyPlayer.stop():this.livelyPlayer.play()}}]),t}(l["default"]);r["default"]=d},{"../create-element":1,events:44}],8:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=e("events"),l=n(u),c=e("@livelyvideo/player-core/lib/logger"),f=n(c),d=e("@livelyvideo/player-core/lib/parse-url"),h=n(d),p=e("../create-element"),v=n(p),y=function(e){function t(e){i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.options.popout&&e.options.popout.url?(r.popoutUrl=h["default"](e.options.popout.url),r.popoutUrl?(r.controls=e,r.livelyPlayer=e.livelyPlayer,r.bar=e.bar,r.popoutOptions="width="+e.options.popout.width+", height="+e.options.popout.height+", resizable=yes, scrollbars=no, titlebar=no",r.poppedoutPlayer=null,r.el=v["default"]("div",["popout-button"]),r.el.setAttribute("target","_blank"),r.el.setAttribute("title","Popout"),r.el.addEventListener("click",r.openPopout.bind(r)),r.bar.appendChild(r.el),r.el.addEventListener("click",r.openPopout.bind(r)),r):(f["default"].error("popout url is invalid"),o(r))):o(r)}return s(t,e),a(t,[{key:"destroy",value:function(){this.el&&this.el.remove()}},{key:"popoverStartPlaying",value:function(e){var t=this;return this.livelyPlayer?(this.livelyPlayer.play(),e&&(this.livelyPlayer.currentTime=e.currentTime,this.livelyPlayer.volume(e.volume)),void this.livelyPlayer.play(function(){e&&e.muted?t.livelyPlayer.mute():e&&!e.muted&&t.livelyPlayer.unmute()})):void f["default"].error("could not start playing on pop in, no player instance")}},{key:"openPopout",value:function(e){var t=this;if(!this.livelyPlayer)return void f["default"].error("could not attach popout, no player instance");if(this.poppedoutPlayer)return void this.poppedoutPlayer.focus();if(e.preventDefault(),this.poppedoutPlayer&&(this.poppedoutPlayer.onbeforeunload=null,this.poppedoutPlayer.onunload=null),this.livelyPlayer.vod){var r=this.popoutUrl.search?"&":"?";this.popoutUrl&&(this.popoutUrl.href+=r+"start"+this.livelyPlayer.currentTime)}this.poppedoutPlayer=window.open(this.popoutUrl.href,"_blank",this.popoutOptions),this.livelyPlayer.pause();var n=void 0,i=function(){t.poppedoutPlayer.closed||(delete t.poppedoutPlayer,setTimeout(function(){t.popoverStartPlaying(n)},20))};this.poppedoutPlayer.onmessage=function(e){n=e.data},setTimeout(function(){t.poppedoutPlayer.addEventListener("beforeunload",i)},250)}}]),t}(l["default"]);r["default"]=y},{"../create-element":1,"@livelyvideo/player-core/lib/logger":20,"@livelyvideo/player-core/lib/parse-url":23,events:44}],9:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=e("events"),l=n(u),c=e("@livelyvideo/player-core/lib/logger"),f=n(c),d=e("../get-el-position"),h=n(d),p=e("../get-pointer-position"),v=n(p),y=function(e){function t(e){i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.controls=e,r.livelyPlayer=e.livelyPlayer,r.bar=e.bar,r.rendered=!1,r.livelyPlayer.on("manifest",r.renderIfNotRendered.bind(r)),r.render(),r}return s(t,e),a(t,[{key:"renderIfNotRendered",value:function(){this.rendered||this.render()}},{key:"render",value:function(){var e=this;if(this.livelyPlayer.vod){this.rendered=!0,this.livelyPlayer.removeListener("manifest",this.renderIfNotRendered),this.el=document.createElement("div");var t=this.controls.screenInteraction.userInteraction?"progress interacting":"progress";this.el.setAttribute("class",t),this.progressBarEl=document.createElement("div"),this.progressBarEl.setAttribute("class","progress-bar"),this.sliderEl=document.createElement("div"),this.sliderEl.setAttribute("class","progress-slider"),this.sliderBufferEl=document.createElement("div"),this.sliderBufferEl.setAttribute("class","progress-slider-buffer"),this.sliderValueEl=document.createElement("div"),this.sliderValueEl.setAttribute("class","progress-slider-value"),this.controls.screenInteraction.on("user-active",function(){e.el.classList.add("interacting")}),this.controls.screenInteraction.on("user-idle",function(){e.el.classList.remove("interacting")}),this.nextTime=0,this.el.addEventListener("mousedown",function(t){e.startDrag(t)}),document.addEventListener("mouseup",function(t){e.stopDrag(t)}),document.addEventListener("mousemove",function(t){e.moveSlider(t)}),this.el.appendChild(this.progressBarEl),this.el.appendChild(this.sliderEl),this.el.appendChild(this.sliderBufferEl),this.el.appendChild(this.sliderValueEl),this.controls.el.appendChild(this.el),this.livelyPlayer.on("timeupdate",function(t){e.updateSliderValue(t)}),this.livelyPlayer.on("progress",function(t){e.updateSliderValue(t)})}}},{key:"calculateSeek",value:function(e){if(this.dragging){var t=(v["default"](e).x-h["default"](this.el).left)/this.el.getBoundingClientRect().width;t=Math.max(t,0),t=Math.min(t,1),this.nextTime=t*this.livelyPlayer.duration}}},{key:"updateSliderValue",value:function(){if(!this.dragging){for(var e=this.livelyPlayer,t=e.currentTime,r=t/e.duration,n=this.livelyPlayer.bufferTimes,i=void 0,o=0;o<n.length;o++)if(t>=n[o][0]&&t<=n[o][1]){i=n[o];break}if(i){var s=Math.max(Number((i[0]/e.duration).toFixed(2)),0),a=Math.max(Number((i[1]/e.duration).toFixed(2)),0);this.sliderBufferEl.style.left=100*s+"%",this.sliderBufferEl.style.width=100*(a-s)+"%"}else this.sliderBufferEl.style.width=0;this.sliderValueEl.style.left=100*r+"%"}}},{key:"moveSlider",value:function(e){this.dragging&&(this.sliderValueEl.style.left=v["default"](e).x-h["default"](this.el).left+"px")}},{key:"startDrag",value:function(){this.dragging=!0}},{key:"stopDrag",value:function(e){if(this.dragging){this.dragging=!1;var t=(v["default"](e).x-h["default"](this.el).left)/this.el.getBoundingClientRect().width;t=Math.max(t,0),t=Math.min(t,1);var r=t*this.livelyPlayer.duration;return isNaN(r)?void f["default"].error("attempted to set current time to NaN",r):void(this.livelyPlayer.currentTime=r)}}},{key:"destroy",value:function(){this.livelyPlayer.removeListener("manifest",this.renderIfNotRendered),this.livelyPlayer.removeListener("timeupdate",this.updateSliderValue),this.livelyPlayer.removeListener("progress",this.updateSliderValue),this.rendered&&(this.rendered=!1,this.el.remove(),this.progressBarEl.remove(),this.sliderEl.remove(),this.sliderBufferEl.remove(),this.sliderValueEl.remove(),document.removeEventListener("mouseup",this.stopDrag.bind(this)))}}]),t}(l["default"]);r["default"]=y},{"../get-el-position":3,"../get-pointer-position":4,"@livelyvideo/player-core/lib/logger":20,events:44}],10:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=e("events"),l=n(u),c=e("text-content"),f=n(c),d=function(e){function t(e){i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.controls=e,r.livelyPlayer=e.livelyPlayer,r.bar=e.bar,r.mediaData=null,r.encodings=[],r.el=document.createElement("div"),r.el.setAttribute("title","Quality Selector"),r.qualitiesEl=document.createElement("div"),r.qualitiesEl.setAttribute("class","qualities hidden"),r.el.appendChild(r.qualitiesEl),r.el.addEventListener("click",r.openQualitySelector.bind(r)),r.livelyPlayer.on("progress",function(){r.reclass()}),r.livelyPlayer.on("play",function(){r.render()}),r.controls.bar.appendChild(r.el),r}return s(t,e),a(t,[{key:"openQualitySelector",value:function(e){"qualities"!==this.qualitiesEl.getAttribute("class")&&(this.controls.screenInteraction.lockOpen(),this.qualitiesEl.setAttribute("class","qualities"),e.stopPropagation(),document.addEventListener("click",this.closeQualitySelector.bind(this)))}},{key:"closeQualitySelector",value:function(){this.controls.screenInteraction.releaseLockOpen(),document.removeEventListener("click",this.closeQualitySelector.bind(this)),this.qualitiesEl.setAttribute("class","qualities hidden")}},{key:"destroy",value:function(){document.removeEventListener("click",this.closeQualitySelector.bind(this)),this.qualitiesEl.remove(),this.el.remove()}},{key:"reclass",value:function(){var e=this.livelyPlayer.currentEncoding(),t=void 0,r=void 0;e||(t=this.currentLevel,r=this.nextLevel);for(var n=void 0,i=0;i<this.qualitiesEl.children.length;i++)n=this.qualitiesEl.children[i],i===t||e&&this.qualitiesEl.children[i].getAttribute("data-location")===e.location?n.classList.add("current-level"):n.classList.remove("current-level"),i===r?n.classList.add("next-level"):n.classList.remove("next-level")}},{key:"render",value:function(){var e=this;if(this.encodings.forEach(function(e){e.remove()}),this.encodings=[],this.mediaData=this.livelyPlayer.mediaData,!(this.mediaData&&this.mediaData.encodings&&this.mediaData.encodings.length))return void this.el.setAttribute("class","quality-selector hidden");this.el.setAttribute("class","quality-selector");for(var t=this.livelyPlayer.currentEncoding(),r=this.currentLevel,n=this.chosenLevel,i=this.nextLevel,o=function(o,s){var a=document.createElement("div"),u="quality",l=void 0;o.videoKbps&&(o.videoHeight?(f["default"](a,o.videoHeight+"p - "+(o.videoKbps+o.audioKbps)+"Kbps"),l=o.videoKbps+o.audioKbps,null!==n&&"undefined"!=typeof s&&s===n&&(u+=" selected"),null!==r&&"undefined"!=typeof s&&s===r&&(u+=" current-level"),null!==i&&"undefined"!=typeof s&&s===i&&(u+=" next-level")):(r--,n--,i--,f["default"](a,"Auto"),l=null,null===t&&(u+=" selected")),a.setAttribute("class",u),a.setAttribute("data-location",o.location),a.addEventListener("click",function(){e.livelyPlayer.bitrate=l,e.render()}),e.qualitiesEl.appendChild(a),e.encodings.push(a))};this.qualitiesEl.firstChild;)this.qualitiesEl.removeChild(this.qualitiesEl);this.mediaData.auto&&o({location:this.mediaData.manifest,videoKbps:!0}),this.mediaData.encodings.reverse().forEach(o)}},{key:"chosenLevel",get:function(){return this.mediaData.encodings?this.livelyPlayer.chosenLevel?this.mediaData.encodings.length-this.livelyPlayer.chosenLevel:this.livelyPlayer.chosenLevel:null}},{key:"currentLevel",get:function(){return this.mediaData.encodings?this.livelyPlayer.currentLevel?this.mediaData.encodings.length-this.livelyPlayer.currentLevel:this.livelyPlayer.currentLevel:null}},{key:"nextLevel",get:function(){return this.mediaData.encodings?this.livelyPlayer.nextLevel?this.mediaData.encodings.length-this.livelyPlayer.nextLevel:this.livelyPlayer.nextLevel:null}}]),t}(l["default"]);r["default"]=d},{events:44,"text-content":52}],11:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=e("events"),l=n(u),c=e("@livelyvideo/player-core/lib/detect"),f=n(c),d=e("@livelyvideo/player-core/lib/events"),h=n(d),p=e("lodash.throttle"),v=n(p),y=function(e){function t(e,r){i(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.targetEl=e,n.limit=r||250,n.mobileControls=f["default"].any(),n.userInteraction=null,n.userInteractionTimeout=null,n.disableReset=null,n.throttledSetUserInteraction=v["default"](n.setUserInteraction.bind(n),n.limit,{leading:!0,trailing:!1}),n.handleEvents(),n}return s(t,e),a(t,[{key:"handleEvents",value:function(){var e=this;return this.mobileControls?(this.setUserInteraction(),this.targetEl.addEventListener("touchstart",function(){e.forceInteraction()}),this.targetEl.addEventListener("touchend",function(){e.forceInteractionEnd()}),void this.targetEl.addEventListener("touchcancel",function(){e.forceInteractionEnd()})):(this.targetEl.addEventListener("mousemove",function(t){e.resetUserInteraction(),e.throttledSetUserInteraction(t)}),this.targetEl.addEventListener("mousedown",function(){e.forceInteraction()}),this.targetEl.addEventListener("mouseup",function(){e.forceInteractionEnd()}),void this.targetEl.addEventListener("mouseout",function(){e.forceInteractionEnd()}))}},{key:"forceInteraction",value:function(){this.disableReset=!0,clearTimeout(this.userInteractionTimeout),this.setUserInteraction()}},{key:"lockOpen",value:function(){this.lockedOpen=!0,clearTimeout(this.userInteractionTimeout)}},{key:"releaseLockOpen",value:function(){this.lockedOpen=!1,this.resetUserInteraction()}},{key:"forceInteractionEnd",value:function(){this.disableReset=!1,this.setUserInteraction()}},{key:"setUserInteraction",value:function(){this.userInteraction||(this.userInteraction=!0,this.emit(h["default"].USER_ACTIVE)),this.disableReset||this.resetUserInteraction()}},{key:"resetUserInteraction",value:function(){var e=this;clearTimeout(this.userInteractionTimeout),this.userInteractionTimeout=setTimeout(function(){e.lockedOpen||(e.userInteraction=!1,e.emit(h["default"].USER_IDLE))},2e3)}},{key:"destroy",value:function(){return this.mobileControls?(this.targetEl.removeEventListener("touchstart",this.forceInteraction.bind(this)),this.targetEl.removeEventListener("touchend",this.forceInteractionEnd.bind(this)),void this.targetEl.removeEventListener("touchcancel",this.forceInteractionEnd.bind(this))):(this.targetEl.removeEventListener("mousemove",this.throttledSetUserInteraction.bind(this)),this.targetEl.removeEventListener("mousedown",this.forceInteraction.bind(this)),this.targetEl.removeEventListener("mouseup",this.forceInteractionEnd.bind(this)),void this.targetEl.removeEventListener("mouseout",this.forceInteractionEnd.bind(this)))}}]),t}(l["default"]);r["default"]=y},{"@livelyvideo/player-core/lib/detect":15,"@livelyvideo/player-core/lib/events":17,events:44,"lodash.throttle":49}],12:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=e("events"),l=n(u),c=e("../get-el-position"),f=n(c),d=e("../get-pointer-position"),h=n(d),p=function(e){function t(e){i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.controls=e,r.livelyPlayer=e.livelyPlayer,r.bar=e.bar,r.el=document.createElement("div"),r.indicatorEl=document.createElement("div"),r.indicatorEl.setAttribute("title","Mute"),r.sliderEl=document.createElement("div"),r.sliderValueEl=document.createElement("div"),r.showingSlider=!1,r.hideSlider(),r.indicatorEl.setAttribute("class","indicator"),r.sliderValueEl.setAttribute("class","slider-value"),r.sliderEl.appendChild(r.sliderValueEl),r.setMutedClass(),r.indicatorEl.addEventListener("click",function(e){r.toggleMuted(e)}),r.indicatorEl.addEventListener("touch",function(e){r.toggleMuted(e)}),r.el.addEventListener("mouseover",function(){r.showingSlider=!0,r.showSlider()}),r.el.addEventListener("mouseout",function(){r.showingSlider=!1,r.hideSlider()}),r.sliderEl.addEventListener("click",function(e){r.clickVolume(e)}),r.sliderEl.addEventListener("mousedown",function(e){r.startDrag(e)}),r.el.appendChild(r.indicatorEl),r.el.appendChild(r.sliderEl),r.el.setAttribute("class","volume-bar"),r.bar.appendChild(r.el),r.livelyPlayer.on("mute",function(e){r.setMutedClass(e)}),r.livelyPlayer.on("unmute",function(e){r.setMutedClass(e)}),r.livelyPlayer.on("volume",function(e){r.updateVolume(e)}),r.livelyPlayer.on("play",function(e){r.setMutedClass(e)}),r.updateVolume(),r}return s(t,e),a(t,[{key:"updateVolume",value:function(){this.setMutedClass(),this.setVolume()}},{key:"setMutedClass",value:function(){var e=this.livelyPlayer.muted?"muted":"unmuted";this.indicatorEl.setAttribute("class","indicator "+e);var t=this.livelyPlayer.muted?"Unmute":"Mute";this.indicatorEl.setAttribute("title",t)}},{key:"startDrag",value:function(){this.dragging=!0,document.addEventListener("mousemove",this.calculateVolume.bind(this)),document.addEventListener("mouseup",this.stopDrag.bind(this)),document.addEventListener("mouseleave",this.stopDrag.bind(this))}},{key:"stopDrag",value:function(){this.dragging=!1,this.hideSlider(),document.removeEventListener("mouseup",this.stopDrag.bind(this)),document.removeEventListener("mouseleave",this.stopDrag.bind(this)),document.removeEventListener("mousemove",this.calculateVolume.bind(this))}},{key:"calculateVolume",value:function(e){if(this.dragging){var t=Math.floor(h["default"](e).x-f["default"](this.sliderEl).left)/100;t=Math.max(t,0),t=Math.min(t,1),this.livelyPlayer.volume=t}}},{key:"clickVolume",value:function(e){this.dragging=!0,this.calculateVolume(e),
this.dragging=!1}},{key:"setVolume",value:function(){this.sliderValueEl.style.width=Math.floor(100*this.livelyPlayer.volume)+"%"}},{key:"toggleMuted",value:function(){this.livelyPlayer.muted?this.livelyPlayer.unmute():this.livelyPlayer.mute()}},{key:"showSlider",value:function(){this.sliderEl.setAttribute("class","slider")}},{key:"hideSlider",value:function(){this.dragging||this.showingSlider||this.sliderEl.setAttribute("class","slider hidden")}},{key:"destroy",value:function(){this.el.remove(),this.indicatorEl.remove(),this.sliderEl.remove(),this.sliderValueEl.remove(),this.livelyPlayer.removeListener("mute",this.setMutedClass.bind(this)),this.livelyPlayer.removeListener("unmute",this.setMutedClass.bind(this)),this.livelyPlayer.removeListener("volume",this.updateVolume.bind(this)),this.livelyPlayer.removeListener("play",this.setMutedClass.bind(this))}}]),t}(l["default"]);r["default"]=p},{"../get-el-position":3,"../get-pointer-position":4,events:44}],13:[function(t,r,n){(function(i){!function(t){if("object"==typeof n&&"undefined"!=typeof r)r.exports=t();else if("function"==typeof e&&e.amd)e([],t);else{var o;o="undefined"!=typeof window?window:"undefined"!=typeof i?i:"undefined"!=typeof self?self:this,o.LivelyPlayerCore=t()}}(function(){return function e(r,n,i){function o(a,u){if(!n[a]){if(!r[a]){var l="function"==typeof t&&t;if(!u&&l)return l(a,!0);if(s)return s(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var f=n[a]={exports:{}};r[a][0].call(f.exports,function(e){var t=r[a][1][e];return o(t?t:e)},f,f.exports,e,r,n,i)}return n[a].exports}for(var s="function"==typeof t&&t,a=0;a<i.length;a++)o(i[a]);return o}({1:[function(e,t){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function n(e){return"function"==typeof e}function i(e){return"number"==typeof e}function o(e){return"object"==typeof e&&null!==e}function s(e){return void 0===e}t.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(e){if(!i(e)||0>e||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},r.prototype.emit=function(e){var t,r,i,a,u,l;if(this._events||(this._events={}),"error"===e&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;var c=new Error('Uncaught, unspecified "error" event. ('+t+")");throw c.context=t,c}if(r=this._events[e],s(r))return!1;if(n(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:a=Array.prototype.slice.call(arguments,1),r.apply(this,a)}else if(o(r))for(a=Array.prototype.slice.call(arguments,1),l=r.slice(),i=l.length,u=0;i>u;u++)l[u].apply(this,a);return!0},r.prototype.addListener=function(e,t){var i;if(!n(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,n(t.listener)?t.listener:t),this._events[e]?o(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,o(this._events[e])&&!this._events[e].warned&&(i=s(this._maxListeners)?r.defaultMaxListeners:this._maxListeners,i&&i>0&&this._events[e].length>i&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())),this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(e,t){function r(){this.removeListener(e,r),i||(i=!0,t.apply(this,arguments))}if(!n(t))throw TypeError("listener must be a function");var i=!1;return r.listener=t,this.on(e,r),this},r.prototype.removeListener=function(e,t){var r,i,s,a;if(!n(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(r=this._events[e],s=r.length,i=-1,r===t||n(r.listener)&&r.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(o(r)){for(a=s;a-->0;)if(r[a]===t||r[a].listener&&r[a].listener===t){i=a;break}if(0>i)return this;1===r.length?(r.length=0,delete this._events[e]):r.splice(i,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},r.prototype.removeAllListeners=function(e){var t,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(r=this._events[e],n(r))this.removeListener(e,r);else if(r)for(;r.length;)this.removeListener(e,r[r.length-1]);return delete this._events[e],this},r.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?n(this._events[e])?[this._events[e]]:this._events[e].slice():[]},r.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(n(t))return 1;if(t)return t.length}return 0},r.listenerCount=function(e,t){return e.listenerCount(t)}},{}],2:[function(e,t){function r(e,t,r){if(!s(t))throw new TypeError("iterator must be a function");arguments.length<3&&(r=this),"[object Array]"===a.call(e)?n(e,t,r):"string"==typeof e?i(e,t,r):o(e,t,r)}function n(e,t,r){for(var n=0,i=e.length;i>n;n++)u.call(e,n)&&t.call(r,e[n],n,e)}function i(e,t,r){for(var n=0,i=e.length;i>n;n++)t.call(r,e.charAt(n),n,e)}function o(e,t,r){for(var n in e)u.call(e,n)&&t.call(r,e[n],n,e)}var s=e("is-function");t.exports=r;var a=Object.prototype.toString,u=Object.prototype.hasOwnProperty},{"is-function":4}],3:[function(e,t){(function(e){t.exports="undefined"!=typeof window?window:"undefined"!=typeof e?e:"undefined"!=typeof self?self:{}}).call(this,"undefined"!=typeof i?i:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],4:[function(e,t){function r(e){var t=n.call(e);return"[object Function]"===t||"function"==typeof e&&"[object RegExp]"!==t||"undefined"!=typeof window&&(e===window.setTimeout||e===window.alert||e===window.confirm||e===window.prompt)}t.exports=r;var n=Object.prototype.toString},{}],5:[function(e,t){var r=e("trim"),n=e("for-each"),i=function(e){return"[object Array]"===Object.prototype.toString.call(e)};t.exports=function(e){if(!e)return{};var t={};return n(r(e).split("\n"),function(e){var n=e.indexOf(":"),o=r(e.slice(0,n)).toLowerCase(),s=r(e.slice(n+1));"undefined"==typeof t[o]?t[o]=s:i(t[o])?t[o].push(s):t[o]=[t[o],s]}),t}},{"for-each":2,trim:6}],6:[function(e,t,r){function n(e){return e.replace(/^\s*|\s*$/g,"")}r=t.exports=n,r.left=function(e){return e.replace(/^\s*/,"")},r.right=function(e){return e.replace(/\s*$/,"")}},{}],7:[function(e,t){"use strict";function r(e,t){for(var r=0;r<e.length;r++)t(e[r])}function n(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}function i(e,t,r){var n=e;return c(t)?(r=t,"string"==typeof e&&(n={uri:e})):n=d(t,{uri:e}),n.callback=r,n}function o(e,t,r){return t=i(e,t,r),s(t)}function s(e){function t(){4===d.readyState&&s()}function r(){var e=void 0;if(e=d.response?d.response:d.responseText||a(d),E)try{e=JSON.parse(e)}catch(t){}return e}function i(e){return clearTimeout(v),e instanceof Error||(e=new Error(""+(e||"Unknown XMLHttpRequest Error"))),e.statusCode=0,l(e,c)}function s(){if(!p){var t;clearTimeout(v),t=e.useXDR&&void 0===d.status?200:1223===d.status?204:d.status;var n=c,i=null;return 0!==t?(n={body:r(),statusCode:t,method:m,headers:{},url:y,rawRequest:d},d.getAllResponseHeaders&&(n.headers=f(d.getAllResponseHeaders()))):i=new Error("Internal XMLHttpRequest Error"),l(i,n,n.body)}}if("undefined"==typeof e.callback)throw new Error("callback argument missing");var u=!1,l=function(t,r,n){u||(u=!0,e.callback(t,r,n))},c={body:void 0,headers:{},statusCode:0,method:m,url:y,rawRequest:d},d=e.xhr||null;d||(d=e.cors||e.useXDR?new o.XDomainRequest:new o.XMLHttpRequest);var h,p,v,y=d.url=e.uri||e.url,m=d.method=e.method||"GET",g=e.body||e.data||null,b=d.headers=e.headers||{},w=!!e.sync,E=!1;if("json"in e&&(E=!0,b.accept||b.Accept||(b.Accept="application/json"),"GET"!==m&&"HEAD"!==m&&(b["content-type"]||b["Content-Type"]||(b["Content-Type"]="application/json"),g=JSON.stringify(e.json))),d.onreadystatechange=t,d.onload=s,d.onerror=i,d.onprogress=function(){},d.ontimeout=i,d.open(m,y,!w,e.username,e.password),w||(d.withCredentials=!!e.withCredentials),!w&&e.timeout>0&&(v=setTimeout(function(){p=!0,d.abort("timeout");var e=new Error("XMLHttpRequest timeout");e.code="ETIMEDOUT",i(e)},e.timeout)),d.setRequestHeader)for(h in b)b.hasOwnProperty(h)&&d.setRequestHeader(h,b[h]);else if(e.headers&&!n(e.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in e&&(d.responseType=e.responseType),"beforeSend"in e&&"function"==typeof e.beforeSend&&e.beforeSend(d),d.send(g),d}function a(e){if("document"===e.responseType)return e.responseXML;var t=204===e.status&&e.responseXML&&"parsererror"===e.responseXML.documentElement.nodeName;return""!==e.responseType||t?null:e.responseXML}function u(){}var l=e("global/window"),c=e("is-function"),f=e("parse-headers"),d=e("xtend");t.exports=o,o.XMLHttpRequest=l.XMLHttpRequest||u,o.XDomainRequest="withCredentials"in new o.XMLHttpRequest?o.XMLHttpRequest:l.XDomainRequest,r(["get","put","post","patch","head","delete"],function(e){o["delete"===e?"del":e]=function(t,r,n){return r=i(t,r,n),r.method=e.toUpperCase(),s(r)}})},{"global/window":3,"is-function":4,"parse-headers":5,xtend:8}],8:[function(e,t){function r(){for(var e={},t=0;t<arguments.length;t++){var r=arguments[t];for(var i in r)n.call(r,i)&&(e[i]=r[i])}return e}t.exports=r;var n=Object.prototype.hasOwnProperty},{}],9:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=e("events"),l=n(u),c=e("./logger"),f=n(c),d=e("./detect"),h=n(d),p=e("./errors"),v=n(p),y=e("./events"),m=n(y),g=function(e){function t(e,r,n){i(this,t);var s=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return s.resetCounts(),s.errors={},s.livelyPlayer=e,s.mediaLoader=r,s.options=n,s.onceHandlerLock=!1,s}return s(t,e),a(t,[{key:"resetCounts",value:function(){this.fragCounts=0,this.fragSize=0,this.fragDuration=0,this.fragDownloadTime=0,this.fragMaxTime=0,this.fragMinTime=0,this.bufferOverflowCount=0,this.bufferUnderflowCount=0,this.upshift=0,this.downshift=0,this.lastProgress=0,this.currentErrorCount=0,this.recentErrorCount=0}},{key:"pickEncoding",value:function(e){if(e&&(this.options.bitrate=e),!this.options.bitrate)return null;var t=this.data.encodings;return t.length?t[this.chosenLevel]:void 0}},{key:"whenReady",value:function(e){var t=this;if(!this.onceHandlerLock){var r=this.manifest;return r?void(e&&e()):this.mediaLoader.currentState===m["default"].ONLINE?void this.emit(m["default"].ERROR,v["default"].DRIVER_NOT_SUPPORTED):(this.onceHandlerLock=!0,void this.mediaLoader.once(m["default"].MANIFEST,function(){t.onceHandlerLock=!1,t.whenReady(e)}))}}},{key:"setOption",value:function(e,t){switch(this.options[e]=t,e){case"posterURI":this.el&&this.el.setAttribute("poster",t)}}},{key:"elementPlay",value:function(){if(this.el&&this.el.play){var e=this.el.play();"undefined"!=typeof Promise&&e instanceof Promise&&e["catch"](function(){})}}},{key:"play",value:function(e){var t=this;h["default"].any()&&this.el.play();var r=e||function(){};return this.mediaLoader.vod&&this.manifest&&this.manifest===this.el.getAttribute("src")?(this.el.play(),void r(!this.el.paused)):void this.whenReady(function(){var e=t.manifest;f["default"].setPlayer(t.mediaLoader.host,t.mediaLoader.publicId,t.format,e,t),t.el.setAttribute("src",e);var n=t.el.play();"undefined"!=typeof Promise&&n instanceof Promise?n.then(function(){r(!0)})["catch"](function(){r(!1)}):r(!t.el.paused)})}},{key:"stop",value:function(){this.el.setAttribute("src","")}},{key:"destroy",value:function(){this.el.remove(),this.stop()}},{key:"pause",value:function(){this.el.pause()}},{key:"unmute",value:function(){return this.el.muted=!1,this.el.muted}},{key:"mute",value:function(){return this.el.muted=!0,this.el.muted}},{key:"supportsFullscreen",value:function(){var e=document.createElement("video");return!!(document.fullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitSupportsFullscreen||document.webkitFullscreenEnabled||e.webkitRequestFullScreen||e.webkitEnterFullScreen)}},{key:"restart",value:function(){var e=this;this.lockRestart||(this.lockRestart=!0,this.currentErrorCount=0,this.recentErrorCount=0,this.stop(),this.play(function(){e.lockRestart=!1}))}},{key:"checkRestart",value:function(e){var t=this,r=e;this.recentErrorCount++,setTimeout(function(){t.recentErrorCount--,t.recentErrorCount=Math.max(t.recentErrorCount,0)},1e4),this.recentErrorCount>=this.options.recoverErrorCount&&(r.fatal=!0),this.currentErrorCount>=this.options.recoverErrorCount&&(r.fatal=!0),r.fatal&&!this.mediaLoader.vod&&this.restart()}},{key:"handleError",value:function(e,t,r){var n=t+":"+r.details;this.errors[n]||(this.errors[n]=0),this.errors[n]++;for(var i=arguments.length,o=Array(i>3?i-3:0),s=3;i>s;s++)o[s-3]=arguments[s];this.emit.apply(this,[e,t,r].concat(o))}},{key:"emitProgress",value:function(){this.lastProgress=window.performance.now(),this.emit(m["default"].MEDIA_PROGRESS)}},{key:"emitTimeupdate",value:function(){this.emit(m["default"].MEDIA_TIMEUPDATE)}},{key:"format",get:function(){return this.constructor.format}},{key:"driver",get:function(){return this.constructor.driver}},{key:"duration",get:function(){return this.el&&this.el.duration?this.el.duration:1/0}},{key:"bufferTimes",get:function(){for(var e=[],t=this.el.buffered.length,r=0;t>r;r++)e.push([this.el.buffered.start(r),this.el.buffered.end(r)]);return e}},{key:"volume",get:function(){return this.el.volume},set:function(e){return"undefined"!=typeof e&&(this.el.volume=e),this.el.muted&&e&&e>0&&this.unmute(),this.el.volume}},{key:"supportsAutoplay",get:function(){return h["default"].any()?this.supportsMobileAutoplay:!0}},{key:"supportsMobileAutoplay",get:function(){return!1}},{key:"supportsVolume",get:function(){return!0}},{key:"data",get:function(){var e=this.mediaLoader.get(this.format);return e.auto=!0,e}},{key:"chosenLevel",get:function(){if(!this.options.bitrate)return null;var e=this.data.encodings;if(!e.length)return void 0;var t=void 0;for(t=0;t<e.length&&!(e[t].videoWidth&&e[t].videoKbps+e[t].audioKbps>this.options.bitrate);t++);return t=Math.max(t-1,0)}},{key:"currentLevel",get:function(){this.chosenLevel}},{key:"nextLevel",get:function(){return null}},{key:"manifest",get:function(){var e=this.pickEncoding(),t=void 0;if(t=e?e.location:this.data.manifest,!t)return null;var r=-1===t.indexOf("?")?"?":"&";return null===this.options.preset||(this.options.preset?t=""+t+r+"preset="+this.options.preset:h["default"].any()||(t=""+t+r+"preset=desktop")),t}},{key:"currentTime",get:function(){return this.el.currentTime},set:function(e){this.el.currentTime=e}},{key:"stopped",get:function(){return!!this.el.getAttribute("src","")}},{key:"bitrate",set:function(e){var t=this,r=this.el.currentTime;this.stop(),this.options.bitrate=e,this.mediaLoader.vod&&(this.el.onloadedmetadata=function(){t.el.onloadedmetadata=null,t.el.currentTime=r},this.el.oncanplay=function(){t.el.oncanplay=null,t.el.currentTime>=r||(t.el.currentTime=r)}),this.play(function(){t.emit(m["default"].BITRATE_SWITCH)})}},{key:"muted",get:function(){return!!this.el.muted}},{key:"paused",get:function(){return this.el.paused}},{key:"details",get:function(){return{bufferOverflowCount:this.bufferOverflowCount||0,bufferUnderflowCount:this.bufferUnderflowCount||0,downshift:this.downshift||0,errors:this.errors||{},muted:this.el&&this.el.muted,segments:this.fragCounts||0,segmentsSize:this.fragSize||0,segmentsDuration:this.fragDuration||0,segmentTotalDownloadTime:this.fragDownloadTime||0,segMaxTime:this.fragMaxTime||0,segMinTime:this.fragMinTime||0,upshift:this.upshift||0,volume:this.el&&this.el.volume?this.el.volume:0}}}],[{key:"isSupported",value:function(){f["default"].error("an abstract method has been called")}},{key:"defaultOptions",get:function(){return{adaptive:null,bitrate:null,muted:!1,volume:.75}}}]),t}(l["default"]);r["default"]=g},{"./detect":10,"./errors":11,"./events":12,"./logger":16,events:1}],10:[function(e,t,r){"use strict";function n(e,t){return function(){return"undefined"==typeof i[e]&&(i[e]=t()),i[e]}}Object.defineProperty(r,"__esModule",{value:!0});var i={},o={winChrome51:n("winChrome51",function(){if(!o.windowsDesktop())return!1;if(!o.chrome())return!1;for(var e=navigator.userAgent.split(/\s*[;)(]\s*/),t=void 0,r=0;r<e.length;r++)if("Chrome"===e[r].slice(0,6)){t=e[r];break}if(!t)return!1;var n=t.split("/"),i=n[1].split(".");return parseInt(i[0],10)<52?!0:!1}),iPhone9:n("iPhone9",function(){if(!o.iPhone())return!1;for(var e=navigator.userAgent.split(/\s*[;)(]\s*/),t=void 0,r=void 0,n=0;n<e.length;n++){if("Version"===e[n].slice(0,7)){t=e[n];break}if(e.length>0&&"OS"===e[n]&&"iPhone"===e[n-1]){r=e[n+1];break}}if(!t&&!r)return!1;var i=r?r.split("_"):t.split("/");return parseFloat(i[1])<10?!0:!1}),windowsDesktop:n("windowsDesktop",function(){return/Windows/i.test(navigator.userAgent)}),chrome:n("chrome",function(){return/Chrome/i.test(navigator.userAgent)}),firefox:n("firefox",function(){return/Firefox/i.test(navigator.userAgent)}),ie:n("ie",function(){return/Trident/i.test(navigator.userAgent)}),edge:n("edge",function(){return/Edge\/\d+/.test(navigator.userAgent)}),safari:n("safari",function(){return/Safari/i.test(navigator.userAgent)}),windows:n("windows",function(){return/IEMobile/i.test(navigator.userAgent)}),android:n("android",function(){return/Android/i.test(navigator.userAgent)}),blackBerry:n("blackBerry",function(){return/BlackBerry/i.test(navigator.userAgent)}),iOS:n("iOS",function(){return/iPhone|iPad|iPod/i.test(navigator.userAgent)}),iPhone:n("iPhone",function(){return/iPhone/i.test(navigator.userAgent)}),any:n("any",function(){return o.android()||o.blackBerry()||o.iOS()||o.windows()})};r["default"]=o},{}],11:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={BAD_INPUT:"bad-input",DRIVER_NOT_SUPPORTED:"driver-not-supported",ELEMENT_REQUIRED:"element-required",EMBED_SWF_FAILED:"embedding-flash-swf-failed",GET_USER_MEDIA_FAILED:"get-user-media-failed",HTTP_SERVER_INTERNAL_ERROR:"http-server-internal-error",HTTP_SERVER_NOT_FOUND:"http-server-not-found",MANIFEST:"http-response",INVALID_CONTROLS:"invalid-controls-parent",INVALID_MEDIA_URL:"invalid-media-url",INVALID_POPOUT_URL:"invalid-popout-url",INVALID_EL:"invalid-element",WS_NETWORK_ERROR:"websocket-network-error",NETWORK_ERROR:"network-error",NO_DRIVERS:"no-valid-drivers",PLAYBACK_ERROR:"playback-error",UNKNOWN_DRIVER:"unknown-driver",UNKNOWN_ERROR:"unknown-error",UNRECOGNIZED_DRIVER:"unrecognized-driver",USER_REQUIRED:"user-required"};r["default"]=n},{}],12:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={EXIT_FULLSCREEN:"exit-fullscreen",ENTER_FULLSCREEN:"enter-fullscreen",ERROR:"error",BITRATE_SWITCH:"bitrate-switch",SELECT_DRIVER:"select-driver",MANIFEST:"manifest",MEDIA_PLAY:"play",MEDIA_STOP:"stop",MEDIA_PAUSE:"pause",MEDIA_STALL:"stall",MEDIA_PROGRESS:"progress",MEDIA_TIMEUPDATE:"timeupdate",MEDIA_MUTE:"mute",MEDIA_UNMUTE:"unmute",MEDIA_VOLUME:"volume",ONLINE:"online",OFFLINE:"offline",ESTIMATED_BW:"estimated-bw",USER_ACTIVE:"user-active",USER_IDLE:"user-idle"};r["default"]=n},{}],13:[function(e,t,r){"use strict";function n(e,t){return 0===t?e:n(t,e%t)}Object.defineProperty(r,"__esModule",{value:!0}),r["default"]=n},{}],14:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r["default"]=function(e,t){var r=e?Object.create(e):{};if(!t)return r;for(var n in t)"undefined"==typeof r[n]&&(r[n]=t[n]);return r}},{}],15:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0}),r.parseUrl=r.getDefaultOptions=r.STORAGE_VALUES=r.EVENTS=r.ERRORS=r.detect=r.Store=r.stats=r.logger=r.BaseDriver=void 0;var i=e("./base-driver"),o=n(i),s=e("./logger"),a=n(s),u=e("./stats"),l=n(u),c=e("./store"),f=n(c),d=e("./detect"),h=n(d),p=e("./errors"),v=n(p),y=e("./events"),m=n(y),g=e("./storage-values"),b=n(g),w=e("./get-default-options"),E=n(w),_=e("./parse-url"),k=n(_),O=e("./player"),P=n(O);r.BaseDriver=o["default"],r.logger=a["default"],r.stats=l["default"],r.Store=f["default"],r.detect=h["default"],r.ERRORS=v["default"],r.EVENTS=m["default"],r.STORAGE_VALUES=b["default"],r.getDefaultOptions=E["default"],r.parseUrl=k["default"],r["default"]=P["default"]},{"./base-driver":9,"./detect":10,"./errors":11,"./events":12,"./get-default-options":14,"./logger":16,"./parse-url":19,"./player":20,"./stats":23,"./storage-values":25,"./store":30}],16:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("./logger"),o=n(i),s=new o["default"];r["default"]=s},{"./logger":17}],17:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=e("../uuidv4"),a=n(s),u=["debug","error","info","warn","timing","deprecated"],l=function(){function e(){i(this,e),this.sessionKey=a["default"](),this.sessionQueryString="sessionId="+this.sessionKey,this.host=null,this.setLevels(),this.publicKey=null,this.format=null,this.encoding=null,this.disable(),this.enable(),this.logEntries=[]}return o(e,[{key:"setLevels",value:function(e){var t=e||{};this.levels={debug:t.debug||!1,error:t.error||1,warn:t.warn||1,info:t.info||1,timing:t.timing||0}}},{key:"setPlayer",value:function(e,t,r,n,i){this.host=e,this.publicKey=t,this.format=r,this.encoding=n,this.driver=i}},{key:"checkSet",value:function(){return!this.host||!this.publicKey||!this.format}},{key:"levelIsSupported",value:function(e){return-1!==u.indexOf(e)}},{key:"log",value:function(e){var t;if(!this.levelIsSupported(e))return void this.log("error","unsupported log level",{level:e});if(this.levels[e]&&this.writer[e]&&this.writer[e].apply){for(var r=arguments.length,n=Array(r>1?r-1:0),i=1;r>i;i++)n[i-1]=arguments[i];(t=this.writer)[e].apply(t,n),this.apiLogging&&this.host&&this.publicKey&&this.pushBatch(n)}}},{key:"disable",value:function(){this.writer={};for(var e=0;e<u.length;e++)this.writer[u[e]]=function(){}}},{key:"enable",value:function(){window.console&&(this.writer=window.console,this.writer.timing=this.writer.info,this.writer.deprecated=this.writer.info)}},{key:"argJoin",value:function(e,t){for(var r=[e],n=0;n<t.length;n++)r.push(t[n]);return r}},{key:"debug",value:function(){for(var e=arguments.length,t=Array(e),r=0;e>r;r++)t[r]=arguments[r];this.log.apply(this,["debug"].concat(t))}},{key:"error",value:function(){for(var e=arguments.length,t=Array(e),r=0;e>r;r++)t[r]=arguments[r];this.log.apply(this,["error"].concat(t))}},{key:"timing",value:function(){for(var e=arguments.length,t=Array(e),r=0;e>r;r++)t[r]=arguments[r];this.log.apply(this,["timing"].concat(t))}},{key:"info",value:function(){for(var e=arguments.length,t=Array(e),r=0;e>r;r++)t[r]=arguments[r];this.log.apply(this,["info"].concat(t))}},{key:"warn",value:function(){for(var e=arguments.length,t=Array(e),r=0;e>r;r++)t[r]=arguments[r];this.log.apply(this,["warn"].concat(t))}},{key:"deprecated",value:function(){for(var e=arguments.length,t=Array(e),r=0;e>r;r++)t[r]=arguments[r];this.log.apply(this,["deprecated"].concat(t))}}]),e}();r["default"]=l},{"../uuidv4":31}],18:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("events"),c=n(l),f=e("xhr"),d=n(f),h=e("./errors"),p=n(h),v=e("./events"),y=n(v),m=e("./parse-url"),g=n(m),b=function(e){function t(e,r){i(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.currentState=y["default"].OFFLINE,n.formats={},n.options=r,n.host=n.options.host||window.location.host,n.setPublicId(e),n.publicId&&(n.options.pollingInterval=parseInt(n.options.pollingInterval,10)),n.setUri(e)&&n.options.pollingInterval?n:o(n)}return s(t,e),u(t,[{key:"load",value:function(){var e=this,t=void 0,r=void 0;return"function"==typeof(arguments.length<=0?void 0:arguments[0])?r=arguments.length<=0?void 0:arguments[0]:(t=arguments.length<=0?void 0:arguments[0],r=arguments.length<=1?void 0:arguments[1]),r||(r=function(){}),this.manifest||this.vod?(this.emit(y["default"].MANIFEST,this.currentState),void r()):t||this.uri?("string"!=typeof t||"http://"!==t.slice(0,7)&&"https://"!==t.slice(0,8)||(this.options.mediaLoaderUri=t),this.setUri(t)?void d["default"]({method:"GET",uri:this.uri,json:!0,useXDR:!0},function(t,n,i){var o=void 0;t?o=new Error(p["default"].HTTP_SERVER_INTERNAL_ERROR):n.statusCode>499?o=new Error(p["default"].HTTP_SERVER_INTERNAL_ERROR):n.statusCode>399?o=new Error(p["default"].HTTP_SERVER_NOT_FOUND):e.validateResponse(i)||(o=new Error(p["default"].HTTP_SERVER_UNEXPECTED_RESPONSE)),o&&e.emit(y["default"].ERROR,o.message);var s=void 0;404!==n.statusCode&&i&&i.formats?200===n.statusCode&&(e.uri=i.self):s=y["default"].OFFLINE,s||(e.formats=i.formats,s=Object.keys(i.formats).length?y["default"].ONLINE:y["default"].OFFLINE),e.type=i&&i.type?i.type:"live",e.vod&&clearInterval(e.pollingSetInterval),s!==e.currentState&&e.emit(s),e.currentState=s,e.emit(y["default"].MANIFEST,e.currentState),r()}):void r(new Error(p["default"].INVALID_MEDIA_URL))):void 0}},{key:"setPublicId",value:function(e){this.type=null,this.formats={},"string"==typeof e?this.publicId=e:"object"===("undefined"==typeof e?"undefined":a(e))&&(this.manifest=e,this.currentState=y["default"].ONLINE,this.type=this.manifest.type,this.formats=this.manifest.formats)}},{key:"validateResponse",value:function(e){return e&&"object"===("undefined"==typeof e?"undefined":a(e))?"object"!==a(e.formats)?!1:!0:!1}},{key:"setUri",value:function(e){return e?this.options.mediaLoaderUri?(this.uri=this.options.mediaLoaderUri,!0):(this.uri=g["default"](this.host).href,this.uri?(this.uri=""+this.uri+this.options.apiPrefix+"/"+e+this.options.apiSuffix,!0):(this.emit(y["default"].ERROR,p["default"].INVALID_MEDIA_URL),!1)):!!this.uri}},{key:"get",value:function(e){if(!this.formats[e])return{type:null,encodings:[],manifest:null,state:y["default"].ONLINE};var t=[];if(this.formats[e].encodings)t=this.formats[e].encodings.sort(function(e,t){return e.videoKbps+e.audioKbps>t.videoKbps+t.audioKbps?1:-1});else for(var r=Object.keys(this.formats[e]).filter(function(e){return!isNaN(e)}).sort(),n=0;n<r.length;n++)t.push(this.formats[e][r[n]]);return{type:this.type,encodings:t,manifest:this.formats[e].manifest,state:y["default"].ONLINE}}},{key:"destroy",value:function(){clearInterval(this.pollingSetInterval)}},{key:"startInterval",value:function(){var e=this;!this.options.pollingInterval||this.manifest||this.vod||(this.pollingSetInterval=setInterval(function(){e.load(e.publicId)},this.options.pollingInterval))}},{key:"vod",get:function(){return"recorded"===this.type}}]),t}(c["default"]);r["default"]=b},{"./errors":11,"./events":12,"./parse-url":19,events:1,xhr:7}],19:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r["default"]=function(e){var t=document.createElement("a");return t.href=e,t.pathname?{href:t.href,protocol:t.protocol,port:t.port,pathname:t.pathname,search:t.search,host:t.host||window.location.host}:!1}},{}],20:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("events"),c=n(l),f=e("./logger"),d=n(f),h=e("./store"),p=n(h),v=e("./stats"),y=e("./media-loader"),m=n(y),g=e("./errors"),b=n(g),w=e("./events"),E=n(w),_=e("./gcd"),k=n(_),O=e("./get-default-options"),P=n(O);e("./polyfills");var T=e("./storage-values"),R=n(T),L=1800,S=600,D={apiPrefix:"/live",apiSuffix:".json",autoplay:!0,bitrate:void 0,debug:!1,flashWmode:"transparent",flashFrameRate:60,fullscreenEl:"parent",forceDrivers:!1,formats:null,maxBufferLength:30,maxBufferSize:6e7,muted:void 0,pollingInterval:1e4,posterURI:null,preset:void 0,recoverErrorCount:10,recoverTimeout:4e3,startTime:0,volume:.75,flashlsPath:"../dist/flashlsChromeless.swf",strobeSwfPath:"../dist/StrobeMediaPlayback.swf",tfSwfPath:"../dist/thin.swf",avpPath:"../dist/avp.swf",hlsjsPath:null},I=function(e){function t(e,r,n){i(this,t);var s=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));switch(s.availableDrivers=[],"undefined"==typeof e?"undefined":a(e)){
case"string":s.el=document.querySelector(e);break;case"object":s.el=e;break;default:s.error(b["default"].INVALID_EL)}if(s.options=P["default"](n,D),s.store=new p["default"],s.firstPlay=!0,"undefined"==typeof s.options.muted){var u=s.store.get(R["default"].muted);s.options.muted=null!==u?"true"===u:s.options.muted}var l=s.store.get(R["default"].volume);s.options.volume=isNaN(parseFloat(l))?s.options.volume:parseFloat(l),s.options.bitrate&&!parseInt(s.options.bitrate,10)&&(s.error(b["default"].INVALD_BITRATE),s.options.bitrate=void 0),"undefined"!=typeof s.options.bitrate&&s.storeBitrate(s.options.bitrate);var c=parseInt(s.store.get(R["default"].lockedKbps),10);if(s.options.bitrate=c||parseInt(s.options.bitrate,10)||null,s.estimatedKbps=parseInt(s.store.get(R["default"].estimatedKbps),10)||L,s.isTryingToPlay=!1,s.shouldTryToPlay=s.options.autoplay,s.options.debug?d["default"].setLevels({debug:!0,error:1,warn:1,info:1,timing:1}):d["default"].setLevels(),s.trackFirstProgress(),s.options.mediaLoaderUri&&d["default"].deprecated("mediaLoaderUri","second argument may now take a uri or publicId"),r)if("string"==typeof r)("http://"===r.slice(0,7)||"https://"===r.slice(0,8))&&(s.options.mediaLoaderUri=r);else if("object"===("undefined"==typeof r?"undefined":a(r)))s.options.mediaLoaderUri=r;else if(null!==r)return d["default"].error("invalid manifest",r),o(s);if(!Array.isArray(s.options.drivers))return d["default"].error("invalid drivers, must be an array",s.options.drivers),o(s);for(var f=0;f<s.options.drivers.length;f++)if("function"!=typeof s.options.drivers[f])return d["default"].error("invalid drivers, each driver must type function, check driver at index "+f),o(s);return s.mediaLoader=s.options.mediaLoader||new m["default"](r,s.options),s.setDrivers(s.options.drivers),s.mediaLoader.on(E["default"].ERROR,s.eventHandler(E["default"].ERROR).bind(s)),s.mediaLoader.on(E["default"].MANIFEST,s.eventHandler(E["default"].MANIFEST).bind(s)),s.mediaLoader.on(E["default"].MANIFEST,function(){return s.mediaLoader.currentState!==E["default"].ONLINE?void s.stop():void(!s.shouldTryToPlay||s.currentDriver&&!s.currentDriver.supportsAutoplay||s.play())}),s.mediaLoader.on(E["default"].ONLINE,function(){s.emit(E["default"].ONLINE)}),s.mediaLoader.on(E["default"].OFFLINE,function(){s.tryingToPlay&&(s.shouldTryToPlay=!0),s.emit(E["default"].OFFLINE)}),s.mediaLoader.load(),s.mediaLoader.startInterval&&s.mediaLoader.startInterval(),s.options.autoplay&&s.currentDriver&&s.currentDriver.elementPlay&&s.currentDriver.elementPlay(),s}return s(t,e),u(t,[{key:"trackFirstProgress",value:function(){var e=this;this.options.autoplay&&(this.autoplayProgressId=v.stats.start(v.STATS_EVENTS.AUTOPLAY_PROGRESS),this.once(E["default"].MEDIA_PROGRESS,function(){v.stats.stop(e.autoplayProgressId,{driver:e.currentDriver.driver})}))}},{key:"setOption",value:function(e,t){this.options[e]=t,this.currentDriver&&this.currentDriver.setOption(e,t)}},{key:"load",value:function(e,t){this.stop(),this.mediaLoader.setPublicId(e),this.mediaLoader.load(e,t)}},{key:"destroy",value:function(){this.mediaLoader.destroy&&(this.mediaLoader.removeAllListeners(E["default"].MANIFEST),this.mediaLoader.removeAllListeners(E["default"].ERROR),this.mediaLoader.destroy());var e=void 0;if(this.currentDriver){this.currentDriver.destroy();for(e in E["default"])this.currentDriver.removeAllListeners(E["default"][e]);this.currentDriver.removeAllListeners(E["default"][e],this.eventHandler(E["default"][e])),this.currentDriver.destroy()}this.removeAllListeners(E["default"].MEDIA_PROGRESS),this.emit(E["default"].DESTROY)}},{key:"storeBitrate",value:function(e){this.store.set(R["default"].lockedKbps,e)}},{key:"restart",value:function(){var e=this.tryingToPlay;this.stop(),this.shouldTryToPlay=e,this.mediaLoader.load()}},{key:"switchDrivers",value:function(e){this.options.drivers=e,this.setDrivers(e),this.restart()}},{key:"getState",value:function(){return this.mediaLoader.currentState}},{key:"eventHandler",value:function(e){var t=this;return function(){for(var r=arguments.length,n=Array(r),i=0;r>i;i++)n[i]=arguments[i];("error"!==e||t._events&&t._events.hasOwnProperty("error"))&&t.emit.apply(t,[e].concat(n))}}},{key:"error",value:function(e,t){(!this._events||this._events.hasOwnProperty("error"))&&this.emit(E["default"].ERROR,e,t),d["default"].warn(e)}},{key:"setDrivers",value:function(e){var t=void 0;this.availableDrivers=[];for(var r=0;r<e.length;r++)t=e[r],t&&t.isSupported()?(this.options.forceDrivers||t.isSupported())&&this.availableDrivers.push(t):d["default"].debug("driver at index "+r+" is not supported");return this.availableDrivers.length?void(this.driver=0):void this.noDrivers()}},{key:"pause",value:function(){this.isTryingToPlay=!1,this.currentDriver&&this.currentDriver.pause(),this.emit(E["default"].MEDIA_PAUSE)}},{key:"noDrivers",value:function(){this.mediaLoader.currentState===E["default"].ONLINE&&this.error(b["default"].NO_DRIVERS)}},{key:"play",value:function(){var e=this;return this.currentDriver?(this.isTryingToPlay=!0,void this.currentDriver.play(function(t){return t?(e.shouldTryToPlay=!1,"true"===e.store.get(R["default"].muted)&&e.currentDriver.mute(),e.firstPlay&&e.vod&&e.options.startTime&&(e.currentDriver.currentTime=e.options.startTime),e.isTryingToPlay=!0,void(e.mediaLoader.state!==E["default"].OFFLINE&&(e.emit(E["default"].MEDIA_PLAY),e.firstPlay=!1))):void(e.isTryingToPlay=!1)})):void this.noDrivers()}},{key:"stop",value:function(){this.isTryingToPlay=!1,this.currentDriver&&this.currentDriver.stop(),this.emit(E["default"].MEDIA_STOP)}},{key:"isTryingToPlayAudio",value:function(){return this.currentDriver?this.currentDriver.isTryingToPlayAudio(this.tryingToPlay):this.tryingToPlay}},{key:"mute",value:function(){if(!this.currentDriver)return this.noDrivers(),null;var e=this.currentDriver.mute();return this.store.set(R["default"].muted,String(e)),this.emit(E["default"].MEDIA_MUTE),e}},{key:"unmute",value:function(){if(!this.currentDriver)return this.noDrivers(),null;var e=this.currentDriver.unmute();return this.store.set(R["default"].muted,String(e)),this.emit(E["default"].MEDIA_UNMUTE),e}},{key:"currentEncoding",value:function(){return this.currentDriver?this.currentDriver.pickEncoding():void 0}},{key:"supportsFullscreen",value:function(){return this.currentDriver?this.currentDriver.supportsFullscreen():null}},{key:"supportsVolume",value:function(){return this.currentDriver?this.currentDriver.supportsVolume():null}},{key:"bitrate",set:function(e){this.storeBitrate(e),this.currentDriver.bitrate=e}},{key:"driver",set:function(e){var t=this;if(!this.availableDrivers[e])return void this.noDrivers();var r=this.availableDrivers[e];this.currentDriver&&this.currentDriver.destroy(),this.currentDriver=new r(this,this.mediaLoader,{bitrate:this.options.bitrate,estimatedKbps:this.estimatedKbps,volume:this.options.volume,muted:this.options.muted,debug:this.options.debug,recoverTimeout:this.options.recoverTimeout,recoverErrorCount:this.options.recoverErrorCount,maxBufferLength:this.options.maxBufferLength,maxBufferSize:this.options.maxBufferSize,preset:this.options.preset,flashlsPath:this.options.flashlsPath,tfSwfPath:this.options.tfSwfPath,strobeSwfPath:this.options.strobeSwfPath,avpPath:this.options.avpPath,hlsjsPath:this.options.hlsjsPath,posterURI:this.options.posterURI,flashFrameRate:this.options.flashFrameRate,flashWmode:this.options.flashWmode}),this.currentDriver.on(E["default"].ERROR,function(r){var n=function(){t.availableDrivers.length&&(t.currentDriver.destroy(),t.availableDrivers.splice(e,1),t.driver=e,t.tryingToPlay&&t.play())};switch(r){case b["default"].EMBED_SWF_FAILED:n();break;case b["default"].DRIVER_NOT_SUPPORTED:n()}}),this.emit(E["default"].SELECT_DRIVER,this.currentDriver),this.currentDriver.on(E["default"].ESTIMATED_BW,function(e){t.store.set(R["default"].estimatedKbps,parseInt(e,10)||S)});for(var n in E["default"])this.currentDriver.on(E["default"][n],this.eventHandler(E["default"][n]))}},{key:"duration",get:function(){return this.currentDriver?this.currentDriver.duration:1/0}},{key:"vod",get:function(){return this.mediaLoader?this.mediaLoader.vod:null}},{key:"bufferLength",get:function(){return this.currentDriver?this.currentDriver.bufferLength:0}},{key:"backBufferLength",get:function(){return this.currentDriver?this.currentDriver.backBufferLength:0}},{key:"currentTime",get:function(){return this.currentDriver?this.currentDriver.currentTime:0},set:function(e){this.currentDriver&&(this.currentDriver.currentTime=e)}},{key:"bufferTimes",get:function(){return this.currentDriver?this.currentDriver.bufferTimes:[]}},{key:"tryingToPlay",get:function(){return!!this.isTryingToPlay}},{key:"muted",get:function(){return this.currentDriver?this.currentDriver.muted:(this.noDrivers(),null)}},{key:"mediaData",get:function(){return this.currentDriver?this.currentDriver.data:null}},{key:"allMediaData",get:function(){for(var e=this.availableDrivers,t=[],r=void 0,n=0;n<e.length;n++)if(r=e[n],r.isSupported&&r.isSupported(this.el)){var i=this.mediaLoader.get(r.format);if(!i.manifest)continue;i.driver=r.driver,t.push(i)}return t}},{key:"volume",set:function(e){if(!this.currentDriver)return void 0;var t=this.currentDriver.volume=e;return this.store.set(R["default"].muted,0===t),this.store.set(R["default"].volume,t),this.emit(E["default"].MEDIA_VOLUME,t),t},get:function(){return this.currentDriver?this.currentDriver.volume:0}},{key:"details",get:function(){return this.currentDriver?this.currentDriver.details:{}}},{key:"chosenLevel",get:function(){return this.currentDriver?this.currentDriver.chosenLevel:void 0}},{key:"currentLevel",get:function(){return this.currentDriver?this.currentDriver.currentLevel:void 0}},{key:"nextLevel",get:function(){return this.currentDriver?this.currentDriver.nextLevel:void 0}},{key:"aspectRatio",get:function(){if(!this.currentDriver)return null;var e=this.currentDriver.data;if(!e)return null;if(!e.encodings||!e.encodings.length)return null;if(!e.encodings[0].videoWidth||!e.encodings[0].videoHeight)return null;var t=k["default"](e.encodings[0].videoWidth,e.encodings[0].videoHeight);return{width:e.encodings[0].videoWidth/t,height:e.encodings[0].videoHeight/t}}}]),t}(c["default"]);r["default"]=I},{"./errors":11,"./events":12,"./gcd":13,"./get-default-options":14,"./logger":16,"./media-loader":18,"./polyfills":21,"./stats":23,"./storage-values":25,"./store":30,events:1}],21:[function(){"use strict";var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};"remove"in window.Element.prototype||(window.Element.prototype.remove=function(){this.parentNode&&this.parentNode.removeChild(this)}),"function"!=typeof Object.create&&(Object.create=function(e){var t=function(){};return function(r,n){if(r!==Object(r)&&null!==r)throw TypeError("Argument must be an object, or null");t.prototype=r||{},n!==e&&Object.defineProperties(t.prototype,n);var i=new t;return t.prototype=null,i}}()),function(){for(var e=0,t=["ms","moz","webkit","o"],r=0;r<t.length&&!window.requestAnimationFrame;++r)window.requestAnimationFrame=window[t[r]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[r]+"CancelAnimationFrame"]||window[t[r]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t){var r=(new Date).getTime(),n=Math.max(0,16-(r-e)),i=window.setTimeout(function(){t(r+n)},n);return e=r+n,i}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})}(),function(e){var t=Date.now?Date.now():+new Date;e.performance=e.performance||{},e.performance.now=e.performance.webkitNow||e.performance.mozNow||e.performance.msNow||function(){return(Date.now?Date.now():+new Date)-t}}(window),Object.keys||(Object.keys=function(){var t=Object.prototype.hasOwnProperty,r=!{toString:null}.propertyIsEnumerable("toString"),n=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],i=n.length;return function(o){if("object"!==("undefined"==typeof o?"undefined":e(o))&&("function"!=typeof o||null===o))throw new TypeError("Object.keys called on non-object");var s=[],a=void 0,u=void 0;for(a in o)t.call(o,a)&&s.push(a);if(r)for(u=0;i>u;u++)t.call(o,n[u])&&s.push(n[u]);return s}}()),"document"in self&&("classList"in document.createElement("_")&&(!document.createElementNS||"classList"in document.createElementNS("http://www.w3.org/2000/svg","g"))?!function(){var e=document.createElement("_");if(e.classList.add("c1","c2"),!e.classList.contains("c2")){var t=function(e){var t=DOMTokenList.prototype[e];DOMTokenList.prototype[e]=function(e){var r,n=arguments.length;for(r=0;n>r;r++)e=arguments[r],t.call(this,e)}};t("add"),t("remove")}if(e.classList.toggle("c3",!1),e.classList.contains("c3")){var r=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(e,t){return 1 in arguments&&!this.contains(e)==!t?t:r.call(this,e)}}e=null}():!function(e){if("Element"in e){var t="classList",r="prototype",n=e.Element[r],i=Object,o=String[r].trim||function(){return this.replace(/^\s+|\s+$/g,"")},s=Array[r].indexOf||function(e){for(var t=0,r=this.length;r>t;t++)if(t in this&&this[t]===e)return t;return-1},a=function(e,t){this.name=e,this.code=DOMException[e],this.message=t},u=function(e,t){if(""===t)throw new a("SYNTAX_ERR","An invalid or illegal string was specified");if(/\s/.test(t))throw new a("INVALID_CHARACTER_ERR","String contains an invalid character");return s.call(e,t)},l=function(e){for(var t=o.call(e.getAttribute("class")||""),r=t?t.split(/\s+/):[],n=0,i=r.length;i>n;n++)this.push(r[n]);this._updateClassName=function(){e.setAttribute("class",this.toString())}},c=l[r]=[],f=function(){return new l(this)};if(a[r]=Error[r],c.item=function(e){return this[e]||null},c.contains=function(e){return e+="",-1!==u(this,e)},c.add=function(){var e,t=arguments,r=0,n=t.length,i=!1;do e=t[r]+"",-1===u(this,e)&&(this.push(e),i=!0);while(++r<n);i&&this._updateClassName()},c.remove=function(){var e,t,r=arguments,n=0,i=r.length,o=!1;do for(e=r[n]+"",t=u(this,e);-1!==t;)this.splice(t,1),o=!0,t=u(this,e);while(++n<i);o&&this._updateClassName()},c.toggle=function(e,t){e+="";var r=this.contains(e),n=r?t!==!0&&"remove":t!==!1&&"add";return n&&this[n](e),t===!0||t===!1?t:!r},c.toString=function(){return this.join(" ")},i.defineProperty){var d={get:f,enumerable:!0,configurable:!0};try{i.defineProperty(n,t,d)}catch(h){-2146823252===h.number&&(d.enumerable=!1,i.defineProperty(n,t,d))}}else i[r].__defineGetter__&&n.__defineGetter__(t,f)}}(self))},{}],22:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={AUTOPLAY_PROGRESS:"autoplay-first-progress",FIRST_LOAD:"first-load"};r["default"]=n},{}],23:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0}),r.STATS_EVENTS=r.stats=void 0;var i=e("./stats"),o=n(i),s=e("./events"),a=n(s),u=new o["default"];r.stats=u,r.STATS_EVENTS=a["default"]},{"./events":22,"./stats":24}],24:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=e("../logger"),a=n(s),u=function(){function e(){i(this,e),this.eventCounter=0,this.timings={}}return o(e,[{key:"start",value:function(e){var t=this.eventCounter++;return this.timings[t]={ms:Date.now(),name:e},t}},{key:"stop",value:function(e,t){if(this.timings[e]){var r=t||{};r.ms=Date.now()-this.timings[e].ms,a["default"].timing(this.timings[e].name,r),delete this.timings[e]}}}]),e}();r["default"]=u},{"../logger":16}],25:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={muted:"aiw_muted",volume:"aiw_volume",lockedKbps:"aiw_locked_kbs",estimatedKbps:"aiw_estimated_kbs",hideSuggestion:"aiw_hide_suggestion"};r["default"]=n},{}],26:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=function(){function e(){n(this,e)}return i(e,[{key:"set",value:function(){console.error("an abstract method has been called")}},{key:"get",value:function(){console.error("an abstract method has been called")}}]),e}();r["default"]=o},{}],27:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function e(e,t){var r=[],n=!0,i=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(n=(s=a.next()).done)&&(r.push(s.value),!t||r.length!==t);n=!0);}catch(u){i=!0,o=u}finally{try{!n&&a["return"]&&a["return"]()}finally{if(i)throw o}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("./base-driver"),c=n(l),f=new RegExp("\\s*;\\s*"),d=function(e){function t(){return i(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s(t,e),u(t,[{key:"parse",value:function(e){var t={};return e?(e.split(f).forEach(function(e){var r=e.split("="),n=a(r,2),i=n[0],o=n[1],s=decodeURIComponent(i),u=decodeURIComponent(o);t[s]=u}),t):t}},{key:"stringify",value:function(e){var t=[];for(var r in e)({}).hasOwnProperty.call(e,r)&&t.push(r+"="+e[r]);return t.join("; ")}},{key:"set",value:function(e,t){document.cookie=e+"="+t}},{key:"get",value:function(e){var t=this.parse(document.cookie);return t[e]||null}}]),t}(c["default"]);r["default"]=d},{"./base-driver":26}],28:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=e("./base-driver"),l=n(u),c=function(e){function t(){return i(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s(t,e),a(t,[{key:"set",value:function(e,t){try{window.localStorage.setItem(e,t)}catch(r){}}},{key:"get",value:function(e){var t=null;try{t=window.localStorage.getItem(e)||null}catch(r){}return t}}]),t}(l["default"]);r["default"]=c},{"./base-driver":26}],29:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=e("./base-driver"),l=n(u),c={},f=function(e){function t(){return i(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s(t,e),a(t,[{key:"set",value:function(e,t){c[e]=t}},{key:"get",value:function(e){return c[e]||null}}]),t}(l["default"]);r["default"]=f},{"./base-driver":26}],30:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=e("./drivers/cookie"),a=n(s),u=e("./drivers/local-storage"),l=n(u),c=e("./drivers/memory"),f=n(c),d=function(){function e(){i(this,e);try{if(window.localStorage)return void(this.driver=new l["default"])}catch(t){}try{if("string"==typeof document.cookie)return void(this.driver=new a["default"])}catch(t){}this.driver=new f["default"]}return o(e,[{key:"set",value:function(e,t){this.driver&&this.driver.set(e,t)}},{key:"get",value:function(e){return this.driver?this.driver.get(e):void 0}}]),e}();r["default"]=d},{"./drivers/cookie":27,"./drivers/local-storage":28,"./drivers/memory":29}],31:[function(e,t,r){"use strict";function n(){for(var e,t=0;16>t;t++)0===(3&t)&&(e=4294967296*Math.random()),o[t]=e>>>((3&t)<<3)&255;return o}function i(e,t){var r=t||0,n=s;return n[e[r++]]+n[e[r++]]+n[e[r++]]+n[e[r++]]+"-"+n[e[r++]]+n[e[r++]]+"-"+n[e[r++]]+n[e[r++]]+"-"+n[e[r++]]+n[e[r++]]+"-"+n[e[r++]]+n[e[r++]]+n[e[r++]]+n[e[r++]]+n[e[r++]]+n[e[r++]]}Object.defineProperty(r,"__esModule",{value:!0}),r["default"]=function(){var e=n();return e[6]=15&e[6]|64,e[8]=63&e[8]|128,i(e)};for(var o=new Array(16),s=[],a={},u=0;256>u;u++)s[u]=(u+256).toString(16).substr(1),a[s[u]]=u},{}]},{},[15])(15)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],14:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=e("events"),l=n(u),c=e("./logger"),f=n(c),d=e("./detect"),h=n(d),p=e("./errors"),v=n(p),y=e("./events"),m=n(y),g=function(e){function t(e,r,n){i(this,t);var s=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return s.resetCounts(),s.errors={},s.livelyPlayer=e,s.mediaLoader=r,s.options=n,s.onceHandlerLock=!1,s}return s(t,e),a(t,[{key:"resetCounts",value:function(){this.fragCounts=0,this.fragSize=0,this.fragDuration=0,this.fragDownloadTime=0,this.fragMaxTime=0,this.fragMinTime=0,this.bufferOverflowCount=0,this.bufferUnderflowCount=0,this.upshift=0,this.downshift=0,this.lastProgress=0,this.currentErrorCount=0,this.recentErrorCount=0}},{key:"pickEncoding",value:function(e){if(e&&(this.options.bitrate=e),!this.options.bitrate)return null;var t=this.data.encodings;return t.length?t[this.chosenLevel]:void 0}},{key:"whenReady",value:function(e){var t=this;if(!this.onceHandlerLock){var r=this.manifest;return r?void(e&&e()):this.mediaLoader.currentState===m["default"].ONLINE?void this.emit(m["default"].ERROR,v["default"].DRIVER_NOT_SUPPORTED):(this.onceHandlerLock=!0,void this.mediaLoader.once(m["default"].MANIFEST,function(){t.onceHandlerLock=!1,t.whenReady(e)}))}}},{key:"setOption",value:function(e,t){switch(this.options[e]=t,e){case"posterURI":this.el&&this.el.setAttribute("poster",t)}}},{key:"elementPlay",value:function(){if(this.el&&this.el.play){var e=this.el.play();"undefined"!=typeof Promise&&e instanceof Promise&&e["catch"](function(){})}}},{key:"play",value:function(e){var t=this;h["default"].any()&&this.el.play();var r=e||function(){};return this.mediaLoader.vod&&this.manifest&&this.manifest===this.el.getAttribute("src")?(this.el.play(),void r(!this.el.paused)):void this.whenReady(function(){var e=t.manifest;f["default"].setPlayer(t.mediaLoader.host,t.mediaLoader.publicId,t.format,e,t),t.el.setAttribute("src",e);var n=t.el.play();"undefined"!=typeof Promise&&n instanceof Promise?n.then(function(){r(!0)})["catch"](function(){r(!1)}):r(!t.el.paused)})}},{key:"stop",value:function(){this.el.setAttribute("src","")}},{key:"destroy",value:function(){this.el.remove(),this.stop()}},{key:"pause",value:function(){this.el.pause()}},{key:"unmute",value:function(){return this.el.muted=!1,this.el.muted}},{key:"mute",value:function(){return this.el.muted=!0,this.el.muted}},{key:"supportsFullscreen",value:function(){var e=document.createElement("video");return!!(document.fullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitSupportsFullscreen||document.webkitFullscreenEnabled||e.webkitRequestFullScreen||e.webkitEnterFullScreen)}},{key:"restart",value:function(){var e=this;this.lockRestart||(this.lockRestart=!0,this.currentErrorCount=0,this.recentErrorCount=0,this.stop(),this.play(function(){e.lockRestart=!1}))}},{key:"checkRestart",value:function(e){var t=this,r=e;this.recentErrorCount++,setTimeout(function(){t.recentErrorCount--,t.recentErrorCount=Math.max(t.recentErrorCount,0)},1e4),this.recentErrorCount>=this.options.recoverErrorCount&&(r.fatal=!0),this.currentErrorCount>=this.options.recoverErrorCount&&(r.fatal=!0),r.fatal&&!this.mediaLoader.vod&&this.restart()}},{key:"handleError",value:function(e,t,r){var n=t+":"+r.details;this.errors[n]||(this.errors[n]=0),this.errors[n]++;for(var i=arguments.length,o=Array(i>3?i-3:0),s=3;i>s;s++)o[s-3]=arguments[s];this.emit.apply(this,[e,t,r].concat(o))}},{key:"emitProgress",value:function(){this.lastProgress=window.performance.now(),this.emit(m["default"].MEDIA_PROGRESS)}},{key:"emitTimeupdate",value:function(){this.emit(m["default"].MEDIA_TIMEUPDATE)}},{key:"format",get:function(){return this.constructor.format}},{key:"driver",get:function(){return this.constructor.driver}},{key:"duration",get:function(){return this.el&&this.el.duration?this.el.duration:1/0}},{key:"bufferTimes",get:function(){for(var e=[],t=this.el.buffered.length,r=0;t>r;r++)e.push([this.el.buffered.start(r),this.el.buffered.end(r)]);return e}},{key:"volume",get:function(){return this.el.volume},set:function(e){return"undefined"!=typeof e&&(this.el.volume=e),this.el.muted&&e&&e>0&&this.unmute(),this.el.volume}},{key:"supportsAutoplay",get:function(){return h["default"].any()?this.supportsMobileAutoplay:!0}},{key:"supportsMobileAutoplay",get:function(){return!1}},{key:"supportsVolume",get:function(){return!0}},{key:"data",get:function(){var e=this.mediaLoader.get(this.format);return e.auto=!0,e}},{key:"chosenLevel",get:function(){if(!this.options.bitrate)return null;var e=this.data.encodings;if(!e.length)return void 0;var t=void 0;for(t=0;t<e.length&&!(e[t].videoWidth&&e[t].videoKbps+e[t].audioKbps>this.options.bitrate);t++);return t=Math.max(t-1,0)}},{key:"currentLevel",get:function(){this.chosenLevel}},{key:"nextLevel",get:function(){return null}},{key:"manifest",get:function(){var e=this.pickEncoding(),t=void 0;if(t=e?e.location:this.data.manifest,!t)return null;var r=-1===t.indexOf("?")?"?":"&";return null===this.options.preset||(this.options.preset?t=""+t+r+"preset="+this.options.preset:h["default"].any()||(t=""+t+r+"preset=desktop")),t}},{key:"currentTime",get:function(){return this.el.currentTime},set:function(e){this.el.currentTime=e}},{key:"stopped",get:function(){return!!this.el.getAttribute("src","")}},{key:"bitrate",set:function(e){var t=this,r=this.el.currentTime;this.stop(),this.options.bitrate=e,this.mediaLoader.vod&&(this.el.onloadedmetadata=function(){t.el.onloadedmetadata=null,t.el.currentTime=r},this.el.oncanplay=function(){t.el.oncanplay=null,t.el.currentTime>=r||(t.el.currentTime=r)}),this.play(function(){t.emit(m["default"].BITRATE_SWITCH)})}},{key:"muted",get:function(){return!!this.el.muted}},{key:"paused",get:function(){return this.el.paused}},{key:"details",get:function(){return{bufferOverflowCount:this.bufferOverflowCount||0,bufferUnderflowCount:this.bufferUnderflowCount||0,downshift:this.downshift||0,errors:this.errors||{},muted:this.el&&this.el.muted,segments:this.fragCounts||0,segmentsSize:this.fragSize||0,segmentsDuration:this.fragDuration||0,segmentTotalDownloadTime:this.fragDownloadTime||0,segMaxTime:this.fragMaxTime||0,segMinTime:this.fragMinTime||0,upshift:this.upshift||0,volume:this.el&&this.el.volume?this.el.volume:0}}}],[{key:"isSupported",value:function(){f["default"].error("an abstract method has been called")}},{key:"defaultOptions",get:function(){return{adaptive:null,bitrate:null,muted:!1,volume:.75}}}]),t}(l["default"]);r["default"]=g},{"./detect":15,"./errors":16,"./events":17,"./logger":20,events:44}],15:[function(e,t,r){"use strict";function n(e,t){return function(){return"undefined"==typeof i[e]&&(i[e]=t()),i[e]}}Object.defineProperty(r,"__esModule",{value:!0});var i={},o={winChrome51:n("winChrome51",function(){if(!o.windowsDesktop())return!1;if(!o.chrome())return!1;for(var e=navigator.userAgent.split(/\s*[;)(]\s*/),t=void 0,r=0;r<e.length;r++)if("Chrome"===e[r].slice(0,6)){t=e[r];break}if(!t)return!1;var n=t.split("/"),i=n[1].split(".");return parseInt(i[0],10)<52?!0:!1}),iPhone9:n("iPhone9",function(){if(!o.iPhone())return!1;for(var e=navigator.userAgent.split(/\s*[;)(]\s*/),t=void 0,r=void 0,n=0;n<e.length;n++){if("Version"===e[n].slice(0,7)){t=e[n];break}if(e.length>0&&"OS"===e[n]&&"iPhone"===e[n-1]){r=e[n+1];break}}if(!t&&!r)return!1;var i=r?r.split("_"):t.split("/");return parseFloat(i[1])<10?!0:!1}),windowsDesktop:n("windowsDesktop",function(){return/Windows/i.test(navigator.userAgent)}),chrome:n("chrome",function(){return/Chrome/i.test(navigator.userAgent)}),firefox:n("firefox",function(){return/Firefox/i.test(navigator.userAgent)}),ie:n("ie",function(){
return/Trident/i.test(navigator.userAgent)}),edge:n("edge",function(){return/Edge\/\d+/.test(navigator.userAgent)}),safari:n("safari",function(){return/Safari/i.test(navigator.userAgent)}),windows:n("windows",function(){return/IEMobile/i.test(navigator.userAgent)}),android:n("android",function(){return/Android/i.test(navigator.userAgent)}),blackBerry:n("blackBerry",function(){return/BlackBerry/i.test(navigator.userAgent)}),iOS:n("iOS",function(){return/iPhone|iPad|iPod/i.test(navigator.userAgent)}),iPhone:n("iPhone",function(){return/iPhone/i.test(navigator.userAgent)}),any:n("any",function(){return o.android()||o.blackBerry()||o.iOS()||o.windows()})};r["default"]=o},{}],16:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={BAD_INPUT:"bad-input",DRIVER_NOT_SUPPORTED:"driver-not-supported",ELEMENT_REQUIRED:"element-required",EMBED_SWF_FAILED:"embedding-flash-swf-failed",GET_USER_MEDIA_FAILED:"get-user-media-failed",HTTP_SERVER_INTERNAL_ERROR:"http-server-internal-error",HTTP_SERVER_NOT_FOUND:"http-server-not-found",MANIFEST:"http-response",INVALID_CONTROLS:"invalid-controls-parent",INVALID_MEDIA_URL:"invalid-media-url",INVALID_POPOUT_URL:"invalid-popout-url",INVALID_EL:"invalid-element",WS_NETWORK_ERROR:"websocket-network-error",NETWORK_ERROR:"network-error",NO_DRIVERS:"no-valid-drivers",PLAYBACK_ERROR:"playback-error",UNKNOWN_DRIVER:"unknown-driver",UNKNOWN_ERROR:"unknown-error",UNRECOGNIZED_DRIVER:"unrecognized-driver",USER_REQUIRED:"user-required"};r["default"]=n},{}],17:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={EXIT_FULLSCREEN:"exit-fullscreen",ENTER_FULLSCREEN:"enter-fullscreen",ERROR:"error",BITRATE_SWITCH:"bitrate-switch",SELECT_DRIVER:"select-driver",MANIFEST:"manifest",MEDIA_PLAY:"play",MEDIA_STOP:"stop",MEDIA_PAUSE:"pause",MEDIA_STALL:"stall",MEDIA_PROGRESS:"progress",MEDIA_TIMEUPDATE:"timeupdate",MEDIA_MUTE:"mute",MEDIA_UNMUTE:"unmute",MEDIA_VOLUME:"volume",ONLINE:"online",OFFLINE:"offline",ESTIMATED_BW:"estimated-bw",USER_ACTIVE:"user-active",USER_IDLE:"user-idle"};r["default"]=n},{}],18:[function(e,t,r){"use strict";function n(e,t){return 0===t?e:n(t,e%t)}Object.defineProperty(r,"__esModule",{value:!0}),r["default"]=n},{}],19:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r["default"]=function(e,t){var r=e?Object.create(e):{};if(!t)return r;for(var n in t)"undefined"==typeof r[n]&&(r[n]=t[n]);return r}},{}],20:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("./logger"),o=n(i),s=new o["default"];r["default"]=s},{"./logger":21}],21:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=e("../uuidv4"),a=n(s),u=["debug","error","info","warn","timing","deprecated"],l=function(){function e(){i(this,e),this.sessionKey=a["default"](),this.sessionQueryString="sessionId="+this.sessionKey,this.host=null,this.setLevels(),this.publicKey=null,this.format=null,this.encoding=null,this.disable(),this.enable(),this.logEntries=[]}return o(e,[{key:"setLevels",value:function(e){var t=e||{};this.levels={debug:t.debug||!1,error:t.error||1,warn:t.warn||1,info:t.info||1,timing:t.timing||0}}},{key:"setPlayer",value:function(e,t,r,n,i){this.host=e,this.publicKey=t,this.format=r,this.encoding=n,this.driver=i}},{key:"checkSet",value:function(){return!this.host||!this.publicKey||!this.format}},{key:"levelIsSupported",value:function(e){return-1!==u.indexOf(e)}},{key:"log",value:function(e){var t;if(!this.levelIsSupported(e))return void this.log("error","unsupported log level",{level:e});if(this.levels[e]&&this.writer[e]&&this.writer[e].apply){for(var r=arguments.length,n=Array(r>1?r-1:0),i=1;r>i;i++)n[i-1]=arguments[i];(t=this.writer)[e].apply(t,n),this.apiLogging&&this.host&&this.publicKey&&this.pushBatch(n)}}},{key:"disable",value:function(){this.writer={};for(var e=0;e<u.length;e++)this.writer[u[e]]=function(){}}},{key:"enable",value:function(){window.console&&(this.writer=window.console,this.writer.timing=this.writer.info,this.writer.deprecated=this.writer.info)}},{key:"argJoin",value:function(e,t){for(var r=[e],n=0;n<t.length;n++)r.push(t[n]);return r}},{key:"debug",value:function(){for(var e=arguments.length,t=Array(e),r=0;e>r;r++)t[r]=arguments[r];this.log.apply(this,["debug"].concat(t))}},{key:"error",value:function(){for(var e=arguments.length,t=Array(e),r=0;e>r;r++)t[r]=arguments[r];this.log.apply(this,["error"].concat(t))}},{key:"timing",value:function(){for(var e=arguments.length,t=Array(e),r=0;e>r;r++)t[r]=arguments[r];this.log.apply(this,["timing"].concat(t))}},{key:"info",value:function(){for(var e=arguments.length,t=Array(e),r=0;e>r;r++)t[r]=arguments[r];this.log.apply(this,["info"].concat(t))}},{key:"warn",value:function(){for(var e=arguments.length,t=Array(e),r=0;e>r;r++)t[r]=arguments[r];this.log.apply(this,["warn"].concat(t))}},{key:"deprecated",value:function(){for(var e=arguments.length,t=Array(e),r=0;e>r;r++)t[r]=arguments[r];this.log.apply(this,["deprecated"].concat(t))}}]),e}();r["default"]=l},{"../uuidv4":35}],22:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("events"),c=n(l),f=e("xhr"),d=n(f),h=e("./errors"),p=n(h),v=e("./events"),y=n(v),m=e("./parse-url"),g=n(m),b=function(e){function t(e,r){i(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.currentState=y["default"].OFFLINE,n.formats={},n.options=r,n.host=n.options.host||window.location.host,n.setPublicId(e),n.publicId&&(n.options.pollingInterval=parseInt(n.options.pollingInterval,10)),n.setUri(e)&&n.options.pollingInterval?n:o(n)}return s(t,e),u(t,[{key:"load",value:function(){var e=this,t=void 0,r=void 0;return"function"==typeof(arguments.length<=0?void 0:arguments[0])?r=arguments.length<=0?void 0:arguments[0]:(t=arguments.length<=0?void 0:arguments[0],r=arguments.length<=1?void 0:arguments[1]),r||(r=function(){}),this.manifest||this.vod?(this.emit(y["default"].MANIFEST,this.currentState),void r()):t||this.uri?("string"!=typeof t||"http://"!==t.slice(0,7)&&"https://"!==t.slice(0,8)||(this.options.mediaLoaderUri=t),this.setUri(t)?void d["default"]({method:"GET",uri:this.uri,json:!0,useXDR:!0},function(t,n,i){var o=void 0;t?o=new Error(p["default"].HTTP_SERVER_INTERNAL_ERROR):n.statusCode>499?o=new Error(p["default"].HTTP_SERVER_INTERNAL_ERROR):n.statusCode>399?o=new Error(p["default"].HTTP_SERVER_NOT_FOUND):e.validateResponse(i)||(o=new Error(p["default"].HTTP_SERVER_UNEXPECTED_RESPONSE)),o&&e.emit(y["default"].ERROR,o.message);var s=void 0;404!==n.statusCode&&i&&i.formats?200===n.statusCode&&(e.uri=i.self):s=y["default"].OFFLINE,s||(e.formats=i.formats,s=Object.keys(i.formats).length?y["default"].ONLINE:y["default"].OFFLINE),e.type=i&&i.type?i.type:"live",e.vod&&clearInterval(e.pollingSetInterval),s!==e.currentState&&e.emit(s),e.currentState=s,e.emit(y["default"].MANIFEST,e.currentState),r()}):void r(new Error(p["default"].INVALID_MEDIA_URL))):void 0}},{key:"setPublicId",value:function(e){this.type=null,this.formats={},"string"==typeof e?this.publicId=e:"object"===("undefined"==typeof e?"undefined":a(e))&&(this.manifest=e,this.currentState=y["default"].ONLINE,this.type=this.manifest.type,this.formats=this.manifest.formats)}},{key:"validateResponse",value:function(e){return e&&"object"===("undefined"==typeof e?"undefined":a(e))?"object"!==a(e.formats)?!1:!0:!1}},{key:"setUri",value:function(e){return e?this.options.mediaLoaderUri?(this.uri=this.options.mediaLoaderUri,!0):(this.uri=g["default"](this.host).href,this.uri?(this.uri=""+this.uri+this.options.apiPrefix+"/"+e+this.options.apiSuffix,!0):(this.emit(y["default"].ERROR,p["default"].INVALID_MEDIA_URL),!1)):!!this.uri}},{key:"get",value:function(e){if(!this.formats[e])return{type:null,encodings:[],manifest:null,state:y["default"].ONLINE};var t=[];if(this.formats[e].encodings)t=this.formats[e].encodings.sort(function(e,t){return e.videoKbps+e.audioKbps>t.videoKbps+t.audioKbps?1:-1});else for(var r=Object.keys(this.formats[e]).filter(function(e){return!isNaN(e)}).sort(),n=0;n<r.length;n++)t.push(this.formats[e][r[n]]);return{type:this.type,encodings:t,manifest:this.formats[e].manifest,state:y["default"].ONLINE}}},{key:"destroy",value:function(){clearInterval(this.pollingSetInterval)}},{key:"startInterval",value:function(){var e=this;!this.options.pollingInterval||this.manifest||this.vod||(this.pollingSetInterval=setInterval(function(){e.load(e.publicId)},this.options.pollingInterval))}},{key:"vod",get:function(){return"recorded"===this.type}}]),t}(c["default"]);r["default"]=b},{"./errors":16,"./events":17,"./parse-url":23,events:44,xhr:54}],23:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r["default"]=function(e){var t=document.createElement("a");return t.href=e,t.pathname?{href:t.href,protocol:t.protocol,port:t.port,pathname:t.pathname,search:t.search,host:t.host||window.location.host}:!1}},{}],24:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("events"),c=n(l),f=e("./logger"),d=n(f),h=e("./store"),p=n(h),v=e("./stats"),y=e("./media-loader"),m=n(y),g=e("./errors"),b=n(g),w=e("./events"),E=n(w),_=e("./gcd"),k=n(_),O=e("./get-default-options"),P=n(O);e("./polyfills");var T=e("./storage-values"),R=n(T),L=1800,S=600,D={apiPrefix:"/live",apiSuffix:".json",autoplay:!0,bitrate:void 0,debug:!1,flashWmode:"transparent",flashFrameRate:60,fullscreenEl:"parent",forceDrivers:!1,formats:null,maxBufferLength:30,maxBufferSize:6e7,muted:void 0,pollingInterval:1e4,posterURI:null,preset:void 0,recoverErrorCount:10,recoverTimeout:4e3,startTime:0,volume:.75,flashlsPath:"../dist/flashlsChromeless.swf",strobeSwfPath:"../dist/StrobeMediaPlayback.swf",tfSwfPath:"../dist/thin.swf",avpPath:"../dist/avp.swf",hlsjsPath:null},I=function(e){function t(e,r,n){i(this,t);var s=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));switch(s.availableDrivers=[],"undefined"==typeof e?"undefined":a(e)){case"string":s.el=document.querySelector(e);break;case"object":s.el=e;break;default:s.error(b["default"].INVALID_EL)}if(s.options=P["default"](n,D),s.store=new p["default"],s.firstPlay=!0,"undefined"==typeof s.options.muted){var u=s.store.get(R["default"].muted);s.options.muted=null!==u?"true"===u:s.options.muted}var l=s.store.get(R["default"].volume);s.options.volume=isNaN(parseFloat(l))?s.options.volume:parseFloat(l),s.options.bitrate&&!parseInt(s.options.bitrate,10)&&(s.error(b["default"].INVALD_BITRATE),s.options.bitrate=void 0),"undefined"!=typeof s.options.bitrate&&s.storeBitrate(s.options.bitrate);var c=parseInt(s.store.get(R["default"].lockedKbps),10);if(s.options.bitrate=c||parseInt(s.options.bitrate,10)||null,s.estimatedKbps=parseInt(s.store.get(R["default"].estimatedKbps),10)||L,s.isTryingToPlay=!1,s.shouldTryToPlay=s.options.autoplay,s.options.debug?d["default"].setLevels({debug:!0,error:1,warn:1,info:1,timing:1}):d["default"].setLevels(),s.trackFirstProgress(),s.options.mediaLoaderUri&&d["default"].deprecated("mediaLoaderUri","second argument may now take a uri or publicId"),r)if("string"==typeof r)("http://"===r.slice(0,7)||"https://"===r.slice(0,8))&&(s.options.mediaLoaderUri=r);else if("object"===("undefined"==typeof r?"undefined":a(r)))s.options.mediaLoaderUri=r;else if(null!==r)return d["default"].error("invalid manifest",r),o(s);if(!Array.isArray(s.options.drivers))return d["default"].error("invalid drivers, must be an array",s.options.drivers),o(s);for(var f=0;f<s.options.drivers.length;f++)if("function"!=typeof s.options.drivers[f])return d["default"].error("invalid drivers, each driver must type function, check driver at index "+f),o(s);return s.mediaLoader=s.options.mediaLoader||new m["default"](r,s.options),s.setDrivers(s.options.drivers),s.mediaLoader.on(E["default"].ERROR,s.eventHandler(E["default"].ERROR).bind(s)),s.mediaLoader.on(E["default"].MANIFEST,s.eventHandler(E["default"].MANIFEST).bind(s)),s.mediaLoader.on(E["default"].MANIFEST,function(){return s.mediaLoader.currentState!==E["default"].ONLINE?void s.stop():void(!s.shouldTryToPlay||s.currentDriver&&!s.currentDriver.supportsAutoplay||s.play())}),s.mediaLoader.on(E["default"].ONLINE,function(){s.emit(E["default"].ONLINE)}),s.mediaLoader.on(E["default"].OFFLINE,function(){s.tryingToPlay&&(s.shouldTryToPlay=!0),s.emit(E["default"].OFFLINE)}),s.mediaLoader.load(),s.mediaLoader.startInterval&&s.mediaLoader.startInterval(),s.options.autoplay&&s.currentDriver&&s.currentDriver.elementPlay&&s.currentDriver.elementPlay(),s}return s(t,e),u(t,[{key:"trackFirstProgress",value:function(){var e=this;this.options.autoplay&&(this.autoplayProgressId=v.stats.start(v.STATS_EVENTS.AUTOPLAY_PROGRESS),this.once(E["default"].MEDIA_PROGRESS,function(){v.stats.stop(e.autoplayProgressId,{driver:e.currentDriver.driver})}))}},{key:"setOption",value:function(e,t){this.options[e]=t,this.currentDriver&&this.currentDriver.setOption(e,t)}},{key:"load",value:function(e,t){this.stop(),this.mediaLoader.setPublicId(e),this.mediaLoader.load(e,t)}},{key:"destroy",value:function(){this.mediaLoader.destroy&&(this.mediaLoader.removeAllListeners(E["default"].MANIFEST),this.mediaLoader.removeAllListeners(E["default"].ERROR),this.mediaLoader.destroy());var e=void 0;if(this.currentDriver){this.currentDriver.destroy();for(e in E["default"])this.currentDriver.removeAllListeners(E["default"][e]);this.currentDriver.removeAllListeners(E["default"][e],this.eventHandler(E["default"][e])),this.currentDriver.destroy()}this.removeAllListeners(E["default"].MEDIA_PROGRESS),this.emit(E["default"].DESTROY)}},{key:"storeBitrate",value:function(e){this.store.set(R["default"].lockedKbps,e)}},{key:"restart",value:function(){var e=this.tryingToPlay;this.stop(),this.shouldTryToPlay=e,this.mediaLoader.load()}},{key:"switchDrivers",value:function(e){this.options.drivers=e,this.setDrivers(e),this.restart()}},{key:"getState",value:function(){return this.mediaLoader.currentState}},{key:"eventHandler",value:function(e){var t=this;return function(){for(var r=arguments.length,n=Array(r),i=0;r>i;i++)n[i]=arguments[i];("error"!==e||t._events&&t._events.hasOwnProperty("error"))&&t.emit.apply(t,[e].concat(n))}}},{key:"error",value:function(e,t){(!this._events||this._events.hasOwnProperty("error"))&&this.emit(E["default"].ERROR,e,t),d["default"].warn(e)}},{key:"setDrivers",value:function(e){var t=void 0;this.availableDrivers=[];for(var r=0;r<e.length;r++)t=e[r],t&&t.isSupported()?(this.options.forceDrivers||t.isSupported())&&this.availableDrivers.push(t):d["default"].debug("driver at index "+r+" is not supported");return this.availableDrivers.length?void(this.driver=0):void this.noDrivers()}},{key:"pause",value:function(){this.isTryingToPlay=!1,this.currentDriver&&this.currentDriver.pause(),this.emit(E["default"].MEDIA_PAUSE)}},{key:"noDrivers",value:function(){this.mediaLoader.currentState===E["default"].ONLINE&&this.error(b["default"].NO_DRIVERS)}},{key:"play",value:function(){var e=this;return this.currentDriver?(this.isTryingToPlay=!0,void this.currentDriver.play(function(t){return t?(e.shouldTryToPlay=!1,"true"===e.store.get(R["default"].muted)&&e.currentDriver.mute(),e.firstPlay&&e.vod&&e.options.startTime&&(e.currentDriver.currentTime=e.options.startTime),e.isTryingToPlay=!0,void(e.mediaLoader.state!==E["default"].OFFLINE&&(e.emit(E["default"].MEDIA_PLAY),e.firstPlay=!1))):void(e.isTryingToPlay=!1)})):void this.noDrivers()}},{key:"stop",value:function(){this.isTryingToPlay=!1,this.currentDriver&&this.currentDriver.stop(),this.emit(E["default"].MEDIA_STOP)}},{key:"isTryingToPlayAudio",value:function(){return this.currentDriver?this.currentDriver.isTryingToPlayAudio(this.tryingToPlay):this.tryingToPlay}},{key:"mute",value:function(){if(!this.currentDriver)return this.noDrivers(),null;var e=this.currentDriver.mute();return this.store.set(R["default"].muted,String(e)),this.emit(E["default"].MEDIA_MUTE),e}},{key:"unmute",value:function(){if(!this.currentDriver)return this.noDrivers(),null;var e=this.currentDriver.unmute();return this.store.set(R["default"].muted,String(e)),this.emit(E["default"].MEDIA_UNMUTE),e}},{key:"currentEncoding",value:function(){return this.currentDriver?this.currentDriver.pickEncoding():void 0}},{key:"supportsFullscreen",value:function(){return this.currentDriver?this.currentDriver.supportsFullscreen():null}},{key:"supportsVolume",value:function(){return this.currentDriver?this.currentDriver.supportsVolume():null}},{key:"bitrate",set:function(e){this.storeBitrate(e),this.currentDriver.bitrate=e}},{key:"driver",set:function(e){var t=this;if(!this.availableDrivers[e])return void this.noDrivers();var r=this.availableDrivers[e];this.currentDriver&&this.currentDriver.destroy(),this.currentDriver=new r(this,this.mediaLoader,{bitrate:this.options.bitrate,estimatedKbps:this.estimatedKbps,volume:this.options.volume,muted:this.options.muted,debug:this.options.debug,recoverTimeout:this.options.recoverTimeout,recoverErrorCount:this.options.recoverErrorCount,maxBufferLength:this.options.maxBufferLength,maxBufferSize:this.options.maxBufferSize,preset:this.options.preset,flashlsPath:this.options.flashlsPath,tfSwfPath:this.options.tfSwfPath,strobeSwfPath:this.options.strobeSwfPath,avpPath:this.options.avpPath,hlsjsPath:this.options.hlsjsPath,posterURI:this.options.posterURI,flashFrameRate:this.options.flashFrameRate,flashWmode:this.options.flashWmode}),this.currentDriver.on(E["default"].ERROR,function(r){var n=function(){t.availableDrivers.length&&(t.currentDriver.destroy(),t.availableDrivers.splice(e,1),t.driver=e,t.tryingToPlay&&t.play())};switch(r){case b["default"].EMBED_SWF_FAILED:n();break;case b["default"].DRIVER_NOT_SUPPORTED:n()}}),this.emit(E["default"].SELECT_DRIVER,this.currentDriver),this.currentDriver.on(E["default"].ESTIMATED_BW,function(e){t.store.set(R["default"].estimatedKbps,parseInt(e,10)||S)});for(var n in E["default"])this.currentDriver.on(E["default"][n],this.eventHandler(E["default"][n]))}},{key:"duration",get:function(){return this.currentDriver?this.currentDriver.duration:1/0}},{key:"vod",get:function(){return this.mediaLoader?this.mediaLoader.vod:null}},{key:"bufferLength",get:function(){return this.currentDriver?this.currentDriver.bufferLength:0}},{key:"backBufferLength",get:function(){return this.currentDriver?this.currentDriver.backBufferLength:0}},{key:"currentTime",get:function(){return this.currentDriver?this.currentDriver.currentTime:0},set:function(e){this.currentDriver&&(this.currentDriver.currentTime=e)}},{key:"bufferTimes",get:function(){return this.currentDriver?this.currentDriver.bufferTimes:[]}},{key:"tryingToPlay",get:function(){return!!this.isTryingToPlay}},{key:"muted",get:function(){return this.currentDriver?this.currentDriver.muted:(this.noDrivers(),null)}},{key:"mediaData",get:function(){return this.currentDriver?this.currentDriver.data:null}},{key:"allMediaData",get:function(){for(var e=this.availableDrivers,t=[],r=void 0,n=0;n<e.length;n++)if(r=e[n],r.isSupported&&r.isSupported(this.el)){var i=this.mediaLoader.get(r.format);if(!i.manifest)continue;i.driver=r.driver,t.push(i)}return t}},{key:"volume",set:function(e){if(!this.currentDriver)return void 0;var t=this.currentDriver.volume=e;return this.store.set(R["default"].muted,0===t),this.store.set(R["default"].volume,t),this.emit(E["default"].MEDIA_VOLUME,t),t},get:function(){return this.currentDriver?this.currentDriver.volume:0}},{key:"details",get:function(){return this.currentDriver?this.currentDriver.details:{}}},{key:"chosenLevel",get:function(){return this.currentDriver?this.currentDriver.chosenLevel:void 0}},{key:"currentLevel",get:function(){return this.currentDriver?this.currentDriver.currentLevel:void 0}},{key:"nextLevel",get:function(){return this.currentDriver?this.currentDriver.nextLevel:void 0}},{key:"aspectRatio",get:function(){if(!this.currentDriver)return null;var e=this.currentDriver.data;if(!e)return null;if(!e.encodings||!e.encodings.length)return null;if(!e.encodings[0].videoWidth||!e.encodings[0].videoHeight)return null;var t=k["default"](e.encodings[0].videoWidth,e.encodings[0].videoHeight);return{width:e.encodings[0].videoWidth/t,height:e.encodings[0].videoHeight/t}}}]),t}(c["default"]);r["default"]=I},{"./errors":16,"./events":17,"./gcd":18,"./get-default-options":19,"./logger":20,"./media-loader":22,"./polyfills":25,"./stats":27,"./storage-values":29,"./store":34,events:44}],25:[function(){"use strict";var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};"remove"in window.Element.prototype||(window.Element.prototype.remove=function(){this.parentNode&&this.parentNode.removeChild(this)}),"function"!=typeof Object.create&&(Object.create=function(e){var t=function(){};return function(r,n){if(r!==Object(r)&&null!==r)throw TypeError("Argument must be an object, or null");t.prototype=r||{},n!==e&&Object.defineProperties(t.prototype,n);var i=new t;return t.prototype=null,i}}()),function(){for(var e=0,t=["ms","moz","webkit","o"],r=0;r<t.length&&!window.requestAnimationFrame;++r)window.requestAnimationFrame=window[t[r]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[r]+"CancelAnimationFrame"]||window[t[r]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t){var r=(new Date).getTime(),n=Math.max(0,16-(r-e)),i=window.setTimeout(function(){t(r+n)},n);return e=r+n,i}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})}(),function(e){var t=Date.now?Date.now():+new Date;e.performance=e.performance||{},e.performance.now=e.performance.webkitNow||e.performance.mozNow||e.performance.msNow||function(){return(Date.now?Date.now():+new Date)-t}}(window),Object.keys||(Object.keys=function(){var t=Object.prototype.hasOwnProperty,r=!{toString:null}.propertyIsEnumerable("toString"),n=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],i=n.length;return function(o){if("object"!==("undefined"==typeof o?"undefined":e(o))&&("function"!=typeof o||null===o))throw new TypeError("Object.keys called on non-object");var s=[],a=void 0,u=void 0;for(a in o)t.call(o,a)&&s.push(a);if(r)for(u=0;i>u;u++)t.call(o,n[u])&&s.push(n[u]);return s}}()),"document"in self&&("classList"in document.createElement("_")&&(!document.createElementNS||"classList"in document.createElementNS("http://www.w3.org/2000/svg","g"))?!function(){var e=document.createElement("_");if(e.classList.add("c1","c2"),!e.classList.contains("c2")){var t=function(e){var t=DOMTokenList.prototype[e];DOMTokenList.prototype[e]=function(e){var r,n=arguments.length;for(r=0;n>r;r++)e=arguments[r],t.call(this,e)}};t("add"),t("remove")}if(e.classList.toggle("c3",!1),e.classList.contains("c3")){var r=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(e,t){return 1 in arguments&&!this.contains(e)==!t?t:r.call(this,e)}}e=null}():!function(e){if("Element"in e){var t="classList",r="prototype",n=e.Element[r],i=Object,o=String[r].trim||function(){return this.replace(/^\s+|\s+$/g,"")},s=Array[r].indexOf||function(e){for(var t=0,r=this.length;r>t;t++)if(t in this&&this[t]===e)return t;return-1},a=function(e,t){this.name=e,this.code=DOMException[e],this.message=t},u=function(e,t){if(""===t)throw new a("SYNTAX_ERR","An invalid or illegal string was specified");if(/\s/.test(t))throw new a("INVALID_CHARACTER_ERR","String contains an invalid character");return s.call(e,t)},l=function(e){for(var t=o.call(e.getAttribute("class")||""),r=t?t.split(/\s+/):[],n=0,i=r.length;i>n;n++)this.push(r[n]);this._updateClassName=function(){e.setAttribute("class",this.toString())}},c=l[r]=[],f=function(){return new l(this)};if(a[r]=Error[r],c.item=function(e){return this[e]||null},c.contains=function(e){return e+="",-1!==u(this,e)},c.add=function(){var e,t=arguments,r=0,n=t.length,i=!1;do e=t[r]+"",-1===u(this,e)&&(this.push(e),i=!0);while(++r<n);i&&this._updateClassName()},c.remove=function(){var e,t,r=arguments,n=0,i=r.length,o=!1;do for(e=r[n]+"",t=u(this,e);-1!==t;)this.splice(t,1),o=!0,t=u(this,e);while(++n<i);o&&this._updateClassName()},c.toggle=function(e,t){e+="";var r=this.contains(e),n=r?t!==!0&&"remove":t!==!1&&"add";return n&&this[n](e),t===!0||t===!1?t:!r},c.toString=function(){return this.join(" ")},i.defineProperty){var d={get:f,enumerable:!0,configurable:!0};try{i.defineProperty(n,t,d)}catch(h){-2146823252===h.number&&(d.enumerable=!1,i.defineProperty(n,t,d))}}else i[r].__defineGetter__&&n.__defineGetter__(t,f)}}(self))},{}],26:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={AUTOPLAY_PROGRESS:"autoplay-first-progress",FIRST_LOAD:"first-load"};r["default"]=n},{}],27:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0}),r.STATS_EVENTS=r.stats=void 0;var i=e("./stats"),o=n(i),s=e("./events"),a=n(s),u=new o["default"];r.stats=u,r.STATS_EVENTS=a["default"]},{"./events":26,"./stats":28}],28:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=e("../logger"),a=n(s),u=function(){function e(){i(this,e),this.eventCounter=0,this.timings={}}return o(e,[{key:"start",value:function(e){var t=this.eventCounter++;return this.timings[t]={ms:Date.now(),name:e},t}},{key:"stop",value:function(e,t){if(this.timings[e]){var r=t||{};r.ms=Date.now()-this.timings[e].ms,a["default"].timing(this.timings[e].name,r),delete this.timings[e]}}}]),e}();r["default"]=u},{"../logger":20}],29:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={muted:"aiw_muted",volume:"aiw_volume",lockedKbps:"aiw_locked_kbs",estimatedKbps:"aiw_estimated_kbs",hideSuggestion:"aiw_hide_suggestion"};r["default"]=n},{}],30:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=function(){function e(){n(this,e)}return i(e,[{key:"set",value:function(){console.error("an abstract method has been called")}},{key:"get",value:function(){console.error("an abstract method has been called")}}]),e}();r["default"]=o},{}],31:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function e(e,t){var r=[],n=!0,i=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(n=(s=a.next()).done)&&(r.push(s.value),!t||r.length!==t);n=!0);}catch(u){i=!0,o=u}finally{try{!n&&a["return"]&&a["return"]()}finally{if(i)throw o}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("./base-driver"),c=n(l),f=new RegExp("\\s*;\\s*"),d=function(e){function t(){return i(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s(t,e),u(t,[{key:"parse",value:function(e){var t={};return e?(e.split(f).forEach(function(e){var r=e.split("="),n=a(r,2),i=n[0],o=n[1],s=decodeURIComponent(i),u=decodeURIComponent(o);t[s]=u}),t):t}},{key:"stringify",value:function(e){var t=[];for(var r in e)({}).hasOwnProperty.call(e,r)&&t.push(r+"="+e[r]);return t.join("; ")}},{key:"set",value:function(e,t){document.cookie=e+"="+t}},{key:"get",value:function(e){var t=this.parse(document.cookie);return t[e]||null}}]),t}(c["default"]);r["default"]=d},{"./base-driver":30}],32:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);

e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=e("./base-driver"),l=n(u),c=function(e){function t(){return i(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s(t,e),a(t,[{key:"set",value:function(e,t){try{window.localStorage.setItem(e,t)}catch(r){}}},{key:"get",value:function(e){var t=null;try{t=window.localStorage.getItem(e)||null}catch(r){}return t}}]),t}(l["default"]);r["default"]=c},{"./base-driver":30}],33:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=e("./base-driver"),l=n(u),c={},f=function(e){function t(){return i(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s(t,e),a(t,[{key:"set",value:function(e,t){c[e]=t}},{key:"get",value:function(e){return c[e]||null}}]),t}(l["default"]);r["default"]=f},{"./base-driver":30}],34:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=e("./drivers/cookie"),a=n(s),u=e("./drivers/local-storage"),l=n(u),c=e("./drivers/memory"),f=n(c),d=function(){function e(){i(this,e);try{if(window.localStorage)return void(this.driver=new l["default"])}catch(t){}try{if("string"==typeof document.cookie)return void(this.driver=new a["default"])}catch(t){}this.driver=new f["default"]}return o(e,[{key:"set",value:function(e,t){this.driver&&this.driver.set(e,t)}},{key:"get",value:function(e){return this.driver?this.driver.get(e):void 0}}]),e}();r["default"]=d},{"./drivers/cookie":31,"./drivers/local-storage":32,"./drivers/memory":33}],35:[function(e,t,r){"use strict";function n(){for(var e,t=0;16>t;t++)0===(3&t)&&(e=4294967296*Math.random()),o[t]=e>>>((3&t)<<3)&255;return o}function i(e,t){var r=t||0,n=s;return n[e[r++]]+n[e[r++]]+n[e[r++]]+n[e[r++]]+"-"+n[e[r++]]+n[e[r++]]+"-"+n[e[r++]]+n[e[r++]]+"-"+n[e[r++]]+n[e[r++]]+"-"+n[e[r++]]+n[e[r++]]+n[e[r++]]+n[e[r++]]+n[e[r++]]+n[e[r++]]}Object.defineProperty(r,"__esModule",{value:!0}),r["default"]=function(){var e=n();return e[6]=15&e[6]|64,e[8]=63&e[8]|128,i(e)};for(var o=new Array(16),s=[],a={},u=0;256>u;u++)s[u]=(u+256).toString(16).substr(1),a[s[u]]=u},{}],36:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=e("@livelyvideo/player-core/lib/base-driver"),l=n(u),c=e("@livelyvideo/player-core/lib/logger"),f=n(c),d=e("@livelyvideo/player-core/lib/events"),h=n(d),p=e("@livelyvideo/player-core/lib/errors"),v=n(p),y=e("swfobject-amd"),m=n(y),g=e("lodash.noop"),b=n(g),w=e("./thinflash/broadcast"),E=n(w),_=e("./thinflash/playback"),k=n(_),O=300,P="11.0.0",T="aiw-swf-uniqid",R=0,L=function(e){function t(e,r,n){i(this,t);var s=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r,n));return s.options.bitrate||(s.options.bitrate=s.options.estimatedKbps),s.el=e.el,s.fragCounts=0,s.fragSize=0,s.fragDuration=0,s.fragDownloadTime=0,s.fragMaxTime=0,s.fragMinTime=0,s.bufferOverflowCount=0,s.bufferUnderflowCount=0,s.upshift=0,s.downshift=0,s.lastProgress=0,s.currentErrorCount=0,s.recentErrorCount=0,s.errors={},s.livelyPlayer=e,s.mediaLoader=r,s.options=n,s.el.volume=s.options.volume,s.el.muted=s.options.muted,s.selectedEncoding=null,s.swf=null,s.isStopped=!0,s.playing={},s.hasStarted=!1,s.broadcastId=-1,s.currentVolume=n.volume,s.currentMuted=n.muted,s.id=R++,s.render(),s.setupThinflash(),s}return s(t,e),a(t,[{key:"render",value:function(){this.obj=document.createElement("div"),this.el.appendChild(this.obj),this.obj.setAttribute("class","aiw-swf-container"),this.obj.setAttribute("id",T+"-"+this.id)}},{key:"handleTFError",value:function(){for(var e=arguments.length,t=Array(e),r=0;e>r;r++)t[r]=arguments[r];this.emit.apply(this,[h["default"].ERROR].concat(t))}},{key:"setupThinflash",value:function(){var e=this;this.thinBroadcast=E["default"],this.thinBroadcast.logError=this.handleTFError.bind(this),this.thinBroadcast.getSwf=function(){return e.swf},this.thinPlayback=k["default"],this.thinPlayback.logError=this.handleTFError.bind(this),this.thinPlayback.getSwf=function(){return e.swf},this.tfIsReadyCbs=[],window.tfSendToJavaScript=function(t,r,n){t===e.obj.getAttribute("id")&&e.emit(n[1],n[0],n.slice(2))},window.tfIsReady=function(){return!0}}},{key:"createAndPlay",value:function(){var e=this;this.createBroadcast(),this.connectToBroadcast(this.playing,function(){e.progressCounter=0,e.startPlayback()})}},{key:"shouldBePlaying",value:function(){return!!this.rtmpSrc}},{key:"startPlayback",value:function(){this.thinPlayback.playbackPlay(this.broadcastId),this.thinPlayback.setVolume(this.broadcastId,this.currentVolume),this.thinPlayback.muteAudio(this.broadcastId,this.currentMuted)}},{key:"watchProgress",value:function(e){var t=this;clearInterval(this.recoveryInterval),this.progressCounter=0,this.recoveryInterval=setInterval(function(){if(!(t.broadcastId<0)&&t.livelyPlayer.tryingToPlay){var r=t.livelyPlayer.details;if(r.currentBytesPerSecond>0&&t.progressCounter++,!r.currentBytesPerSecond&&t.livelyPlayer.tryingToPlay)return void(t.errorTimeout||(t.errorTimeout=setTimeout(function(){r=t.livelyPlayer.details,t.errorTimeout=null,t.broadcastId<0||!r.currentBytesPerSecond&&t.progressCounter>0&&(t.destroyBroadcast(),t.createAndPlay(),t.emit(h["default"].ERROR,v["default"].NETWORK_ERROR))},10*e)));t.emitProgress(),r.playbackBytesPerSecond>0&&t.emitTimeupdate(),clearTimeout(t.errorTimeout),t.errorTimeout=null}},e)}},{key:"onceTfIsReady",value:function(e){return this.swf&&this.swf.tfBroadcastCreate?void e():(this.tfIsReadyCbs.push(e),void this.pollTf())}},{key:"pollTf",value:function(){var e=this;this.pollingTf||(this.pollingTfAttempts=0,clearInterval(this.pollingTf),this.pollingTf=setInterval(function(){if(e.pollingTfAttempts++,e.pollingTfAttempts>30)return clearInterval(e.pollingTf),void e.emit(h["default"].ERROR,v["default"].EMBED_SWF_FAILED,"timeout");if(e.swf&&e.swf.tfBroadcastCreate){clearInterval(e.pollingTf);for(var t=e.tfIsReadyCbs.shift();t;)t(),t=e.tfIsReadyCbs.shift()}},20))}},{key:"pause",value:function(){this.stop()}},{key:"stop",value:function(){clearInterval(this.recoveryInterval),clearTimeout(this.watchLessTimeout),this.broadcastId&&(this.removeListener(h["default"].MEDIA_PROGRESS,this.watchProgress),this.isStopped=!0,this.swf&&this.swf.tfPlaybackPlay&&this.thinPlayback.playbackPlay(this.broadcastId,!1),this.destroyBroadcast())}},{key:"destroy",value:function(){this.destroyed=!0,clearInterval(this.recoveryInterval),clearTimeout(this.watchLessTimeout),this.thinBroadcast.logError=null,this.thinPlayback.logError=null,this.obj.remove(),this.swf&&this.swf.remove()}},{key:"unmute",value:function(){return this.currentMuted=!1,this.thinPlayback.muteAudio(this.broadcastId,!1),!1}},{key:"mute",value:function(){return this.currentMuted=!0,this.thinPlayback.muteAudio(this.broadcastId,!0),!0}},{key:"enterFullscreen",value:function(){this.swf.requestFullscreen?this.swf.requestFullscreen():this.swf.mozRequestFullScreen?this.swf.mozRequestFullScreen():this.swf.webkitRequestFullScreen?this.swf.webkitRequestFullScreen():this.swf.msRequestFullscreen&&this.swf.msRequestFullscreen()}},{key:"getReady",value:function(e){var t=this;this.whenReady(function(){return t.swf?void e(t.swf):void m["default"].embedSWF(t.options.tfSwfPath,t.obj.getAttribute("id"),"100%","100%",P,"/dist/expressInstall.swf",{framerate:t.options.flashFrameRate,tfID:t.obj.getAttribute("id")},{scale:"noscale",quality:"high",allowscriptaccess:"always",allowfullscreen:"true",wmode:t.options.flashWmode,bgcolor:"#000000",align:"middle",salign:"TL",menu:"true",id:t.obj.getAttribute("id")},{id:t.obj.getAttribute("id"),"class":"tf-content"},function(r){t.swf=r.ref,t.onceTfIsReady(function(){e(r)})})})}},{key:"pickEncoding",value:function(){var e=this.options.bitrate||this.options.estimatedKbps,t=this.data.encodings;if(!t.length)return null;var r=void 0;for(r=0;r<t.length&&!(t[r].videoWidth&&t[r].videoKbps+t[r].audioKbps>e);r++);return r=Math.max(r-1,0),t[r]}},{key:"destroyBroadcast",value:function(){this.broadcastId>=0&&this.thinBroadcast.destroyBroadcast(this.broadcastId)&&(this.broadcastId=-1)}},{key:"createBroadcast",value:function(){return this.broadcastId<0&&(this.broadcastId=this.thinBroadcast.createBroadcast(),!this.broadcastId)?void(this.broadcastId=-1):void 0}},{key:"connectToBroadcast",value:function(e,t){this.thinBroadcast.connectToBroadcast(this.broadcastId,e.prefix,e.video),this.once("NetConnection.Connect.Success",t)}},{key:"play",value:function(e){var t=this,r=e||b["default"],n=this.rtmpSrc;return n?void(this.destroyed||(this.playing={prefix:n.prefix,video:n.video},this.getReady(function(e){return e.success||t.swf?t.mediaLoader.vod?void t.emit(h["default"].ERROR,v["default"].DRIVER_NOT_SUPPORTED):(t.destroyBroadcast(),t.createBroadcast(),void t.connectToBroadcast(t.playing,function(){f["default"].setPlayer(t.mediaLoader.host,t.mediaLoader.publicId,t.format,t.selectedEncoding.location,t),t.startPlayback(),t.watchProgress(O),r(!0)})):void t.emit(h["default"].ERROR,v["default"].EMBED_SWF_FAILED)}))):void(this.mediaLoader.currentState===h["default"].ONLINE&&this.emit(h["default"].ERROR,v["default"].DRIVER_NOT_SUPPORTED))}},{key:"supportsAutoplay",get:function(){return!0}},{key:"bufferTimes",get:function(){return[]}},{key:"data",get:function(){return this.mediaLoader.get(this.format)}},{key:"rtmpSrc",get:function(){if(this.selectedEncoding=this.pickEncoding(),!this.selectedEncoding)return null;var e=this.selectedEncoding.location.split(/\//),t=e.splice(e.length-1,1)[0],r=e.join("/")+"/";return{prefix:r,video:t}}},{key:"stopped",get:function(){return this.isStopped}},{key:"muted",get:function(){return this.currentMuted}},{key:"paused",get:function(){return this.isStopped()}},{key:"volume",get:function(){return this.currentVolume},set:function(e){return e?(this.currentVolume=e,this.thinPlayback.setVolume(this.broadcastId,e),this.currentVolume>0&&this.unmute(),e):this.currentVolume}},{key:"bitrate",set:function(e){var t=this;this.options.bitrate=e,this.stop(),this.play(function(e){e&&t.emit(h["default"].BITRATE_SWITCH)})}},{key:"details",get:function(){var e={};try{this.swf&&this.swf.tfGetNetStreamProperty&&this.broadcastId>0&&(e=this.swf.tfGetNetStreamProperty(this.broadcastId,"info"))}catch(t){this.livelyPlayer.tryingToPlay&&this.checkRestart({fatal:!1,reason:"swf not loaded yet"})}return e=e||{},e.volume=this.currentVolume,e.muted=this.currentMuted,e}}],[{key:"isSupported",value:function(){return m["default"].hasFlashPlayerVersion(P)}},{key:"driver",get:function(){return"flash"}},{key:"format",get:function(){return"mp4-rtmp"}}]),t}(l["default"]);r["default"]=L},{"./thinflash/broadcast":37,"./thinflash/playback":38,"@livelyvideo/player-core/lib/base-driver":14,"@livelyvideo/player-core/lib/errors":16,"@livelyvideo/player-core/lib/events":17,"@livelyvideo/player-core/lib/logger":20,"lodash.noop":48,"swfobject-amd":51}],37:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("@livelyvideo/player-core"),o=n(i);r["default"]={createBroadcast:function(){try{return this.getSwf().tfBroadcastCreate()}catch(e){return o["default"].error("broadcast","createBroadcast",[],"error initializing broadcast [err="+e+"]"),!1}},destroyBroadcast:function(e){try{this.getSwf().tfBroadcastDestroy(e)}catch(t){return o["default"].error("broadcast","destroyBroadcast",[e],"error destroying broadcast [err="+t+"]"),!1}return!0},connectToBroadcast:function(e,t,r){try{var n;(n=this.getSwf()).tfBroadcastConnect.apply(n,arguments)}catch(i){return o["default"].error("broadcast","connectToBroadcast",[e,t,r],"error connecting to broadcast [err="+i+"]"),!1}return!0},setVideoPath:function(e,t){try{this.getSwf().tfBroadcastConnect(e,null,t)}catch(r){return o["default"].error("broadcast","connectToVideo",[e,t],"error connecting to video [err="+r+"]"),!1}return!0},setStreamName:function(e,t){try{this.getSwf().tfBroadcastSetStreamName(e,t)}catch(r){return o["default"].error("broadcast","setStreamName",[e,t],"error setting stream name [err="+r+"]"),!1}return!0},broadcastAttachCamera:function(e,t){try{this.getSwf().tfBroadcastAttachCamera(e,t)}catch(r){return o["default"].error("broadcast","broadcastAttachCamera",[e,t],"error attaching camera to broadcast [err="+r+"]"),!1}return!0},broadcastAttachMicrophone:function(e,t){try{this.getSwf().tfBroadcastAttachMicrophone(e,t)}catch(r){return o["default"].error("broadcast","broadcastAttachMicrophone",[e,t],"error attaching mic to broadcast [err="+r+"]"),!1}return!0}}},{"@livelyvideo/player-core":13}],38:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("@livelyvideo/player-core"),o=n(i);r["default"]={playbackPlay:function(e,t){try{this.getSwf().tfPlaybackPlay(e,t)}catch(r){return o["default"].error("playback","playbackPlay",[e,t],"error playing video [err="+r+"]"),!1}return!0},setVolume:function(e,t){try{this.getSwf().tfPlaybackSetVolume(e,t)}catch(r){return o["default"].error("playback","setVolume",[e,t],"error setting volume [err="+r+"]"),!1}return!0},muteAudio:function(e,t){try{this.getSwf().tfPlaybackMute(e,t)}catch(r){return o["default"].error("playback","muteAudio",[e,t],"error muting audio [err="+r+"]"),!1}return!0},pausePlayback:function(e,t){try{this.getSwf().tfPlaybackPause(e,t)}catch(r){return o["default"].error("playback","pausePlayback",[e,t],"error pausing playback [err="+r+"]"),!1}return!0},pausePlaybackToggle:function(e){try{this.getSwf().tfPlaybackTogglePause(e)}catch(t){return o["default"].error("playback","pausePlaybackToggle",[e],"error pausing playback [err="+t+"]"),!1}return!0},createStream:function(e,t){try{this.getSwf().tfBroadcastCreateStream(e,t)}catch(r){return o["default"].error("playback","createStream",[e],"error creating stream [err="+r+"]"),!1}return!0},destroyStream:function(e,t){try{this.getSwf().tfBroadcastDestroyStream(e,t)}catch(r){return o["default"].error("playback","destroyStream",[e,t],"error destroying stream [err="+r+"]"),!1}return!0},setCurrentStreamIndex:function(e,t){try{this.getSwf().tfBroadcastSetCurrentStreamIndex(e,t)}catch(r){return o["default"].error("playback","setCurrentStreamIndex",[e,t],"error setting stream index [err="+r+"]"),!1}return!0},getNetStreamProperty:function(e,t){try{return this.getSwf().tfGetNetStreamProperty(e,t)}catch(r){return o["default"].error("playback","getNetStreamProperty",[e,t],"error getting NetStream property [err="+r+"]"),!1}},setNetStreamProperty:function(e,t,r){try{this.getSwf().tfSetNetStreamProperty(e,t,r)}catch(n){return o["default"].error("playback","setVideoProperties",[e,t,r],"error setting NetStream property [err="+n+"]"),!1}return!0},invokeNetStreamMethod:function(e,t){try{var r;(r=this.getSwf()).tfInvokeNetStreamMethod.apply(r,arguments)}catch(n){return o["default"].error("playback","invokeNetStreamMethod",[e,t],"error invoking NetStream method [err="+n+"]"),!1}return!0},setVideoProperties:function(e,t,r){try{var n;(n=this.getSwf()).tfSetVideoProperties.apply(n,arguments)}catch(i){return o["default"].error("playback","setVideoProperties",[e,t,r],"error setting video properties [err="+i+"]"),!1}return!0}}},{"@livelyvideo/player-core":13}],39:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=8,s=function(){function e(t){n(this,e),t.on(window.Hls.Events.FRAG_LOADING,this.onFragLoading.bind(this)),t.on(window.Hls.Events.FRAG_LOAD_PROGRESS,this.onFragLoadProgress.bind(this)),t.on(window.Hls.Events.FRAG_LOADED,this.onFragLoaded.bind(this)),t.on(window.Hls.Events.ERROR,this.onError.bind(this)),this.lastLoadedFragLevel=0,this._autoLevelCapping=-1,this._nextAutoLevel=-1,this.hls=t,this.onCheck=this.checkFragProgress.bind(this),this.lastBws=[],this.lastBw=0,this.lastCalculated=0}return i(e,[{key:"getCurrentLevel",value:function(){return this.fragCurrent}},{key:"getNextLevel",value:function(){return this.nextAutoLevel}},{key:"destroy",value:function(){this.clearTimer()}},{key:"onFragLoading",value:function(e,t){this.clearTimer(this.timer),this.timer=setInterval(this.onCheck,100),this.fragCurrent=t.frag}},{key:"calculateLastBw",value:function(){this.lastCalculated=Date.now(),this.lastBws.splice(o);for(var e=0,t=0;t<this.lastBws.length;t++)e+=this.lastBws[t];e=Math.floor(e/this.lastBws.length),this.lastBw=e}},{key:"addBw",value:function(e){this.lastBws.unshift(e),this.calculateLastBw()}},{key:"onFragLoadProgress",value:function(e,t){if(!(this.lastBws.length>o/2)){this.lastfetchduration=(window.performance.now()-t.stats.trequest)/1e3;var r=8*t.stats.loaded/this.lastfetchduration;r&&this.addBw(r)}}},{key:"bufferedInfo",value:function(e,t,r){var n=[],i=void 0,o=void 0,s=void 0,a=void 0,u=void 0;for(e.sort(function(e,t){var r=e.start-t.start;return r?r:t.end-e.end}),u=0;u<e.length;u++){var l=n.length;if(l){var c=n[l-1].end;e[u].start-c<r?e[u].end>c&&(n[l-1].end=e[u].end):n.push(e[u])}else n.push(e[u])}if(n.length&&t<n[0].start)return{len:0,start:t,end:t,nextStart:n[0].start};for(u=0,i=0,o=s=t;u<n.length;u++){var f=n[u].start,d=n[u].end;if(t+r>=f&&d>t)o=f,s=d,i=s-t;else if(f>t+r){a=f;break}}return{len:i,start:o,end:s,nextStart:a}}},{key:"bufferInfo",value:function(e,t,r){if(e){var n=e.buffered,i=[],o=void 0;for(o=0;o<n.length;o++)i.push({start:n.start(o),end:n.end(o)});return this.bufferedInfo(i,t,r)}return{len:0,start:0,end:0,nextStart:void 0}}},{key:"checkFragProgress",value:function(){var e=this.hls,t=e.media,r=this.fragCurrent;if(t&&!t.paused&&t.readyState&&r.autoLevel&&r.level){var n=window.performance.now()-r.trequest;if(!(n<=500*r.duration)){var i=Math.max(1,1e3*r.loaded/n);r.expectedLen<r.loaded&&(r.expectedLen=r.loaded);var o=t.currentTime,s=(r.expectedLen-r.loaded)/i,a=this.bufferInfo(t,o,e.config.maxBufferHole).end-o;if(4*a<r.duration&&s>a){var u=void 0,l=void 0;for(l=r.level-1;l>=0&&(u=r.duration*e.levels[l].bitrate/(5.6*i),!(a>u));l--);s>u&&(l=Math.max(0,l),e.nextLoadLevel=l,r.loader.abort(),this.clearTimer(),e.trigger(window.Hls.Events.FRAG_LOAD_EMERGENCY_ABORTED,{frag:r}))}}}}},{key:"emergencyDrop",value:function(){this.hls.nextLoadLevel=Math.max(0,this.fragCurrent.level-1),this.hls.nextLoadLevel>=this.fragCurrent.level||(this.clearTimer(),this.hls.trigger(window.Hls.Events.FRAG_LOAD_EMERGENCY_ABORTED,{frag:this.fragCurrent}))}},{key:"onFragLoaded",value:function(e,t){this.lastfetchduration=(window.performance.now()-t.stats.trequest)/1e3;var r=8*t.stats.loaded/this.lastfetchduration;r&&this.addBw(r),this.clearTimer(),this.lastLoadedFragLevel=t.frag.level,this._nextAutoLevel=-1}},{key:"onError",value:function(){this.clearTimer()}},{key:"clearTimer",value:function(){this.timer&&(clearInterval(this.timer),this.timer=null)}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(e){this._autoLevelCapping=e}},{key:"nextAutoLevel",get:function(){var e=this.lastBw,t=this.hls,r=void 0,n=void 0,i=void 0;if(-1!==this._autoLevelCapping||!t.levels)return this._autoLevelCapping;if(i=t.levels.length-1,-1!==this._nextAutoLevel)return Math.min(this._nextAutoLevel,i);for(n=0;i>=n;n++)if(r=.7*e,r<t.levels[n].bitrate)return Math.max(0,n-1);return n-1},set:function(e){this._nextAutoLevel=e}}]),e}();r["default"]=s},{}],40:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=function L(e,t,r){null===e&&(e=Function.prototype);var n=Object.getOwnPropertyDescriptor(e,t);if(void 0===n){var i=Object.getPrototypeOf(e);return null===i?void 0:L(i,t,r)}if("value"in n)return n.value;var o=n.get;return void 0===o?void 0:o.call(r)},c=e("@livelyvideo/player-core/lib/base-driver"),f=n(c),d=e("@livelyvideo/player-core/lib/detect"),h=n(d),p=e("@livelyvideo/player-core/lib/logger"),v=n(p),y=e("@livelyvideo/player-core/lib/events"),m=n(y),g=e("@livelyvideo/player-core/lib/errors"),b=n(g),w=e("lodash.noop"),E=n(w),_=e("./abr-controller"),k=n(_),O=50,P=window.Hls,T=function(){var e=document.getElementsByTagName("script"),t=e[e.length-1].src.split("?")[0];return t.split("/").slice(0,-1).join("/")+"/hls.min.js"}(),R=function(e){function t(e,r,n){i(this,t);var s=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r,n));return s.el=document.createElement("video"),s.el.setAttribute("class","aiw-video"),s.options.posterURI&&s.el.setAttribute("poster",s.options.posterURI),s.livelyPlayer.el.appendChild(s.el),s.el.volume=s.options.volume,s.el.muted=s.options.muted,s.options.hlsjsPath=s.options.hlsjsPath||T,s.lastFrag=null,s.loadingHls=!1,s.recoverDecodingErrorDate=null,s.recoverSwapAudioCodecDate=null,s.loadHls(),s}return s(t,e),u(t,[{key:"loadHls",value:function(e){var t=this,r=e||E["default"];if(P)return void r();if(this.loadingHls)return void setTimeout(function(){t.loadHls(r)},O);this.loadingHls=!0;var n=document.createElement("script");n.setAttribute("src",this.options.hlsjsPath),n.onload=function(){P=window.Hls,t.loadingHls=!1,r()},document.body.appendChild(n)}},{key:"whenReady",value:function(e){var r=this;this.loadHls(function(){l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"whenReady",r).call(r,e)})}},{key:"playNow",value:function(e){var t=this,r=this.manifest,n=e||E["default"];if(!r&&this.mediaLoader.currentState===m["default"].ONLINE)return void this.emit(m["default"].ERROR,b["default"].DRIVER_NOT_SUPPORTED);if(this.hls){if(this.mediaLoader.vod&&r===this.hls.url||this.hls.url===r)return this.elementPlay(),void n(!0);this.destroyHls()}this.el.setAttribute("src",r),this.hls=new P({abrController:k["default"],seekHoleNudgeDuration:.5,debug:this.options.debug,maxBufferLength:this.options.maxBufferLength,maxBufferSize:this.options.maxBufferSize,fragLoadingTimeOut:3900,fragLoadingMaxRetry:2,liveSyncDuration:4}),this.listen(),v["default"].setPlayer(this.mediaLoader.host,this.mediaLoader.publicId,this.format,r),this.hls.loadSource(r),this.hls.attachMedia(this.el),this.elementPlay(),this.hls.on(P.Events.MEDIA_ATTACHED,function(){t.isAttached=!0}),this.hls.on(P.Events.MEDIA_DETACHED,function(){t.isAttached=!1}),this.hls.on(P.Events.MANIFEST_PARSED,function(){t.lastProgress=Date.now()}),null===this.options.bitrate?this.bitrateCap=null:isNaN(this.options.bitrate)||(this.bitrateCap=this.options.bitrate),n(!0)}},{key:"play",value:function(e){var t=this;if(!this.hls||this.el.paused)return this.el.onprogress=null,this.ready?void this.playNow(e):void this.whenReady(function(){t.playNow(e)})}},{key:"switchBitrate",value:function(e){var t=this;if(this.bitrateCap=e,h["default"].firefox()||this.mediaLoader.vod){var r=function(){var e=t.el.currentTime;return t.stop(),t.livelyPlayer.isTryingToPlay()?void t.play(function(){t.mediaLoader.vod&&(t.el.currentTime=e)}):(t.mediaLoader.vod&&(t.el.currentTime=e),{v:void 0})}();if("object"===("undefined"==typeof r?"undefined":a(r)))return r.v}}},{key:"stop",value:function(){this.hls&&this.hls.destroy()}},{key:"pause",value:function(){this.el.pause()}},{key:"destroy",value:function(){this.el.remove(),this.hls&&this.destroyHls()}},{key:"destroyHls",value:function(){this.hls.detachMedia&&this.hls.detachMedia(),this.hls.destroy&&this.hls.destroy(),this.hls=null}},{key:"listen",value:function(){var e=this;this.hls.on(P.Events.ERROR,function(t,r){switch(r.details){case P.ErrorDetails.BUFFER_SEEK_OVER_HOLE:return void e.handleError(m["default"].ERROR,b["default"].PLAYBACK_ERROR,r);case P.ErrorDetails.BUFFER_APPEND_ERROR:case P.ErrorDetails.BUFFER_FULL_ERROR:e.bufferOverflowCount++;break;case P.ErrorDetails.FRAG_LOAD_ERROR:case P.ErrorDetails.FRAG_LOOP_LOADING_ERROR:case P.ErrorDetails.FRAG_LOAD_TIMEOUT:case P.ErrorDetails.FRAG_DECRYPT_ERROR:case P.ErrorDetails.FRAG_PARSING_ERROR:case P.ErrorDetails.BUFFER_APPENDING_ERROR:case P.ErrorDetails.BUFFER_STALLED_ERROR:e.bufferUnderflowCount++}switch(r.type){case P.ErrorTypes.NETWORK_ERROR:r.details!==P.ErrorDetails.FRAG_LOAD_TIMEOUT?e.currentErrorCount++:r.details===P.ErrorDetails.LEVEL_LOAD_TIMEOUT&&(e.currentErrorCount=e.options.recoverErrorCount),e.handleError(m["default"].ERROR,b["default"].NETWORK_ERROR,r);break;case P.ErrorTypes.MEDIA_ERROR:if(r.fatal)return void e.handleMediaError();if(r.details===P.ErrorDetails.BUFFER_STALLED_ERROR)return void e.handleError(m["default"].ERROR,b["default"].PLAYBACK_ERROR,r);r.details===P.ErrorDetails.FRAG_LOOP_LOADING_ERROR&&e.currentErrorCount++,e.handleError(m["default"].ERROR,b["default"].PLAYBACK_ERROR,r);break;case P.ErrorTypes.OTHER_ERROR:e.currentErrorCount++,e.handleError(m["default"].ERROR,b["default"].UNKNOWN_ERROR,r);break;default:return void v["default"].error("unhandled hlsjs error",t,r)}e.checkRestart(r),v["default"].error(t,r)}),this.el.addEventListener("progress",function(){e.emitProgress()}),this.el.addEventListener("timeupdate",function(){e.emitTimeupdate()}),this.el.addEventListener("error",function(t){var r=t.currentTarget.error;if(r)switch(r.code){case r.MEDIA_ERR_DECODE:e.handleMediaError();break;case r.MEDIA_ERR_SRC_NOT_SUPPORTED:e.emit(m["default"].ERROR,b["default"].DRIVER_NOT_SUPPORTED)}}),this.hls.on(P.Events.LEVEL_SWITCH,function(t,r){e.bitrateSwitch(r.level)}),this.hls.on(P.Events.FRAG_LOADED,function(t,r){e.loadedFrag(r.frag)})}},{key:"handleMediaError",value:function(){var e=window.performance.now();!this.recoverDecodingErrorDate||e-this.recoverDecodingErrorDate>3e3?(this.recoverDecodingErrorDate=e,this.hls.recoverMediaError()):(!this.recoverSwapAudioCodecDate||e-this.recoverSwapAudioCodecDate>3e3)&&(this.recoverSwapAudioCodecDate=e,this.hls.swapAudioCodec(),this.hls.recoverMediaError())}},{key:"bitrateSwitch",value:function(e){e>this.currentLevel?this.upshift++:this.downshift++,this.emit(m["default"].BITRATE_SWITCH)}},{key:"loadedFrag",value:function(e){var t=e;this.fragCounts++,t.request=this.lastFrag?t.trequest-this.lastFrag.trequest:t.trequest,this.lastFrag=t,this.fragSize+=t.loaded,this.fragDuration+=t.duration,this.fragDownloadTime+=t.request,this.fragMaxTime=Math.max(this.fragMaxTime,t.request),this.fragMinTime=Math.min(this.fragMinTime||t.request,t.request)}},{key:"ready",get:function(){return P&&this.manifest}},{key:"manifest",get:function(){var e=void 0;if(e=this.data.manifest,!e)return null;var t=-1===e.indexOf("?")?"?":"&";return null===this.options.preset||(this.options.preset?e+=t+"preset="+this.options.preset:h["default"].any()||(e+=t+"preset=desktop")),e}},{key:"bitrateCap",set:function(e){if(this.options.bitrate=e,!e)return this.hls.abrController.autoLevelCapping=-1,void this.emit(m["default"].MEDIA_PLAY);var t=this.data.encodings;if(t&&t.length&&this.hls){var r=void 0;for(r=0;r<t.length&&!(t[r].videoKbps+t[r].audioKbps>e);r++);this.hls.abrController.autoLevelCapping=Math.max(r-1,0),this.emit(m["default"].MEDIA_PLAY)}}},{key:"currentLevel",get:function(){return this.hls&&this.hls.abrController.fragCurrent?this.hls.abrController.fragCurrent.level:void 0}},{key:"nextLevel",get:function(){return this.hls?this.hls.abrController.nextAutoLevel:null}}],[{key:"isSupported",value:function(){return h["default"].winChrome51()?!1:!h["default"].safari()||h["default"].android()||h["default"].chrome()||h["default"].ie()?window.MediaSource&&window.MediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'):!1}},{key:"driver",get:function(){return"hlsjs"}},{key:"format",get:function(){return"mp4-hls"}}]),t}(f["default"]);r["default"]=R},{"./abr-controller":39,"@livelyvideo/player-core/lib/base-driver":14,"@livelyvideo/player-core/lib/detect":15,"@livelyvideo/player-core/lib/errors":16,"@livelyvideo/player-core/lib/events":17,"@livelyvideo/player-core/lib/logger":20,"lodash.noop":48}],41:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r["default"]=function(e,t){var r=new window.FileReader;r.onload=function(){t(r.result)},r.readAsArrayBuffer(e)}},{}],42:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){
if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=function P(e,t,r){null===e&&(e=Function.prototype);var n=Object.getOwnPropertyDescriptor(e,t);if(void 0===n){var i=Object.getPrototypeOf(e);return null===i?void 0:P(i,t,r)}if("value"in n)return n.value;var o=n.get;return void 0===o?void 0:o.call(r)},l=e("@livelyvideo/player-core/lib/base-driver"),c=n(l),f=e("@livelyvideo/player-core/lib/detect"),d=n(f),h=e("@livelyvideo/player-core/lib/logger"),p=n(h),v=e("@livelyvideo/player-core/lib/events"),y=n(v),m=e("@livelyvideo/player-core/lib/errors"),g=n(m),b=e("lodash.noop"),w=n(b),E=e("./blob-to-array-buffer"),_=n(E),k=["moof","mfhd"],O=function(e){function t(e,r,n){i(this,t);var s=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r,n));return window.hackManifest=function(e){s.hackedManifest=e},s.options.bitrate||(s.options.bitrate=s.options.estimatedKbps),s.options.mse||(s.options.mse={}),(!s.options.mse.backFill||isNaN(s.options.mse.backFill)||s.options.mse.backFill<0||s.options.mse.backFill>1e4)&&(s.options.mse.backFill=0),(!s.options.mse.maxGap||isNaN(s.options.mse.maxGap)||s.options.mse.maxGap<0||s.options.mse.maxGap>1e4)&&(s.options.mse.maxGap=500),(!s.options.mse.retry||isNaN(s.options.mse.retry)||s.options.mse.retry<0||s.options.mse.retry>30)&&(s.options.mse.retry=20),(!s.options.mse.requiredBuffer||isNaN(s.options.mse.requiredBuffer)||s.options.mse.requiredBuffer<0||s.options.mse.requiredBuffer>10)&&(s.options.mse.requiredBuffer=1),s.options.mse.requiredBufferBeforeRemove=s.options.mse.requiredBuffer,s.options.mse.skipWatchInterval=Math.floor(400*s.options.mse.requiredBuffer),s.options.mse.skipForwardThreshold=Math.floor(6*s.options.mse.requiredBuffer),s.offlineInterval=null,s.volumeValue=s.options.volume,s.mutedValue=s.options.muted,s.render(),s.gcInterval=null,s.queue=[],s.buffering=!1,s.currentSegmentNumber=null,s}return s(t,e),a(t,[{key:"render",value:function(){var e=this;this.el=document.createElement("video"),this.el.setAttribute("class","aiw-video"),this.options.posterURI&&this.el.setAttribute("poster",this.options.posterURI),this.livelyPlayer.el.appendChild(this.el),this.el.addEventListener("stall",function(){p["default"].warn("playback stalled"),e.emit("stall")}),this.el.addEventListener("progress",function(){e.emitProgress()}),this.el.addEventListener("pause",function(){e.mediaLoader.currentState===y["default"].OFFLINE&&e.stop()}),this.el.volume=this.volumeValue,this.el.muted=this.mutedValue}},{key:"rerender",value:function(){this.volumeValue=this.el.volume,this.mutedValue=this.el.muted,this.el.remove(),this.render()}},{key:"getData",value:function(e){return this.mediaLoader.get(e||this.format)}},{key:"pickEncoding",value:function(){var e=this.options.bitrate||this.options.estimatedKbps,t=this.data.encodings;if(!t.length)return null;var r=void 0;for(r=0;r<t.length&&!(t[r].videoWidth&&t[r].videoKbps+t[r].audioKbps>e);r++);return r=Math.max(r-1,0),t[r]}},{key:"manifest",value:function(e){if(this.hackedManifest)return this.hackedManifest;var t=this.pickEncoding();return t?(e?t.location+="?seq="+e:null!==e&&this.currentSegmentNumber&&(t.location+="?seq="+(this.currentSegmentNumber+1)),t.location):null}},{key:"destroy",value:function(){this.shutdown(),this.el&&this.el.remove()}},{key:"appendBuffer",value:function(){if(!this.buffering){var e=this.queue.shift();e&&(this.buffering=!0,"remove"===e.type?this.sourceBuffer.buffered.length&&this.sourceBuffer.buffered.end(0)-this.el.currentTime>this.options.mse.requiredBufferBeforeRemove?(p["default"].debug("remove buffer",e.start+"-"+e.end,"buffered until "+this.sourceBuffer.buffered.end(0)),this.sourceBuffer&&this.sourceBuffer.remove(e.start,e.end)):this.buffering=!1:this.sourceBuffer?this.sourceBuffer.appendBuffer(e.arrayBuffer):this.restart())}}},{key:"restart",value:function(){var e=this;this.lockRestart||(this.lockRestart=!0,this.currentErrorCount=0,this.recentErrorCount=0,this.stop(function(){e.whenReady(function(){e.connect(null,null),e.lockRestart=!1})}))}},{key:"whenReady",value:function(e){var r=this;return this.ms?void u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"whenReady",this).call(this,e):(this.ms=new window.MediaSource,u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"whenReady",this).call(this,function(){r.ms.addEventListener("sourceopen",function(){r.sourceBuffer=r.ms.addSourceBuffer('video/mp4; codecs="avc1.4d4028, mp4a.40.2"');var t=r.el.currentTime;r.sourceBuffer.addEventListener("update",function(){r.emit("bufferAppended");var e=r.el.currentTime-t;e!==t?p["default"].debug("source buffer updated","current time",r.el.currentTime,"fragment duration",e):p["default"].debug("source buffer updated","current time",r.el.currentTime),r.buffering=!1,r.appendBuffer()}),r.sourceBuffer.addEventListener("error",function(e){p["default"].error("sourcebuffer error",e),r.restart()}),e&&e()})}),void(this.el.src=window.URL.createObjectURL(this.ms)))}},{key:"pause",value:function(){this.stop()}},{key:"shutdown",value:function(e){var t=e||w["default"];this.resetCounts(),clearInterval(this.progressInterval),clearInterval(this.gcInterval),this.el.pause(),delete this.ms,delete this.sourceBuffer,this.currentSegmentNumber=null,this.ws&&(this.ws.onclose=null,this.ws.close(),this.ws=null,t())}},{key:"stop",value:function(e){this.shutdown(e),this.rerender()}},{key:"getSegmentNumber",value:function(e){var t=new DataView(e),r=0,n=0,i=0,o=e.byteLength;for(n=0;o>n&&i<k.length;)r=t.getUint32(n),String.fromCharCode(t.getUint8(n+4))===k[i].charAt(0)&&String.fromCharCode(t.getUint8(n+5))===k[i].charAt(1)&&String.fromCharCode(t.getUint8(n+6))===k[i].charAt(2)&&String.fromCharCode(t.getUint8(n+7))===k[i].charAt(3)?(o=n+r,i++,n+=8):n+=r;return i===k.length?t.getUint32(n+4):null}},{key:"connect",value:function(e,t){var r=this;if(!this.ws){var n=e||w["default"],i=function o(){var e=r.manifest(t);p["default"].debug("set up websocket connection",e),r.ws=new window.WebSocket(e),r.ws.onerror=function(){setTimeout(function(){1===r.ws.readyState?r.emit(y["default"].ERROR,g["default"].WS_NETWORK_ERROR,{fatal:!1}):r.emit(y["default"].ERROR,g["default"].WS_CONNECTION,{fatal:!0})},r.options.mse.requiredBuffer)},r.ws.onclose=function(){o()},r.progressInterval=setInterval(function(){if(!r.el.paused&&r.sourceBuffer&&r.sourceBuffer.buffered.length&&r.el.currentTime){var e=r.sourceBuffer.buffered.end(r.sourceBuffer.buffered.length-1);e-r.el.currentTime>r.options.mse.skipForwardThreshold&&(p["default"].error("skipping forward - current time",r.el.currentTime,"end of buffer",e),r.el.currentTime=e-r.options.mse.requiredBuffer,r.el.play())}},r.options.mse.skipWatchInterval);var i=!1;r.ws.destroy=function(){i=!0,r.queue=[],r.buffering=!1};var s=window.performance.now();r.ws.onmessage=function(e){if(!i){var t=window.performance.now()-s;t>500?p["default"].warn("long segment wait",t,e.data.size):p["default"].debug("segment wait",t,e.data.size),r.fragCounts++,r.fragSize+=e.data.size,r.fragDownloadTime+=t,r.fragMaxTime=Math.max(r.fragMaxTime,t),r.fragMinTime=Math.min(r.fragMinTime||t,t),s=window.performance.now(),_["default"](e.data,function(e){if(!i){var t=r.currentSegmentNumber=r.getSegmentNumber(e);r.queue.push({type:"append",arrayBuffer:e,segment:t}),r.appendBuffer(),n&&(n(),n=w["default"])}})}},clearInterval(r.gcInterval),r.gcInterval=setInterval(function(){r.queue.push({type:"remove",start:0,end:r.el.currentTime-30})},3e4),r.once("bufferAppended",function(){var e=function t(){setTimeout(function(){!r.sourceBuffer.buffered.length||r.sourceBuffer.buffered.end(0)-r.sourceBuffer.buffered.start(0)<r.options.mse.requiredBuffer?setTimeout(t.bind(r),20):(r.el.currentTime=r.sourceBuffer.buffered.start(0),r.el.play()),n()},50)};e()})};i()}}},{key:"play",value:function(e){var t=this,r=e||w["default"];d["default"].any()&&this.el.play(),this.whenReady(function(){t.connect(),r(!0)})}},{key:"bitrate",set:function(e){this.options.bitrate=e,this.restart()}}],[{key:"isSupported",value:function(){return window.WebSocket&&window.MediaSource&&window.MediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"')}},{key:"driver",get:function(){return"mediaSourceMp4"}},{key:"format",get:function(){return"mp4-ws"}}]),t}(c["default"]);r["default"]=O},{"./blob-to-array-buffer":41,"@livelyvideo/player-core/lib/base-driver":14,"@livelyvideo/player-core/lib/detect":15,"@livelyvideo/player-core/lib/errors":16,"@livelyvideo/player-core/lib/events":17,"@livelyvideo/player-core/lib/logger":20,"lodash.noop":48}],43:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=function _(e,t,r){null===e&&(e=Function.prototype);var n=Object.getOwnPropertyDescriptor(e,t);if(void 0===n){var i=Object.getPrototypeOf(e);return null===i?void 0:_(i,t,r)}if("value"in n)return n.value;var o=n.get;return void 0===o?void 0:o.call(r)},l=e("@livelyvideo/player-core/lib/base-driver"),c=n(l),f=e("@livelyvideo/player-core/lib/detect"),d=n(f),h=e("@livelyvideo/player-core/lib/events"),p=n(h),v=e("@livelyvideo/player-core/lib/errors"),y=n(v),m=e("lodash.noop"),g=n(m),b={1:"MEDIA_ERR_ABORTED",2:"MEDIA_ERR_NETWORK",3:"MEDIA_ERR_DECODE",4:"MEDIA_ERR_SRC_NOT_SUPPORTED"},w=250,E=function(e){function t(e,r,n){i(this,t);var s=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r,n));return s.el=document.createElement("video"),s.el.setAttribute("class","aiw-video"),s.el.setAttribute("playsinline",!0),s.el.setAttribute("webkit-playsinline",!0),n.autoplay&&s.el.setAttribute("autoplay",!0),s.options.posterURI&&s.el.setAttribute("poster",s.options.posterURI),s.livelyPlayer.el.appendChild(s.el),s.el.volume=s.options.volume,s.el.muted=s.options.muted,s.el.addEventListener(p["default"].ERROR,function(){s.el.getAttribute("src")&&(s.handleError(p["default"].ERROR,y["default"].UNKNOWN_ERROR,{fatal:!0,details:b[s.el.error.code]}),setTimeout(function(){s.livelyPlayer.tryingToPlay&&s.play()},w))}),s.lastProgress=Date.now(),s}return s(t,e),a(t,[{key:"stop",value:function(){u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"stop",this).call(this),clearInterval(this.progressInterval)}},{key:"play",value:function(e){var r=this,n=e||g["default"];u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"play",this).call(this,function(e){e&&(r.el.onprogress=function(){r.emitProgress()},r.el.ontimeupdate=function(){r.fragCounts++,r.emitTimeupdate()}),n(e)})}}],[{key:"isSupported",value:function(){if(d["default"].iPhone9())return!1;var e=document.createElement("video"),t=e.canPlayType&&("maybe"===e.canPlayType("application/vnd.apple.mpegURL")||"probably"===e.canPlayType("application/vnd.apple.mpegURL"));return e.remove(),t}},{key:"driver",get:function(){return"hls"}},{key:"format",get:function(){return"mp4-hls"}}]),t}(c["default"]);r["default"]=E},{"@livelyvideo/player-core/lib/base-driver":14,"@livelyvideo/player-core/lib/detect":15,"@livelyvideo/player-core/lib/errors":16,"@livelyvideo/player-core/lib/events":17,"lodash.noop":48}],44:[function(e,t){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function n(e){return"function"==typeof e}function i(e){return"number"==typeof e}function o(e){return"object"==typeof e&&null!==e}function s(e){return void 0===e}t.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(e){if(!i(e)||0>e||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},r.prototype.emit=function(e){var t,r,i,a,u,l;if(this._events||(this._events={}),"error"===e&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;var c=new Error('Uncaught, unspecified "error" event. ('+t+")");throw c.context=t,c}if(r=this._events[e],s(r))return!1;if(n(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:a=Array.prototype.slice.call(arguments,1),r.apply(this,a)}else if(o(r))for(a=Array.prototype.slice.call(arguments,1),l=r.slice(),i=l.length,u=0;i>u;u++)l[u].apply(this,a);return!0},r.prototype.addListener=function(e,t){var i;if(!n(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,n(t.listener)?t.listener:t),this._events[e]?o(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,o(this._events[e])&&!this._events[e].warned&&(i=s(this._maxListeners)?r.defaultMaxListeners:this._maxListeners,i&&i>0&&this._events[e].length>i&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())),this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(e,t){function r(){this.removeListener(e,r),i||(i=!0,t.apply(this,arguments))}if(!n(t))throw TypeError("listener must be a function");var i=!1;return r.listener=t,this.on(e,r),this},r.prototype.removeListener=function(e,t){var r,i,s,a;if(!n(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(r=this._events[e],s=r.length,i=-1,r===t||n(r.listener)&&r.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(o(r)){for(a=s;a-->0;)if(r[a]===t||r[a].listener&&r[a].listener===t){i=a;break}if(0>i)return this;1===r.length?(r.length=0,delete this._events[e]):r.splice(i,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},r.prototype.removeAllListeners=function(e){var t,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(r=this._events[e],n(r))this.removeListener(e,r);else if(r)for(;r.length;)this.removeListener(e,r[r.length-1]);return delete this._events[e],this},r.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?n(this._events[e])?[this._events[e]]:this._events[e].slice():[]},r.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(n(t))return 1;if(t)return t.length}return 0},r.listenerCount=function(e,t){return e.listenerCount(t)}},{}],45:[function(e,t){function r(e,t,r){if(!s(t))throw new TypeError("iterator must be a function");arguments.length<3&&(r=this),"[object Array]"===a.call(e)?n(e,t,r):"string"==typeof e?i(e,t,r):o(e,t,r)}function n(e,t,r){for(var n=0,i=e.length;i>n;n++)u.call(e,n)&&t.call(r,e[n],n,e)}function i(e,t,r){for(var n=0,i=e.length;i>n;n++)t.call(r,e.charAt(n),n,e)}function o(e,t,r){for(var n in e)u.call(e,n)&&t.call(r,e[n],n,e)}var s=e("is-function");t.exports=r;var a=Object.prototype.toString,u=Object.prototype.hasOwnProperty},{"is-function":47}],46:[function(e,t){(function(e){t.exports="undefined"!=typeof window?window:"undefined"!=typeof e?e:"undefined"!=typeof self?self:{}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],47:[function(e,t){function r(e){var t=n.call(e);return"[object Function]"===t||"function"==typeof e&&"[object RegExp]"!==t||"undefined"!=typeof window&&(e===window.setTimeout||e===window.alert||e===window.confirm||e===window.prompt)}t.exports=r;var n=Object.prototype.toString},{}],48:[function(e,t){function r(){}t.exports=r},{}],49:[function(e,t){(function(e){function r(e,t,r){function n(t){var r=v,n=y;return v=y=void 0,O=t,g=e.apply(n,r)}function o(e){return O=e,b=setTimeout(c,t),P?n(e):g}function s(e){var r=e-w,n=e-O,i=t-r;return T?_(i,m-n):i}function l(e){var r=e-w,n=e-O;return void 0===w||r>=t||0>r||T&&n>=m}function c(){var e=k();return l(e)?f(e):void(b=setTimeout(c,s(e)))}function f(e){return b=void 0,R&&v?n(e):(v=y=void 0,g)}function d(){void 0!==b&&clearTimeout(b),O=0,v=w=y=b=void 0}function h(){return void 0===b?g:f(k())}function p(){var e=k(),r=l(e);if(v=arguments,y=this,w=e,r){if(void 0===b)return o(w);if(T)return b=setTimeout(c,t),n(w)}return void 0===b&&(b=setTimeout(c,t)),g}var v,y,m,g,b,w,O=0,P=!1,T=!1,R=!0;if("function"!=typeof e)throw new TypeError(u);return t=a(t)||0,i(r)&&(P=!!r.leading,T="maxWait"in r,m=T?E(a(r.maxWait)||0,t):m,R="trailing"in r?!!r.trailing:R),p.cancel=d,p.flush=h,p}function n(e,t,n){var o=!0,s=!0;if("function"!=typeof e)throw new TypeError(u);return i(n)&&(o="leading"in n?!!n.leading:o,s="trailing"in n?!!n.trailing:s),r(e,t,{leading:o,maxWait:t,trailing:s})}function i(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function o(e){return!!e&&"object"==typeof e}function s(e){return"symbol"==typeof e||o(e)&&w.call(e)==c}function a(e){if("number"==typeof e)return e;if(s(e))return l;if(i(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=i(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(f,"");var r=h.test(e);return r||p.test(e)?v(e.slice(2),r?2:8):d.test(e)?l:+e}var u="Expected a function",l=0/0,c="[object Symbol]",f=/^\s+|\s+$/g,d=/^[-+]0x[0-9a-f]+$/i,h=/^0b[01]+$/i,p=/^0o[0-7]+$/i,v=parseInt,y="object"==typeof e&&e&&e.Object===Object&&e,m="object"==typeof self&&self&&self.Object===Object&&self,g=y||m||Function("return this")(),b=Object.prototype,w=b.toString,E=Math.max,_=Math.min,k=function(){return g.Date.now()};t.exports=n}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],50:[function(e,t){var r=e("trim"),n=e("for-each"),i=function(e){return"[object Array]"===Object.prototype.toString.call(e)};t.exports=function(e){if(!e)return{};var t={};return n(r(e).split("\n"),function(e){var n=e.indexOf(":"),o=r(e.slice(0,n)).toLowerCase(),s=r(e.slice(n+1));"undefined"==typeof t[o]?t[o]=s:i(t[o])?t[o].push(s):t[o]=[t[o],s]}),t}},{"for-each":45,trim:53}],51:[function(t,r){!function(t,n){"undefined"!=typeof r?r.exports=n():"function"==typeof e&&"undefined"!=typeof e.amd?e(n):t.swfobject=n()}(this,function(){function e(){if(!W&&document.getElementsByTagName("body")[0]){try{var e,t=m("span");t.style.display="none",e=F.getElementsByTagName("body")[0].appendChild(t),e.parentNode.removeChild(e),e=null,t=null}catch(r){return}W=!0;for(var n=V.length,i=0;n>i;i++)V[i]()}}function t(e){W?e():V[V.length]=e}function r(e){if(typeof x.addEventListener!=D)x.addEventListener("load",e,!1);else if(typeof F.addEventListener!=D)F.addEventListener("load",e,!1);else if(typeof x.attachEvent!=D)b(x,"onload",e);else if("function"==typeof x.onload){var t=x.onload;x.onload=function(){t(),e()}}else x.onload=e}function n(){var e=F.getElementsByTagName("body")[0],t=m(I);t.setAttribute("style","visibility: hidden;"),t.setAttribute("type",j);var r=e.appendChild(t);if(r){var n=0;!function o(){if(typeof r.GetVariable!=D)try{var s=r.GetVariable("$version");s&&(s=s.split(" ")[1].split(","),Y.pv=[g(s[0]),g(s[1]),g(s[2])])}catch(a){Y.pv=[8,0,0]}else if(10>n)return n++,void setTimeout(o,10);e.removeChild(t),r=null,i()}()}else i()}function i(){var e=q.length;if(e>0)for(var t=0;e>t;t++){var r=q[t].id,n=q[t].callbackFn,i={success:!1,id:r};if(Y.pv[0]>0){var l=y(r);if(l)if(!w(q[t].swfVersion)||Y.wk&&Y.wk<312)if(q[t].expressInstall&&s()){var c={};c.data=q[t].expressInstall,c.width=l.getAttribute("width")||"0",c.height=l.getAttribute("height")||"0",l.getAttribute("class")&&(c.styleclass=l.getAttribute("class")),l.getAttribute("align")&&(c.align=l.getAttribute("align"));for(var f={},d=l.getElementsByTagName("param"),h=d.length,p=0;h>p;p++)"movie"!=d[p].getAttribute("name").toLowerCase()&&(f[d[p].getAttribute("name")]=d[p].getAttribute("value"));a(c,f,r,n)}else u(l),n&&n(i);else _(r,!0),n&&(i.success=!0,i.ref=o(r),i.id=r,n(i))}else if(_(r,!0),n){var v=o(r);v&&typeof v.SetVariable!=D&&(i.success=!0,i.ref=v,i.id=v.id),n(i)}}}function o(e){var t=null,r=y(e);return r&&"OBJECT"===r.nodeName.toUpperCase()&&(t=typeof r.SetVariable!==D?r:r.getElementsByTagName(I)[0]||r),t}function s(){return!G&&w("6.0.65")&&(Y.win||Y.mac)&&!(Y.wk&&Y.wk<312)}function a(e,t,r,n){var i=y(r);if(r=v(r),G=!0,T=n||null,R={success:!1,id:r},i){"OBJECT"==i.nodeName.toUpperCase()?(O=l(i),P=null):(O=i,P=r),e.id=C,(typeof e.width==D||!/%$/.test(e.width)&&g(e.width)<310)&&(e.width="310"),(typeof e.height==D||!/%$/.test(e.height)&&g(e.height)<137)&&(e.height="137"),F.title=F.title.slice(0,47)+" - Flash Player Installation";var o=Y.ie?"ActiveX":"PlugIn",s="MMredirectURL="+encodeURIComponent(x.location.toString().replace(/&/g,"%26"))+"&MMplayerType="+o+"&MMdoctitle="+F.title;if(typeof t.flashvars!=D?t.flashvars+="&"+s:t.flashvars=s,Y.ie&&4!=i.readyState){var a=m("div");r+="SWFObjectNew",a.setAttribute("id",r),i.parentNode.insertBefore(a,i),i.style.display="none",h(i)}f(e,t,r)}}function u(e){if(Y.ie&&4!=e.readyState){e.style.display="none";var t=m("div");e.parentNode.insertBefore(t,e),t.parentNode.replaceChild(l(e),t),h(e)}else e.parentNode.replaceChild(l(e),e)}function l(e){var t=m("div");if(Y.win&&Y.ie)t.innerHTML=e.innerHTML;else{var r=e.getElementsByTagName(I)[0];if(r){var n=r.childNodes;if(n)for(var i=n.length,o=0;i>o;o++)1==n[o].nodeType&&"PARAM"==n[o].nodeName||8==n[o].nodeType||t.appendChild(n[o].cloneNode(!0))}}return t}function c(e,t){var r=m("div");return r.innerHTML="<object classid='clsid:D27CDB6E-AE6D-11cf-96B8-444553540000'><param name='movie' value='"+e+"'>"+t+"</object>",r.firstChild}function f(e,t,r){var n,i=y(r);if(r=v(r),Y.wk&&Y.wk<312)return n;if(i){var o,s,a,u=m(Y.ie?"div":I);typeof e.id==D&&(e.id=r);for(a in t)t.hasOwnProperty(a)&&"movie"!==a.toLowerCase()&&d(u,a,t[a]);Y.ie&&(u=c(e.data,u.innerHTML));for(o in e)e.hasOwnProperty(o)&&(s=o.toLowerCase(),"styleclass"===s?u.setAttribute("class",e[o]):"classid"!==s&&"data"!==s&&u.setAttribute(o,e[o]));Y.ie?H[H.length]=e.id:(u.setAttribute("type",j),u.setAttribute("data",e.data)),i.parentNode.replaceChild(u,i),n=u}return n}function d(e,t,r){var n=m("param");n.setAttribute("name",t),n.setAttribute("value",r),e.appendChild(n)}function h(e){var t=y(e);t&&"OBJECT"==t.nodeName.toUpperCase()&&(Y.ie?(t.style.display="none",function r(){if(4==t.readyState){for(var e in t)"function"==typeof t[e]&&(t[e]=null);t.parentNode.removeChild(t)}else setTimeout(r,10)}()):t.parentNode.removeChild(t))}function p(e){return e&&e.nodeType&&1===e.nodeType}function v(e){return p(e)?e.id:e}function y(e){if(p(e))return e;var t=null;try{t=F.getElementById(e)}catch(r){}return t}function m(e){return F.createElement(e)}function g(e){return parseInt(e,10)}function b(e,t,r){e.attachEvent(t,r),K[K.length]=[e,t,r]}function w(e){e+="";var t=Y.pv,r=e.split(".");return r[0]=g(r[0]),r[1]=g(r[1])||0,r[2]=g(r[2])||0,t[0]>r[0]||t[0]==r[0]&&t[1]>r[1]||t[0]==r[0]&&t[1]==r[1]&&t[2]>=r[2]?!0:!1}function E(e,t,r,n){var i=F.getElementsByTagName("head")[0];if(i){var o="string"==typeof r?r:"screen";if(n&&(L=null,S=null),!L||S!=o){var s=m("style");s.setAttribute("type","text/css"),s.setAttribute("media",o),L=i.appendChild(s),Y.ie&&typeof F.styleSheets!=D&&F.styleSheets.length>0&&(L=F.styleSheets[F.styleSheets.length-1]),S=o}L&&(typeof L.addRule!=D?L.addRule(e,t):typeof F.createTextNode!=D&&L.appendChild(F.createTextNode(e+" {"+t+"}")))}}function _(e,t){if(X){var r=t?"visible":"hidden",n=y(e);W&&n?n.style.visibility=r:"string"==typeof e&&E("#"+e,"visibility:"+r)}}function k(e){var t=/[\\\"<>\.;]/,r=null!=t.exec(e);return r&&typeof encodeURIComponent!=D?encodeURIComponent(e):e}{var O,P,T,R,L,S,D="undefined",I="object",A="Shockwave Flash",M="ShockwaveFlash.ShockwaveFlash",j="application/x-shockwave-flash",C="SWFObjectExprInst",N="onreadystatechange",x=window,F=document,B=navigator,U=!1,V=[],q=[],H=[],K=[],W=!1,G=!1,X=!0,z=!1,Y=function(){var e=typeof F.getElementById!=D&&typeof F.getElementsByTagName!=D&&typeof F.createElement!=D,t=B.userAgent.toLowerCase(),r=B.platform.toLowerCase(),n=/win/.test(r?r:t),i=/mac/.test(r?r:t),o=/webkit/.test(t)?parseFloat(t.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):!1,s="Microsoft Internet Explorer"===B.appName,a=[0,0,0],u=null;if(typeof B.plugins!=D&&typeof B.plugins[A]==I)u=B.plugins[A].description,u&&typeof B.mimeTypes!=D&&B.mimeTypes[j]&&B.mimeTypes[j].enabledPlugin&&(U=!0,s=!1,u=u.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),a[0]=g(u.replace(/^(.*)\..*$/,"$1")),a[1]=g(u.replace(/^.*\.(.*)\s.*$/,"$1")),a[2]=/[a-zA-Z]/.test(u)?g(u.replace(/^.*[a-zA-Z]+(.*)$/,"$1")):0);else if(typeof x.ActiveXObject!=D)try{var l=new ActiveXObject(M);l&&(u=l.GetVariable("$version"),u&&(s=!0,u=u.split(" ")[1].split(","),a=[g(u[0]),g(u[1]),g(u[2])]))}catch(c){}return{w3:e,pv:a,wk:o,ie:s,win:n,mac:i}}();!function(){Y.w3&&((typeof F.readyState!=D&&("complete"===F.readyState||"interactive"===F.readyState)||typeof F.readyState==D&&(F.getElementsByTagName("body")[0]||F.body))&&e(),W||(typeof F.addEventListener!=D&&F.addEventListener("DOMContentLoaded",e,!1),Y.ie&&(F.attachEvent(N,function t(){"complete"==F.readyState&&(F.detachEvent(N,t),e())}),x==top&&!function r(){if(!W){try{F.documentElement.doScroll("left")}catch(t){return void setTimeout(r,0)}e()}}()),Y.wk&&!function n(){return W?void 0:/loaded|complete/.test(F.readyState)?void e():void setTimeout(n,0)}()))}()}V[0]=function(){U?n():i()};!function(){Y.ie&&window.attachEvent("onunload",function(){for(var e=K.length,t=0;e>t;t++)K[t][0].detachEvent(K[t][1],K[t][2]);for(var r=H.length,n=0;r>n;n++)h(H[n]);for(var i in Y)Y[i]=null;if(Y=null,"undefined"!=typeof swfobject){for(var o in swfobject)swfobject[o]=null;swfobject=null}})}();return{registerObject:function(e,t,r,n){if(Y.w3&&e&&t){var i={};i.id=e,i.swfVersion=t,i.expressInstall=r,i.callbackFn=n,q[q.length]=i,_(e,!1)}else n&&n({success:!1,id:e})},getObjectById:function(e){return Y.w3?o(e):void 0},embedSWF:function(e,r,n,i,o,u,l,c,d,h){var p=v(r),y={success:!1,id:p};Y.w3&&!(Y.wk&&Y.wk<312)&&e&&r&&n&&i&&o?(_(p,!1),t(function(){n+="",i+="";var t={};if(d&&typeof d===I)for(var v in d)t[v]=d[v];t.data=e,t.width=n,t.height=i;var m={};if(c&&typeof c===I)for(var g in c)m[g]=c[g];if(l&&typeof l===I)for(var b in l)if(l.hasOwnProperty(b)){var E=z?encodeURIComponent(b):b,k=z?encodeURIComponent(l[b]):l[b];typeof m.flashvars!=D?m.flashvars+="&"+E+"="+k:m.flashvars=E+"="+k}if(w(o)){var O=f(t,m,r);t.id==p&&_(p,!0),y.success=!0,y.ref=O,y.id=O.id}else{if(u&&s())return t.data=u,void a(t,m,r,h);_(p,!0)}h&&h(y)})):h&&h(y)},switchOffAutoHideShow:function(){X=!1},enableUriEncoding:function(e){z=typeof e===D?!0:e},ua:Y,getFlashPlayerVersion:function(){return{major:Y.pv[0],minor:Y.pv[1],release:Y.pv[2]}},hasFlashPlayerVersion:w,createSWF:function(e,t,r){return Y.w3?f(e,t,r):void 0},showExpressInstall:function(e,t,r,n){Y.w3&&s()&&a(e,t,r,n)},removeSWF:function(e){Y.w3&&h(e)},createCSS:function(e,t,r,n){Y.w3&&E(e,t,r,n)},addDomLoadEvent:t,addLoadEvent:r,getQueryParamValue:function(e){var t=F.location.search||F.location.hash;if(t){if(/\?/.test(t)&&(t=t.split("?")[1]),null==e)return k(t);for(var r=t.split("&"),n=0;n<r.length;n++)if(r[n].substring(0,r[n].indexOf("="))==e)return k(r[n].substring(r[n].indexOf("=")+1))}return""},expressInstallCallback:function(){if(G){var e=y(C);e&&O&&(e.parentNode.replaceChild(O,e),P&&(_(P,!0),Y.ie&&(O.style.display="block")),T&&T(R)),G=!1}},version:"2.3"}})},{}],52:[function(e,t){t.exports=function(e,t){var r=void 0!==e.textContent?"textContent":"innerText";return"undefined"!=typeof t&&(e[r]=t),e[r]}},{}],53:[function(e,t,r){function n(e){return e.replace(/^\s*|\s*$/g,"")}r=t.exports=n,r.left=function(e){return e.replace(/^\s*/,"")},r.right=function(e){return e.replace(/\s*$/,"")}},{}],54:[function(e,t){"use strict";function r(e,t){for(var r=0;r<e.length;r++)t(e[r])}function n(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}function i(e,t,r){var n=e;return c(t)?(r=t,"string"==typeof e&&(n={uri:e})):n=d(t,{uri:e}),n.callback=r,n}function o(e,t,r){return t=i(e,t,r),s(t)}function s(e){function t(){4===d.readyState&&s()}function r(){var e=void 0;if(e=d.response?d.response:d.responseText||a(d),E)try{e=JSON.parse(e)}catch(t){}return e}function i(e){return clearTimeout(v),e instanceof Error||(e=new Error(""+(e||"Unknown XMLHttpRequest Error"))),e.statusCode=0,l(e,c)}function s(){if(!p){var t;clearTimeout(v),t=e.useXDR&&void 0===d.status?200:1223===d.status?204:d.status;var n=c,i=null;return 0!==t?(n={body:r(),statusCode:t,method:m,headers:{},url:y,rawRequest:d},d.getAllResponseHeaders&&(n.headers=f(d.getAllResponseHeaders()))):i=new Error("Internal XMLHttpRequest Error"),l(i,n,n.body)}}if("undefined"==typeof e.callback)throw new Error("callback argument missing");var u=!1,l=function(t,r,n){u||(u=!0,e.callback(t,r,n))},c={body:void 0,headers:{},statusCode:0,method:m,url:y,rawRequest:d},d=e.xhr||null;d||(d=e.cors||e.useXDR?new o.XDomainRequest:new o.XMLHttpRequest);var h,p,v,y=d.url=e.uri||e.url,m=d.method=e.method||"GET",g=e.body||e.data||null,b=d.headers=e.headers||{},w=!!e.sync,E=!1;if("json"in e&&(E=!0,b.accept||b.Accept||(b.Accept="application/json"),"GET"!==m&&"HEAD"!==m&&(b["content-type"]||b["Content-Type"]||(b["Content-Type"]="application/json"),g=JSON.stringify(e.json))),d.onreadystatechange=t,d.onload=s,d.onerror=i,d.onprogress=function(){},d.ontimeout=i,d.open(m,y,!w,e.username,e.password),w||(d.withCredentials=!!e.withCredentials),!w&&e.timeout>0&&(v=setTimeout(function(){p=!0,d.abort("timeout");var e=new Error("XMLHttpRequest timeout");e.code="ETIMEDOUT",i(e)},e.timeout)),d.setRequestHeader)for(h in b)b.hasOwnProperty(h)&&d.setRequestHeader(h,b[h]);else if(e.headers&&!n(e.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in e&&(d.responseType=e.responseType),"beforeSend"in e&&"function"==typeof e.beforeSend&&e.beforeSend(d),d.send(g),d}function a(e){if("document"===e.responseType)return e.responseXML;var t=204===e.status&&e.responseXML&&"parsererror"===e.responseXML.documentElement.nodeName;return""!==e.responseType||t?null:e.responseXML}function u(){}var l=e("global/window"),c=e("is-function"),f=e("parse-headers"),d=e("xtend");t.exports=o,o.XMLHttpRequest=l.XMLHttpRequest||u,o.XDomainRequest="withCredentials"in new o.XMLHttpRequest?o.XMLHttpRequest:l.XDomainRequest,r(["get","put","post","patch","head","delete"],function(e){o["delete"===e?"del":e]=function(t,r,n){return r=i(t,r,n),r.method=e.toUpperCase(),s(r)}})},{"global/window":46,"is-function":47,"parse-headers":50,xtend:55}],55:[function(e,t){function r(){for(var e={},t=0;t<arguments.length;t++){var r=arguments[t];

for(var i in r)n.call(r,i)&&(e[i]=r[i])}return e}t.exports=r;var n=Object.prototype.hasOwnProperty},{}],56:[function(e,t){"use strict";t.exports="undefined"==typeof window?function(){}:e("./stock-live-player")["default"]},{"./stock-live-player":57}],57:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=e("events"),l=n(u),c=e("@livelyvideo/player-core/lib/player"),f=n(c),d=e("@livelyvideo/player-media-source-mp4-driver/lib/driver"),h=n(d),p=e("@livelyvideo/player-hlsjs-driver/lib/driver"),v=n(p),y=e("@livelyvideo/player-native-hls-driver/lib/driver"),m=n(y),g=e("@livelyvideo/player-flash-rtmp-driver/lib/driver"),b=n(g),w=e("@livelyvideo/player-controls/lib/index"),E=n(w),_=function(e){function t(e,r,n,s){i(this,t);var a=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));a.el=e,a.playerEl=document.createElement("div"),a.controlsEl=document.createElement("div"),a.el.appendChild(a.playerEl),a.el.appendChild(a.controlsEl);var u=[];if(n.drivers)for(var l=0;l<n.drivers.length;l++)switch(n.drivers[l]){case"hlsjs":u.push(v["default"]);break;case"hls":u.push(m["default"]);break;case"mediaSourceMp4":u.push(h["default"]);break;case"flashRtmp":u.push(b["default"])}else u=[h["default"],v["default"],m["default"],b["default"]];return n.drivers=u,a.player=new f["default"](a.playerEl,r,n),a.controls=new E["default"](a.controlsEl,s),a.controls.attach(a.player),a}return s(t,e),a(t,[{key:"destroy",value:function(){this.playerEl.remove(),this.controlsEl.remove(),this.controls.destroy(),this.player.destroy()}}]),t}(l["default"]);r["default"]=_},{"@livelyvideo/player-controls/lib/index":5,"@livelyvideo/player-core/lib/player":24,"@livelyvideo/player-flash-rtmp-driver/lib/driver":36,"@livelyvideo/player-hlsjs-driver/lib/driver":40,"@livelyvideo/player-media-source-mp4-driver/lib/driver":42,"@livelyvideo/player-native-hls-driver/lib/driver":43,events:44}]},{},[56])(56)});
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{}],4:[function(require,module,exports){
var isFunction = require('is-function')

module.exports = forEach

var toString = Object.prototype.toString
var hasOwnProperty = Object.prototype.hasOwnProperty

function forEach(list, iterator, context) {
    if (!isFunction(iterator)) {
        throw new TypeError('iterator must be a function')
    }

    if (arguments.length < 3) {
        context = this
    }
    
    if (toString.call(list) === '[object Array]')
        forEachArray(list, iterator, context)
    else if (typeof list === 'string')
        forEachString(list, iterator, context)
    else
        forEachObject(list, iterator, context)
}

function forEachArray(array, iterator, context) {
    for (var i = 0, len = array.length; i < len; i++) {
        if (hasOwnProperty.call(array, i)) {
            iterator.call(context, array[i], i, array)
        }
    }
}

function forEachString(string, iterator, context) {
    for (var i = 0, len = string.length; i < len; i++) {
        // no such thing as a sparse string.
        iterator.call(context, string.charAt(i), i, string)
    }
}

function forEachObject(object, iterator, context) {
    for (var k in object) {
        if (hasOwnProperty.call(object, k)) {
            iterator.call(context, object[k], k, object)
        }
    }
}

},{"is-function":6}],5:[function(require,module,exports){
(function (global){
if (typeof window !== "undefined") {
    module.exports = window;
} else if (typeof global !== "undefined") {
    module.exports = global;
} else if (typeof self !== "undefined"){
    module.exports = self;
} else {
    module.exports = {};
}

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{}],6:[function(require,module,exports){
module.exports = isFunction

var toString = Object.prototype.toString

function isFunction (fn) {
  var string = toString.call(fn)
  return string === '[object Function]' ||
    (typeof fn === 'function' && string !== '[object RegExp]') ||
    (typeof window !== 'undefined' &&
     // IE8 and below
     (fn === window.setTimeout ||
      fn === window.alert ||
      fn === window.confirm ||
      fn === window.prompt))
};

},{}],7:[function(require,module,exports){
var trim = require('trim')
  , forEach = require('for-each')
  , isArray = function(arg) {
      return Object.prototype.toString.call(arg) === '[object Array]';
    }

module.exports = function (headers) {
  if (!headers)
    return {}

  var result = {}

  forEach(
      trim(headers).split('\n')
    , function (row) {
        var index = row.indexOf(':')
          , key = trim(row.slice(0, index)).toLowerCase()
          , value = trim(row.slice(index + 1))

        if (typeof(result[key]) === 'undefined') {
          result[key] = value
        } else if (isArray(result[key])) {
          result[key].push(value)
        } else {
          result[key] = [ result[key], value ]
        }
      }
  )

  return result
}
},{"for-each":4,"trim":9}],8:[function(require,module,exports){
module.exports = function(node, value) {
  var text = (node.textContent !== undefined ?
    'textContent' : 'innerText'
  )

  if (typeof value != 'undefined') {
    node[text] = value
  }

  return node[text]
}

},{}],9:[function(require,module,exports){

exports = module.exports = trim;

function trim(str){
  return str.replace(/^\s*|\s*$/g, '');
}

exports.left = function(str){
  return str.replace(/^\s*/, '');
};

exports.right = function(str){
  return str.replace(/\s*$/, '');
};

},{}],10:[function(require,module,exports){
"use strict";
var window = require("global/window")
var isFunction = require("is-function")
var parseHeaders = require("parse-headers")
var xtend = require("xtend")

module.exports = createXHR
createXHR.XMLHttpRequest = window.XMLHttpRequest || noop
createXHR.XDomainRequest = "withCredentials" in (new createXHR.XMLHttpRequest()) ? createXHR.XMLHttpRequest : window.XDomainRequest

forEachArray(["get", "put", "post", "patch", "head", "delete"], function(method) {
    createXHR[method === "delete" ? "del" : method] = function(uri, options, callback) {
        options = initParams(uri, options, callback)
        options.method = method.toUpperCase()
        return _createXHR(options)
    }
})

function forEachArray(array, iterator) {
    for (var i = 0; i < array.length; i++) {
        iterator(array[i])
    }
}

function isEmpty(obj){
    for(var i in obj){
        if(obj.hasOwnProperty(i)) return false
    }
    return true
}

function initParams(uri, options, callback) {
    var params = uri

    if (isFunction(options)) {
        callback = options
        if (typeof uri === "string") {
            params = {uri:uri}
        }
    } else {
        params = xtend(options, {uri: uri})
    }

    params.callback = callback
    return params
}

function createXHR(uri, options, callback) {
    options = initParams(uri, options, callback)
    return _createXHR(options)
}

function _createXHR(options) {
    if(typeof options.callback === "undefined"){
        throw new Error("callback argument missing")
    }

    var called = false
    var callback = function cbOnce(err, response, body){
        if(!called){
            called = true
            options.callback(err, response, body)
        }
    }

    function readystatechange() {
        if (xhr.readyState === 4) {
            loadFunc()
        }
    }

    function getBody() {
        // Chrome with requestType=blob throws errors arround when even testing access to responseText
        var body = undefined

        if (xhr.response) {
            body = xhr.response
        } else {
            body = xhr.responseText || getXml(xhr)
        }

        if (isJson) {
            try {
                body = JSON.parse(body)
            } catch (e) {}
        }

        return body
    }

    var failureResponse = {
                body: undefined,
                headers: {},
                statusCode: 0,
                method: method,
                url: uri,
                rawRequest: xhr
            }

    function errorFunc(evt) {
        clearTimeout(timeoutTimer)
        if(!(evt instanceof Error)){
            evt = new Error("" + (evt || "Unknown XMLHttpRequest Error") )
        }
        evt.statusCode = 0
        return callback(evt, failureResponse)
    }

    // will load the data & process the response in a special response object
    function loadFunc() {
        if (aborted) return
        var status
        clearTimeout(timeoutTimer)
        if(options.useXDR && xhr.status===undefined) {
            //IE8 CORS GET successful response doesn't have a status field, but body is fine
            status = 200
        } else {
            status = (xhr.status === 1223 ? 204 : xhr.status)
        }
        var response = failureResponse
        var err = null

        if (status !== 0){
            response = {
                body: getBody(),
                statusCode: status,
                method: method,
                headers: {},
                url: uri,
                rawRequest: xhr
            }
            if(xhr.getAllResponseHeaders){ //remember xhr can in fact be XDR for CORS in IE
                response.headers = parseHeaders(xhr.getAllResponseHeaders())
            }
        } else {
            err = new Error("Internal XMLHttpRequest Error")
        }
        return callback(err, response, response.body)
    }

    var xhr = options.xhr || null

    if (!xhr) {
        if (options.cors || options.useXDR) {
            xhr = new createXHR.XDomainRequest()
        }else{
            xhr = new createXHR.XMLHttpRequest()
        }
    }

    var key
    var aborted
    var uri = xhr.url = options.uri || options.url
    var method = xhr.method = options.method || "GET"
    var body = options.body || options.data || null
    var headers = xhr.headers = options.headers || {}
    var sync = !!options.sync
    var isJson = false
    var timeoutTimer

    if ("json" in options) {
        isJson = true
        headers["accept"] || headers["Accept"] || (headers["Accept"] = "application/json") //Don't override existing accept header declared by user
        if (method !== "GET" && method !== "HEAD") {
            headers["content-type"] || headers["Content-Type"] || (headers["Content-Type"] = "application/json") //Don't override existing accept header declared by user
            body = JSON.stringify(options.json)
        }
    }

    xhr.onreadystatechange = readystatechange
    xhr.onload = loadFunc
    xhr.onerror = errorFunc
    // IE9 must have onprogress be set to a unique function.
    xhr.onprogress = function () {
        // IE must die
    }
    xhr.ontimeout = errorFunc
    xhr.open(method, uri, !sync, options.username, options.password)
    //has to be after open
    if(!sync) {
        xhr.withCredentials = !!options.withCredentials
    }
    // Cannot set timeout with sync request
    // not setting timeout on the xhr object, because of old webkits etc. not handling that correctly
    // both npm's request and jquery 1.x use this kind of timeout, so this is being consistent
    if (!sync && options.timeout > 0 ) {
        timeoutTimer = setTimeout(function(){
            aborted=true//IE9 may still call readystatechange
            xhr.abort("timeout")
            var e = new Error("XMLHttpRequest timeout")
            e.code = "ETIMEDOUT"
            errorFunc(e)
        }, options.timeout )
    }

    if (xhr.setRequestHeader) {
        for(key in headers){
            if(headers.hasOwnProperty(key)){
                xhr.setRequestHeader(key, headers[key])
            }
        }
    } else if (options.headers && !isEmpty(options.headers)) {
        throw new Error("Headers cannot be set on an XDomainRequest object")
    }

    if ("responseType" in options) {
        xhr.responseType = options.responseType
    }

    if ("beforeSend" in options &&
        typeof options.beforeSend === "function"
    ) {
        options.beforeSend(xhr)
    }

    xhr.send(body)

    return xhr


}

function getXml(xhr) {
    if (xhr.responseType === "document") {
        return xhr.responseXML
    }
    var firefoxBugTakenEffect = xhr.status === 204 && xhr.responseXML && xhr.responseXML.documentElement.nodeName === "parsererror"
    if (xhr.responseType === "" && !firefoxBugTakenEffect) {
        return xhr.responseXML
    }

    return null
}

function noop() {}

},{"global/window":5,"is-function":6,"parse-headers":7,"xtend":11}],11:[function(require,module,exports){
module.exports = extend

var hasOwnProperty = Object.prototype.hasOwnProperty;

function extend() {
    var target = {}

    for (var i = 0; i < arguments.length; i++) {
        var source = arguments[i]

        for (var key in source) {
            if (hasOwnProperty.call(source, key)) {
                target[key] = source[key]
            }
        }
    }

    return target
}

},{}]},{},[1]);
