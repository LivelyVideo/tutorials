(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
'use strict';

var _chat = require('@livelyvideo/chat');

var _chat2 = _interopRequireDefault(_chat);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

/**
Set up the chat instance

Params:
	- html element
	- options
			user: users username, should be unique to the user
			room: room name
			apiHost: lively chat api
			websocketHost: lively ws api
			url: the company's auth url, which should access livelyvideo to create an access token for the user
**/
var chat = void 0;
var ROOM = 'demo';
//const ROOM = 'sea1a~1~931c1d57-785d-4629-adb2-f290b74b16eb_585_426x240_56';

function createChat(user, el) {
	if (chat) {
		chat.destroy();
	}
	chat = new _chat2.default(el, {
		room: ROOM,
		host: 'dev.livelyvideo.tv',
		authUrl: '/access-token?username=' + user
	});
}

document.querySelector('#pickuser').onsubmit = function (e) {
	e.preventDefault();
	createChat(e.target.querySelector('[name=username]').value, document.querySelector('.chat'));
	e.target.setAttribute('disabled', true);
	e.target.querySelector('[name=username]').value = '';
};

},{"@livelyvideo/chat":2}],2:[function(require,module,exports){
(function (global){
!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).LivelyChat=e()}}(function(){return function e(t,r,n){function o(s,a){if(!r[s]){if(!t[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(i)return i(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var l=r[s]={exports:{}};t[s][0].call(l.exports,function(e){var r=t[s][1][e];return o(r||e)},l,l.exports,e,t,r,n)}return r[s].exports}for(var i="function"==typeof require&&require,s=0;s<n.length;s++)o(n[s]);return o}({1:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=u(e("@livelyvideo/logger-core/lib/source")),i=u(e("events")),s=u(e("deepmerge")),a=u(e("./package-json"));function u(e){return e&&e.__esModule?e:{default:e}}function c(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var l=new o.default(a.default),h={timeout:5e3,headers:{},bootstrap:{},loggerOptions:{}},f={Accept:"application/json"},d=function(e){function t(e,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var o=c(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));if(o.options=(0,s.default)(h,n),l.setOptions(o.options.loggerOptions),l.attachEmitter(o),o.options.host&&l.setInstanceOptions({host:o.options.host}),!e)return setTimeout(function(){return o.emit("error","scope is required")}),c(o);if(!r)return setTimeout(function(){return o.emit("error","authorization server url is required")}),c(o);if(-1===r.indexOf("?")?o._url=r+"?scope="+e:o._url=r+"&scope="+e,o._stopped=!1,o._fatalError=null,o._token=o.options.bootstrap.token||null,o._retries=[0,200,1e3,3e3],o._retry=0,o._autorefresh=null,o._headers=Object.assign({},f,n.headers),null===o._token)o._retryRequest();else if(o.options.bootstrap&&o.options.bootstrap.expire){var i=o.options.bootstrap.expire-Date.now()-6e4;o._autorefresh=setTimeout(function(){o._autorefresh=null,o._stopped||o._retryRequest()},i)}return o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),n(t,[{key:"destroy",value:function(){this._stopped=!0}},{key:"request",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};if(this._fatalError)t(this._fatalError);else if(null===this._token){var r=!1,n=function(){r||(r=!0,t(null,e._token))},o=setTimeout(function(){e.removeListener("ready",n),r||(r=!0,t(new Error("authorization: timeout")))},this.options.timeout);this.once("ready",function(){clearTimeout(o),n()})}else t(null,this._token)}},{key:"refreshToken",value:function(){var e=this;null!==this._token&&(null!==this._autorefresh&&(clearTimeout(this._autorefresh),this._autorefresh=null),this._token=null,e._retryRequest())}},{key:"ensureToken",value:function(e){this._token?e():this.once("ready",function(){e()})}},{key:"_parseJSON",value:function(e){return e.text().then(function(e){if(e)try{return JSON.parse(e)}catch(e){throw e.fatal=!0,e}return{}})}},{key:"_retryRequest",value:function(){var e=this,t=this._retries[this._retry];t?setTimeout(function(){e._makeRequest()},t):this._makeRequest()}},{key:"_makeRequest",value:function(){var e=this;fetch(this._url,{credentials:"same-origin",headers:this._headers}).then(function(t){if(t.status>=200&&t.status<300)return e._parseJSON(t);if(401===t.status){var r=new Error("authorization: unauthorized");throw r.fatal=!0,r}if(403===t.status){var n=new Error("authorization: forbidden");throw n.fatal=!0,n}throw new Error("authorization: non-200 response code from auth server")}).then(function(t){e._token=t.token,e._retry=0,e.emit("ready",{token:t.token});var r=new Date(t.expire).getTime()-Date.now()-6e4;e._autorefresh=setTimeout(function(){e._autorefresh=null,e._stopped||e._retryRequest()},r)}).catch(function(t){if(e._token=null,t.fatal)return e._fatalError=t,void e.emit("error",t.message||"",t);e.emit("log","network",t.message||"",t),e._retryRequest(),e._retry<e._retries.length-1&&e._retry++})}}]),t}();r.default=d,t.exports=r.default},{"./package-json":2,"@livelyvideo/logger-core/lib/source":8,deepmerge:136,events:154}],2:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default={version:"1.3.1",name:"@livelyvideo/auth-core"},t.exports=r.default},{}],3:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n,o=e("./auth-core"),i=(n=o)&&n.__esModule?n:{default:n};r.default=i.default,t.exports=r.default},{"./auth-core":1}],4:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.supportedLevels={error:0,warn:1,deprecated:1,info:2,debug:3,timing:3,network:3}},{}],5:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=u(e("serialize-error")),s=e("./const"),a=u(e("./package-json"));function u(e){return e&&e.__esModule?e:{default:e}}var c={host:null,interval:3e4,limit:500,maxRequestSize:1048576,reportLevel:"error"},l=null,h=function(){function e(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),l||(l=this,this.options=c,this.storage=[],l)}return o(e,[{key:"setOptions",value:function(e){this.options=n({},c,e),this.options.host&&this._uri||(this._uri="https://"+this.options.host+"/client-logs")}},{key:"add",value:function(e){this.storage.push(e),s.supportedLevels[e.level]<=s.supportedLevels[this.options.reportLevel]?this.send():this.checkStorageLimit()}},{key:"send",value:function(){var e=this;if(this.storage.length&&this._uri){var t=this.storage;this.storage=[];var r={messages:t},n=void 0;try{n=JSON.stringify(r)}catch(e){return void this.storage.push({level:"error",package:a.default,source:"client",message:"Error stringifying batch. Dropped "+t.length+" logs.",error:(0,i.default)(e)})}this._byteLength(n)>this.options.maxRequestSize?this.storage.push({level:"error",package:a.default,source:"client",message:"Body exceeds maxRequestSize. Dropped "+t.length+" logs."}):fetch(this._uri,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:n}).then(this._handleFetchError).catch(function(r){e.storage.push({level:"network",package:a.default,source:"client",message:"Network failure. Dropped "+t.length+" logs.",error:(0,i.default)(r)})})}}},{key:"enable",value:function(){var e=this;this._uri&&(this._watchInterval=setInterval(function(){return e.send()},this.options.interval),"undefined"!=typeof window&&(this._watchUnload=this._eventHelper(window,"unload",function(){return e.send()})))}},{key:"disable",value:function(){this._watchInterval&&clearInterval(this._watchInterval),this._watchUnload&&this._watchUnload()}},{key:"checkStorageLimit",value:function(){this.options.limit&&this.storage.length>this.options.limit&&this.send()}},{key:"_handleFetchError",value:function(e){if(!e.ok)throw new TypeError(e.status,e.statusText);return e}},{key:"_byteLength",value:function(e){for(var t=e.length,r=e.length-1;r>=0;r--){var n=e.charCodeAt(r);n>127&&n<=2047?t++:n>2047&&n<=65535&&(t+=2),n>=56320&&n<=57343&&r--}return t}},{key:"_eventHelper",value:function(e,t,r){e.addEventListener(t,r);return function(){e.removeEventListener(t,r)}}}]),e}();r.default=h,t.exports=r.default},{"./const":4,"./package-json":7,"serialize-error":138}],6:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=l(e("events")),s=l(e("serialize-error")),a=l(e("./instance")),u=l(e("./package-json")),c=e("./const");function l(e){return e&&e.__esModule?e:{default:e}}function h(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}var f={level:"warn",silent:!0,disable:!1,events:!0,name:u.default.name,version:u.default.version},d=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=n({},f,t),this.instance=new a.default,this.enable()}return o(e,[{key:"setOptions",value:function(e,t,r){this.options=n({},this.options,e),t&&this.options.events&&this.attachEmitter(t,r)}},{key:"setInstanceOptions",value:function(e){this.instance.options.host&&e.host&&this.instance.options.host!==e.host?this.warn("Unable to set instance options. Host set to "+this.instance.options.host+" and cannot be set "+e.host+"."):(this.instance.setOptions(e),this.options.disable||this.enableInstance())}},{key:"enableInstance",value:function(){this.instance.enable()}},{key:"disableInstance",value:function(){this.instance.disable()}},{key:"instanceSend",value:function(){this.instance.send()}},{key:"setLevel",value:function(e){c.supportedLevels[e]?this.options.level=e:this.warn(e+" level is unsupported.")}},{key:"log",value:function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var o;this._isWritable(e)&&(o=this.writer)[e].apply(o,r);var i=this._validateLog(e,r);i&&this.instance.add(i)}},{key:"debug",value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];this.log.apply(this,["debug"].concat(t))}},{key:"error",value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];this.log.apply(this,["error"].concat(t))}},{key:"info",value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];this.log.apply(this,["info"].concat(t))}},{key:"warn",value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];this.log.apply(this,["warn"].concat(t))}},{key:"deprecated",value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];this.log.apply(this,["deprecated"].concat(t))}},{key:"timing",value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];this.log.apply(this,["timing"].concat(t))}},{key:"network",value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];this.log.apply(this,["network"].concat(t))}},{key:"enable",value:function(){"undefined"!=typeof window?this.writer=window.console:console&&(this.writer=console),this.writer&&(this.writer.timing=this.writer.info,this.writer.deprecated=this.writer.warn,this.writer.network=this.writer.warn)}},{key:"disable",value:function(){this.writer={}}},{key:"attachEmitter",value:function(e,t){if(e instanceof i.default)for(var r=t||["error","log"],n=0;n<r.length;n++)e.on(r[n],function(){this[arguments[0]]||this.error.apply(this,h(Array.prototype.slice.call(arguments,1))),this[arguments[0]].apply(this,h(Array.prototype.slice.call(arguments,1)))}.bind(this,r[n]));else this.error("attachEmitter not supplied with instanceof EventEmitter")}},{key:"detachEmitter",value:function(e,t){if(e instanceof i.default)for(var r=t||["error","log"],n=0;n<r.length;n++)e.removeListener(r[n],function(){this[arguments[0]]||this.error.apply(this,h(Array.prototype.slice.call(arguments,1))),this[arguments[0]].apply(this,h(Array.prototype.slice.call(arguments,1)))}.bind(this,r[n]));else this.error("detachEmitter not supplied with instanceof EventEmitter")}},{key:"_isWritable",value:function(e){return!this.options.silent&&this.writer[e]&&this.writer[e].apply&&c.supportedLevels[e]<=c.supportedLevels[this.options.level]}},{key:"_validateLog",value:function(e,t){var r={package:{name:this.options.name,version:this.options.version},timestamp:(new Date).toISOString(),source:"client",userAgent:"undefined"!=typeof navigator?navigator.userAgent:"node",referrer:"undefined"!=typeof document?document.referrer:"node",level:e},o=t[t.length-1];switch(Object.prototype.toString.call(o)){case"[object Object]":r=n({},r,t.pop());break;case"[object Error]":r.error=(0,s.default)(t.pop());break;case"[object Array]":r.array=t.pop()}r.message=t.join(" ");try{JSON.stringify(r)}catch(e){return this.error("Dropped log due to invalid data structure",e),null}return r}}]),e}();r.default=d,t.exports=r.default},{"./const":4,"./instance":5,"./package-json":7,events:154,"serialize-error":138}],7:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default={version:"1.1.1",name:"@livelyvideo/logger-core"},t.exports=r.default},{}],8:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n,o=e("./logger-core"),i=(n=o)&&n.__esModule?n:{default:n};r.default=i.default,t.exports=r.default},{"./logger-core":6}],9:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n,o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e("events"),s=(n=i)&&n.__esModule?n:{default:n};function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var u=function(e){function t(e,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var o=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e?r?(o._auth=e,o._url=r,o._nextParams="",o._options=n,o._retries=[0,300,1e3],o):(setTimeout(function(){return o.emit("error","url is required for a changerole request")}),a(o)):(setTimeout(function(){return o.emit("error","auth is required for a changerole request")}),a(o))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s.default),o(t,[{key:"get",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},t=this._url+"?";this._options.limit&&(t=t+"limit="+this._options.limit+"&"),this._request(t,e)}},{key:"next",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};if(this._nextParams){var t=this._url+"?"+this._nextParams;this._request(t,e)}else e(null,[])}},{key:"_request",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},n=-1;!function o(){t._auth.request(function(i,s){i?r(i):fetch(e,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+s}}).then(function(e){if(200===e.status)return e.json();if(401===e.status){var t=new Error("chat: unauthorized");throw t.retry=!0,t}if(503===e.status){var r=new Error("chat: server unavailable");throw r.retry=!0,r}if(403===e.status)throw new Error("chat: forbidden");throw new Error("chat: non-200 response code from chat server")}).then(function(e){t._nextParams=e&&e._links&&e._links.next&&e._links.next.href?e._links.next.href.split("?")[1]:"",r(null,e.changeroles)}).catch(function(e){if(e.retry&&n<t._retries.length-1){n++;var i=t._retries[n];return i?void setTimeout(o,i):void o()}r(e)})})}()}}]),t}();r.default=u,t.exports=r.default},{events:154}],10:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=m(e("events")),s=m(e("@livelyvideo/logger-core/lib/source")),a=m(e("@livelyvideo/chat-parser-core/lib/source")),u=m(e("@livelyvideo/auth-core/lib/source")),c=m(e("@livelyvideo/utils/lib/forwardEvents")),l=m(e("./websocket")),h=m(e("./fallback")),f=m(e("./command")),d=m(e("./roster")),p=m(e("./changerole")),_=m(e("./http")),v=m(e("./package-json"));function m(e){return e&&e.__esModule?e:{default:e}}function y(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var b=new s.default(v.default),g={room:null,host:null,roleHistory:!1,insecure:!1,loggerOptions:{}},w=function(e){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var o=y(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));if(b.setOptions(e.loggerOptions,o),!e)return setTimeout(function(){return o.emit("error","Chat options is required")}),y(o);if(!e.room)return setTimeout(function(){return o.emit("error","Chat room is required")}),y(o);if(!e.host)return setTimeout(function(){return o.emit("error","Chat server host required")}),y(o);e.wshost||(e.wshost="ws-"+e.host),o.options=n({},g,e),b.setInstanceOptions({host:o.options.host});var i="https",s="wss";e.insecure&&(i="http",s="ws");var d="";e.roleHistory&&(d="role-history=true");var p=i+"://"+e.host+"/chat/v1/rooms/"+e.room+"/command",v=i+"://"+e.host+"/chat/v1/manifests/say/rooms/"+e.room+"/version",m=s+"://"+e.wshost+"/chat/ws/v1/rooms/"+e.room+"?"+d,w="/chat/http/v1/rooms/"+e.room+"?"+d;if(o._rosterUrl=i+"://"+e.host+"/chat/v1/rooms/"+e.room+"/roster",o._changeroleUrl=i+"://"+e.host+"/chat/v1/rooms/"+e.room+"/changeroles",o._routeStart=i+"://"+e.host+"/chat/v1",r){if(!r.url)return setTimeout(function(){return o.emit("error","authorization options url is required")}),y(o);o._auth=new u.default("chat",r.url,r.options),(0,c.default)(o._auth,o,["error"]),o._http=new _.default(o._auth),(0,c.default)(o._http,o),o._command=new f.default(o._auth,p),(0,c.default)(o._command,o)}if(o._parser=new a.default(v),(0,c.default)(o._parser,o),"undefined"!=typeof window)if(window.WebSocket)o._socketInterface=new l.default(m,o._auth);else{var k=i+"://"+e.host+w;o._socketInterface=new h.default(k,o._auth)}else o._socketInterface=new l.default(m,o._auth);return(0,c.default)(o._socketInterface,o,["error","ready"]),o._historyEmitted=!1,o._socketInterface.on("unauthorized",function(){if(o._historyEmitted)o.emit("me",null);else{var e=function(){o.emit("me",null)},t=setTimeout(function(){e(),e=null},3e3);o.once("history",function(){e&&e(),clearTimeout(t)})}}),o._socketInterface.on("disconnect",function(){o._historyEmitted=!1,o.emit("disconnect")}),o._socketInterface.on("message",function(e){o._parser.parseMessage(e,o._emitCommand.bind(o))}),o._sayDedupe=[],o._me=null,o._room=null,o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),o(t,[{key:"getDefaultAvatars",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};this._auth?this._http.execGet(this._routeStart+"/avatars",e):e(new Error("Http calls require authentication"))}},{key:"setDefaultUserAvatar",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};this._auth?this._http.execPatch(this._routeStart+"/users/"+e+"/avatar",{default:t},r):r(new Error("Http calls require authentication"))}},{key:"getUserEmoticons",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};this._auth?this._http.execGet(this._routeStart+"/users/"+e+"/emoticons",t):t(new Error("Http calls require authentication"))}},{key:"getAllEmoticons",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};this._auth?this._http.execGet(this._routeStart+"/rooms/"+e+"/users/"+t+"/emoticons/all",r):r(new Error("Http calls require authentication"))}},{key:"postUserEmoticon",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};this._auth?this._http.execPost(this._routeStart+"/users/"+e+"/emoticons",t,r):r(new Error("Http calls require authentication"))}},{key:"deleteUserEmoticon",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};this._auth?this._http.execDelete(this._routeStart+"/users/"+e+"/emoticons/"+t,r):r(new Error("Http calls require authentication"))}},{key:"getUserAvatar",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};this._auth?this._http.execGet(this._routeStart+"/users/"+e+"/avatar",t):t(new Error("Http calls require authentication"))}},{key:"putUserAvatar",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};this._auth?this._http.execPut(this._routeStart+"/users/"+e+"/avatar",t,r):r(new Error("Http calls require authentication"))}},{key:"getUser",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};this._auth?this._http.execGet(this._routeStart+"/users/"+e,t):t(new Error("Http calls require authentication"))}},{key:"patchUser",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};this._auth?this._http.execPatch(this._routeStart+"/users/"+e,t,r):r(new Error("Http calls require authentication"))}},{key:"getRoomUser",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};this._auth?this._http.execGet(this._routeStart+"/rooms/"+e+"/users/"+t,r):r(new Error("Http calls require authentication"))}},{key:"patchRoomUser",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){};this._auth?this._http.execPatch(this._routeStart+"/rooms/"+e+"/users/"+t,r,n):n(new Error("Http calls require authentication"))}},{key:"getRoom",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};this._auth?this._http.execGet(this._routeStart+"/rooms/"+e,t):t(new Error("Http calls require authentication"))}},{key:"patchRoom",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};this._auth?this._http.execPatch(this._routeStart+"/rooms/"+e,t,r):r(new Error("Http calls require authentication"))}},{key:"getChangeroles",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!this._auth)return this.emit("error","Changeroles calls require authentication"),!1;var t=Object.assign({},{limit:100,role:""},e);return new p.default(this._auth,this._changeroleUrl,t)}},{key:"getRoster",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object.assign({},{limit:100,role:""},e);return new d.default(this._rosterUrl,t)}},{key:"command",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};this._auth?this._command.run(e,function(e,n){if(e)r(e);else{for(var o=n.length-1;o>=0;o--)n[o].data&&n[o].data&&n[o].data.command&&(t._parser.parseMessage(n[o].data.command,t._emitCommand.bind(t)),n.splice(0,1));r(null,n)}}):r(new Error("Command calls require authentication"))}},{key:"destroy",value:function(){this._auth.destroy(),this._socketInterface.destroy()}},{key:"_emitCommand",value:function(e,t,r){if(e)this.emit("error",e);else switch(t){case"NOTIFICATION":this.emit("notification",r);break;case"CLOSE":this.emit("close",r),this._socketInterface.destroy();break;case"SAY":this._emitSay(r);break;case"ME":this._me=r,this.emit("me",r);break;case"ROOM":this._room=r,this.emit("room",r);break;case"MESSAGE":this.emit("message",r);break;case"HISTORY":this.emit("history",r),this._historyEmitted=!0;break;case"DELETE":this.emit("delete",r)}}},{key:"_emitSay",value:function(e){for(var t=this._sayDedupe.length-1;t>=0;t--)if(this._sayDedupe[t]===e.id)return;this._me&&this._me.ignore&&-1!==this._me.ignore.indexOf(e.actor.id)&&(e.ignore=!0),this._sayDedupe.length>50&&this._sayDedupe.splice(0,1),this._sayDedupe.push(e.id),this.emit("chat",e)}}]),t}();r.default=w,t.exports=r.default},{"./changerole":9,"./command":11,"./fallback":12,"./http":13,"./package-json":14,"./roster":15,"./websocket":18,"@livelyvideo/auth-core/lib/source":3,"@livelyvideo/chat-parser-core/lib/source":25,"@livelyvideo/logger-core/lib/source":23,"@livelyvideo/utils/lib/forwardEvents":35,events:154}],11:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n,o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e("events"),s=(n=i)&&n.__esModule?n:{default:n};function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var u=function(e){function t(e,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e?r?(n._auth=e,n._url=r,n._retries=[0,300,1e3],n):(setTimeout(function(){return n.emit("error","url is required for a command")}),a(n)):(setTimeout(function(){return n.emit("error","auth is required for a command")}),a(n))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s.default),o(t,[{key:"run",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};if(e){var n=-1,o=function o(){t._auth.request(function(i,s){i?r(i):fetch(t._url,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+s},body:JSON.stringify({command:e})}).then(function(e){if(e.status>=200&&e.status<300)return 204===e.status?null:e.json();if(401===e.status){t._auth.refreshToken();var r=new Error("chat: unauthorized");throw r.retry=!0,r}if(503===e.status){var n=new Error("chat: server unavailable");throw n.retry=!0,n}if(403===e.status)throw new Error("chat: forbidden");if(e.status>=400&&e.status<500)return e.json();throw new Error("chat: non-200 response code from chat server")}).then(function(e){e&&e.messages?r(null,e.messages):r()}).catch(function(e){if(e.retry&&n<t._retries.length-1){n++;var i=t._retries[n];return i?void setTimeout(o,i):void o()}r(e)})})};o()}else r(new Error("command is required for a command"))}}]),t}();r.default=u,t.exports=r.default},{events:154}],12:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n,o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e("events"),s=e("./uuid"),a=(n=s)&&n.__esModule?n:{default:n};function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var c=function(e){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=u(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n._auth=r,e?(n._url=e,n._stopped=!0,n._connectionID=(0,a.default)(),n._isConnected=!1,n._retry=0,n._retries=[0,300,1e3],n._run(),n):(setTimeout(function(){return n.emit("error","url is required for a command")}),u(n))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.EventEmitter),o(t,[{key:"destroy",value:function(){this._stopped=!0}},{key:"_retryRun",value:function(e){var t=this;if(e)return this._retry=0,void this._run();this._retry<this._retries.length-1&&this._retry++,setTimeout(function(){t._run()},this._retries[this._retry])}},{key:"_run",value:function(){var e=this;this._auth?this._auth.request(function(t,r){t?e._disconnected(t):e._request(r)}):this._request()}},{key:"_request",value:function(e){var t=this,r={Accept:"application/json","Content-Type":"application/json"};e&&(r.Authorization="Bearer "+e);var n=void 0;n=this._url.indexOf("?")===this._url.length-1?this._url+"cid="+this._connectionID:this._url+"&cid="+this._connectionID,fetch(n,{method:"GET",headers:r}).then(function(e){if(200===e.status)return e.json();if(401===e.status){t._auth.refreshToken();var r=new Error("chat: unauthorized");throw r.retry=!0,r}if(503===e.status){var n=new Error("chat: server unavailable");throw n.retry=!0,n}if(404===e.status)throw new Error("Room does not exist");if(403===e.status)throw t.emit("unauthorized"),new Error("chat: forbidden");if(409===e.status){t._connectionID=(0,a.default)();var o=new Error("chat: connection id conflict");throw o.ignore=!0,o.retry=!0,o}throw new Error("non 200 response")}).then(function(e){t._connected();for(var r=0;r<e.length;r++)t.emit("message",e[r]);t._stopped||t._retryRun(!0)}).catch(function(e){t._disconnected(e),e.retry&&(t._stopped||t._retryRun())})}},{key:"_disconnected",value:function(e){e&&(e.ignore||this.emit("error",e)),this._isConnected&&(this.emit("disconnect"),this._isConnected=!1)}},{key:"_connected",value:function(){this._isConnected||(this.emit("ready"),this._isConnected=!0)}}]),t}();r.default=c,t.exports=r.default},{"./uuid":17,events:154}],13:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n,o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e("events"),s=(n=i)&&n.__esModule?n:{default:n};function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var u=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e?(r._auth=e,r._retries=[0,300,1e3],r):(setTimeout(function(){return r.emit("error","auth is required for an http request")}),a(r))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s.default),o(t,[{key:"execGet",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};e?this._execute("GET",e,null,t):this.emit("error","url is required for an http request")}},{key:"execPut",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};e?this._execute("PUT",e,t,r):this.emit("error","url is required for an http request")}},{key:"execPost",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};e?this._execute("POST",e,t,r):this.emit("error","url is required for an http request")}},{key:"execPatch",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};e?this._execute("PATCH",e,t,r):this.emit("error","url is required for an http request")}},{key:"execDelete",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};e?this._execute("DELETE",e,t):this.emit("error","url is required for an http request")}},{key:"_execute",value:function(e,t,r){var n=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){},i={method:e,headers:{Accept:"application/json","Content-Type":"application/json"}};r&&(i.body=JSON.stringify(r));var s=-1;!function e(){n._auth.request(function(r,a){r?o(r):(i.headers.Authorization="Bearer "+a,fetch(t,i).then(function(e){if(e.status>=200&&e.status<300)return e.json();if(401===e.status){var t=new Error("chat: unauthorized");throw t.retry=!0,t}if(503===e.status){var r=new Error("chat: server unavailable");throw r.retry=!0,r}if(403===e.status)throw new Error("chat: forbidden");throw new Error("chat: non-200 response code from chat server")}).then(function(e){o(null,e)}).catch(function(t){if(t.retry&&s<n._retries.length-1){s++;var r=n._retries[s];return r?void setTimeout(e,r):void e()}o(t)}))})}()}}]),t}();r.default=u,t.exports=r.default},{events:154}],14:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default={version:"1.2.4",name:"@livelyvideo/chat-core"},t.exports=r.default},{}],15:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n,o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e("events"),s=(n=i)&&n.__esModule?n:{default:n};function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var u=function(e){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e?(n._url=e,n._nextParams="",n._options=r,n._retries=[0,300,1e3],n):(setTimeout(function(){return n.emit("url is required for a roster request")}),a(n))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s.default),o(t,[{key:"update",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},t=this._url+"?";this._options.limit&&(t=t+"limit="+this._options.limit+"&"),this._options.role&&(t=t+"role="+this._options.role+"&"),this._request(t,e)}},{key:"next",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};if(this._nextParams){var t=this._url+"?"+this._nextParams;this._request(t,e)}else e(null,[])}},{key:"_request",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},n=-1;!function o(){fetch(e,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}}).then(function(e){if(200===e.status)return e.json();if(503===e.status){var t=new Error("chat: server unavailable");throw t.retry=!0,t}if(403===e.status)throw new Error("chat: forbidden");throw new Error("chat: non-200 response code from chat server")}).then(function(e){t._nextParams=e&&e._links&&e._links.next&&e._links.next.href?e._links.next.href.split("?")[1]:"",r(null,e.users)}).catch(function(e){if(e.retry&&n<t._retries.length-1){n++;var i=t._retries[n];return i?void setTimeout(o,i):void o()}r(e)})}()}}]),t}();r.default=u,t.exports=r.default},{events:154}],16:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n,o=e("./chat-core"),i=(n=o)&&n.__esModule?n:{default:n};r.default=i.default,t.exports=r.default},{"./chat-core":10}],17:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});for(var n=new Array(16),o=[],i={},s=0;s<256;s++)o[s]=(s+256).toString(16).substr(1),i[o[s]]=s;r.default=function(){var e,t,r,i,s=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),n[t]=e>>>((3&t)<<3)&255;return n}();return s[6]=15&s[6]|64,s[8]=63&s[8]|128,r=t||0,(i=o)[(e=s)[r++]]+i[e[r++]]+i[e[r++]]+i[e[r++]]+"-"+i[e[r++]]+i[e[r++]]+"-"+i[e[r++]]+i[e[r++]]+"-"+i[e[r++]]+i[e[r++]]+"-"+i[e[r++]]+i[e[r++]]+i[e[r++]]+i[e[r++]]+i[e[r++]]+i[e[r++]]},t.exports=r.default},{}],18:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n,o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e("reconnectable-websocket"),s=(n=i)&&n.__esModule?n:{default:n},a=e("events");function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var c="msg",l="msg",h="err",f="fin",d="ack",p="/",_="/auth",v=function(e){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=u(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e?(n._auth=r,n._socket=new s.default(e,"livelyWebsocket",{automaticOpen:!1,reconnectOnError:!0,reconnectOnCleanClose:!0,randomRatio:!1}),n._retries=[0,200,1e3,2e3],n._retry=0,n.ready=!1,n.authed=!1,n._socket.onopen=function(){n._auth&&n._authenticate()},n._socket.onclose=function(e){n.emit("disconnect"),n.ready=!1,n.authed=!1,1003===e.code&&(n._socket._options.reconnectOnCleanClose=!1,n._socket._options.reconnectOnError=!1,n._socket.close(),n.emit("error",new Error("Requested room does not exist")))},n._socket.onmessage=function(e){n._onmessage(e)},n._socket.open(),n):(setTimeout(function(){return n.emit("error","url is required for chat")}),u(n))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.EventEmitter),o(t,[{key:"destroy",value:function(){this._socket._options.reconnectOnCleanClose=!1,this._socket._options.reconnectOnError=!1,this._socket.close()}},{key:"_authenticate",value:function(){var e=this;this._auth.request(function(t,r){t?e.emit("error",t):(e._send(e._socket,c,_,r),e.once("_authed",function(t){t&&e.emit("unauthorized")}))})}},{key:"_send",value:function(e,t,r,n){if(e&&e.readyState===e.OPEN){var o=t+" "+r+" "+n;this._socket.send(o)}}},{key:"_onmessage",value:function(e){var t=e.data;if(t){var r=t.indexOf(" "),n=t.indexOf(" ",r+1),o=t.slice(0,r),i=t.slice(r+1,n),s=t.slice(n+1);if(o!==l)this.ready||o!==d||i!==p||(this.emit("ready"),this.ready=!0,this._auth||this.emit("unauthorized")),this.authed||o!==f?o===h&&this.emit("error",new Error(s)):i===_&&(this.emit("_authed"),this.authed=!0);else{var a=void 0;try{a=JSON.parse(s)}catch(e){return void this.emit("error",e)}this.emit("message",a)}}}}]),t}();r.default=v,t.exports=r.default},{events:154,"reconnectable-websocket":137}],19:[function(e,t,r){arguments[4][4][0].apply(r,arguments)},{dup:4}],20:[function(e,t,r){arguments[4][5][0].apply(r,arguments)},{"./const":19,"./package-json":22,dup:5,"serialize-error":138}],21:[function(e,t,r){arguments[4][6][0].apply(r,arguments)},{"./const":19,"./instance":20,"./package-json":22,dup:6,events:154,"serialize-error":138}],22:[function(e,t,r){arguments[4][7][0].apply(r,arguments)},{dup:7}],23:[function(e,t,r){arguments[4][8][0].apply(r,arguments)},{"./logger-core":21,dup:8}],24:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=s(e("events")),i=s(e("./template-parser"));function s(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var u="index",c="type",l="nestedItems",h="key",f="vars",d="nestedArray",p="nestedObject",_="template",v={emoticons:"emoticon",links:"link",mentions:"mention",tags:"tag"},m=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e?(r._baseUrl=e,r._manifests={},r._buffer={},r._fetchingManifests={},r):(setTimeout(function(){return r.emit("error","url is required for parser")}),a(r))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),n(t,[{key:"parseMessage",value:function(e,t){var r=this;e&&e instanceof Array&&!(e.length<2)||t(new Error("Invalid data format"));var n=e[0],o=e[1];this._parseMessage(n,o,function(e,o){e?t(e):("HISTORY"===n&&o.messages.length&&o.messages.forEach(function(e,t){r._parseMessage("SAY",e,function(e,r){e||(o.messages[t]=r)})}),t(null,n,o))})}},{key:"_addManifest",value:function(e){this._manifests[e.version]=e}},{key:"_parseMessage",value:function(e,t,r){var n=this,o=t[0],i=void 0;if(this._manifests[o])return this._manifests[o].manifests[e]?(i=this._parse(o,this._manifests[o].manifests[e],t),void r(null,i)):void r(new Error("manifest does not have "+e+" command"));this._buffer[o]?this._buffer[o].push([t,e,r]):this._buffer[o]=[[t,e,r]],!0!==this._fetchingManifests[o]&&(this._fetchingManifests[o]=!0,fetch(this._baseUrl+"/"+o).then(function(e){if(200!==e.status)throw new Error("chat: non-200 response code from chat server");return e.json()}).then(function(e){for(n._addManifest(e);n._buffer[e.version].length>0;){var t=n._buffer[e.version].shift();i=n._parse(e.version,e.manifests[t[1]],t[0]),t[2](null,i)}}).catch(function(e){n._buffer[o]=[],r(e)}))}},{key:"_parse",value:function(e,t,r){for(var n=this,o={},i=Object.keys(t),s=function(s){var a=i[s],m=t[a],y=r[m[u]];if(null===y)return o[a]=null,"continue";var b=void 0;switch(m[c]){case d:b=[];for(var g=0;g<y.length;g++)b.push(n._parse(e,m[l],y[g]));break;case p:b=n._parse(e,m[l],y);break;case _:b=n._parseTemplate(e,y[m[l][h].index],y[m[l][f].index]);break;default:b=y}b&&b instanceof Array&&b.forEach(function(e){var t=e;t.positions&&t.positions instanceof Array&&t.positions.forEach(function(e){v[a]&&(t.type=v[a],o.positions||(o.positions={}),o.positions[e]=t)})}),o[a]=b},a=0;a<i.length;a++)s(a);return o}},{key:"_parseTemplate",value:function(e,t,r){return new i.default(this._manifests[e].templates[t],r).getParsed()}}]),t}();r.default=m,t.exports=r.default},{"./template-parser":26,events:154}],25:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n,o=e("./chat-parser-core"),i=(n=o)&&n.__esModule?n:{default:n};r.default=i.default,t.exports=r.default},{"./chat-parser-core":24}],26:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var o=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._parsed="",r&&0!==r.length?t&&0!==t.length&&(this._parsed="",this._varPos=0,this._curr="",this._template=t,this._templateLength=t.length,this._vars=r,this._next=this._startState.bind(this),this._pos=0,this._skipNext=!1):this._parsed=t}return n(e,[{key:"getParsed",value:function(){if(this._parsed)return this._parsed;for(var e=0;e<this._templateLength;e++)this._skipNext?this._skipNext=!1:(this._pos=e,this._curr=this._template[e],this._next=this._next().bind(this));return this._parsed}},{key:"_startDelim",value:function(){return!(this._pos>=this._templateLength-1)&&("{"===this._curr&&"{"===this._template[this._pos+1]&&(this._skipNext=!0,!0))}},{key:"_endDelim",value:function(){return!(this._pos>=this._templateLength-1)&&("}"===this._curr&&"}"===this._template[this._pos+1]&&(this._skipNext=!0,!0))}},{key:"_startState",value:function(){return this._startDelim()?this._midState:(this._parsed+=this._curr,this._startState)}},{key:"_midState",value:function(){return"n"===this._curr?this._endState:(this._parsed=this._parsed+"{{"+this._curr,this._startState)}},{key:"_endState",value:function(){return this._endDelim()?(this._parsed+=this._vars[this._varPos],this._varPos++):this._parsed+=this._curr,this._startState}}]),e}();r.default=o,t.exports=r.default},{}],27:[function(e,t,r){(function(n){!function(e){"object"==typeof r&&void 0!==t?t.exports=e():("undefined"!=typeof window?window:void 0!==n?n:"undefined"!=typeof self?self:this).LivelyLocales=e()}(function(){return function t(r,n,o){function i(a,u){if(!n[a]){if(!r[a]){var c="function"==typeof e&&e;if(!u&&c)return c(a,!0);if(s)return s(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var h=n[a]={exports:{}};r[a][0].call(h.exports,function(e){var t=r[a][1][e];return i(t||e)},h,h.exports,t,r,n,o)}return n[a].exports}for(var s="function"==typeof e&&e,a=0;a<o.length;a++)i(o[a]);return i}({1:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var i={},s={},a=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t&&i[t]||r?(this.warned={},this.silent=n,this.name=t,this.data=i[t]||{},r&&Object.assign(this.data,r)):this.localize=function(e){return e}}return o(e,[{key:"localize",value:function(e){var t;return(t=this.data[e])?t:(this.silent||this.warned[e]||(this.warned[e]=!0,this.name?console.warn("'"+e+"' has no translation in the provided '"+this.name+"' locale files or localization messages"):console.warn("'"+e+"' has no translation in the provided localization messages.")),e)}}]),e}();[].map(function(e){var t=e.name.split("/")[2];i[t]=Object.assign({},i[t],e.module)});var u=new a;Object.keys(i).forEach(function(e){s[e]=new a(e)}),r.default=function(e,t,r){if(t){if("object"!==(void 0===t?"undefined":n(t)))throw new Error("Lively Localization instantiated with something other than a messages object",{messages:t});return new a(e,t,r)}return e&&s[e]?s[e]:u},t.exports=r.default},{}]},{},[1])(1)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],28:[function(e,t,r){arguments[4][4][0].apply(r,arguments)},{dup:4}],29:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=f(e("babel-runtime/core-js/array/from")),o=f(e("babel-runtime/core-js/object/assign")),i=f(e("babel-runtime/core-js/object/define-property")),s=f(e("babel-runtime/core-js/json/stringify")),a=o.default||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),(0,i.default)(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),c=f(e("serialize-error")),l=e("./const"),h=f(e("./package-json"));function f(e){return e&&e.__esModule?e:{default:e}}function d(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return(0,n.default)(e)}var p={host:null,interval:3e4,limit:500,maxRequestSize:1048576,reportLevel:"error",noHttps:!1},_=null,v=function(){function e(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),_||(_=this,this.options=p,this.storage=[],this.networkFailure=!1,this._handleFetchError=this._handleFetchError.bind(this),_)}return u(e,[{key:"setOptions",value:function(e){var t=function(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}(e,[]);this.options=a({},this.options,t),this._uri||(this.options.uri?this._uri=this.options.uri:this._uri=(this.options.noHttps?"http://":"https://")+this.options.host+"/client-logs")}},{key:"validateContext",value:function(e){var t=void 0;try{t=(0,s.default)(e)}catch(e){return this.addInstanceLog({level:"error",package:h.default,source:"client",message:"Error stringifying options context",error:(0,c.default)(e)}),!1}return t}},{key:"add",value:function(e){this.storage.push(e),l.supportedLevels[e.level]<=l.supportedLevels[this.options.reportLevel]?this.send():this.checkStorageLimit()}},{key:"addInstanceLog",value:function(e){var t=void 0;try{t=(0,s.default)(e)}catch(e){return}this.storage.push(t)}},{key:"send",value:function(){var e=this;if(this.storage.length&&this._uri){var t=this.storage.splice(0,this.options.limit),r=this.validateContext(this.options.context),n='{ "messages": [';t.map(function(e,r){n+=e,r!==t.length-1&&(n+=", ")}),n+="]",n+=r?', "context": '+r+" }":" }",this._byteLength(n)>this.options.maxRequestSize?this.addInstanceLog({level:"error",package:h.default,source:"client",message:"Body exceeds maxRequestSize. Dropped "+t.length+" logs."}):fetch(this._uri,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:n}).then(this._handleFetchError).catch(function(r){e.storage=[].concat(d(t),d(e.storage)),e.networkFailure=!0,e.addInstanceLog({level:"network",package:h.default,source:"client",message:"Network failure.",error:(0,c.default)(r)})})}}},{key:"enable",value:function(){var e=this;this._uri&&(this._watchInterval=setInterval(function(){return e.send()},this.options.interval),"undefined"!=typeof window&&(this._watchUnload=this._eventHelper(window,"unload",function(){return e.send()})))}},{key:"disable",value:function(){this._watchInterval&&clearInterval(this._watchInterval),this._watchUnload&&this._watchUnload()}},{key:"checkStorageLimit",value:function(){this.options.limit&&!this.networkFailure&&this.storage.length>=this.options.limit&&this.send()}},{key:"_handleFetchError",value:function(e){if(!e.ok)throw new TypeError(e.status,e.statusText);return this.networkFailure=!1,e}},{key:"_byteLength",value:function(e){for(var t=e.length,r=e.length-1;r>=0;r--){var n=e.charCodeAt(r);n>127&&n<=2047?t++:n>2047&&n<=65535&&(t+=2),n>=56320&&n<=57343&&r--}return t}},{key:"_eventHelper",value:function(e,t,r){e.addEventListener(t,r);return function(){e.removeEventListener(t,r)}}}]),e}();r.default=v,t.exports=r.default},{"./const":28,"./package-json":31,"babel-runtime/core-js/array/from":36,"babel-runtime/core-js/json/stringify":37,"babel-runtime/core-js/object/assign":38,"babel-runtime/core-js/object/define-property":40,"serialize-error":138}],30:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=p(e("babel-runtime/core-js/array/from")),o=p(e("babel-runtime/core-js/object/assign")),i=p(e("babel-runtime/core-js/object/define-property")),s=p(e("babel-runtime/core-js/json/stringify")),a=o.default||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),(0,i.default)(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),c=p(e("events")),l=p(e("serialize-error")),h=p(e("./instance")),f=p(e("./package-json")),d=e("./const");function p(e){return e&&e.__esModule?e:{default:e}}function _(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return(0,n.default)(e)}var v={level:"warn",remoteLevel:"info",silent:!0,disable:!1,events:!0,name:f.default.name,version:f.default.version},m=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=a({},v,t),this.instance=new h.default,this.enable()}return u(e,[{key:"setOptions",value:function(e,t,r){this.options=a({},this.options,e),this.options.disable&&this.disableInstance(),t&&this.options.events&&this.attachEmitter(t,r)}},{key:"setInstanceOptions",value:function(e){this.instance.options.host&&e.host&&this.instance.options.host!==e.host?this.warn("Unable to set instance options. Host set to "+this.instance.options.host+" and cannot be set "+e.host+"."):this.instance.options.uri&&e.uri&&this.instance.options.uri!==e.uri?this.warn("Unable to set instance options. Host set to "+this.instance.options.uri+" and cannot be set "+e.uri+"."):(this.instance.setOptions(e),this.options.disable||this.enableInstance())}},{key:"enableInstance",value:function(){this.instance.enable()}},{key:"disableInstance",value:function(){this.instance.disable()}},{key:"instanceSend",value:function(){this.instance.send()}},{key:"setLevel",value:function(e){d.supportedLevels[e]?this.options.level=e:this.warn(e+" level is unsupported.")}},{key:"setRemoteLevel",value:function(e){d.supportedLevels[e]?this.options.remoteLevel=e:this.warn(e+" level is unsupported.")}},{key:"log",value:function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var o;this._isWritable(e)&&(o=this.writer)[e].apply(o,r);var i=this._validateLog(e,r);i&&d.supportedLevels[e]<=d.supportedLevels[this.options.remoteLevel]&&this.instance.add(i)}},{key:"debug",value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];this.log.apply(this,["debug"].concat(t))}},{key:"error",value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];this.log.apply(this,["error"].concat(t))}},{key:"info",value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];this.log.apply(this,["info"].concat(t))}},{key:"warn",value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];this.log.apply(this,["warn"].concat(t))}},{key:"deprecated",value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];this.log.apply(this,["deprecated"].concat(t))}},{key:"timing",value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];this.log.apply(this,["timing"].concat(t))}},{key:"network",value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];this.log.apply(this,["network"].concat(t))}},{key:"enable",value:function(){"undefined"!=typeof window?this.writer=window.console:console&&(this.writer=console),this.writer&&(this.writer.timing=this.writer.info,this.writer.deprecated=this.writer.warn,this.writer.network=this.writer.warn)}},{key:"disable",value:function(){this.writer={}}},{key:"attachEmitter",value:function(e,t){if(e instanceof c.default)for(var r=t||["error","log"],n=0;n<r.length;n++)e.on(r[n],function(){this[arguments[0]]||this.error.apply(this,_(Array.prototype.slice.call(arguments,1))),this[arguments[0]].apply(this,_(Array.prototype.slice.call(arguments,1)))}.bind(this,r[n]));else this.error("attachEmitter not supplied with instanceof EventEmitter")}},{key:"detachEmitter",value:function(e,t){if(e instanceof c.default)for(var r=t||["error","log"],n=0;n<r.length;n++)e.removeListener(r[n],function(){this[arguments[0]]||this.error.apply(this,_(Array.prototype.slice.call(arguments,1))),this[arguments[0]].apply(this,_(Array.prototype.slice.call(arguments,1)))}.bind(this,r[n]));else this.error("detachEmitter not supplied with instanceof EventEmitter")}},{key:"_isWritable",value:function(e){return!this.options.silent&&this.writer[e]&&this.writer[e].apply&&d.supportedLevels[e]<=d.supportedLevels[this.options.level]}},{key:"_validateLog",value:function(e,t){var r={package:{name:this.options.name,version:this.options.version},time:(new Date).toISOString(),source:"client",userAgent:"undefined"!=typeof navigator?navigator.userAgent:"node",referrer:"undefined"!=typeof document?document.referrer:"node",level:e},n=t[t.length-1];switch(Object.prototype.toString.call(n)){case"[object Object]":r=a({},r,t.pop());break;case"[object Error]":r.error=(0,l.default)(t.pop());break;case"[object Array]":r.array=t.pop()}r.message=t.join(" ");var o=void 0;try{o=(0,s.default)(r)}catch(e){try{o=(0,s.default)(r,function(e,t){return e?""+t:t})}catch(e){return this.error("Dropped log due to invalid data structure",e),null}}return o}}]),e}();r.default=m,t.exports=r.default},{"./const":28,"./instance":29,"./package-json":31,"babel-runtime/core-js/array/from":36,"babel-runtime/core-js/json/stringify":37,"babel-runtime/core-js/object/assign":38,"babel-runtime/core-js/object/define-property":40,events:154,"serialize-error":138}],31:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default={version:"1.3.4",name:"@livelyvideo/logger-core"},t.exports=r.default},{}],32:[function(e,t,r){arguments[4][8][0].apply(r,arguments)},{"./logger-core":30,dup:8}],33:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function e(t){var r=void 0,n=void 0,o=void 0;if(t.tagName){if(r=document.createElement(t.tagName),t.className&&(r.className=t.className),t.attributes)for(n in t.attributes)r.setAttribute(n,t.attributes[n]);void 0!==t.html&&(r.innerHTML=t.html)}else r=document.createDocumentFragment();if(t.text&&r.appendChild(document.createTextNode(t.text)),void 0===window.HTMLElement&&(window.HTMLElement=Element),t.childs&&t.childs.length)for(o=0;o<t.childs.length;o++)r.appendChild(t.childs[o]instanceof window.HTMLElement?t.childs[o]:e(t.childs[o]));if(t.events)for(var i in t.events)r.addEventListener(i,t.events[i]);return r},t.exports=r.default},{}],34:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e,t,r){if(e.addEventListener)return e.addEventListener(t,r),function(){e.removeEventListener(t,r)};return e.attachEvent("on"+t,function(){r.call(e)}),function(){e.detachEvent("on"+t,function(){r.call(e)})}},t.exports=r.default},{}],35:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n,o=e("events"),i=(n=o)&&n.__esModule?n:{default:n};r.default=function(e,t,r){if(!(e instanceof i.default))throw new Error("src must be an emitter");if(!(t instanceof i.default))throw new Error("dst must be an emitter");var n=e.emit;e.once("error",function(){}),e.emit=function(o){if(n.apply(e,arguments),!r||-1!==r.indexOf(o))return t.emit.apply(t,arguments)}.bind(e)},t.exports=r.default},{events:154}],36:[function(e,t,r){t.exports={default:e("core-js/library/fn/array/from"),__esModule:!0}},{"core-js/library/fn/array/from":48}],37:[function(e,t,r){t.exports={default:e("core-js/library/fn/json/stringify"),__esModule:!0}},{"core-js/library/fn/json/stringify":49}],38:[function(e,t,r){t.exports={default:e("core-js/library/fn/object/assign"),__esModule:!0}},{"core-js/library/fn/object/assign":50}],39:[function(e,t,r){t.exports={default:e("core-js/library/fn/object/create"),__esModule:!0}},{"core-js/library/fn/object/create":51}],40:[function(e,t,r){t.exports={default:e("core-js/library/fn/object/define-property"),__esModule:!0}},{"core-js/library/fn/object/define-property":52}],41:[function(e,t,r){t.exports={default:e("core-js/library/fn/object/get-prototype-of"),__esModule:!0}},{"core-js/library/fn/object/get-prototype-of":53}],42:[function(e,t,r){t.exports={default:e("core-js/library/fn/object/keys"),__esModule:!0}},{"core-js/library/fn/object/keys":54}],43:[function(e,t,r){t.exports={default:e("core-js/library/fn/object/set-prototype-of"),__esModule:!0}},{"core-js/library/fn/object/set-prototype-of":55}],44:[function(e,t,r){t.exports={default:e("core-js/library/fn/symbol"),__esModule:!0}},{"core-js/library/fn/symbol":56}],45:[function(e,t,r){t.exports={default:e("core-js/library/fn/symbol/iterator"),__esModule:!0}},{"core-js/library/fn/symbol/iterator":57}],46:[function(e,t,r){"use strict";r.__esModule=!0,r.default=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},{}],47:[function(e,t,r){"document"in window.self&&("classList"in document.createElement("_")&&(!document.createElementNS||"classList"in document.createElementNS("http://www.w3.org/2000/svg","g"))||function(e){"use strict";if("Element"in e){var t="classList",r="prototype",n=e.Element[r],o=Object,i=String[r].trim||function(){return this.replace(/^\s+|\s+$/g,"")},s=Array[r].indexOf||function(e){for(var t=0,r=this.length;t<r;t++)if(t in this&&this[t]===e)return t;return-1},a=function(e,t){this.name=e,this.code=DOMException[e],this.message=t},u=function(e,t){if(""===t)throw new a("SYNTAX_ERR","An invalid or illegal string was specified");if(/\s/.test(t))throw new a("INVALID_CHARACTER_ERR","String contains an invalid character");return s.call(e,t)},c=function(e){for(var t=i.call(e.getAttribute("class")||""),r=t?t.split(/\s+/):[],n=0,o=r.length;n<o;n++)this.push(r[n]);this._updateClassName=function(){e.setAttribute("class",this.toString())}},l=c[r]=[],h=function(){return new c(this)};if(a[r]=Error[r],l.item=function(e){return this[e]||null},l.contains=function(e){return-1!==u(this,e+="")},l.add=function(){var e,t=arguments,r=0,n=t.length,o=!1;do{e=t[r]+"",-1===u(this,e)&&(this.push(e),o=!0)}while(++r<n);o&&this._updateClassName()},l.remove=function(){var e,t,r=arguments,n=0,o=r.length,i=!1;do{for(e=r[n]+"",t=u(this,e);-1!==t;)this.splice(t,1),i=!0,t=u(this,e)}while(++n<o);i&&this._updateClassName()},l.toggle=function(e,t){e+="";var r=this.contains(e),n=r?!0!==t&&"remove":!1!==t&&"add";return n&&this[n](e),!0===t||!1===t?t:!r},l.toString=function(){return this.join(" ")},o.defineProperty){var f={get:h,enumerable:!0,configurable:!0};try{o.defineProperty(n,t,f)}catch(e){void 0!==e.number&&-2146823252!==e.number||(f.enumerable=!1,o.defineProperty(n,t,f))}}else o[r].__defineGetter__&&n.__defineGetter__(t,h)}}(window.self),function(){"use strict";var e=document.createElement("_");if(e.classList.add("c1","c2"),!e.classList.contains("c2")){var t=function(e){var t=DOMTokenList.prototype[e];DOMTokenList.prototype[e]=function(e){var r,n=arguments.length;for(r=0;r<n;r++)e=arguments[r],t.call(this,e)}};t("add"),t("remove")}if(e.classList.toggle("c3",!1),e.classList.contains("c3")){var r=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(e,t){return 1 in arguments&&!this.contains(e)==!t?t:r.call(this,e)}}e=null}())},{}],48:[function(e,t,r){e("../../modules/es6.string.iterator"),e("../../modules/es6.array.from"),t.exports=e("../../modules/_core").Array.from},{"../../modules/_core":64,"../../modules/es6.array.from":122,"../../modules/es6.string.iterator":131}],49:[function(e,t,r){var n=e("../../modules/_core"),o=n.JSON||(n.JSON={stringify:JSON.stringify});t.exports=function(e){return o.stringify.apply(o,arguments)}},{"../../modules/_core":64}],50:[function(e,t,r){e("../../modules/es6.object.assign"),t.exports=e("../../modules/_core").Object.assign},{"../../modules/_core":64,"../../modules/es6.object.assign":124}],51:[function(e,t,r){e("../../modules/es6.object.create");var n=e("../../modules/_core").Object;t.exports=function(e,t){return n.create(e,t)}},{"../../modules/_core":64,"../../modules/es6.object.create":125}],52:[function(e,t,r){e("../../modules/es6.object.define-property");var n=e("../../modules/_core").Object;t.exports=function(e,t,r){return n.defineProperty(e,t,r)}},{"../../modules/_core":64,"../../modules/es6.object.define-property":126}],53:[function(e,t,r){e("../../modules/es6.object.get-prototype-of"),t.exports=e("../../modules/_core").Object.getPrototypeOf},{"../../modules/_core":64,"../../modules/es6.object.get-prototype-of":127}],54:[function(e,t,r){e("../../modules/es6.object.keys"),t.exports=e("../../modules/_core").Object.keys},{"../../modules/_core":64,"../../modules/es6.object.keys":128}],55:[function(e,t,r){e("../../modules/es6.object.set-prototype-of"),t.exports=e("../../modules/_core").Object.setPrototypeOf},{"../../modules/_core":64,"../../modules/es6.object.set-prototype-of":129}],56:[function(e,t,r){e("../../modules/es6.symbol"),e("../../modules/es6.object.to-string"),e("../../modules/es7.symbol.async-iterator"),e("../../modules/es7.symbol.observable"),t.exports=e("../../modules/_core").Symbol},{"../../modules/_core":64,"../../modules/es6.object.to-string":130,"../../modules/es6.symbol":132,"../../modules/es7.symbol.async-iterator":133,"../../modules/es7.symbol.observable":134}],57:[function(e,t,r){e("../../modules/es6.string.iterator"),e("../../modules/web.dom.iterable"),t.exports=e("../../modules/_wks-ext").f("iterator")},{"../../modules/_wks-ext":119,"../../modules/es6.string.iterator":131,"../../modules/web.dom.iterable":135}],58:[function(e,t,r){t.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},{}],59:[function(e,t,r){t.exports=function(){}},{}],60:[function(e,t,r){var n=e("./_is-object");t.exports=function(e){if(!n(e))throw TypeError(e+" is not an object!");return e}},{"./_is-object":82}],61:[function(e,t,r){var n=e("./_to-iobject"),o=e("./_to-length"),i=e("./_to-absolute-index");t.exports=function(e){return function(t,r,s){var a,u=n(t),c=o(u.length),l=i(s,c);if(e&&r!=r){for(;c>l;)if((a=u[l++])!=a)return!0}else for(;c>l;l++)if((e||l in u)&&u[l]===r)return e||l||0;return!e&&-1}}},{"./_to-absolute-index":111,"./_to-iobject":113,"./_to-length":114}],62:[function(e,t,r){var n=e("./_cof"),o=e("./_wks")("toStringTag"),i="Arguments"==n(function(){return arguments}());t.exports=function(e){var t,r,s;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),o))?r:i?n(t):"Object"==(s=n(t))&&"function"==typeof t.callee?"Arguments":s}},{"./_cof":63,"./_wks":120}],63:[function(e,t,r){var n={}.toString;t.exports=function(e){return n.call(e).slice(8,-1)}},{}],64:[function(e,t,r){var n=t.exports={version:"2.5.3"};"number"==typeof __e&&(__e=n)},{}],65:[function(e,t,r){"use strict";var n=e("./_object-dp"),o=e("./_property-desc");t.exports=function(e,t,r){t in e?n.f(e,t,o(0,r)):e[t]=r}},{"./_object-dp":93,"./_property-desc":104}],66:[function(e,t,r){var n=e("./_a-function");t.exports=function(e,t,r){if(n(e),void 0===t)return e;switch(r){case 1:return function(r){return e.call(t,r)};case 2:return function(r,n){return e.call(t,r,n)};case 3:return function(r,n,o){return e.call(t,r,n,o)}}return function(){return e.apply(t,arguments)}}},{"./_a-function":58}],67:[function(e,t,r){t.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},{}],68:[function(e,t,r){t.exports=!e("./_fails")(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},{"./_fails":73}],69:[function(e,t,r){var n=e("./_is-object"),o=e("./_global").document,i=n(o)&&n(o.createElement);t.exports=function(e){return i?o.createElement(e):{}}},{"./_global":74,"./_is-object":82}],70:[function(e,t,r){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},{}],71:[function(e,t,r){var n=e("./_object-keys"),o=e("./_object-gops"),i=e("./_object-pie");t.exports=function(e){var t=n(e),r=o.f;if(r)for(var s,a=r(e),u=i.f,c=0;a.length>c;)u.call(e,s=a[c++])&&t.push(s);return t}},{"./_object-gops":98,"./_object-keys":101,"./_object-pie":102}],72:[function(e,t,r){var n=e("./_global"),o=e("./_core"),i=e("./_ctx"),s=e("./_hide"),a="prototype",u=function(e,t,r){var c,l,h,f=e&u.F,d=e&u.G,p=e&u.S,_=e&u.P,v=e&u.B,m=e&u.W,y=d?o:o[t]||(o[t]={}),b=y[a],g=d?n:p?n[t]:(n[t]||{})[a];for(c in d&&(r=t),r)(l=!f&&g&&void 0!==g[c])&&c in y||(h=l?g[c]:r[c],y[c]=d&&"function"!=typeof g[c]?r[c]:v&&l?i(h,n):m&&g[c]==h?function(e){var t=function(t,r,n){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,r)}return new e(t,r,n)}return e.apply(this,arguments)};return t[a]=e[a],t}(h):_&&"function"==typeof h?i(Function.call,h):h,_&&((y.virtual||(y.virtual={}))[c]=h,e&u.R&&b&&!b[c]&&s(b,c,h)))};u.F=1,u.G=2,u.S=4,u.P=8,u.B=16,u.W=32,u.U=64,u.R=128,t.exports=u},{"./_core":64,"./_ctx":66,"./_global":74,"./_hide":76}],73:[function(e,t,r){t.exports=function(e){try{return!!e()}catch(e){return!0}}},{}],74:[function(e,t,r){var n=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},{}],75:[function(e,t,r){var n={}.hasOwnProperty;t.exports=function(e,t){return n.call(e,t)}},{}],76:[function(e,t,r){var n=e("./_object-dp"),o=e("./_property-desc");t.exports=e("./_descriptors")?function(e,t,r){return n.f(e,t,o(1,r))}:function(e,t,r){return e[t]=r,e}},{"./_descriptors":68,"./_object-dp":93,"./_property-desc":104}],77:[function(e,t,r){var n=e("./_global").document;t.exports=n&&n.documentElement},{"./_global":74}],78:[function(e,t,r){t.exports=!e("./_descriptors")&&!e("./_fails")(function(){return 7!=Object.defineProperty(e("./_dom-create")("div"),"a",{get:function(){return 7}}).a})},{"./_descriptors":68,"./_dom-create":69,"./_fails":73}],79:[function(e,t,r){var n=e("./_cof");t.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==n(e)?e.split(""):Object(e)}},{"./_cof":63}],80:[function(e,t,r){var n=e("./_iterators"),o=e("./_wks")("iterator"),i=Array.prototype;t.exports=function(e){return void 0!==e&&(n.Array===e||i[o]===e)}},{"./_iterators":88,"./_wks":120}],81:[function(e,t,r){var n=e("./_cof");t.exports=Array.isArray||function(e){return"Array"==n(e)}},{"./_cof":63}],82:[function(e,t,r){t.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},{}],83:[function(e,t,r){var n=e("./_an-object");t.exports=function(e,t,r,o){try{return o?t(n(r)[0],r[1]):t(r)}catch(t){var i=e.return;throw void 0!==i&&n(i.call(e)),t}}},{"./_an-object":60}],84:[function(e,t,r){"use strict";var n=e("./_object-create"),o=e("./_property-desc"),i=e("./_set-to-string-tag"),s={};e("./_hide")(s,e("./_wks")("iterator"),function(){return this}),t.exports=function(e,t,r){e.prototype=n(s,{next:o(1,r)}),i(e,t+" Iterator")}},{"./_hide":76,"./_object-create":92,"./_property-desc":104,"./_set-to-string-tag":107,"./_wks":120}],85:[function(e,t,r){"use strict";var n=e("./_library"),o=e("./_export"),i=e("./_redefine"),s=e("./_hide"),a=e("./_has"),u=e("./_iterators"),c=e("./_iter-create"),l=e("./_set-to-string-tag"),h=e("./_object-gpo"),f=e("./_wks")("iterator"),d=!([].keys&&"next"in[].keys()),p="values",_=function(){return this};t.exports=function(e,t,r,v,m,y,b){c(r,t,v);var g,w,k,j=function(e){if(!d&&e in S)return S[e];switch(e){case"keys":case p:return function(){return new r(this,e)}}return function(){return new r(this,e)}},x=t+" Iterator",E=m==p,O=!1,S=e.prototype,C=S[f]||S["@@iterator"]||m&&S[m],T=!d&&C||j(m),N=m?E?j("entries"):T:void 0,M="Array"==t&&S.entries||C;if(M&&(k=h(M.call(new e)))!==Object.prototype&&k.next&&(l(k,x,!0),n||a(k,f)||s(k,f,_)),E&&C&&C.name!==p&&(O=!0,T=function(){return C.call(this)}),n&&!b||!d&&!O&&S[f]||s(S,f,T),u[t]=T,u[x]=_,m)if(g={values:E?T:j(p),keys:y?T:j("keys"),entries:N},b)for(w in g)w in S||i(S,w,g[w]);else o(o.P+o.F*(d||O),t,g);return g}},{"./_export":72,"./_has":75,"./_hide":76,"./_iter-create":84,"./_iterators":88,"./_library":89,"./_object-gpo":99,"./_redefine":105,"./_set-to-string-tag":107,"./_wks":120}],86:[function(e,t,r){var n=e("./_wks")("iterator"),o=!1;try{var i=[7][n]();i.return=function(){o=!0},Array.from(i,function(){throw 2})}catch(e){}t.exports=function(e,t){if(!t&&!o)return!1;var r=!1;try{var i=[7],s=i[n]();s.next=function(){return{done:r=!0}},i[n]=function(){return s},e(i)}catch(e){}return r}},{"./_wks":120}],87:[function(e,t,r){t.exports=function(e,t){return{value:t,done:!!e}}},{}],88:[function(e,t,r){t.exports={}},{}],89:[function(e,t,r){t.exports=!0},{}],90:[function(e,t,r){var n=e("./_uid")("meta"),o=e("./_is-object"),i=e("./_has"),s=e("./_object-dp").f,a=0,u=Object.isExtensible||function(){return!0},c=!e("./_fails")(function(){return u(Object.preventExtensions({}))}),l=function(e){s(e,n,{value:{i:"O"+ ++a,w:{}}})},h=t.exports={KEY:n,NEED:!1,fastKey:function(e,t){if(!o(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!i(e,n)){if(!u(e))return"F";if(!t)return"E";l(e)}return e[n].i},getWeak:function(e,t){if(!i(e,n)){if(!u(e))return!0;if(!t)return!1;l(e)}return e[n].w},onFreeze:function(e){return c&&h.NEED&&u(e)&&!i(e,n)&&l(e),e}}},{"./_fails":73,"./_has":75,"./_is-object":82,"./_object-dp":93,"./_uid":117}],91:[function(e,t,r){"use strict";var n=e("./_object-keys"),o=e("./_object-gops"),i=e("./_object-pie"),s=e("./_to-object"),a=e("./_iobject"),u=Object.assign;t.exports=!u||e("./_fails")(function(){var e={},t={},r=Symbol(),n="abcdefghijklmnopqrst";return e[r]=7,n.split("").forEach(function(e){t[e]=e}),7!=u({},e)[r]||Object.keys(u({},t)).join("")!=n})?function(e,t){for(var r=s(e),u=arguments.length,c=1,l=o.f,h=i.f;u>c;)for(var f,d=a(arguments[c++]),p=l?n(d).concat(l(d)):n(d),_=p.length,v=0;_>v;)h.call(d,f=p[v++])&&(r[f]=d[f]);return r}:u},{"./_fails":73,"./_iobject":79,"./_object-gops":98,"./_object-keys":101,"./_object-pie":102,"./_to-object":115}],92:[function(e,t,r){var n=e("./_an-object"),o=e("./_object-dps"),i=e("./_enum-bug-keys"),s=e("./_shared-key")("IE_PROTO"),a=function(){},u="prototype",c=function(){var t,r=e("./_dom-create")("iframe"),n=i.length;for(r.style.display="none",e("./_html").appendChild(r),r.src="javascript:",(t=r.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),c=t.F;n--;)delete c[u][i[n]];return c()};t.exports=Object.create||function(e,t){var r;return null!==e?(a[u]=n(e),r=new a,a[u]=null,r[s]=e):r=c(),void 0===t?r:o(r,t)}},{"./_an-object":60,"./_dom-create":69,"./_enum-bug-keys":70,"./_html":77,"./_object-dps":94,"./_shared-key":108}],93:[function(e,t,r){var n=e("./_an-object"),o=e("./_ie8-dom-define"),i=e("./_to-primitive"),s=Object.defineProperty;r.f=e("./_descriptors")?Object.defineProperty:function(e,t,r){if(n(e),t=i(t,!0),n(r),o)try{return s(e,t,r)}catch(e){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(e[t]=r.value),e}},{"./_an-object":60,"./_descriptors":68,"./_ie8-dom-define":78,"./_to-primitive":116}],94:[function(e,t,r){var n=e("./_object-dp"),o=e("./_an-object"),i=e("./_object-keys");t.exports=e("./_descriptors")?Object.defineProperties:function(e,t){o(e);for(var r,s=i(t),a=s.length,u=0;a>u;)n.f(e,r=s[u++],t[r]);return e}},{"./_an-object":60,"./_descriptors":68,"./_object-dp":93,"./_object-keys":101}],95:[function(e,t,r){var n=e("./_object-pie"),o=e("./_property-desc"),i=e("./_to-iobject"),s=e("./_to-primitive"),a=e("./_has"),u=e("./_ie8-dom-define"),c=Object.getOwnPropertyDescriptor;r.f=e("./_descriptors")?c:function(e,t){if(e=i(e),t=s(t,!0),u)try{return c(e,t)}catch(e){}if(a(e,t))return o(!n.f.call(e,t),e[t])}},{"./_descriptors":68,"./_has":75,"./_ie8-dom-define":78,"./_object-pie":102,"./_property-desc":104,"./_to-iobject":113,"./_to-primitive":116}],96:[function(e,t,r){var n=e("./_to-iobject"),o=e("./_object-gopn").f,i={}.toString,s="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(e){return s&&"[object Window]"==i.call(e)?function(e){try{return o(e)}catch(e){return s.slice()}}(e):o(n(e))}},{"./_object-gopn":97,"./_to-iobject":113}],97:[function(e,t,r){var n=e("./_object-keys-internal"),o=e("./_enum-bug-keys").concat("length","prototype");r.f=Object.getOwnPropertyNames||function(e){return n(e,o)}},{"./_enum-bug-keys":70,"./_object-keys-internal":100}],98:[function(e,t,r){r.f=Object.getOwnPropertySymbols},{}],99:[function(e,t,r){var n=e("./_has"),o=e("./_to-object"),i=e("./_shared-key")("IE_PROTO"),s=Object.prototype;t.exports=Object.getPrototypeOf||function(e){return e=o(e),n(e,i)?e[i]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?s:null}},{"./_has":75,"./_shared-key":108,"./_to-object":115}],100:[function(e,t,r){var n=e("./_has"),o=e("./_to-iobject"),i=e("./_array-includes")(!1),s=e("./_shared-key")("IE_PROTO");t.exports=function(e,t){var r,a=o(e),u=0,c=[];for(r in a)r!=s&&n(a,r)&&c.push(r);for(;t.length>u;)n(a,r=t[u++])&&(~i(c,r)||c.push(r));return c}},{"./_array-includes":61,"./_has":75,"./_shared-key":108,"./_to-iobject":113}],101:[function(e,t,r){var n=e("./_object-keys-internal"),o=e("./_enum-bug-keys");t.exports=Object.keys||function(e){return n(e,o)}},{"./_enum-bug-keys":70,"./_object-keys-internal":100}],102:[function(e,t,r){r.f={}.propertyIsEnumerable},{}],103:[function(e,t,r){var n=e("./_export"),o=e("./_core"),i=e("./_fails");t.exports=function(e,t){var r=(o.Object||{})[e]||Object[e],s={};s[e]=t(r),n(n.S+n.F*i(function(){r(1)}),"Object",s)}},{"./_core":64,"./_export":72,"./_fails":73}],104:[function(e,t,r){t.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},{}],105:[function(e,t,r){t.exports=e("./_hide")},{"./_hide":76}],106:[function(e,t,r){var n=e("./_is-object"),o=e("./_an-object"),i=function(e,t){if(o(e),!n(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,r,n){try{(n=e("./_ctx")(Function.call,e("./_object-gopd").f(Object.prototype,"__proto__").set,2))(t,[]),r=!(t instanceof Array)}catch(e){r=!0}return function(e,t){return i(e,t),r?e.__proto__=t:n(e,t),e}}({},!1):void 0),check:i}},{"./_an-object":60,"./_ctx":66,"./_is-object":82,"./_object-gopd":95}],107:[function(e,t,r){var n=e("./_object-dp").f,o=e("./_has"),i=e("./_wks")("toStringTag");t.exports=function(e,t,r){e&&!o(e=r?e:e.prototype,i)&&n(e,i,{configurable:!0,value:t})}},{"./_has":75,"./_object-dp":93,"./_wks":120}],108:[function(e,t,r){var n=e("./_shared")("keys"),o=e("./_uid");t.exports=function(e){return n[e]||(n[e]=o(e))}},{"./_shared":109,"./_uid":117}],109:[function(e,t,r){var n=e("./_global"),o="__core-js_shared__",i=n[o]||(n[o]={});t.exports=function(e){return i[e]||(i[e]={})}},{"./_global":74}],110:[function(e,t,r){var n=e("./_to-integer"),o=e("./_defined");t.exports=function(e){return function(t,r){var i,s,a=String(o(t)),u=n(r),c=a.length;return u<0||u>=c?e?"":void 0:(i=a.charCodeAt(u))<55296||i>56319||u+1===c||(s=a.charCodeAt(u+1))<56320||s>57343?e?a.charAt(u):i:e?a.slice(u,u+2):s-56320+(i-55296<<10)+65536}}},{"./_defined":67,"./_to-integer":112}],111:[function(e,t,r){var n=e("./_to-integer"),o=Math.max,i=Math.min;t.exports=function(e,t){return(e=n(e))<0?o(e+t,0):i(e,t)}},{"./_to-integer":112}],112:[function(e,t,r){var n=Math.ceil,o=Math.floor;t.exports=function(e){return isNaN(e=+e)?0:(e>0?o:n)(e)}},{}],113:[function(e,t,r){var n=e("./_iobject"),o=e("./_defined");t.exports=function(e){return n(o(e))}},{"./_defined":67,"./_iobject":79}],114:[function(e,t,r){var n=e("./_to-integer"),o=Math.min;t.exports=function(e){return e>0?o(n(e),9007199254740991):0}},{"./_to-integer":112}],115:[function(e,t,r){var n=e("./_defined");t.exports=function(e){return Object(n(e))}},{"./_defined":67}],116:[function(e,t,r){var n=e("./_is-object");t.exports=function(e,t){if(!n(e))return e;var r,o;if(t&&"function"==typeof(r=e.toString)&&!n(o=r.call(e)))return o;if("function"==typeof(r=e.valueOf)&&!n(o=r.call(e)))return o;if(!t&&"function"==typeof(r=e.toString)&&!n(o=r.call(e)))return o;throw TypeError("Can't convert object to primitive value")}},{"./_is-object":82}],117:[function(e,t,r){var n=0,o=Math.random();t.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+o).toString(36))}},{}],118:[function(e,t,r){var n=e("./_global"),o=e("./_core"),i=e("./_library"),s=e("./_wks-ext"),a=e("./_object-dp").f;t.exports=function(e){var t=o.Symbol||(o.Symbol=i?{}:n.Symbol||{});"_"==e.charAt(0)||e in t||a(t,e,{value:s.f(e)})}},{"./_core":64,"./_global":74,"./_library":89,"./_object-dp":93,"./_wks-ext":119}],119:[function(e,t,r){r.f=e("./_wks")},{"./_wks":120}],120:[function(e,t,r){var n=e("./_shared")("wks"),o=e("./_uid"),i=e("./_global").Symbol,s="function"==typeof i;(t.exports=function(e){return n[e]||(n[e]=s&&i[e]||(s?i:o)("Symbol."+e))}).store=n},{"./_global":74,"./_shared":109,"./_uid":117}],121:[function(e,t,r){var n=e("./_classof"),o=e("./_wks")("iterator"),i=e("./_iterators");t.exports=e("./_core").getIteratorMethod=function(e){if(null!=e)return e[o]||e["@@iterator"]||i[n(e)]}},{"./_classof":62,"./_core":64,"./_iterators":88,"./_wks":120}],122:[function(e,t,r){"use strict";var n=e("./_ctx"),o=e("./_export"),i=e("./_to-object"),s=e("./_iter-call"),a=e("./_is-array-iter"),u=e("./_to-length"),c=e("./_create-property"),l=e("./core.get-iterator-method");o(o.S+o.F*!e("./_iter-detect")(function(e){Array.from(e)}),"Array",{from:function(e){var t,r,o,h,f=i(e),d="function"==typeof this?this:Array,p=arguments.length,_=p>1?arguments[1]:void 0,v=void 0!==_,m=0,y=l(f);if(v&&(_=n(_,p>2?arguments[2]:void 0,2)),null==y||d==Array&&a(y))for(r=new d(t=u(f.length));t>m;m++)c(r,m,v?_(f[m],m):f[m]);else for(h=y.call(f),r=new d;!(o=h.next()).done;m++)c(r,m,v?s(h,_,[o.value,m],!0):o.value);return r.length=m,r}})},{"./_create-property":65,"./_ctx":66,"./_export":72,"./_is-array-iter":80,"./_iter-call":83,"./_iter-detect":86,"./_to-length":114,"./_to-object":115,"./core.get-iterator-method":121}],123:[function(e,t,r){"use strict";var n=e("./_add-to-unscopables"),o=e("./_iter-step"),i=e("./_iterators"),s=e("./_to-iobject");t.exports=e("./_iter-define")(Array,"Array",function(e,t){this._t=s(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,r=this._i++;return!e||r>=e.length?(this._t=void 0,o(1)):o(0,"keys"==t?r:"values"==t?e[r]:[r,e[r]])},"values"),i.Arguments=i.Array,n("keys"),n("values"),n("entries")},{"./_add-to-unscopables":59,"./_iter-define":85,"./_iter-step":87,"./_iterators":88,"./_to-iobject":113}],124:[function(e,t,r){var n=e("./_export");n(n.S+n.F,"Object",{assign:e("./_object-assign")})},{"./_export":72,"./_object-assign":91}],125:[function(e,t,r){var n=e("./_export");n(n.S,"Object",{create:e("./_object-create")})},{"./_export":72,"./_object-create":92}],126:[function(e,t,r){var n=e("./_export");n(n.S+n.F*!e("./_descriptors"),"Object",{defineProperty:e("./_object-dp").f})},{"./_descriptors":68,"./_export":72,"./_object-dp":93}],127:[function(e,t,r){var n=e("./_to-object"),o=e("./_object-gpo");e("./_object-sap")("getPrototypeOf",function(){return function(e){return o(n(e))}})},{"./_object-gpo":99,"./_object-sap":103,"./_to-object":115}],128:[function(e,t,r){var n=e("./_to-object"),o=e("./_object-keys");e("./_object-sap")("keys",function(){return function(e){return o(n(e))}})},{"./_object-keys":101,"./_object-sap":103,"./_to-object":115}],129:[function(e,t,r){var n=e("./_export");n(n.S,"Object",{setPrototypeOf:e("./_set-proto").set})},{"./_export":72,"./_set-proto":106}],130:[function(e,t,r){},{}],131:[function(e,t,r){"use strict";var n=e("./_string-at")(!0);e("./_iter-define")(String,"String",function(e){this._t=String(e),this._i=0},function(){var e,t=this._t,r=this._i;return r>=t.length?{value:void 0,done:!0}:(e=n(t,r),this._i+=e.length,{value:e,done:!1})})},{"./_iter-define":85,"./_string-at":110}],132:[function(e,t,r){"use strict";var n=e("./_global"),o=e("./_has"),i=e("./_descriptors"),s=e("./_export"),a=e("./_redefine"),u=e("./_meta").KEY,c=e("./_fails"),l=e("./_shared"),h=e("./_set-to-string-tag"),f=e("./_uid"),d=e("./_wks"),p=e("./_wks-ext"),_=e("./_wks-define"),v=e("./_enum-keys"),m=e("./_is-array"),y=e("./_an-object"),b=e("./_is-object"),g=e("./_to-iobject"),w=e("./_to-primitive"),k=e("./_property-desc"),j=e("./_object-create"),x=e("./_object-gopn-ext"),E=e("./_object-gopd"),O=e("./_object-dp"),S=e("./_object-keys"),C=E.f,T=O.f,N=x.f,M=n.Symbol,L=n.JSON,P=L&&L.stringify,A="prototype",H=d("_hidden"),R=d("toPrimitive"),B={}.propertyIsEnumerable,I=l("symbol-registry"),z=l("symbols"),q=l("op-symbols"),U=Object[A],D="function"==typeof M,F=n.QObject,G=!F||!F[A]||!F[A].findChild,W=i&&c(function(){return 7!=j(T({},"a",{get:function(){return T(this,"a",{value:7}).a}})).a})?function(e,t,r){var n=C(U,t);n&&delete U[t],T(e,t,r),n&&e!==U&&T(U,t,n)}:T,V=function(e){var t=z[e]=j(M[A]);return t._k=e,t},J=D&&"symbol"==typeof M.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof M},Q=function(e,t,r){return e===U&&Q(q,t,r),y(e),t=w(t,!0),y(r),o(z,t)?(r.enumerable?(o(e,H)&&e[H][t]&&(e[H][t]=!1),r=j(r,{enumerable:k(0,!1)})):(o(e,H)||T(e,H,k(1,{})),e[H][t]=!0),W(e,t,r)):T(e,t,r)},Y=function(e,t){y(e);for(var r,n=v(t=g(t)),o=0,i=n.length;i>o;)Q(e,r=n[o++],t[r]);return e},$=function(e){var t=B.call(this,e=w(e,!0));return!(this===U&&o(z,e)&&!o(q,e))&&(!(t||!o(this,e)||!o(z,e)||o(this,H)&&this[H][e])||t)},K=function(e,t){if(e=g(e),t=w(t,!0),e!==U||!o(z,t)||o(q,t)){var r=C(e,t);return!r||!o(z,t)||o(e,H)&&e[H][t]||(r.enumerable=!0),r}},X=function(e){for(var t,r=N(g(e)),n=[],i=0;r.length>i;)o(z,t=r[i++])||t==H||t==u||n.push(t);return n},Z=function(e){for(var t,r=e===U,n=N(r?q:g(e)),i=[],s=0;n.length>s;)!o(z,t=n[s++])||r&&!o(U,t)||i.push(z[t]);return i};D||(a((M=function(){if(this instanceof M)throw TypeError("Symbol is not a constructor!");var e=f(arguments.length>0?arguments[0]:void 0),t=function(r){this===U&&t.call(q,r),o(this,H)&&o(this[H],e)&&(this[H][e]=!1),W(this,e,k(1,r))};return i&&G&&W(U,e,{configurable:!0,set:t}),V(e)})[A],"toString",function(){return this._k}),E.f=K,O.f=Q,e("./_object-gopn").f=x.f=X,e("./_object-pie").f=$,e("./_object-gops").f=Z,i&&!e("./_library")&&a(U,"propertyIsEnumerable",$,!0),p.f=function(e){return V(d(e))}),s(s.G+s.W+s.F*!D,{Symbol:M});for(var ee="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),te=0;ee.length>te;)d(ee[te++]);for(var re=S(d.store),ne=0;re.length>ne;)_(re[ne++]);s(s.S+s.F*!D,"Symbol",{for:function(e){return o(I,e+="")?I[e]:I[e]=M(e)},keyFor:function(e){if(!J(e))throw TypeError(e+" is not a symbol!");for(var t in I)if(I[t]===e)return t},useSetter:function(){G=!0},useSimple:function(){G=!1}}),s(s.S+s.F*!D,"Object",{create:function(e,t){return void 0===t?j(e):Y(j(e),t)},defineProperty:Q,defineProperties:Y,getOwnPropertyDescriptor:K,getOwnPropertyNames:X,getOwnPropertySymbols:Z}),L&&s(s.S+s.F*(!D||c(function(){var e=M();return"[null]"!=P([e])||"{}"!=P({a:e})||"{}"!=P(Object(e))})),"JSON",{stringify:function(e){for(var t,r,n=[e],o=1;arguments.length>o;)n.push(arguments[o++]);if(r=t=n[1],(b(t)||void 0!==e)&&!J(e))return m(t)||(t=function(e,t){if("function"==typeof r&&(t=r.call(this,e,t)),!J(t))return t}),n[1]=t,P.apply(L,n)}}),M[A][R]||e("./_hide")(M[A],R,M[A].valueOf),h(M,"Symbol"),h(Math,"Math",!0),h(n.JSON,"JSON",!0)},{"./_an-object":60,"./_descriptors":68,"./_enum-keys":71,"./_export":72,"./_fails":73,"./_global":74,"./_has":75,"./_hide":76,"./_is-array":81,"./_is-object":82,"./_library":89,"./_meta":90,"./_object-create":92,"./_object-dp":93,"./_object-gopd":95,"./_object-gopn":97,"./_object-gopn-ext":96,"./_object-gops":98,"./_object-keys":101,"./_object-pie":102,"./_property-desc":104,"./_redefine":105,"./_set-to-string-tag":107,"./_shared":109,"./_to-iobject":113,"./_to-primitive":116,"./_uid":117,"./_wks":120,"./_wks-define":118,"./_wks-ext":119}],133:[function(e,t,r){e("./_wks-define")("asyncIterator")},{"./_wks-define":118}],134:[function(e,t,r){e("./_wks-define")("observable")},{"./_wks-define":118}],135:[function(e,t,r){e("./es6.array.iterator");for(var n=e("./_global"),o=e("./_hide"),i=e("./_iterators"),s=e("./_wks")("toStringTag"),a="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),u=0;u<a.length;u++){var c=a[u],l=n[c],h=l&&l.prototype;h&&!h[s]&&o(h,s,c),i[c]=i.Array}},{"./_global":74,"./_hide":76,"./_iterators":88,"./_wks":120,"./es6.array.iterator":123}],136:[function(e,t,r){"use strict";var n=function(e){return!(i=e,!i||"object"!=typeof i||(t=e,r=Object.prototype.toString.call(t),"[object RegExp]"===r||"[object Date]"===r||(n=t,n.$$typeof===o)));var t,r,n,i};var o="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function i(e,t){var r;return t&&!0===t.clone&&n(e)?a((r=e,Array.isArray(r)?[]:{}),e,t):e}function s(e,t,r){var o=e.slice();return t.forEach(function(t,s){void 0===o[s]?o[s]=i(t,r):n(t)?o[s]=a(e[s],t,r):-1===e.indexOf(t)&&o.push(i(t,r))}),o}function a(e,t,r){var o,u,c,l,h=Array.isArray(t);return h===Array.isArray(e)?h?((r||{arrayMerge:s}).arrayMerge||s)(e,t,r):(u=t,c=r,l={},n(o=e)&&Object.keys(o).forEach(function(e){l[e]=i(o[e],c)}),Object.keys(u).forEach(function(e){n(u[e])&&o[e]?l[e]=a(o[e],u[e],c):l[e]=i(u[e],c)}),l):i(t,r)}a.all=function(e,t){if(!Array.isArray(e)||e.length<2)throw new Error("first argument should be an array with at least two elements");return e.reduce(function(e,r){return a(e,r,t)})};var u=a;t.exports=u},{}],137:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=i(e("babel-runtime/core-js/object/assign")),o=i(e("babel-runtime/helpers/classCallCheck"));function i(e){return e&&e.__esModule?e:{default:e}}var s={debug:!1,automaticOpen:!0,reconnectOnError:!1,reconnectInterval:1e3,maxReconnectInterval:3e4,reconnectDecay:1.5,timeoutInterval:2e3,maxReconnectAttempts:null,randomRatio:3,binaryType:"blob",reconnectOnCleanClose:!1};r.default=function e(t){var r=this,i=arguments.length<=1||void 0===arguments[1]?[]:arguments[1],a=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];(0,o.default)(this,e),this.CONNECTING=0,this.OPEN=1,this.CLOSING=2,this.CLOSED=3,this.open=function(){var e=r._socket=new WebSocket(r._url,r._protocols);e.binaryType=r._options.binaryType,r._options.maxReconnectAttempts&&r._options.maxReconnectAttempts<r._reconnectAttempts||(r._syncState(),e.onmessage=r._onmessage.bind(r),e.onopen=r._onopen.bind(r),e.onclose=r._onclose.bind(r),e.onerror=r._onerror.bind(r))},this.send=function(e){r._socket&&r._socket.readyState===WebSocket.OPEN&&0===r._messageQueue.length?r._socket.send(e):r._messageQueue.push(e)},this.close=function(e,t){void 0===e&&(e=1e3),r._socket&&r._socket.close(e,t)},this._onmessage=function(e){r.onmessage&&r.onmessage(e)},this._onopen=function(e){r._syncState(),r._flushQueue(),r._reconnectAttempts=0,r.onopen&&r.onopen(e)},this._onclose=function(e){r._syncState(),r._debug("WebSocket: connection is broken",e),r.onclose&&r.onclose(e),r._tryReconnect(e)},this._onerror=function(e){r._socket.close(),r._debug("WebSocket: error",e),r.onerror&&r.onerror(e),r._options.reconnectOnError&&r._tryReconnect(e)},this._tryReconnect=function(e){e.wasClean&&!r._options.reconnectOnCleanClose||setTimeout(function(){r.readyState!==r.CLOSING&&r.readyState!==r.CLOSED||(r._reconnectAttempts++,r.open())},r._getTimeout())},this._flushQueue=function(){for(;0!==r._messageQueue.length;){var e=r._messageQueue.shift();r._socket.send(e)}},this._getTimeout=function(){var e,t,n=r._options.reconnectInterval*Math.pow(r._options.reconnectDecay,r._reconnectAttempts);return n=n>r._options.maxReconnectInterval?r._options.maxReconnectInterval:n,r._options.randomRatio?(e=n/r._options.randomRatio,t=n,Math.random()*(t-e)+e):n},this._syncState=function(){r.readyState=r._socket.readyState},this._url=t,this._protocols=i,this._options=(0,n.default)({},s,a),this._messageQueue=[],this._reconnectAttempts=0,this.readyState=this.CONNECTING,"function"==typeof this._options.debug?this._debug=this._options.debug:this._options.debug?this._debug=console.log.bind(console):this._debug=function(){},a.automaticOpen&&this.open()},t.exports=r.default},{"babel-runtime/core-js/object/assign":38,"babel-runtime/helpers/classCallCheck":46}],138:[function(e,t,r){"use strict";t.exports=function(e){return"object"==typeof e?function e(t,r){var n;n=Array.isArray(t)?[]:{};r.push(t);Object.keys(t).forEach(function(o){var i=t[o];"function"!=typeof i&&(i&&"object"==typeof i?-1!==r.indexOf(t[o])?n[o]="[Circular]":n[o]=e(t[o],r.slice(0)):n[o]=i)});"string"==typeof t.name&&(n.name=t.name);"string"==typeof t.message&&(n.message=t.message);"string"==typeof t.stack&&(n.stack=t.stack);return n}(e,[]):"function"==typeof e?"[Function: "+(e.name||"anonymous")+"]":e}},{}],139:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=u(e("babel-runtime/core-js/object/define-property")),o=function(){function e(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),(0,n.default)(e,o.key,o)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=u(e("@livelyvideo/utils/lib/createElement")),s=u(e("@livelyvideo/utils/lib/eventListener")),a=u(e("../utils/isBlurred"));function u(e){return e&&e.__esModule?e:{default:e}}var c=function(){function e(t,r,n,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.parent=t,this.chatBody=r,this.localize=n,this.options=o,this.closeFlyoutOnBlur=this.closeFlyoutOnBlur.bind(this),this.actionMuteHandler=this.actionMuteHandler.bind(this),this.actionIgnoreHandler=this.actionIgnoreHandler.bind(this),this.actionBanHandler=this.actionBanHandler.bind(this),this.actionModHandler=this.actionModHandler.bind(this),this.render(),this._blurEvent=(0,s.default)(document,"click",this.closeFlyoutOnBlur),this._blurEventTouch=(0,s.default)(document,"touchend",this.closeFlyoutOnBlur)}return o(e,[{key:"render",value:function(){var e=this.parent.getBoundingClientRect().y<215?"chat__actions-flyout--bounds":"";this.flyout=(0,i.default)({tagName:"div",className:"chat__actions-flyout "+e+" "+(this.options.modifierClass||"")}),this.parent.parentElement.appendChild(this.flyout);var t=(0,i.default)({tagName:"div",className:"chat__actions-flyout-username",text:this.options.username});if(this.flyout.appendChild(t),this.options.url){var r=(0,i.default)({tagName:"a",className:"chat__actions-flyout-button",text:this.localize("View"),attributes:{href:this.options.url}});this.flyout.appendChild(r)}(this.chatBody.isMod||this.chatBody.isAdmin)&&(this.muteButton=(0,i.default)({tagName:"button",className:"chat__actions-flyout-button",text:this.localize("Mute"),events:{click:this.actionMuteHandler}}),this.flyout.appendChild(this.muteButton),this.banButton=(0,i.default)({tagName:"button",className:"chat__actions-flyout-button",text:this.localize("Ban IP"),events:{click:this.actionBanHandler}}),this.flyout.appendChild(this.banButton),this.ignoreButton=(0,i.default)({tagName:"button",className:"chat__actions-flyout-button",text:this.localize("Ignore"),events:{click:this.actionIgnoreHandler}}),this.flyout.appendChild(this.ignoreButton)),this.chatBody.isAdmin&&(this.modButton=(0,i.default)({tagName:"button",className:"chat__actions-flyout-button",text:this.options.role?this.localize("Unmod"):this.localize("Mod"),events:{click:this.actionModHandler}}),this.flyout.appendChild(this.modButton))}},{key:"actionModHandler",value:function(){var e=this;this.modButton.textContent!==this.localize("Unmod")?this.chatBody.modActionHandler(this.options.username,function(){e.modButton.textContent=e.localize("Unmod")}):this.chatBody.unmodActionHandler(this.options.username,function(){e.modButton.textContent=e.localize("Mod")})}},{key:"actionMuteHandler",value:function(){this.muteButton.textContent!==this.localize("Unmute")?(this.chatBody.muteActionHandler(this.options.username),this.muteButton.textContent=this.localize("Unmute")):this.chatBody.unmuteActionHandler(this.options.username)}},{key:"actionIgnoreHandler",value:function(){this.ignoreButton.textContent!==this.localize("Unignore")?(this.chatBody.ignoreActionHandler(this.options.username),this.ignoreButton.textContent=this.localize("Unignore")):this.chatBody.unignoreActionHandler(this.options.username)}},{key:"actionBanHandler",value:function(){this.banButton.textContent!==this.localize("Unban IP")?(this.chatBody.banActionHandler(this.options.username),this.banButton.textContent=this.localize("Unban IP")):this.chatBody.unbanActionHandler(this.options.username)}},{key:"closeFlyoutOnBlur",value:function(e){(0,a.default)(e,this.flyout,this.parent)&&this.close()}},{key:"close",value:function(){this._blurEvent(),this._blurEventTouch(),this._closed=!0,this.flyout.parentElement.removeChild(this.flyout)}}]),e}();r.default=c,t.exports=r.default},{"../utils/isBlurred":152,"@livelyvideo/utils/lib/createElement":33,"@livelyvideo/utils/lib/eventListener":34,"babel-runtime/core-js/object/define-property":40}],140:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=l(e("babel-runtime/core-js/object/define-property")),o=l(e("babel-runtime/core-js/object/set-prototype-of")),i=l(e("babel-runtime/core-js/object/create")),s=l(e("babel-runtime/core-js/object/get-prototype-of")),a=function(){function e(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),(0,n.default)(e,o.key,o)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=l(e("@livelyvideo/utils/lib/createElement")),c=l(e("./chat-flyout"));function l(e){return e&&e.__esModule?e:{default:e}}var h=[{name:"rateLimitDuration",value:1,text:"1s"},{name:"rateLimitDuration",value:5,text:"5s"},{name:"rateLimitDuration",value:30,text:"30s"},{name:"rateLimitDuration",value:60,text:"1m"},{name:"rateLimitDuration",value:300,text:"5m"},{name:"rateLimitDuration",value:900,text:"15m"}],f=[{name:"rateLimitMax",value:1,text:"1 chat"},{name:"rateLimitMax",value:5,text:"5 chats"},{name:"rateLimitMax",value:10,text:"10 chats"}],d=[{name:"mode",value:"user",text:"Everyone"},{name:"mode",value:"moderator",text:"Moderators"},{name:"mode",value:"owner",text:"Owner"}],p=function(e){function t(e,r,n,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||(0,s.default)(t)).call(this,e,"admin",n("admin")));return i.parent=e,i.chat=r,i.localize=n,i.errorHandler=o,i.handleRadioChange=i.handleRadioChange.bind(i),i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=(0,i.default)(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(o.default?(0,o.default)(e,t):e.__proto__=t)}(t,c.default),a(t,[{key:"initUser",value:function(){this.chat._roomname&&this.chat._me&&("moderator"!==this.chat._me.room.role&&"owner"!==this.chat._me.room.role&&"admin"!==this.chat._me.room.role||(this.render(),this.enableFlyout()))}},{key:"render",value:function(){var e=(0,u.default)({tagName:"div",className:"chat__info chat__info--mode",text:this.localize("Chat Mode")});this.flyout.appendChild(e),this.radioRenderer(d);var t=(0,u.default)({tagName:"div",className:"chat__description chat__description--mode",text:this.localize("The current mode of the room specifying which users can chat")});this.flyout.appendChild(t);var r=(0,u.default)({tagName:"div",className:"chat__info",text:this.localize("Chat Rate Limit")});this.flyout.appendChild(r),this.radioRenderer(f),this.radioRenderer(h);var n=(0,u.default)({tagName:"div",className:"chat__description",text:this.localize("Maximum amount of chats during time period")});this.flyout.appendChild(n)}},{key:"radioRenderer",value:function(e){for(var t=[],r=0;r<e.length;r++){var n=(0,u.default)({tagName:"input",className:"chat__radio",attributes:{type:"radio",name:e[r].name,value:e[r].value,id:e[r].name+r},events:{change:this.handleRadioChange}});this.chat._room[e[r].name]===e[r].value&&(n.checked="checked"),t.push(n);var o=(0,u.default)({tagName:"label",className:"chat__radio-label chat__radio-label--"+e.length,text:this.localize(e[r].text),attributes:{for:e[r].name+r}});t.push(o)}var i=(0,u.default)({tagName:"div",className:"chat__radio-slider chat__radio-slider--"+e.length});t.push(i);var s=(0,u.default)({tagName:"div",className:"chat__radio-wrapper",childs:t}),a=(0,u.default)({tagName:"div",className:"chat__radio-container chat__radio-container--restricted chat__radio-container--"+e[0].name,childs:[s]});this.flyout.appendChild(a)}},{key:"handleRadioChange",value:function(e){var t=this,r={};r[e.target.name]=isNaN(e.target.value)?e.target.value:parseInt(e.target.value,10),this.chat.patchRoom(this.chat._roomname,r,function(e,r){e&&r&&r[0]&&t.errorHandler(e,r[0])})}}]),t}();r.default=p,t.exports=r.default},{"./chat-flyout":144,"@livelyvideo/utils/lib/createElement":33,"babel-runtime/core-js/object/create":39,"babel-runtime/core-js/object/define-property":40,"babel-runtime/core-js/object/get-prototype-of":41,"babel-runtime/core-js/object/set-prototype-of":43}],141:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=u(e("babel-runtime/core-js/object/define-property")),o=function(){function e(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),(0,n.default)(e,o.key,o)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=u(e("@livelyvideo/utils/lib/createElement")),s=u(e("@livelyvideo/utils/lib/eventListener")),a=u(e("./chat-actions-flyout"));function u(e){return e&&e.__esModule?e:{default:e}}var c=function(){function e(t,r,n,o,i){var a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.parent=t,this.chat=r,this.localize=n,this.errorHandler=o,this.options=i,this._chatLineQueue=[],this._currentChunk=this.buildChunkElement(),this._currentChunkSize=0,this._chunkView=[],this._chunkHistory=[],this._chunkStorage=[],this._scrollLocked=!0,this._scrollPaused=!1,this._scrollThrottleCount=0,this._scrollThrottleRate=100,this._scrollThrottleNewRate=!1,this.scrollToggle=this.scrollToggle.bind(this),this.scrollWheelHandler=this.scrollWheelHandler.bind(this),this.actionDelete=this.actionDelete.bind(this),this.actionMore=this.actionMore.bind(this),this.render(),this._queueProcess=setInterval(function(){a.queueProcessor()},100),setTimeout(function(){a._scrollThrottleCount=0,a._scrollThrottleInterval=setInterval(function(){a.scrollThrottleHandler()},2e3)},500),this._wheelListener1=(0,s.default)(this.chatBody,"DOMMouseScroll",this.scrollWheelHandler),this._wheelListener2=(0,s.default)(this.chatBody,"mousewheel",this.scrollWheelHandler),this._wheelListener3=(0,s.default)(this.chatBody,"wheel",this.scrollWheelHandler)}return o(e,[{key:"queueProcessor",value:function(){if(!this._scrollPaused){this._chatLineQueue.length&&this._scrollThrottleCount++;for(var e=document.createDocumentFragment();this._chatLineQueue.length&&this._currentChunkSize!==this.options.chunkSize;){var t=this._chatLineQueue.shift();e.appendChild(t),this._currentChunkSize++}if(this._currentChunk.appendChild(e),this._currentChunk.parentElement||this._chunkStorage.push(this._currentChunk),this._currentChunkSize===this.options.chunkSize&&(this._currentChunk=this.buildChunkElement(),this._currentChunksProcessed++,this._currentChunkSize=0),this._chatLineQueue.length)this.queueProcessor();else{for(var r=document.createDocumentFragment(),n=this._chunkStorage.splice(-Math.abs(this.options.chunkView));n.length;){var o=n.shift();r.appendChild(o),this._chunkView.push(o)}for(this.chatBody.appendChild(r);this._chunkView.length>this.options.chunkView;){var i=this._chunkView.shift();this.chatBody.removeChild(i),this._chunkHistory.unshift(i)}for(;this._chunkStorage.length;)this._chunkHistory.unshift(this._chunkStorage.shift());for(;this._chunkHistory>this.options.chunkHistory;)this._chunkHistory.shift();this.scrollBottom()}}}},{key:"scrollThrottleHandler",value:function(){var e=this;switch(this._scrollThrottleNewRate&&(this._scrollThrottleNewRate=!1,this._scrollThrottleCount++),this._scrollThrottleRate){case 100:this._scrollThrottleCount>=10&&(this._scrollThrottleRate=200,this._scrollThrottleNewRate=!0,clearInterval(this._queueProcess),this._queueProcess=setInterval(function(){e.queueProcessor()},this._scrollThrottleRate));break;case 200:this._scrollThrottleCount>=10?(this._scrollThrottleRate=250,this._scrollThrottleNewRate=!0,clearInterval(this._queueProcess),this._queueProcess=setInterval(function(){e.queueProcessor()},this._scrollThrottleRate)):this._scrollThrottleCount<5&&(this._scrollThrottleRate=100,this._scrollThrottleNewRate=!0,clearInterval(this._queueProcess),this._queueProcess=setInterval(function(){e.queueProcessor()},this._scrollThrottleRate));break;default:this._scrollThrottleCount<8&&(this._scrollThrottleRate=200,this._scrollThrottleNewRate=!0,clearInterval(this._queueProcess),this._queueProcess=setInterval(function(){e.queueProcessor()},this._scrollThrottleRate))}this._scrollThrottleCount=0}},{key:"processChat",value:function(e){if(!e.ignore){var t=this.buildLineElement(),r=this.writeChatToLine(t,e);this._chatLineQueue.push(r)}}},{key:"processMessage",value:function(e){var t=this.buildLineElement(),r=this.writeMessageToLine(t,e);this._chatLineQueue.push(r)}},{key:"render",value:function(){this.chatBody=(0,i.default)({tagName:"div",className:"chat__body"}),this.chatBodyContainer=(0,i.default)({tagName:"div",className:"chat__body-container",childs:[this.chatBody]}),this.chatBodyScrollButton=(0,i.default)({tagName:"div",className:"chat__body-scroll",events:{click:this.scrollToggle}}),this.parent.appendChild(this.chatBodyContainer),this.parent.appendChild(this.chatBodyScrollButton)}},{key:"buildChunkElement",value:function(){return this._chunkElement?this._chunkElement.cloneNode():(this._chunkElement=(0,i.default)({tagName:"div",className:"chat__chunk"}),this._chunkElement.cloneNode(!0))}},{key:"buildLineElement",value:function(){if(this._lineElement)return this._lineElement.cloneNode(!0);var e=[],t=(0,i.default)({tagName:"div",className:"chat__avatar"});e.push(t);var r=(0,i.default)({tagName:"span",className:"chat__line-role"});e.push(r);var n=(0,i.default)({tagName:"span",className:"chat__username"});e.push(n);var o=(0,i.default)({tagName:"span",className:"chat__line-timestamp"});e.push(o);var s=(0,i.default)({tagName:"div",className:"chat__line-content"});e.push(s);var a=(0,i.default)({tagName:"button",className:"chat__action chat__action--delete",attributes:{"data-tooltip":"Delete Chat"}});e.push(a);var u=(0,i.default)({tagName:"button",className:"chat__action chat__action--more",attributes:{"data-tooltip":"More Actions"}});return e.push(u),this._lineElement=(0,i.default)({tagName:"div",className:"chat__line",childs:e}),this._lineElement.cloneNode(!0)}},{key:"writeChatToLine",value:function(e,t){var r=e,n=r.childNodes;return n[0].setAttribute("style","background-color: "+t.actor.color+"; background-image: url("+t.actor.avatar+");"),n[1].className="chat__line-role chat__line-role--"+t.actor.role,n[1].textContent=t.actor.role,n[2].setAttribute("style","color: "+t.actor.color),n[2].textContent=t.actor.username,n[3].textContent=this.formatDate(t.timestamp),n[4].innerHTML=this.parseChatText(t),r.className="chat__line"+(t.actor.username===this.chat._username||void 0===this.chat._username?" chat__line--currentUser":""),r.setAttribute("data-username",t.actor.username),r.setAttribute("data-id",t.id),"moderator"===t.actor.role&&r.setAttribute("data-role",t.actor.role),t.url&&r.setAttribute("data-url",t.url),(0,s.default)(n[5],"click",this.actionDelete),(0,s.default)(n[6],"click",this.actionMore),r}},{key:"writeMessageToLine",value:function(e,t){var r=e,n=r.childNodes,o="";switch(t.level){case"warn":o="#EBC844";break;case"info":o="#1395BA";break;default:o="#D94E1F"}n[0].setAttribute("style","background-color: "+o+"; background-image: none;"),n[1].className="",n[1].textContent="",n[2].setAttribute("style","color: "+o),n[2].textContent=t.level,n[3].textContent="",n[4].innerHTML='<div class="chat__text">'+t.message+"</div>",r.className="chat__line chat__line--message chat__line--"+t.level;var i=function(e){e.parentElement.removeChild(e)}.bind(this,r);return(0,s.default)(n[5],"click",i),r}},{key:"formatDate",value:function(e){var t=new Date(1e3*e),r="0"+t.getMinutes(),n=t.getHours();return(n=(n%=12)||12)+":"+r.substr(-2)}},{key:"parseChatText",value:function(e){var t="<div class='chat__text'>",r=e.message,n=e.positions,o=0;for(var i in n){i=parseInt(i,10);var s=r.slice(o,i),a=r.slice(i,i+n[i].length);switch(o=i+n[i].length,s.length&&(t+=s),n[i].type){case"emoticon":this.chat&&this.chat._me&&this.chat._me.showGifs,t+="<span class='chat__line-emoticon-wrap' data-pattern='"+a+"'><img class='chat__line-emoticon' src='"+n[i].url+"'/></span>";break;case"mention":t+="<a class='"+(this.chat._username===n[i].username?"chat__line-mention chat__line-mention--me":"chat__line-mention")+"' href='/"+n[i].url+"' target='_blank'>"+a+"</a>";break;case"tag":t+="<a class='chat__line-tag' href='/tag/"+n[i].text+"' target='_blank'>"+a+"</a>";break;default:t+="<a class='chat__line-link' href='"+n[i].href+"' target='_blank'>"+a+"</a>"}}return o<r.length&&(t+=r.slice(o)),t+="</div>"}},{key:"scrollToggle",value:function(){if(this._scrollPaused)return this._scrollPaused=!1,void this.chatBodyScrollButton.classList.remove("chat__body-scroll--paused");this._scrollPaused=!0,this.chatBodyScrollButton.classList.add("chat__body-scroll--paused")}},{key:"scrollBottom",value:function(){this.chatBody.scrollTop=this.chatBody.scrollHeight}},{key:"scrollWheelHandler",value:function(e){if(this.preventSrollHandler(),this.chatBody.scrollTop<=0&&this._scrollPaused&&this._chunkHistory.length){var t=this._chunkHistory.shift();return this.chatBody.insertBefore(t,this.chatBody.firstChild),void this._chunkView.unshift(t)}Math.abs(this.chatBody.scrollTop-(this.chatBody.scrollHeight-this.chatBody.offsetHeight))<=5?this._scrollPaused&&this.scrollToggle():this._scrollPaused||this.scrollToggle()}},{key:"preventSrollHandler",value:function(){var e=this;if(this.options.preventScroll&&this.options.preventScroll.length){for(var t=0;t<this.options.preventScroll.length;t++){var r=this.options.preventScroll[t];switch(r){case"body":document.body.style.overflow="hidden",document.body.style.height="100vh";break;case"html":document.documentElement.style.overflow="hidden",document.documentElement.style.height="100vh";break;default:var n=document.querySelector(r);n?(n.style.overflow="hidden",n.style.height="100vh"):console.warn("Invalid preventScroll element")}}this._preventScrollTimeout&&clearTimeout(this._preventScrollTimeout),this._preventScrollTimeout=setTimeout(function(){for(var t=0;t<e.options.preventScroll.length;t++){var r=e.options.preventScroll[t];switch(r){case"body":document.body.style.overflow="",document.body.style.height="";break;case"html":document.documentElement.style.overflow="",document.documentElement.style.height="";break;default:var n=document.querySelector(r);n&&(n.style.overflow="",n.style.height="")}}},50)}}},{key:"actionDelete",value:function(e){var t=e.target.parentElement.getAttribute("data-id");this.chat.command("/delete "+t)}},{key:"actionMore",value:function(e){var t={username:e.target.parentElement.getAttribute("data-username"),id:e.target.parentElement.getAttribute("data-id"),url:e.target.parentElement.getAttribute("data-url"),role:e.target.parentElement.getAttribute("data-role")};if(this.flyout&&!this.flyout._closed&&t.id===this.flyout.options.id)return this.flyout.close(),void(this.flyout=!1);this.flyout=new a.default(e.target,this,this.localize,t)}},{key:"modActionHandler",value:function(e,t){var r=this;this.chat.command("/mod "+e,function(e,n){e?r.errorHandler(e,n[0]):(n&&n[0],t&&t())})}},{key:"unmodActionHandler",value:function(e,t){var r=this;this.chat.command("/unmod "+e,function(e,n){e?r.errorHandler(e,n[0]):(n&&n[0],t&&t())})}},{key:"muteActionHandler",value:function(e,t){var r=this;this.chat.command("/mute "+e,function(e,n){e?r.errorHandler(e,n[0]):(n&&n[0],t&&t())}),this.deleteByUsername(e)}},{key:"unmuteActionHandler",value:function(e,t){var r=this;this.chat.command("/unmute "+e,function(e,n){e?r.errorHandler(e,n[0]):(n&&n[0],t&&t())})}},{key:"ignoreActionHandler",value:function(e,t){var r=this;this.chat.command("/ignore "+e,function(e,n){e?r.errorHandler(e,n[0]):(n&&n[0],t&&t())}),this.deleteByUsername(e,!0)}},{key:"unignoreActionHandler",value:function(e,t){var r=this;this.chat.command("/unignore "+e,function(e,n){e?r.errorHandler(e,n[0]):(n&&n[0],t&&t())})}},{key:"banActionHandler",value:function(e,t){var r=this;this.chat.command("/ban "+e,function(e,n){e?r.errorHandler(e,n[0]):(n&&n[0],t&&t())}),this.deleteByUsername(e)}},{key:"unbanActionHandler",value:function(e,t){var r=this;this.chat.command("/unban "+e,function(e,n){e?r.errorHandler(e,n[0]):(n&&n[0],t&&t())})}},{key:"deleteById",value:function(e){for(var t=0;t<this._chunkView.length;t++)for(var r=this._chunkView[t].childNodes,n=0;n<r.length;n++)if(r[n].getAttribute("data-id")===e){if(this.isMod||this.isAdmin)return void r[n].classList.add("chat__line--removed");r[n].parentElement.removeChild(r[n])}}},{key:"deleteByUsername",value:function(e,t){for(var r=0;r<this._chunkView.length;r++)for(var n=this._chunkView[r].childNodes,o=0;o<n.length;o++)if(n[o].getAttribute("data-username")===e){if(t)return void n[o].parentElement.removeChild(n[o]);this.actionDelete(n[o].getAttribute("data-id"))}}},{key:"destroy",value:function(){this._wheelListener1(),this._wheelListener2(),this._wheelListener3()}},{key:"isMod",get:function(){return!!(this.chat._me&&this.chat._me.room&&this.chat._me.room.role)&&"moderator"===this.chat._me.room.role}},{key:"isAdmin",get:function(){return!!(this.chat._me&&this.chat._me.room&&this.chat._me.room.role)&&("owner"===this.chat._me.room.role||"admin"===this.chat._me.room.role)}}]),e}();r.default=c,t.exports=r.default},{"./chat-actions-flyout":139,"@livelyvideo/utils/lib/createElement":33,"@livelyvideo/utils/lib/eventListener":34,"babel-runtime/core-js/object/define-property":40}],142:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=s(e("babel-runtime/core-js/object/define-property")),o=function(){function e(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),(0,n.default)(e,o.key,o)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=s(e("@livelyvideo/utils/lib/createElement"));function s(e){return e&&e.__esModule?e:{default:e}}var a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.parent=t,this.render()}return o(e,[{key:"render",value:function(){this.el=(0,i.default)({tagName:"div",className:"chat__controls"}),this.parent.appendChild(this.el)}}]),e}();r.default=a,t.exports=r.default},{"@livelyvideo/utils/lib/createElement":33,"babel-runtime/core-js/object/define-property":40}],143:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=h(e("babel-runtime/core-js/object/define-property")),o=h(e("babel-runtime/core-js/object/set-prototype-of")),i=h(e("babel-runtime/core-js/object/create")),s=h(e("babel-runtime/core-js/object/keys")),a=h(e("babel-runtime/core-js/object/get-prototype-of")),u=function(){function e(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),(0,n.default)(e,o.key,o)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),c=h(e("@livelyvideo/utils/lib/createElement")),l=h(e("./chat-flyout"));function h(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e,r,n,o,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var s=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||(0,a.default)(t)).call(this,e,"emoticons",o("emoticons")));return s.parent=e,s.chat=r,s.chatInput=n,s.localize=o,s.errorHandler=i,s}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=(0,i.default)(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(o.default?(0,o.default)(e,t):e.__proto__=t)}(t,l.default),u(t,[{key:"initUser",value:function(){this.enableFlyout()}},{key:"getEmoticons",value:function(){var e=this;this.chat.getAllEmoticons(this.chat._roomname,this.chat._username,function(t,r){t&&e.errorHandler(t,e.localize("Chat Error")),e.emoticons=r.emoticons,e.render()})}},{key:"firstToggleHandler",value:function(){this.getEmoticons()}},{key:"render",value:function(){var e=this;(0,s.default)(this.emoticons).map(function(t){var r=e.emoticons[t],n=(0,c.default)({tagName:"button",className:"chat__emoticon-selector",attributes:{style:"background-image: url("+r.source+")",title:r.pattern}}),o=(0,c.default)({tagName:"span",className:"chat__emoticon-selector-container",childs:[n]}),i=e.selectEmoticon.bind(e,r.pattern);return o.addEventListener("click",i),e.flyout.appendChild(o)}),this.parent.appendChild(this.flyout);var t=(0,c.default)({tagName:"a",className:"chat__attribution-link",text:"EmojiOne",attributes:{href:"http://emojione.com"}}),r=(0,c.default)({tagName:"div",className:"chat__attribution",text:"Emoji provided free by ",childs:[t]});this.flyout.appendChild(r)}},{key:"selectEmoticon",value:function(e){this.chatInput.chatInput.value=""+this.chatInput.chatInput.value+e+" ",this.chatInput.chatInput.focus(),this.toggleFlyout()}}]),t}();r.default=f,t.exports=r.default},{"./chat-flyout":144,"@livelyvideo/utils/lib/createElement":33,"babel-runtime/core-js/object/create":39,"babel-runtime/core-js/object/define-property":40,"babel-runtime/core-js/object/get-prototype-of":41,"babel-runtime/core-js/object/keys":42,"babel-runtime/core-js/object/set-prototype-of":43}],144:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=u(e("babel-runtime/core-js/object/define-property")),o=function(){function e(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),(0,n.default)(e,o.key,o)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=u(e("@livelyvideo/utils/lib/createElement")),s=u(e("@livelyvideo/utils/lib/eventListener")),a=u(e("../utils/isBlurred"));function u(e){return e&&e.__esModule?e:{default:e}}var c=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.parent=t,this.flyoutClassModifier=r,this.tooltipText=n,this._firstToggle=!0,this._toggleState=!1,this.toggleFlyout=this.toggleFlyout.bind(this),this.closeFlyoutOnBlur=this.closeFlyoutOnBlur.bind(this),this.flyoutRender()}return o(e,[{key:"flyoutRender",value:function(){var e=(0,i.default)({tagName:"span",className:"chat__tooltip chat__tooltip--"+this.flyoutClassModifier,text:this.tooltipText});this.flyoutButton=(0,i.default)({tagName:"button",className:"chat__flyout-button chat__flyout-button--"+this.flyoutClassModifier+" chat__flyout-button--disabled",childs:[e]}),this.parent.appendChild(this.flyoutButton),this.flyout=(0,i.default)({tagName:"div",className:"chat__flyout chat__flyout--"+this.flyoutClassModifier}),this.parent.parentElement.appendChild(this.flyout)}},{key:"enableFlyout",value:function(){this.flyoutButton.classList.remove("chat__flyout-button--disabled"),(0,s.default)(this.flyoutButton,"click",this.toggleFlyout)}},{key:"closeFlyoutOnBlur",value:function(e){(0,a.default)(e,this.flyout,this.flyoutButton)&&(this._blurEvent(),this._blurEventTouch(),this._blurEvent=null,this.flyout.classList.remove("chat__flyout--visible"))}},{key:"toggleFlyout",value:function(){this._firstToggle&&this.firstToggleHandler&&(this._firstToggle=!1,this.firstToggleHandler()),this.toggleStateHandler&&(this.toggleStateHandler(this._toggleState),this._toggleState=!this._toggleState),this.flyout.classList.toggle("chat__flyout--visible"),this._blurEvent||(this._blurEvent=(0,s.default)(document,"click",this.closeFlyoutOnBlur),this._blurEventTouch=(0,s.default)(document,"touchend",this.closeFlyoutOnBlur))}}]),e}();r.default=c,t.exports=r.default},{"../utils/isBlurred":152,"@livelyvideo/utils/lib/createElement":33,"@livelyvideo/utils/lib/eventListener":34,"babel-runtime/core-js/object/define-property":40}],145:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=s(e("babel-runtime/core-js/object/define-property")),o=function(){function e(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),(0,n.default)(e,o.key,o)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=s(e("@livelyvideo/utils/lib/createElement"));function s(e){return e&&e.__esModule?e:{default:e}}var a=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.parent=t,this.chat=r,this.render()}return o(e,[{key:"initRoom",value:function(e){this.chatHeaderTitle.textContent=e}},{key:"render",value:function(){this.chatHeaderTitle=(0,i.default)({tagName:"h1",className:"chat__header-title"}),this.el=(0,i.default)({tagName:"div",className:"chat__header",childs:[this.chatHeaderTitle]}),this.parent.appendChild(this.el)}}]),e}();r.default=a,t.exports=r.default},{"@livelyvideo/utils/lib/createElement":33,"babel-runtime/core-js/object/define-property":40}],146:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=s(e("babel-runtime/core-js/object/define-property")),o=function(){function e(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),(0,n.default)(e,o.key,o)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=s(e("@livelyvideo/utils/lib/createElement"));function s(e){return e&&e.__esModule?e:{default:e}}var a=function(){function e(t,r,n,o,i,s){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.parent=t,this.chat=r,this.chatBody=n,this.localize=o,this.errorHandler=i,this.sendMiddleware=s&&s.sendMiddleware,this.send=this.send.bind(this),this.render()}return o(e,[{key:"initUser",value:function(){this.chatInput.classList.remove("chat__input--disabled"),this.chatInput.removeAttribute("disabled"),this.chatInput.setAttribute("placeholder",this.localize("Send message")),this.chatSend.classList.remove("chat__input-send--disabled"),this.chatSend.removeAttribute("disabled")}},{key:"render",value:function(){var e=this;this.chatInput=(0,i.default)({tagName:"input",className:"chat__input chat__input--disabled",attributes:{placeholder:this.localize("Login to chat"),disabled:"disabled"}});var t=(0,i.default)({tagName:"span",className:"chat__tooltip chat__tooltip--send",text:this.localize("send")});this.chatSend=(0,i.default)({tagName:"button",className:"chat__flyout-button chat__input-send chat__input-send--disabled",attributes:{disabled:"disabled"},events:{click:this.send},childs:[t]}),this.chatInputWrapper=(0,i.default)({tagName:"div",className:"chat__input-wrapper",childs:[this.chatInput,this.chatSend]}),this.chatInput.addEventListener("keyup",function(t){t.preventDefault(),13===t.keyCode&&e.send()}),this.parent.appendChild(this.chatInputWrapper)}},{key:"send",value:function(){var e=this,t=this.chatInput.value;if(null===t.match(/^\s+$/)){if(t){this.chatInput.value="";var r=function(){e.chat.command(t,function(t,r){if(t)throw t;if(r&&r.length)for(var n=0;n<r.length;n++){if(r[n].data&&r[n].data.help){for(var o in r[n].data.help){var i=r[n].data.help[o];e.chatBody.processMessage({level:"info",message:"/"+i.name+" "+i.text})}return}e.chatBody.processMessage(r[n])}})};if(this.sendMiddleware)return void this.sendMiddleware(t,r);r()}}else this.chatInput.value=""}}]),e}();r.default=a,t.exports=r.default},{"@livelyvideo/utils/lib/createElement":33,"babel-runtime/core-js/object/define-property":40}],147:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=l(e("babel-runtime/core-js/object/define-property")),o=l(e("babel-runtime/core-js/object/set-prototype-of")),i=l(e("babel-runtime/core-js/object/create")),s=l(e("babel-runtime/core-js/object/get-prototype-of")),a=function(){function e(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),(0,n.default)(e,o.key,o)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=l(e("@livelyvideo/utils/lib/createElement")),c=l(e("./chat-flyout"));function l(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(e,r,n,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||(0,s.default)(t)).call(this,e,"options",n("options")));return i.parent=e,i.chat=r,i.localize=n,i.errorHandler=o,i.showGifsHandler=i.showGifsHandler.bind(i),i.showTimestampsHandler=i.showTimestampsHandler.bind(i),i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=(0,i.default)(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(o.default?(0,o.default)(e,t):e.__proto__=t)}(t,c.default),a(t,[{key:"initUser",value:function(){this.enableFlyout(),this.renderOptions()}},{key:"renderOptions",value:function(){var e=(0,u.default)({tagName:"div",className:"chat__options-switch-slider"}),t=(0,u.default)({tagName:"div",className:"chat__options-switch-name",text:this.localize("Show Animated Gifs")}),r=(0,u.default)({tagName:"input",className:"chat__options-switch-checkbox",attributes:{type:"checkbox",id:"showGifs"},events:{change:this.showGifsHandler}});this.chat._me.showGifs&&(r.checked=!0);var n=(0,u.default)({tagName:"label",className:"chat__options-switch",childs:[e],attributes:{for:"showGifs"}}),o=(0,u.default)({tagName:"div",className:"chat__options-switch-container",childs:[r,n,t]}),i=(0,u.default)({tagName:"div",className:"chat__options-switch-slider"}),s=(0,u.default)({tagName:"div",className:"chat__options-switch-name",text:this.localize("Show Timestamps")}),a=(0,u.default)({tagName:"input",className:"chat__options-switch-checkbox",attributes:{type:"checkbox",id:"showTimestamps"},events:{change:this.showTimestampsHandler}});this.chat._me.showTimestamps&&(a.checked=!0);var c=(0,u.default)({tagName:"label",className:"chat__options-switch",childs:[i],attributes:{for:"showTimestamps"}}),l=(0,u.default)({tagName:"div",className:"chat__options-switch-container",childs:[a,c,s]});this.flyout.appendChild(l),this.flyout.appendChild(o)}},{key:"showGifsHandler",value:function(e){var t=this,r={};r.showGifs=e.target.checked,this.chat.patchUser(this.chat._username,r,function(e,r){e&&r&&t.errorHandler(e,r[0])})}},{key:"showTimestampsHandler",value:function(e){var t=this,r={};r.showTimestamps=e.target.checked,this.chat.patchUser(this.chat._username,r,function(e,r){e&&r&&t.errorHandler(e,r[0])})}}]),t}();r.default=h,t.exports=r.default},{"./chat-flyout":144,"@livelyvideo/utils/lib/createElement":33,"babel-runtime/core-js/object/create":39,"babel-runtime/core-js/object/define-property":40,"babel-runtime/core-js/object/get-prototype-of":41,"babel-runtime/core-js/object/set-prototype-of":43}],148:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=s(e("babel-runtime/core-js/object/define-property")),o=function(){function e(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),(0,n.default)(e,o.key,o)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=s(e("@livelyvideo/utils/lib/createElement"));function s(e){return e&&e.__esModule?e:{default:e}}var a=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.parent=t,this.onClick=r,this.localize=n,this.render()}return o(e,[{key:"render",value:function(){var e=(0,i.default)({tagName:"span",className:"chat__tooltip",text:this.localize("popout")});this.el=(0,i.default)({tagName:"button",className:"chat__flyout-button chat__flyout-button--popout",events:{click:this.onClick},childs:[e]}),this.parent.appendChild(this.el)}}]),e}();r.default=a,t.exports=r.default},{"@livelyvideo/utils/lib/createElement":33,"babel-runtime/core-js/object/define-property":40}],149:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=h(e("babel-runtime/core-js/object/define-property")),o=h(e("babel-runtime/core-js/object/set-prototype-of")),i=h(e("babel-runtime/core-js/object/create")),s=h(e("babel-runtime/core-js/object/get-prototype-of")),a=function(){function e(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),(0,n.default)(e,o.key,o)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=h(e("@livelyvideo/utils/lib/createElement")),c=h(e("./chat-flyout")),l=h(e("./chat-actions-flyout"));function h(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e,r,n,o,i,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var u=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||(0,s.default)(t)).call(this,e,"roster",o("roster")));return u.parent=e,u.chat=r,u.chatBody=n,u.localize=o,u.errorHandler=i,u.options=a,u.updateRoster=u.updateRoster.bind(u),u.cleanUpdateRoster=u.cleanUpdateRoster.bind(u),u.handleRadioChange=u.handleRadioChange.bind(u),u.loadMoreHandler=u.loadMoreHandler.bind(u),u.actionMore=u.actionMore.bind(u),u}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=(0,i.default)(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(o.default?(0,o.default)(e,t):e.__proto__=t)}(t,c.default),a(t,[{key:"initUser",value:function(){this.render(),this.roster=this.chat.getRoster({limit:this.options.rosterLimit,role:""}),this.enableFlyout()}},{key:"toggleStateHandler",value:function(e){e||this.roster.update(this.cleanUpdateRoster)}},{key:"render",value:function(){this.rosterRadioUser=(0,u.default)({tagName:"input",className:"chat__radio",attributes:{type:"radio",name:"rosterSort",value:"",checked:"checked",id:"rosterSortUser"},events:{change:this.handleRadioChange}}),this.rosterRadioModerator=(0,u.default)({tagName:"input",className:"chat__radio",attributes:{type:"radio",name:"rosterSort",value:"moderator",id:"rosterSortModerator"},events:{change:this.handleRadioChange}}),this.rosterRadioUserLabel=(0,u.default)({tagName:"label",className:"chat__radio-label",text:this.localize("Everyone"),attributes:{for:"rosterSortUser"}}),this.rosterRadioModeratorLabel=(0,u.default)({tagName:"label",className:"chat__radio-label",text:this.localize("Moderators"),attributes:{for:"rosterSortModerator"}}),this.rosterRadioWrapper=(0,u.default)({tagName:"div",className:"chat__radio-wrapper",childs:[this.rosterRadioUser,this.rosterRadioUserLabel,this.rosterRadioModerator,this.rosterRadioModeratorLabel]}),this.rosterRadioContainer=(0,u.default)({tagName:"div",className:"chat__radio-container chat__radio-container--sort",childs:[this.rosterRadioWrapper]}),this.rosterLoadMore=(0,u.default)({tagName:"button",className:"chat__roster-load-more",text:this.localize("Load More"),events:{click:this.loadMoreHandler}}),this.rosterContainer=(0,u.default)({tagName:"div",className:"chat__roster-container"}),this.rosterScrollContainer=(0,u.default)({tagName:"div",className:"chat__roster-scroll",childs:[this.rosterContainer,this.rosterLoadMore]}),this.flyout.appendChild(this.rosterRadioContainer),this.flyout.appendChild(this.rosterScrollContainer)}},{key:"handleRadioChange",value:function(e){var t={limit:this.options.rosterLimit};t.role=e.target.value,this.roster._options=t,this.roster.update(this.cleanUpdateRoster)}},{key:"loadMoreHandler",value:function(){this.roster.next(this.updateRoster)}},{key:"cleanUpdateRoster",value:function(e,t){for(;this.rosterContainer.firstChild;)this.rosterContainer.removeChild(this.rosterContainer.firstChild);this.updateRoster(e,t)}},{key:"updateRoster",value:function(e,t){if(e)this.errorHandler(e,{message:this.localize("Error updating roster"),level:"error"});else{for(var r=0;r<t.length;r++){var n=[];if("user"!==t[r].role){var o=(0,u.default)({tagName:"span",className:"chat__roster-role",text:t[r].role,attributes:{style:"background:"+t[r].roleColor}});n.push(o)}var i=(0,u.default)({tagName:"span",className:"chat__roster-actor",text:t[r].username});n.push(i);var s=(0,u.default)({tagName:"button",className:"chat__action chat__action--more chat__action--roster",attributes:{"data-tooltip":"More Actions"},events:{click:this.actionMore}});n.push(s);var a=(0,u.default)({tagName:"div",className:"chat__roster-actor-container",childs:n,attributes:{"data-username":t[r].username,"data-role":t[r].role}});this.rosterContainer.appendChild(a)}this.roster._nextParams?this.rosterLoadMore.classList.remove("chat__roster-load-more--disable"):this.rosterLoadMore.classList.add("chat__roster-load-more--disable")}}},{key:"actionMore",value:function(e){var t={username:e.target.parentElement.getAttribute("data-username"),id:e.target.parentElement.getAttribute("data-username"),role:e.target.parentElement.getAttribute("data-role"),modifierClass:"chat__actions-flyout--roster"};if(this.actionsFlyout&&!this.actionsFlyout._closed&&t.id===this.actionsFlyout.options.id)return this.actionsFlyout.close(),void(this.actionsFlyout=!1);this.actionsFlyout=new l.default(e.target,this.chatBody,this.localize,t)}}]),t}();r.default=f,t.exports=r.default},{"./chat-actions-flyout":139,"./chat-flyout":144,"@livelyvideo/utils/lib/createElement":33,"babel-runtime/core-js/object/create":39,"babel-runtime/core-js/object/define-property":40,"babel-runtime/core-js/object/get-prototype-of":41,"babel-runtime/core-js/object/set-prototype-of":43}],150:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=N(e("babel-runtime/core-js/symbol/iterator")),o=N(e("babel-runtime/core-js/symbol")),i=N(e("babel-runtime/core-js/object/assign")),s=N(e("babel-runtime/core-js/object/define-property")),a=N(e("babel-runtime/core-js/object/set-prototype-of")),u=N(e("babel-runtime/core-js/object/create")),c=N(e("babel-runtime/core-js/object/get-prototype-of")),l="function"==typeof o.default&&"symbol"==typeof n.default?function(e){return typeof e}:function(e){return e&&"function"==typeof o.default&&e.constructor===o.default&&e!==o.default.prototype?"symbol":typeof e},h=i.default||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},f=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),(0,s.default)(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();e("classlist-polyfill");var d=N(e("events")),p=N(e("@livelyvideo/chat-core/lib/source")),_=N(e("@livelyvideo/logger-core/lib/source")),v=N(e("@livelyvideo/localization")),m=N(e("@livelyvideo/utils/lib/createElement")),y=N(e("@livelyvideo/utils/lib/forwardEvents")),b=N(e("./utils/popout")),g=N(e("./package-json")),w=N(e("./components/chat-body")),k=N(e("./components/chat-emoticons")),j=N(e("./components/chat-input")),x=N(e("./components/chat-options")),E=N(e("./components/chat-roster")),O=N(e("./components/chat-admin")),S=N(e("./components/chat-controls")),C=N(e("./components/chat-popout")),T=N(e("./components/chat-header"));function N(e){return e&&e.__esModule?e:{default:e}}var M=new _.default(g.default),L={user:null,room:null,host:null,authUrl:null,popout:null,preventScroll:["html","body"],chunkHistory:20,chunkSize:10,chunkView:5,rosterLimit:100,locale:null,messages:null,sendMiddleware:null,loggerOptions:{}},P=function(e){function t(e,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||(0,c.default)(t)).call(this));n.options=h({},L,r);var o=new v.default(n.options.locale,n.options.messages);return n.localize=o.localize.bind(o),n.errorHandler=n.errorHandler.bind(n),n.mount(e),n.init(),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=(0,u.default)(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(a.default?(0,a.default)(e,t):e.__proto__=t)}(t,d.default),f(t,[{key:"init",value:function(){var e=this;this.chat=new p.default({room:this.options.room,host:this.options.host,wshost:this.options.wshost,insecure:this.options.insecure,roleHistory:this.options.roleHistory},{url:this.options.authUrl}),this.chat.on("error",function(t,r){return e.errorHandler(t,r)}),(0,y.default)(this.chat,this),M.setOptions(this.options.loggerOptions,this),M.setInstanceOptions({host:this.options.host}),this.render(),this.initUnauthedUser()}},{key:"mount",value:function(e){var t=this;switch(void 0===e?"undefined":l(e)){case"string":this.el=document.querySelector(e);break;case"object":this.el=e;break;default:setTimeout(function(){return t.emit("error",new Error("The constructor has not been given a valid element or selector."))})}this.el.classList.add("chat")}},{key:"errorHandler",value:function(e,t){var r=void 0;switch(void 0===e?"undefined":l(e)){case"string":r={level:"error",message:this.localize(e)};break;case"object":if(e instanceof Error){r={level:"error",message:this.localize(e.message)};break}}this.chatBody&&this.chatBody.processMessage(r)}},{key:"render",value:function(){var e=this;this.chatHeader=new T.default(this.el,this.chat),this.chatBody=new w.default(this.el,this.chat,this.localize,this.errorHandler,this.options),this.chatInput=new j.default(this.el,this.chat,this.chatBody,this.localize,this.errorHandler,this.options),this.chatEmoticons=new k.default(this.el,this.chat,this.chatInput,this.localize,this.errorHandler),this.chatControls=new S.default(this.el),this.options.popout&&(this.chatPopout=new C.default(this.chatControls.el,this.openPopout.bind(this),this.localize)),this.chatAdmin=new O.default(this.chatControls.el,this.chat,this.localize,this.errorHandler,this.options),this.chatRoster=new E.default(this.chatControls.el,this.chat,this.chatBody,this.localize,this.errorHandler,this.options),this.chatOptions=new x.default(this.chatControls.el,this.chat,this.localize,this.errorHandler),this.chat.on("chat",function(t){return e.chatBody.processChat(t)}),this.chat.once("room",function(t){e.chat._roomname=t.name,e.chatHeader.initRoom(t.title||t.name)}),this.chat.on("message",function(t){return e.chatBody.processMessage(t)}),this.chat.on("delete",function(t){return e.chatBody.deleteById(t.id)})}},{key:"initUnauthedUser",value:function(){var e=this;this.chat.once("me",function(t){if(e.chat._username=t.username,t){if(e.history)for(var r=0;r<e.history.messages.length;r++)e.chatBody.processChat(e.history.messages[r]);e.meHandler(t),e.initAuthedUser(t)}else e.roleHandler({room:{role:"anon"}})}),this.history=!1,this.chat.once("history",function(t){if(e.chat_username&&t)for(var r=0;r<t.messages.length;r++)e.chatBody.processChat(t.messages[r]);else e.history=t})}},{key:"initAuthedUser",value:function(e){var t=this;this.chatOptions.initUser(),this.chatEmoticons.initUser(),this.chatInput.initUser(),this.chatRoster.initUser(),this.chatAdmin.initUser(),this._currentRole=e.room.role,this.chat.on("me",function(e){return t.meHandler(e)})}},{key:"meHandler",value:function(e){this.roleHandler(e),e.showTimestamps?this.el.classList.add("chat--timestamps"):this.el.classList.remove("chat--timestamps")}},{key:"roleHandler",value:function(e){if(this._currentRole&&this._currentRole!==e.room.role){var t={level:"info"};switch(this._currentRole){case"user":t.message=this.localize("You have been modded");break;default:t.message=this.localize("You have been unmodded")}this.chatBody.processMessage(t)}this._currentRole=e.room.role;var r="chat";this.chatBody.isMod&&(r+=" chat--isMod"),this.chatBody.isAdmin&&(r+=" chat--isAdmin"),this.el.className=r}},{key:"openPopout",value:function(){var e=this;this.popout=new b.default(this.options.popout,{width:340,height:640}),this._unmountClose=this.popout.on("close",function(){setTimeout(function(){e.popout&&e.popout.instance&&e.popout.instance.closed&&e.closePopout()},250)}),this.destroy(),this.renderNoPopout()}},{key:"closePopout",value:function(){this.popout&&(this.popout.close(),this.popout=null),this._unmountClose&&(this._unmountClose=null),this.destroyNoPopout(),this.init()}},{key:"renderNoPopout",value:function(){var e=(0,m.default)({tagName:"div",className:"chat__poppedout-text",text:"Your chat is popped out"});this._popoutEl=(0,m.default)({tagName:"div",className:"chat__poppedout",childs:[e]}),this.el.appendChild(this._popoutEl)}},{key:"destroyNoPopout",value:function(){this.el.removeChild(this._popoutEl)}},{key:"destroy",value:function(){for(this.chat.destroy(),this.chatBody.destroy(),this.el.className="chat";this.el.firstChild;)this.el.removeChild(this.el.firstChild)}}]),t}();r.default=P,t.exports=r.default},{"./components/chat-admin":140,"./components/chat-body":141,"./components/chat-controls":142,"./components/chat-emoticons":143,"./components/chat-header":145,"./components/chat-input":146,"./components/chat-options":147,"./components/chat-popout":148,"./components/chat-roster":149,"./package-json":151,"./utils/popout":153,"@livelyvideo/chat-core/lib/source":16,"@livelyvideo/localization":27,"@livelyvideo/logger-core/lib/source":32,"@livelyvideo/utils/lib/createElement":33,"@livelyvideo/utils/lib/forwardEvents":35,"babel-runtime/core-js/object/assign":38,"babel-runtime/core-js/object/create":39,"babel-runtime/core-js/object/define-property":40,"babel-runtime/core-js/object/get-prototype-of":41,"babel-runtime/core-js/object/set-prototype-of":43,"babel-runtime/core-js/symbol":44,"babel-runtime/core-js/symbol/iterator":45,"classlist-polyfill":47,events:154}],151:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default={version:"1.1.3",name:"@livelyvideo/chat"},t.exports=r.default},{}],152:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e,t,r){for(var n=e.target;n&&n!==document.body;){if(n===t||n===r)return!1;n=n.parentNode}return!0},t.exports=r.default},{}],153:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=h(e("babel-runtime/core-js/object/assign")),o=h(e("babel-runtime/core-js/object/define-property")),i=h(e("babel-runtime/core-js/object/set-prototype-of")),s=h(e("babel-runtime/core-js/object/create")),a=h(e("babel-runtime/core-js/object/get-prototype-of")),u=n.default||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},c=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),(0,o.default)(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("events");function h(e){return e&&e.__esModule?e:{default:e}}function f(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var d={width:640,height:550,toolbar:!1,menubar:!1,location:!1,status:!1,scrollbars:!1,resizable:!0,left:0,top:0},p=function(e){function t(e,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n,o=f(this,(t.__proto__||(0,a.default)(t)).call(this));if(!(o instanceof t))return n=new t(e,r),f(o,n);o.options=u({},d,r);var i=o.getParamsString(r);return o.instance=window.open(e,Date.now(),i),setTimeout(function(){return o.onPopupLoad()}),setTimeout(function(){return o.onPopupLoad()},250),o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=(0,s.default)(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(i.default?(0,i.default)(e,t):e.__proto__=t)}(t,l.EventEmitter),c(t,[{key:"onBeforeUnload",value:function(e){var t=this;this.emit("close",e),setTimeout(function(){t.instance.closed||(t.instance.onbeforeunload=t.onBeforeUnload.bind(t))},250)}},{key:"close",value:function(){this.instance.close()}},{key:"onPopupLoad",value:function(){try{this.instance.isPopup=!0,this.instance.onbeforeunload=this.onBeforeUnload.bind(this)}catch(e){}}},{key:"getParamsString",value:function(e){var t=[];for(var r in e)t.push(r+"="+e[r]);return t=t.join(",")}}]),t}();r.default=p,t.exports=r.default},{"babel-runtime/core-js/object/assign":38,"babel-runtime/core-js/object/create":39,"babel-runtime/core-js/object/define-property":40,"babel-runtime/core-js/object/get-prototype-of":41,"babel-runtime/core-js/object/set-prototype-of":43,events:154}],154:[function(e,t,r){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function o(e){return"function"==typeof e}function i(e){return"object"==typeof e&&null!==e}function s(e){return void 0===e}t.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,r,n,a,u,c;if(this._events||(this._events={}),"error"===e&&(!this._events.error||i(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var l=new Error('Uncaught, unspecified "error" event. ('+t+")");throw l.context=t,l}if(s(r=this._events[e]))return!1;if(o(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:a=Array.prototype.slice.call(arguments,1),r.apply(this,a)}else if(i(r))for(a=Array.prototype.slice.call(arguments,1),n=(c=r.slice()).length,u=0;u<n;u++)c[u].apply(this,a);return!0},n.prototype.addListener=function(e,t){var r;if(!o(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,o(t.listener)?t.listener:t),this._events[e]?i(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,i(this._events[e])&&!this._events[e].warned&&(r=s(this._maxListeners)?n.defaultMaxListeners:this._maxListeners)&&r>0&&this._events[e].length>r&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(e,t){if(!o(t))throw TypeError("listener must be a function");var r=!1;function n(){this.removeListener(e,n),r||(r=!0,t.apply(this,arguments))}return n.listener=t,this.on(e,n),this},n.prototype.removeListener=function(e,t){var r,n,s,a;if(!o(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(s=(r=this._events[e]).length,n=-1,r===t||o(r.listener)&&r.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(i(r)){for(a=s;a-- >0;)if(r[a]===t||r[a].listener&&r[a].listener===t){n=a;break}if(n<0)return this;1===r.length?(r.length=0,delete this._events[e]):r.splice(n,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(o(r=this._events[e]))this.removeListener(e,r);else if(r)for(;r.length;)this.removeListener(e,r[r.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){return this._events&&this._events[e]?o(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(o(t))return 1;if(t)return t.length}return 0},n.listenerCount=function(e,t){return e.listenerCount(t)}},{}]},{},[150])(150)});
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{}]},{},[1]);
