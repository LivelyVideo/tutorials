(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
'use strict';

var _upload = require('@livelyvideo/upload');

var _upload2 = _interopRequireDefault(_upload);

var _stockVodPlayer = require('@livelyvideo/stock-vod-player');

var _stockVodPlayer2 = _interopRequireDefault(_stockVodPlayer);

var _xhr = require('xhr');

var _xhr2 = _interopRequireDefault(_xhr);

var _textContent = require('text-content');

var _textContent2 = _interopRequireDefault(_textContent);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

/**
Set up the upload instance

Params:
	- html element
	- options
		* @param {object} el - The DOM element for UploadClient to be constructed on
		* @param {Config} [options] - Configurable options for the UploadClient class
		* @param {string} options.host - Destination host of your uploads
		* @param {string} options.authUrl - Route to retreive access tokens that authorize you to use host
		* @param {string} [options.token] - Manual token for authorization
		* @param {string} [options.accept] - Accept field for upload accept attribute
		* @param {string} [options.bemPrefix=upload] - Prefix for DOM classes
		* @param {string} [options.version=v2] - Api version
		* @param {bool} [options.autoSubmit=true] - Auto submit upload on select. If false you must call
		* @param {bool} [options.multiple=true] - Allow multiple files for upload
		* @param {number} [options.chunkSize=102400] - Size of chunks to be uploaded
		* @param {number} [options.chunkConnections=3] - Number of concurrent chunk connections
		* @param {object} [options.messages] - Hard code message strings
		* @param {object} [options.selectTarget] - Select a custom DOM element to open file select on click, disables drag and drop
		* @param {object} [options.previewsTarget] - Select a custom DOM element for previews to be appended to
**/
var upload = new _upload2.default(document.querySelector('.upload'), {
	authUrl: '/access-token',
	host: 'dev.livelyvideo.tv',
	loggerOptions: {
		disable: true
	}
});
window.upload = upload;

// Play a video
/**
Function to load the stock player, triggered later by a click event on <a> tags generated by the "get listings" button

Params:
	- html element
	- manifest url, returned by the listings endpoint located in server.js
	- player options
		> autoplay: [true] autoplays the stream when it loads
		> bitrate: [undefined] null for adaptive when available, desired kbps otherwise
		> drivers: ["mp4", "nativeHls", "jsHls", "flash", lodef"] driver priority
		> debug: [false] enables debug logging
		> recoverErrorCount: [10] Playback error count to recover the entire driver on
		> forceDrivers:	[false]
		> muted: whether or not the driver is muted
		> pollingInterval: [10000] ms timeout to wait before polling again
		> volume: [0.75] 0-1 volume
	- controls options
		> popout: popout options
		> popout[].url: url for popout
		> popout[].width: width for popout in px
		> popout[].height: height for popout in px

Events:
	- error emitted with all errors
	- exit-fullscreen
	- enter-fullscreen
	- bitrate-switch
	- select-driver
	- manifest
	- play
	- stop
	- pause
	- stall
	- progress
	- timeupdate
	- mute
	- unmute
	- volume
	- online
	- offline
	- estimated-bw
	- user-active
	- user-idle
**/
var stockPlayer = void 0;
function loadPlayer(manifest) {
	return function (e) {
		e.preventDefault();
		if (stockPlayer) {
			stockPlayer.destroy();
		}

		window.stockPlayer = stockPlayer = new _stockVodPlayer2.default(document.querySelector('#player'), manifest, {
			drivers: ['hlsjs', 'hls', 'flashHls', 'mp4'],
			hlsjsPath: 'https://cdn.jsdelivr.net/hls.js/latest/hls.min.js',
			flashlsPath: './flashlsChromeless.swf'
		});
	};
}

// Videos
var videosContainer = document.querySelector('.videos');

function loadVideos() {
	(0, _xhr2.default)({
		method: 'GET',
		uri: '/videos',
		json: true
	}, function (err, response, body) {
		if (err) {
			console.error('get videos error', err);
			return;
		}

		if (response.statusCode > 399) {
			console.error('get videos error', {
				code: response.statusCode,
				body: body
			});
			return;
		}

		while (videosContainer.children.length) {
			videosContainer.children[0].remove();
		}

		for (var i = 0; i < body.results.length; i++) {
			var videoEntry = document.createElement('div');
			var videoLink = document.createElement('a');
			videoLink.setAttribute('href', '#');
			videoEntry.appendChild(videoLink);

			videoLink.onclick = loadPlayer(body.results[i].manifest);
			(0, _textContent2.default)(videoLink, 'video uploaded by ' + body.results[i].userId + ' on ' + body.results[i].dateEnd);
			videosContainer.appendChild(videoEntry);
		}
	});
}

var loadVideosButton = document.querySelector('.loadvideos');
loadVideosButton.onclick = function () {
	loadVideos();
};
loadVideos();

},{"@livelyvideo/stock-vod-player":2,"@livelyvideo/upload":3,"text-content":8,"xhr":10}],2:[function(require,module,exports){
(function (global){
!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).LivelyStockVodPlayer=e()}}(function(){return function e(t,r,n){function i(s,l){if(!r[s]){if(!t[s]){var a="function"==typeof require&&require;if(!l&&a)return a(s,!0);if(o)return o(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var c=r[s]={exports:{}};t[s][0].call(c.exports,function(e){var r=t[s][1][e];return i(r||e)},c,c.exports,e,t,r,n)}return r[s].exports}for(var o="function"==typeof require&&require,s=0;s<n.length;s++)i(n[s]);return i}({1:[function(e,t,r){(function(n){!function(e){"object"==typeof r&&void 0!==t?t.exports=e():("undefined"!=typeof window?window:void 0!==n?n:"undefined"!=typeof self?self:this).LivelyLocales=e()}(function(){return function t(r,n,i){function o(l,a){if(!n[l]){if(!r[l]){var u="function"==typeof e&&e;if(!a&&u)return u(l,!0);if(s)return s(l,!0);var c=new Error("Cannot find module '"+l+"'");throw c.code="MODULE_NOT_FOUND",c}var f=n[l]={exports:{}};r[l][0].call(f.exports,function(e){var t=r[l][1][e];return o(t||e)},f,f.exports,t,r,n,i)}return n[l].exports}for(var s="function"==typeof e&&e,l=0;l<i.length;l++)o(i[l]);return o}({1:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var o={},s={},l=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t&&o[t]||r?(this.warned={},this.silent=n,this.name=t,this.data=o[t]||{},r&&Object.assign(this.data,r)):this.localize=function(e){return e}}return i(e,[{key:"localize",value:function(e){var t;return(t=this.data[e])?t:(this.silent||this.warned[e]||(this.warned[e]=!0,this.name?console.warn("'"+e+"' has no translation in the provided '"+this.name+"' locale files or localization messages"):console.warn("'"+e+"' has no translation in the provided localization messages.")),e)}}]),e}();[].map(function(e){var t=e.name.split("/")[2];o[t]=Object.assign({},o[t],e.module)});var a=new l;Object.keys(o).forEach(function(e){s[e]=new l(e)}),r.default=function(e,t,r){if(t){if("object"!==(void 0===t?"undefined":n(t)))throw new Error("Lively Localization instantiated with something other than a messages object",{messages:t});return new l(e,t,r)}return e&&s[e]?s[e]:a},t.exports=r.default},{}]},{},[1])(1)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e,t){var r=document.createElement(e);if(!t)return r;for(var n=0;n<t.length;n++)r.classList.add(t[n]);return r}},{}],3:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=s(e("events")),o=s(e("../create-element"));function s(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.controls=e,r.livelyPlayer=e.livelyPlayer,r.bar=e.bar,r.el=(0,o.default)("div",["lvcontrols__button","lvcontrols__fullscreen"]),r.el.setAttribute("title",r.controls.localize("Full Screen")),r.bar.appendChild(r.el),r.el.addEventListener("click",r.toggleFullScreen.bind(r)),r.removableEvents=[],["webkitfullscreenchange","mozfullscreenchange","fullscreenchange"].forEach(function(e){document.addEventListener(e,r.handleFullScreenChange.bind(r)),r.removableEvents.push(function(){document.removeEventListener(e,r.handleFullScreenChange.bind(r))})}),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),n(t,[{key:"destroy",value:function(){for(var e=0;e<this.removableEvents.length;e++)this.removableEvents[e]();this.el&&this.el.remove()}},{key:"handleFullScreenChange",value:function(){this.isFullscreen()?(this.el.classList.add("lvcontrols__fullscreen--exit"),this.bar.classList.add("lvcontrols__bar--fullscreen")):(this.el.classList.remove("lvcontrols__fullscreen--exit"),this.bar.classList.remove("lvcontrols__bar--fullscreen"))}},{key:"isFullscreen",value:function(){return!!(document.fullScreen||document.webkitIsFullScreen||document.mozFullScreen||document.msFullscreenElement||document.fullscreenElement)}},{key:"toggleFullScreen",value:function(){if(this.isFullscreen())document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen();else{var e=this.livelyPlayer.el.parentNode;if(e.requestFullscreen)e.requestFullscreen();else if(e.mozRequestFullScreen)e.mozRequestFullScreen();else if(e.webkitRequestFullScreen)e.webkitRequestFullScreen();else if(e.msRequestFullscreen)e.msRequestFullscreen();else if(this.livelyPlayer.el.querySelector){var t=this.livelyPlayer.el.querySelector("video");t.webkitEnterFullscreen&&t.webkitEnterFullscreen()}}}}]),t}();r.default=l},{"../create-element":2,events:45}],4:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e){var t=void 0;e.getBoundingClientRect&&e.parentNode&&(t=e.getBoundingClientRect());if(!t)return{top:0,left:0,right:0};var r=document.documentElement,n=document.body,i=r.clientTop||n.clientTop||0,o=r.clientLeft||n.clientLeft||0,s=window.pageYOffset||n.scrollTop,l=window.pageXOffset||n.scrollLeft,a=Math.floor(t.left+l-o);return{top:Math.floor(t.top+s-i),left:a,right:a+t.right}}},{}],5:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e){var t=e.pageY,r=e.pageX;e.changedTouches&&(t=e.changedTouches[0].pageY,r=e.changedTouches[0].pageX);return{y:t,x:r}}},{}],6:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();e("./polyfills");var i=g(e("events")),o=g(e("@livelyvideo/player-core/lib/detect")),s=g(e("@livelyvideo/player-core/lib/get-default-options")),l=g(e("@livelyvideo/player-core/lib/logger")),a=g(e("@livelyvideo/localization")),u=g(e("./fullscreen")),c=g(e("./overlay")),f=g(e("./popout")),d=g(e("./play-audio")),h=g(e("./playpause")),v=g(e("./progress")),p=g(e("./keyboard")),y=g(e("./quality-selector")),m=g(e("./screen-interaction")),b=g(e("./volume"));function g(e){return e&&e.__esModule?e:{default:e}}var _={controls:["overlay","play-audio","playpause","fullscreen","popout","progress","quality-selector","volume","keyboard"],popout:{url:"",width:480,height:280}},w=["Click to play audio","Tap to play audio","Pause","Play","Auto","Toggle play/pause","Full Screen","Popout","Quality Selector","Mute","Unmute","Stream is currently offline"],E=function(e){function t(e,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));n.el=e,n.bar=document.createElement("div"),n.controls=[],n.mobileControls=o.default.any(),n.mobileControls&&n.el.classList.add("mobile"),n.el.classList.add("lvcontrols"),n.bar.classList.add("lvcontrols__bar"),n.el.appendChild(n.bar),n.options=(0,s.default)(r,_);for(var i=[],u=0;u<w.length;u++)n.options.messages[w[u]]||(n.options.messages[w[u]]=w[u],i.push(w[u]));i.length&&r.debug&&l.default.info("Using default messages",i);var c=new a.default(null,n.options.messages);return n.localize=c.localize.bind(c),n.options.livelyPlayer&&n.attach(n.options.livelyPlayer),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),n(t,[{key:"destroyControls",value:function(){for(var e=0;e<this.controls.length;e++)this.controls[e].destroy()}},{key:"destroy",value:function(){this.destroyControls(),this.bar.remove(),this.screenInteraction&&this.screenInteraction.destroy()}},{key:"attach",value:function(e){var t=this;this.livelyPlayer=e;for(var r=function(e){switch(e){case"fullscreen":t.controls.push(new u.default(t));break;case"overlay":t.controls.push(new c.default(t));break;case"play-audio":t.controls.push(new d.default(t));break;case"playpause":t.controls.push(new h.default(t));break;case"popout":t.controls.push(new f.default(t));break;case"progress":t.controls.push(new v.default(t));break;case"quality-selector":t.controls.push(new y.default(t));break;case"keyboard":t.controls.push(new p.default(t));break;case"volume":t.controls.push(new b.default(t));break;default:l.default.error("unrecognized control",e)}},n=0;n<this.options.controls.length;n++)r(this.options.controls[n]);this.screenInteraction=new m.default(this.el,e),this.screenInteraction.on("user-active",function(){t.bar.classList.add("lvcontrols__bar--interacting")}),this.screenInteraction.on("user-idle",function(){t.bar.classList.remove("lvcontrols__bar--interacting")})}}]),t}();r.default=E},{"./fullscreen":3,"./keyboard":7,"./overlay":8,"./play-audio":9,"./playpause":10,"./polyfills":11,"./popout":12,"./progress":13,"./quality-selector":14,"./screen-interaction":15,"./volume":16,"@livelyvideo/localization":1,"@livelyvideo/player-core/lib/detect":18,"@livelyvideo/player-core/lib/get-default-options":22,"@livelyvideo/player-core/lib/logger":23,events:45}],7:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n,i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=e("events"),s=(n=o)&&n.__esModule?n:{default:n};var l=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.livelyPlayer=e.livelyPlayer,r.livelyPlayer.el.addEventListener("keypress",r.handleKeyPress.bind(r)),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s.default),i(t,[{key:"handleKeyPress",value:function(){}},{key:"destroy",value:function(){this.livelyPlayer.el.removeEventListener("keypress",this.handleKeyPress)}}]),t}();r.default=l},{events:45}],8:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=l(e("events")),o=l(e("text-content")),s=l(e("../create-element"));function l(e){return e&&e.__esModule?e:{default:e}}var a=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.controls=e,r.livelyPlayer=e.livelyPlayer,r.bar=e.bar,r.el=(0,s.default)("div",["lvcontrols__big-button"]),r.el.setAttribute("title",r.controls.localize("Play")),r.controls.el.appendChild(r.el),r.el.addEventListener("click",r.togglePlaying.bind(r)),r.showRestarter=0,r.livelyPlayer.on("play",r.changeState.bind(r)),r.livelyPlayer.on("pause",r.changeState.bind(r)),r.livelyPlayer.on("stop",r.changeState.bind(r)),r.livelyPlayer.on("ended",r.setIcon.bind(r)),r.livelyPlayer.on("offline",r.setIcon.bind(r)),r.livelyPlayer.on("timeupdate",r.onTimeupdate.bind(r)),r.livelyPlayer.once("manifest",r.setIcon.bind(r)),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),n(t,[{key:"changeState",value:function(){this.setIcon(),this.resetRestarter()}},{key:"onTimeupdate",value:function(){this.setIcon(),this.showRestarter=0,this.resetRestarter()}},{key:"resetRestarter",value:function(){var e=this;this.livelyPlayer.vod||(this.stopRestarter(),this.restarter=setTimeout(function(){e.livelyPlayer.tryingToPlay&&(e.showRestarter=1)},5e3))}},{key:"stopRestarter",value:function(){clearTimeout(this.restarter),this.showRestarter=0}},{key:"destroy",value:function(){this.livelyPlayer.removeListener("play",this.changeState.bind(this)),this.livelyPlayer.removeListener("pause",this.changeState.bind(this)),this.livelyPlayer.removeListener("stop",this.changeState.bind(this)),this.livelyPlayer.removeListener("ended",this.setIcon.bind(this)),this.livelyPlayer.removeListener("offline",this.setIcon.bind(this)),this.livelyPlayer.removeListener("timeupdate",this.onTimeupdate.bind(this)),this.livelyPlayer.removeListener("manifest",this.setIcon.bind(this)),this.el.remove()}},{key:"setIcon",value:function(){"offline"===this.livelyPlayer.getState()?(this.el.classList.remove("lvcontrols__big-button--stopped"),this.el.classList.remove("lvcontrols__big-button--playing"),this.el.classList.add("lvcontrols__big-button--offline"),this.livelyPlayer.el.classList.add("video--stopped"),(0,o.default)(this.el,this.controls.localize("Stream is currently offline"))):this.livelyPlayer.tryingToPlay?this.showRestarter?(this.el.classList.remove("lvcontrols__big-button--playing"),this.el.classList.remove("lvcontrols__big-button--offline"),this.el.classList.add("lvcontrols__big-button--stopped"),this.livelyPlayer.el.classList.add("video--stopped"),(0,o.default)(this.el,"")):(this.el.classList.remove("lvcontrols__big-button--stopped"),this.el.classList.remove("lvcontrols__big-button--offline"),this.el.classList.add("lvcontrols__big-button--playing"),this.livelyPlayer.el.classList.remove("video--stopped"),(0,o.default)(this.el,"")):(this.el.classList.remove("lvcontrols__big-button--playing"),this.el.classList.remove("lvcontrols__big-button--offline"),this.el.classList.add("lvcontrols__big-button--stopped"),this.livelyPlayer.el.classList.add("video--stopped"),(0,o.default)(this.el,""))}},{key:"togglePlaying",value:function(){this.livelyPlayer.shouldTryToPlay||(this.showRestarter?this.livelyPlayer.restart():this.livelyPlayer.tryingToPlay?(this.el.setAttribute("title",this.controls.localize("Pause")),this.livelyPlayer.stop()):(this.el.setAttribute("title",this.controls.localize("Play")),this.livelyPlayer.play()))}}]),t}();r.default=a},{"../create-element":2,events:45,"text-content":53}],9:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=l(e("@livelyvideo/player-core/lib/detect")),o=l(e("text-content")),s=l(e("../create-element"));function l(e){return e&&e.__esModule?e:{default:e}}var a=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),i.default.any()){this.controls=t,this.livelyPlayer=t.livelyPlayer,this.el=(0,s.default)("div",["lvcontrols__top-bar"]),this.icon=(0,s.default)("div",["lvcontrols__button","lvcontrols__top-bar-icon"]);var r=i.default.any()?"Tap":"Click",n=this.controls.localize(r+" to play audio");this.el.setAttribute("title",n),(0,o.default)(this.el,n),this.el.insertBefore(this.icon,this.el.firstChild),this.controls.el.appendChild(this.el),this.el.addEventListener("click",this.playAudio.bind(this)),this.livelyPlayer.on("no-audio",this.showIcon.bind(this))}}return n(e,[{key:"hideIcon",value:function(){this.el.classList.remove("lvcontrols__top-bar--showing")}},{key:"showIcon",value:function(){this.el.classList.add("lvcontrols__top-bar--showing")}},{key:"playAudio",value:function(){this.livelyPlayer.playAudio(),this.hideIcon()}},{key:"destroy",value:function(){this.el&&this.el.remove()}}]),e}();r.default=a},{"../create-element":2,"@livelyvideo/player-core/lib/detect":18,"text-content":53}],10:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=s(e("events")),o=s(e("../create-element"));function s(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.controls=e,r.livelyPlayer=e.livelyPlayer,r.bar=e.bar,r.livelyPlayer.on("select-driver",function(){r.checkDriver()}),r.el=(0,o.default)("div",["lvcontrols__button","lvcontrols__play-button"]),r.el.setAttribute("title",r.controls.localize("Toggle play/pause")),r.bar.appendChild(r.el),r.el.addEventListener("click",r.togglePlaying.bind(r)),r.livelyPlayer.on("play",r.setIcon.bind(r)),r.livelyPlayer.on("pause",r.setIcon.bind(r)),r.livelyPlayer.on("stop",r.setIcon.bind(r)),r.livelyPlayer.on("ended",r.setIcon.bind(r)),r.livelyPlayer.on("timeupdate",r.setIcon.bind(r)),r.checkDriver(),r.setIcon(),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),n(t,[{key:"checkDriver",value:function(){this.livelyPlayer.currentDriver&&"flashRtmp"===this.livelyPlayer.currentDriver.driver?this.disable():this.enable()}},{key:"disable",value:function(){this.el.style.display="none"}},{key:"enable",value:function(){this.el.style.display="inline"}},{key:"destroy",value:function(){this.livelyPlayer.removeListener("play",this.setIcon.bind(this)),this.livelyPlayer.removeListener("pause",this.setIcon.bind(this)),this.livelyPlayer.removeListener("stop",this.setIcon.bind(this)),this.livelyPlayer.removeListener("ended",this.setIcon.bind(this)),this.livelyPlayer.removeListener("timeupdate",this.setIcon.bind(this)),this.el.remove()}},{key:"setIcon",value:function(){this.livelyPlayer.tryingToPlay?(this.el.classList.remove("lvcontrols__play-button--stopped"),this.el.classList.add("lvcontrols__play-button--playing"),this.el.setAttribute("title",this.controls.localize("Pause"))):(this.el.classList.remove("lvcontrols__play-button--playing"),this.el.classList.add("lvcontrols__play-button--stopped"),this.el.setAttribute("title",this.controls.localize("Play")))}},{key:"togglePlaying",value:function(){this.livelyPlayer.shouldTryToPlay||(this.livelyPlayer.tryingToPlay?this.livelyPlayer.vod?this.livelyPlayer.pause():this.livelyPlayer.stop():this.livelyPlayer.play())}}]),t}();r.default=l},{"../create-element":2,events:45}],11:[function(e,t,r){"use strict";"function"!=typeof Object.assign&&(Object.assign=function(e,t){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var r=Object(e),n=1;n<arguments.length;n++){var i=arguments[n];if(null!=i)for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])}return r})},{}],12:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=a(e("events")),o=a(e("@livelyvideo/player-core/lib/logger")),s=a(e("@livelyvideo/player-core/lib/parse-url")),l=a(e("../create-element"));function a(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var c=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=u(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.options.popout&&e.options.popout.url?(r.popoutUrl=(0,s.default)(e.options.popout.url),r.popoutUrl?(r.controls=e,r.livelyPlayer=e.livelyPlayer,r.bar=e.bar,r.popoutOptions="width="+e.options.popout.width+", height="+e.options.popout.height+", resizable=yes, scrollbars=no, titlebar=no",r.poppedoutPlayer=null,r.el=(0,l.default)("div",["lvcontrols__button","lvcontrols__popout-button"]),r.el.setAttribute("target","_blank"),r.el.setAttribute("title",r.controls.localize("Popout")),r.el.addEventListener("click",r.openPopout.bind(r)),r.bar.appendChild(r.el),r.el.addEventListener("click",r.openPopout.bind(r)),r):(o.default.error("popout url is invalid"),u(r))):u(r)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),n(t,[{key:"destroy",value:function(){this.el&&this.el.remove()}},{key:"popoverStartPlaying",value:function(e){var t=this;this.livelyPlayer?(this.livelyPlayer.play(),e&&(this.livelyPlayer.currentTime=e.currentTime,this.livelyPlayer.volume(e.volume)),this.livelyPlayer.play(function(){e&&e.muted?t.livelyPlayer.mute():e&&!e.muted&&t.livelyPlayer.unmute()})):o.default.error("could not start playing on pop in, no player instance")}},{key:"openPopout",value:function(e){var t=this;if(this.livelyPlayer)if(this.poppedoutPlayer)this.poppedoutPlayer.focus();else{if(e.preventDefault(),this.poppedoutPlayer&&(this.poppedoutPlayer.onbeforeunload=null,this.poppedoutPlayer.onunload=null),this.livelyPlayer.vod){var r=this.popoutUrl.search?"&":"?";this.popoutUrl&&(this.popoutUrl.href+=r+"start"+this.livelyPlayer.currentTime)}this.poppedoutPlayer=window.open(this.popoutUrl.href,"_blank",this.popoutOptions),this.livelyPlayer.pause();var n=void 0,i=function(){t.poppedoutPlayer.closed||(delete t.poppedoutPlayer,setTimeout(function(){t.popoverStartPlaying(n)},20))};this.poppedoutPlayer.onmessage=function(e){n=e.data},setTimeout(function(){t.poppedoutPlayer.addEventListener("beforeunload",i)},250)}else o.default.error("could not attach popout, no player instance")}}]),t}();r.default=c},{"../create-element":2,"@livelyvideo/player-core/lib/logger":23,"@livelyvideo/player-core/lib/parse-url":26,events:45}],13:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=u(e("events")),o=u(e("@livelyvideo/player-core/lib/logger")),s=u(e("../get-el-position")),l=u(e("../get-pointer-position")),a=u(e("text-content"));function u(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.controls=e,r.livelyPlayer=e.livelyPlayer,r.bar=e.bar,r.rendered=!1,r.livelyPlayer.on("manifest",r.renderIfNotRendered.bind(r)),r.render(),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),n(t,[{key:"renderIfNotRendered",value:function(){this.rendered||this.render()}},{key:"render",value:function(){var e=this;this.livelyPlayer.vod&&(this.rendered=!0,this.livelyPlayer.removeListener("manifest",this.renderIfNotRendered),this.el=document.createElement("div"),this.el.setAttribute("class","lvcontrols__progress"),this.progressBarEl=document.createElement("div"),this.progressBarEl.setAttribute("class","lvcontrols__progress-bar"),this.sliderBufferEl=document.createElement("div"),this.sliderBufferEl.setAttribute("class","lvcontrols__progress-slider-buffer"),this.sliderValueEl=document.createElement("div"),this.sliderValueEl.setAttribute("class","lvcontrols__progress-slider-value"),this.durationEl=document.createElement("div"),this.durationEl.setAttribute("class","lvcontrols__duration"),this.currentTimeEl=document.createElement("div"),this.currentTimeEl.setAttribute("class","lvcontrols__current-time"),setTimeout(function(){e.controls.screenInteraction.on("user-active",function(){e.el.classList.add("lvcontrols__progress--interacting")}),e.controls.screenInteraction.on("user-idle",function(){e.el.classList.remove("lvcontrols__progress--interacting")})},1),this.nextTime=0,this.el.addEventListener("mousedown",function(t){e.startDrag(t)}),document.addEventListener("mouseup",function(t){e.stopDrag(t)}),document.addEventListener("mousemove",function(t){e.moveSlider(t)}),this.el.appendChild(this.progressBarEl),this.el.appendChild(this.sliderBufferEl),this.el.appendChild(this.sliderValueEl),this.el.appendChild(this.durationEl),this.el.appendChild(this.currentTimeEl),this.controls.el.appendChild(this.el),this.livelyPlayer.on("timeupdate",function(t){e.updateSliderValue(t)}),this.livelyPlayer.on("progress",function(t){e.updateSliderValue(t)}))}},{key:"calculateSeek",value:function(e){if(this.dragging){var t=((0,l.default)(e).x-(0,s.default)(this.el).left)/this.el.getBoundingClientRect().width;t=Math.max(t,0),t=Math.min(t,1),this.nextTime=t*this.livelyPlayer.duration}}},{key:"updateSliderValue",value:function(){if(!this.dragging){for(var e=this.livelyPlayer,t=e.currentTime,r=t/e.duration,n=this.livelyPlayer.bufferTimes,i=void 0,o=0;o<n.length;o++)if(t>=n[o][0]&&t<=n[o][1]){i=n[o];break}if(i){var s=Math.max(Number((i[0]/e.duration).toFixed(2)),0),l=Math.max(Number((i[1]/e.duration).toFixed(2)),0);this.sliderBufferEl.style.left=100*s+"%",this.sliderBufferEl.style.width=100*(l-s)+"%"}else this.sliderBufferEl.style.width=0;this.sliderValueEl.style.width=100*r+"%",(0,a.default)(this.durationEl,""+this.formatHHMMSS(e.duration)),(0,a.default)(this.currentTimeEl,""+this.formatHHMMSS(e.currentTime))}}},{key:"formatHHMMSS",value:function(e){var t=parseInt(e,10),r=Math.floor(t/3600),n=Math.floor((t-3600*r)/60),i=t-3600*r-60*n;function o(e,t){isNaN(t)||(t<10?e.push("0"+t):e.push(t))}var s=[];return o(s,r),o(s,n),o(s,i),s.join(":")}},{key:"moveSlider",value:function(e){if(this.dragging){var t=(0,l.default)(e).x-(0,s.default)(this.el).left;t<0?t=0:t>this.el.clientWidth&&(t=this.el.clientWidth),this.sliderValueEl.style.width=t+"px"}}},{key:"startDrag",value:function(){this.dragging=!0}},{key:"stopDrag",value:function(e){if(this.dragging){this.dragging=!1;var t=((0,l.default)(e).x-(0,s.default)(this.el).left)/this.el.getBoundingClientRect().width;t=Math.max(t,0);var r=(t=Math.min(t,1))*this.livelyPlayer.duration;isNaN(r)?o.default.error("attempted to set current time to NaN",r):this.livelyPlayer.currentTime=r}}},{key:"destroy",value:function(){this.livelyPlayer.removeListener("manifest",this.renderIfNotRendered),this.livelyPlayer.removeListener("timeupdate",this.updateSliderValue),this.livelyPlayer.removeListener("progress",this.updateSliderValue),this.rendered&&(this.rendered=!1,this.el.remove(),this.progressBarEl.remove(),this.sliderBufferEl.remove(),this.sliderValueEl.remove(),document.removeEventListener("mouseup",this.stopDrag.bind(this)))}}]),t}();r.default=c},{"../get-el-position":4,"../get-pointer-position":5,"@livelyvideo/player-core/lib/logger":23,events:45,"text-content":53}],14:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=l(e("events")),o=l(e("text-content")),s=l(e("../create-element"));function l(e){return e&&e.__esModule?e:{default:e}}var a=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.controls=e,r.livelyPlayer=e.livelyPlayer,r.bar=e.bar,r.mediaData=null,r.encodings=[],r.el=(0,s.default)("div"),r.el.setAttribute("title",r.controls.localize("Quality Selector")),r.qualitiesEl=(0,s.default)("div",["lvcontrols__qualities","lvcontrols__qualities--hidden"]),r.el.addEventListener("click",r.openQualitySelector.bind(r)),r.livelyPlayer.on("progress",r.reclass.bind(r)),r.livelyPlayer.on("play",r.render.bind(r)),r.controls.bar.appendChild(r.qualitiesEl),r.controls.bar.appendChild(r.el),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),n(t,[{key:"openQualitySelector",value:function(e){"lvcontrols__qualities"!==this.qualitiesEl.getAttribute("class")&&(this.controls.screenInteraction.lockOpen(),this.qualitiesEl.setAttribute("class","lvcontrols__qualities"),e.stopPropagation(),document.addEventListener("click",this.closeQualitySelector.bind(this)))}},{key:"closeQualitySelector",value:function(){this.controls.screenInteraction.releaseLockOpen(),document.removeEventListener("click",this.closeQualitySelector.bind(this)),this.qualitiesEl.setAttribute("class","lvcontrols__qualities lvcontrols__qualities--hidden")}},{key:"destroy",value:function(){this.livelyPlayer.removeListener("progress",this.reclass.bind(this)),this.livelyPlayer.removeListener("play",this.render.bind(this)),document.removeEventListener("click",this.closeQualitySelector.bind(this)),this.qualitiesEl.remove(),this.el.remove()}},{key:"reclass",value:function(){var e=this.livelyPlayer.currentEncoding(),t=void 0,r=void 0;e||(t=this.currentLevel,r=this.nextLevel);for(var n=void 0,i=0;i<this.qualitiesEl.children.length;i++)n=this.qualitiesEl.children[i],i===t||e&&this.qualitiesEl.children[i].getAttribute("data-location")===e.location?n.classList.add("lvcontrols__quality--current-level"):n.classList.remove("lvcontrols__quality--current-level"),i===r?n.classList.add("lvcontrols__quality--next-level"):n.classList.remove("lvcontrols__quality--next-level")}},{key:"render",value:function(){var e=this;if(this.encodings.forEach(function(e){e.remove()}),this.encodings=[],this.mediaData=this.livelyPlayer.mediaData,this.mediaData&&this.mediaData.encodings&&this.mediaData.encodings.length){this.el.setAttribute("class","lvcontrols__button lvcontrols__quality-selector");for(var t=this.livelyPlayer.currentEncoding(),r=this.livelyPlayer.location,n=this.currentLevel,i=(this.chosenLevel,this.nextLevel),s=function(s,l){var a=document.createElement("div"),u="lvcontrols__quality",c=void 0;if(s.videoKbps){if(s.videoHeight){var f=document.createElement("span");f.setAttribute("class","lvcontrols__kbps"),(0,o.default)(a,s.videoHeight+"p"),(0,o.default)(f,s.videoKbps+s.audioKbps+"Kbps"),a.insertBefore(f,a.firstChild),c=s.videoKbps+s.audioKbps,t&&r&&r.slice(0,s.location.length)===s.location&&(u+=" lvcontrols__quality--selected"),null!==n&&void 0!==l&&l===n&&(u+=" lvcontrols__quality--current-level"),null!==i&&void 0!==l&&l===i&&(u+=" lvcontrols__quality--next-level")}else n--,0,i--,(0,o.default)(a,e.controls.localize("Auto")),c=null,null===t&&(u+=" lvcontrols__quality--selected");a.setAttribute("class",u),a.setAttribute("data-location",s.location),a.addEventListener("click",function(){e.livelyPlayer.bitrate=c,e.render()}),e.qualitiesEl.appendChild(a),e.encodings.push(a)}};this.qualitiesEl.firstChild;)this.qualitiesEl.removeChild(this.qualitiesEl);this.mediaData.auto&&s({location:this.mediaData.manifest,videoKbps:!0}),this.mediaData.encodings.reverse().forEach(s)}else this.el.setAttribute("class","lvcontrols__button lvcontrols__quality-selector lvcontrols__quality-selector--hidden")}},{key:"chosenLevel",get:function(){return this.mediaData&&this.mediaData.encodings?this.livelyPlayer.chosenLevel?this.mediaData.encodings.length-this.livelyPlayer.chosenLevel:this.livelyPlayer.chosenLevel:null}},{key:"currentLevel",get:function(){return this.mediaData&&this.mediaData.encodings?this.livelyPlayer.currentLevel?this.mediaData.encodings.length-this.livelyPlayer.currentLevel:this.livelyPlayer.currentLevel:null}},{key:"nextLevel",get:function(){return this.mediaData&&this.mediaData.encodings?this.livelyPlayer.nextLevel?this.mediaData.encodings.length-this.livelyPlayer.nextLevel:this.livelyPlayer.nextLevel:null}}]),t}();r.default=a},{"../create-element":2,events:45,"text-content":53}],15:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=a(e("events")),o=a(e("@livelyvideo/player-core/lib/detect")),s=a(e("@livelyvideo/player-core/lib/events")),l=a(e("lodash.throttle"));function a(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return i.targetEl=e,i.player=r,i.limit=n||500,i.mobileControls=o.default.any(),i.userInteraction=null,i.userInteractionTimeout=null,i.throttledSetUserInteraction=(0,l.default)(i.setUserInteraction.bind(i),i.limit,{leading:!0,trailing:!1}),i.handleEvents(),i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),n(t,[{key:"handleEvents",value:function(){var e=this;if(this.mobileControls)return this.targetEl.addEventListener("touchend",function(t){t.target.classList.contains("lvcontrols__top-bar")||e.forceInteraction()}),void this.targetEl.addEventListener("touchcancel",function(t){t.target.classList.contains("lvcontrols__top-bar")||e.forceInteraction()});this.targetEl.addEventListener("mouseover",function(t){e.resetUserInteraction(),e.throttledSetUserInteraction(t)}),this.targetEl.addEventListener("mousedown",function(){e.forceInteraction()}),this.targetEl.addEventListener("mouseup",function(){e.forceInteractionEnd()}),this.targetEl.addEventListener("mouseout",function(){e.forceInteractionEnd()})}},{key:"forceInteraction",value:function(){clearTimeout(this.userInteractionTimeout),this.setUserInteraction()}},{key:"lockOpen",value:function(){this.lockedOpen=!0,clearTimeout(this.userInteractionTimeout)}},{key:"releaseLockOpen",value:function(){this.lockedOpen=!1,this.resetUserInteraction()}},{key:"forceInteractionEnd",value:function(){this.setUserInteraction()}},{key:"setUserInteraction",value:function(){this.player.firstPlay&&this.player.shouldTryToPlay||(this.userInteraction||(this.userInteraction=!0,this.emit(s.default.USER_ACTIVE)),this.resetUserInteraction())}},{key:"resetUserInteraction",value:function(){var e=this;clearTimeout(this.userInteractionTimeout),this.userInteractionTimeout=setTimeout(function(){e.lockedOpen||(e.userInteraction=!1,e.emit(s.default.USER_IDLE))},2e3)}},{key:"destroy",value:function(){if(this.mobileControls)return this.targetEl.removeEventListener("touchstart",this.forceInteraction.bind(this)),this.targetEl.removeEventListener("touchend",this.forceInteractionEnd.bind(this)),void this.targetEl.removeEventListener("touchcancel",this.forceInteractionEnd.bind(this));this.targetEl.removeEventListener("mouseover",this.throttledSetUserInteraction.bind(this)),this.targetEl.removeEventListener("mousedown",this.forceInteraction.bind(this)),this.targetEl.removeEventListener("mouseup",this.forceInteractionEnd.bind(this)),this.targetEl.removeEventListener("mouseout",this.forceInteractionEnd.bind(this))}}]),t}();r.default=u},{"@livelyvideo/player-core/lib/detect":18,"@livelyvideo/player-core/lib/events":20,events:45,"lodash.throttle":50}],16:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=u(e("events")),o=u(e("@livelyvideo/player-core/lib/detect")),s=u(e("../get-el-position")),l=u(e("../get-pointer-position")),a=u(e("../create-element"));function u(e){return e&&e.__esModule?e:{default:e}}function c(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var f=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=c(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.controls=e,r.livelyPlayer=e.livelyPlayer,r.bar=e.bar,o.default.any()?c(r):(r.el=(0,a.default)("div"),r.indicatorEl=(0,a.default)("div",["lvcontrols__button","lvcontrols__volume-indicator"]),r.indicatorEl.setAttribute("title",r.controls.localize("Mute")),r.sliderEl=(0,a.default)("div"),r.sliderValueEl=(0,a.default)("div",["lvcontrols__volume-slider-value"]),r.showingSlider=!1,r.hideSlider(),r.sliderEl.appendChild(r.sliderValueEl),r.setMutedClass(),r.indicatorEl.addEventListener("click",function(e){r.toggleMuted(e)}),r.indicatorEl.addEventListener("touch",function(e){r.toggleMuted(e)}),r.el.addEventListener("mouseover",function(){r.showingSlider=!0,r.showSlider()}),r.el.addEventListener("mouseout",function(){r.showingSlider=!1,r.hideSlider()}),r.sliderEl.addEventListener("click",function(e){r.clickVolume(e)}),r.sliderEl.addEventListener("mousedown",function(e){r.startDrag(e)}),r.el.appendChild(r.indicatorEl),r.el.appendChild(r.sliderEl),r.el.setAttribute("class","lvcontrols__volume-bar"),r.bar.appendChild(r.el),r.livelyPlayer.on("mute",function(e){r.setMutedClass(e)}),r.livelyPlayer.on("unmute",function(e){r.setMutedClass(e)}),r.livelyPlayer.on("volume",function(e){r.updateVolume(e)}),r.livelyPlayer.on("play",function(e){r.setMutedClass(e)}),r.updateVolume(),r)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),n(t,[{key:"updateVolume",value:function(){this.setMutedClass(),this.setVolume()}},{key:"setMutedClass",value:function(){var e=this.livelyPlayer.muted?"lvcontrols__volume-indicator--muted":"lvcontrols__volume-indicator--unmuted",t=100*this.livelyPlayer.volume,r="";this.livelyPlayer.muted||(r=0===t?"lvcontrols__volume-indicator--off":100*this.livelyPlayer.volume>50?"lvcontrols__volume-indicator--high":"lvcontrols__volume-indicator--low"),this.indicatorEl.setAttribute("class","lvcontrols__button lvcontrols__volume-indicator "+e+" "+r);var n=this.livelyPlayer.muted?this.controls.localize("Unmute"):this.controls.localize("Mute");this.indicatorEl.setAttribute("title",n)}},{key:"startDrag",value:function(){this.dragging=!0,document.addEventListener("mousemove",this.calculateVolume.bind(this)),document.addEventListener("mouseup",this.stopDrag.bind(this)),document.addEventListener("mouseleave",this.stopDrag.bind(this))}},{key:"stopDrag",value:function(){this.dragging=!1,this.hideSlider(),document.removeEventListener("mouseup",this.stopDrag.bind(this)),document.removeEventListener("mouseleave",this.stopDrag.bind(this)),document.removeEventListener("mousemove",this.calculateVolume.bind(this))}},{key:"calculateVolume",value:function(e){if(this.dragging){var t=Math.floor((0,l.default)(e).x-(0,s.default)(this.sliderEl).left)/100;t=Math.max(t,0),t=Math.min(t,1),this.livelyPlayer.volume=t}}},{key:"clickVolume",value:function(e){this.dragging=!0,this.calculateVolume(e),this.dragging=!1}},{key:"setVolume",value:function(){this.sliderValueEl.style.width=Math.floor(100*this.livelyPlayer.volume)+"%"}},{key:"toggleMuted",value:function(){this.livelyPlayer.muted?this.livelyPlayer.unmute():this.livelyPlayer.mute()}},{key:"showSlider",value:function(){this.sliderEl.setAttribute("class","lvcontrols__volume-slider lvcontrols__volume-slider--interacting")}},{key:"hideSlider",value:function(){this.dragging||this.showingSlider||this.sliderEl.setAttribute("class","lvcontrols__volume-slider ")}},{key:"destroy",value:function(){this.el&&(this.el.remove(),this.indicatorEl.remove(),this.sliderEl.remove(),this.sliderValueEl.remove(),this.livelyPlayer.removeListener("mute",this.setMutedClass.bind(this)),this.livelyPlayer.removeListener("unmute",this.setMutedClass.bind(this)),this.livelyPlayer.removeListener("volume",this.updateVolume.bind(this)),this.livelyPlayer.removeListener("play",this.setMutedClass.bind(this)))}}]),t}();r.default=f},{"../create-element":2,"../get-el-position":4,"../get-pointer-position":5,"@livelyvideo/player-core/lib/detect":18,events:45}],17:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=u(e("events")),o=u(e("./logger")),s=u(e("./detect")),l=u(e("./errors")),a=u(e("./events"));function u(e){return e&&e.__esModule?e:{default:e}}var c=[0,1e3,2e3,5e3,25e3],f=function(e){function t(e,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return i.resetCounts(),i.errors={},i.livelyPlayer=e,i.mediaLoader=r,i.options=n,i.onceHandlerLock=!1,i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),n(t,[{key:"resetCounts",value:function(){this.fragCounts=0,this.fragSize=0,this.fragDuration=0,this.fragDownloadTime=0,this.fragMaxTime=0,this.fragMinTime=0,this.bufferOverflowCount=0,this.bufferUnderflowCount=0,this.upshift=0,this.downshift=0,this.lastProgress=0,this.currentErrorCount=0,this.recentErrorCount=0,this.restartCount=0}},{key:"pickEncoding",value:function(e){if(e&&(this.options.bitrate=e),!this.options.bitrate)return null;var t=this.data.encodings;return t.length?t[this.chosenLevel]:void 0}},{key:"reloadAndRestart",value:function(){var e=this;this.lockReload||this.destroyed||(this.lockReload=!0,this.mediaLoader.load(function(){e.mediaLoader.currentState===a.default.ONLINE?e.restart(function(){e.lockReload=!1}):(e.lockReload=!1,e.stop())}))}},{key:"whenReady",value:function(e){var t=this;if(!this.onceHandlerLock){if(!this.manifest)return this.mediaLoader.currentState===a.default.ONLINE?void this.emit(a.default.ERROR,l.default.DRIVER_NOT_SUPPORTED):(this.onceHandlerLock=!0,void this.mediaLoader.once(a.default.MANIFEST,function(){t.onceHandlerLock=!1,t.whenReady(e)}));e&&e()}}},{key:"setOption",value:function(e,t){switch(this.options[e]=t,e){case"posterURI":this.el&&this.el.setAttribute("poster",t)}}},{key:"elementPlay",value:function(){if(this.el&&this.el.play){var e=this.el.play();"undefined"!=typeof Promise&&e instanceof Promise&&e.catch(function(){})}}},{key:"attachListeners",value:function(){var e=this;this.el.onprogress=function(){e.emitProgress()},this.el.ontimeupdate=function(){e.fragCounts++,e.emitTimeupdate()}}},{key:"play",value:function(e){var t=this,r=e||function(){};if(this.mediaLoader.vod&&this.manifest&&this.manifest===this.el.getAttribute("src"))return this.elementPlay(),void r(!this.el.paused);s.default.any()&&this.elementPlay(),this.whenReady(function(){var e=t.manifest;t.location=e,o.default.setPlayer(t.mediaLoader.host,t.mediaLoader.publicId,t.format,e,t);var n=function(){t.el.onprogress=function(){t.emitProgress()},t.el.ontimeupdate=function(){t.fragCounts++,t.emitTimeupdate()}};s.default.iOS()&&t.el.getAttribute("src")===e||t.el.setAttribute("src",e);var i=t.el.play();if(!i||!i.then){return t.el.addEventListener("loadedmetadata",function e(){r&&r(!t.el.paused),t.el.removeEventListener("loadedmetadata",e)}),void n()}i.then(function(){n(),r&&r(!0)}).catch(function(e){if("AbortError"!==e.name||t.el.muted)return t.emit("video-el-error",{err:e}),void(r&&r(!1));t.mute(),t.emit(a.default.MEDIA_MUTE),t.el.play().then(function(){n(),t.emit(a.default.NO_AUDIO),r&&r(!0)}).catch(function(e){t.emit("video-el-error",{err:e}),r&&r(!1)})})})}},{key:"stop",value:function(){this.el.setAttribute("src","")}},{key:"destroy",value:function(){this.destroyed=!0,this.el.remove(),this.stop()}},{key:"pause",value:function(){this.el.pause()}},{key:"unmute",value:function(){return this.el.muted=!1,this.el.muted}},{key:"mute",value:function(){return this.el.muted=!0,this.el.muted}},{key:"supportsFullscreen",value:function(){var e=document.createElement("video");return!!(document.fullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitSupportsFullscreen||document.webkitFullscreenEnabled||e.webkitRequestFullScreen||e.webkitEnterFullScreen)}},{key:"restartTimeout",value:function(e){var t=this;setTimeout(function(){t.destroyed||(t.stop(),t.play(function(){for(var r=arguments.length,n=Array(r),i=0;i<r;i++)n[i]=arguments[i];t.lockRestart=!1,e&&e.apply(e,n)}))},c[Math.min(this.restartCount,c.length-1)])}},{key:"restart",value:function(e){var t=this;this.lockRestart||(this.lockRestart=!0,this.currentErrorCount=0,this.recentErrorCount=0,this.restartCount++,clearTimeout(this.clearRestartCount),this.clearRestartCount=setTimeout(function(){t.restartCount=0},2*c[c.length-1]),this.emit(a.default.RESTART_DRIVER,{timeout:c[Math.min(this.restartCount,c.length-1)]}),this.restartTimeout(e))}},{key:"checkRestart",value:function(e){var t=this,r=e;this.recentErrorCount++,setTimeout(function(){t.recentErrorCount--,t.recentErrorCount=Math.max(t.recentErrorCount,0)},1e4),this.recentErrorCount>=this.options.recoverErrorCount&&(r.fatal=!0),this.currentErrorCount>=this.options.recoverErrorCount&&(r.fatal=!0),r.fatal&&!this.mediaLoader.vod&&this.restart()}},{key:"handleError",value:function(e,t,r){var n=t+":"+r.details;this.errors[n]||(this.errors[n]=0),this.errors[n]++;for(var i=arguments.length,o=Array(i>3?i-3:0),s=3;s<i;s++)o[s-3]=arguments[s];this.emit.apply(this,[e,t,r].concat(o))}},{key:"playOrigin",value:function(e){this.options.origin=!0,this.restart(e)}},{key:"emitProgress",value:function(){this.lastProgress=window.performance.now(),this.emit(a.default.MEDIA_PROGRESS)}},{key:"emitTimeupdate",value:function(){this.emit(a.default.MEDIA_TIMEUPDATE)}},{key:"format",get:function(){return this.constructor.format}},{key:"driver",get:function(){return this.constructor.driver}},{key:"duration",get:function(){return this.el&&this.el.duration?this.el.duration:1/0}},{key:"bufferTimes",get:function(){for(var e=[],t=this.el.buffered.length,r=0;r<t;r++)e.push([this.el.buffered.start(r),this.el.buffered.end(r)]);return e}},{key:"volume",get:function(){return this.el.volume},set:function(e){return void 0!==e&&(this.el.volume=e),this.el.muted&&e&&e>0&&this.unmute(),this.el.volume}},{key:"supportsAutoplay",get:function(){return!s.default.any()}},{key:"supportsMobileAutoplay",get:function(){return!1}},{key:"supportsVolume",get:function(){return!0}},{key:"origin",get:function(){var e=this.data.origin;if(!e){if(!this.data||!this.data.encodings.length)return null;var t=this.data;return t.encodings[t.encodings.length-1]}return e}},{key:"originLocation",get:function(){var e=this.origin;return e?e.location:null}},{key:"data",get:function(){var e=this.mediaLoader.get(this.format);return e.auto=!0,e}},{key:"chosenLevel",get:function(){if(!this.options.bitrate)return null;var e=this.data.encodings;if(e.length){var t=void 0;for(t=0;t<e.length&&!(e[t].videoWidth&&e[t].videoKbps+e[t].audioKbps>this.options.bitrate);t++);return t=Math.max(t-1,0)}}},{key:"currentLevel",get:function(){return this.chosenLevel}},{key:"nextLevel",get:function(){return null}},{key:"manifest",get:function(){if(this.options.origin){var e=this.originLocation;return e||(this.options.origin=!1,this.manifest())}var t=this.data;if(!t.encodings.length){var r=this.originLocation;return r&&(this.options.origin=!0),r}var n=this.pickEncoding(),i=void 0;if(!(i=n?n.location:t.manifest))return null;var o=-1===i.indexOf("?")?"?":"&";return null===this.options.preset||(this.options.preset?i+=o+"preset="+this.options.preset:s.default.any()||(i+=o+"preset=desktop")),i}},{key:"currentTime",get:function(){return this.el.currentTime},set:function(e){this.el.currentTime=e}},{key:"stopped",get:function(){return!!this.el.getAttribute("src","")}},{key:"bitrate",set:function(e){var t=this,r=this.el.currentTime;this.stop(),this.options.bitrate=e,this.mediaLoader.vod&&(this.el.onloadedmetadata=function(){t.el.onloadedmetadata=null,t.el.currentTime=r},this.el.oncanplay=function(){t.el.oncanplay=null,t.el.currentTime>=r||(t.el.currentTime=r)}),this.play(function(){t.emit(a.default.BITRATE_SWITCH)})}},{key:"muted",get:function(){return!!this.el.muted}},{key:"paused",get:function(){return this.el.paused}},{key:"details",get:function(){return{bufferOverflowCount:this.bufferOverflowCount||0,bufferUnderflowCount:this.bufferUnderflowCount||0,downshift:this.downshift||0,errors:this.errors||{},muted:this.el&&this.el.muted,segments:this.fragCounts||0,segmentsSize:this.fragSize||0,segmentsDuration:this.fragDuration||0,segmentTotalDownloadTime:this.fragDownloadTime||0,segMaxTime:this.fragMaxTime||0,segMinTime:this.fragMinTime||0,upshift:this.upshift||0,volume:this.el&&this.el.volume?this.el.volume:0}}}],[{key:"isSupported",value:function(){o.default.error("an abstract method has been called")}},{key:"defaultOptions",get:function(){return{adaptive:null,bitrate:null,muted:!1,volume:.75}}}]),t}();r.default=f},{"./detect":18,"./errors":19,"./events":20,"./logger":23,events:45}],18:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={};function i(e,t){return function(){return void 0===n[e]&&(n[e]=t()),n[e]}}function o(){var e=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);return!!e&&parseInt(e[2],10)}function s(){if(/iP(hone|od|ad)/.test(navigator.platform)){var e=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);return[parseInt(e[1],10),parseInt(e[2],10),parseInt(e[3]||0,10)]}}function l(){var e=navigator.userAgent.match(/Version\/([0-9]+)\./);return!!e&&parseInt(e[1],10)}var a={chromeGreater50:i("chromeGreater50",function(){return!!a.chrome()&&o()>49}),modernChrome:i("modernChrome",function(){return!!a.chrome()&&o()>52}),winChrome51:i("winChrome51",function(){return!!a.windowsDesktop()&&(!!a.chrome()&&o()<52)}),desktopSafari:i("desktopSafari",function(){return!!a.safari()&&!!l()}),oldSafari:i("oldSafari",function(){if(!a.safari())return!1;var e=l();return!!e&&e<10}),iPhone10:i("iPhone10",function(){if(!a.iPhone())return!1;var e=s();return e&&e[0]>=10}),iPhone9:i("iPhone9",function(){if(!a.iPhone())return!1;var e=s();return e&&e[0]<10}),modernMobile:i("modernMobile",function(){return!!a.any()&&(!(!a.android()||!a.modernChrome())||!!a.iPhone10())}),windowsDesktop:i("windowsDesktop",function(){return/Windows/i.test(navigator.userAgent)}),chrome:i("chrome",function(){return/Chrome/i.test(navigator.userAgent)}),firefox:i("firefox",function(){return/Firefox/i.test(navigator.userAgent)}),ie:i("ie",function(){return/Trident/i.test(navigator.userAgent)}),edge:i("edge",function(){return/Edge\/\d+/.test(navigator.userAgent)}),safari:i("safari",function(){return/Safari/i.test(navigator.userAgent)}),windows:i("windows",function(){return/IEMobile/i.test(navigator.userAgent)}),android:i("android",function(){return/Android/i.test(navigator.userAgent)}),blackBerry:i("blackBerry",function(){return/BlackBerry/i.test(navigator.userAgent)}),iOS:i("iOS",function(){return/iPhone|iPad|iPod/i.test(navigator.userAgent)}),iPhone:i("iPhone",function(){return/iPhone/i.test(navigator.userAgent)}),any:i("any",function(){return a.android()||a.blackBerry()||a.iOS()||a.windows()})};r.default=a},{}],19:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.default={BAD_INPUT:"bad-input",DRIVER_NOT_SUPPORTED:"driver-not-supported",ELEMENT_REQUIRED:"element-required",EMBED_SWF_FAILED:"embedding-flash-swf-failed",GET_USER_MEDIA_FAILED:"get-user-media-failed",HTTP_SERVER_UNEXPECTED_RESPONSE:"http-server-unexpected-response",HTTP_SERVER_UNAUTHORIZED:"http-server-unauthorized",HTTP_SERVER_FORBIDDEN:"http-server-forbidden",HTTP_SERVER_INTERNAL_ERROR:"http-server-internal-error",HTTP_SERVER_NOT_FOUND:"http-server-not-found",MANIFEST:"http-response",INVALID_CONTROLS:"invalid-controls-parent",INVALID_MEDIA_URL:"invalid-media-url",INVALID_POPOUT_URL:"invalid-popout-url",INVALID_EL:"invalid-element",WS_NETWORK_ERROR:"websocket-network-error",NETWORK_ERROR:"network-error",NO_DRIVERS:"no-valid-drivers",PLAYBACK_ERROR:"playback-error",UNKNOWN_DRIVER:"unknown-driver",UNKNOWN_ERROR:"unknown-error",UNRECOGNIZED_DRIVER:"unrecognized-driver",USER_REQUIRED:"user-required"}},{}],20:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.default={EXIT_FULLSCREEN:"exit-fullscreen",ENTER_FULLSCREEN:"enter-fullscreen",ERROR:"error",BITRATE_SWITCH:"bitrate-switch",SELECT_DRIVER:"select-driver",RESTART_DRIVER:"restart-driver",MANIFEST:"manifest",LOG:"log",MEDIA_ENDED:"ended",MEDIA_PLAY:"play",MEDIA_STOP:"stop",MEDIA_PAUSE:"pause",MEDIA_STALL:"stall",MEDIA_PROGRESS:"progress",MEDIA_TIMEUPDATE:"timeupdate",MEDIA_MUTE:"mute",MEDIA_UNMUTE:"unmute",MEDIA_VOLUME:"volume",ONLINE:"online",OFFLINE:"offline",NO_AUDIO:"no-audio",ESTIMATED_BW:"estimated-bw",USER_ACTIVE:"user-active",VIEWERS:"viewers",USER_IDLE:"user-idle"}},{}],21:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function e(t,r){return 0===r?t:e(r,t%r)}},{}],22:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e,t){var r=e?Object.create(e):{};if(!t)return r;for(var n in t)void 0===r[n]&&(r[n]=t[n]);return r}},{}],23:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n,i=e("./logger");var o=new((n=i)&&n.__esModule?n:{default:n}).default;r.default=o},{"./logger":24}],24:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=s(e("events")),o=s(e("../uuidv4"));function s(e){return e&&e.__esModule?e:{default:e}}var l=["debug","error","info","warn","timing","deprecated"],a=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.sessionKey=(0,o.default)(),e.sessionQueryString="sessionId="+e.sessionKey,e.host=null,e.setLevels(),e.publicKey=null,e.format=null,e.encoding=null,e.writeLogs=!0,e.disable(),e.enable(),e.logEntries=[],e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),n(t,[{key:"setLevels",value:function(e){var t=e||{};this.levels={debug:t.debug||!1,error:t.error||1,warn:t.warn||1,info:t.info||1,timing:t.timing||0}}},{key:"setPlayer",value:function(e,t,r,n,i){this.host=e,this.publicKey=t,this.format=r,this.encoding=n,this.driver=i}},{key:"checkSet",value:function(){return!this.host||!this.publicKey||!this.format}},{key:"levelIsSupported",value:function(e){return-1!==l.indexOf(e)}},{key:"log",value:function(e){if(this.levelIsSupported(e)){if(this.levels[e]&&this.writer[e]&&this.writer[e].apply){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var i;if(this.writeLogs)(i=this.writer)[e].apply(i,r);this.emit("log",r)}}else this.log("error","unsupported log level",{level:e})}},{key:"disable",value:function(){this.writer={};for(var e=0;e<l.length;e++)this.writer[l[e]]=function(){}}},{key:"enable",value:function(){window.console&&(this.writer=window.console,this.writer.timing=this.writer.info,this.writer.deprecated=this.writer.info)}},{key:"argJoin",value:function(e,t){for(var r=[e],n=0;n<t.length;n++)r.push(t[n]);return r}},{key:"debug",value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];this.log.apply(this,["debug"].concat(t))}},{key:"error",value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];this.log.apply(this,["error"].concat(t))}},{key:"timing",value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];this.log.apply(this,["timing"].concat(t))}},{key:"info",value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];this.log.apply(this,["info"].concat(t))}},{key:"warn",value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];this.log.apply(this,["warn"].concat(t))}},{key:"deprecated",value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];this.log.apply(this,["deprecated"].concat(t))}},{key:"writeLogsToConsole",set:function(e){this.writeLogs=!1!==e}}]),t}();r.default=a},{"../uuidv4":38,events:45}],25:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=d(e("events")),s=d(e("xhr")),l=d(e("@livelyvideo/views")),a=d(e("./errors")),u=d(e("./events")),c=d(e("./parse-url")),f=d(e("./logger"));function d(e){return e&&e.__esModule?e:{default:e}}function h(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var v=["aac","mp3"],p=["aac"],y=function(e){function t(e,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=h(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));if(n.currentState=u.default.OFFLINE,n.formats={},n.pingUri=null,n.destroyed=!1,n.options=r,n.setManifest(e),n.uri&&(n.options.pollingInterval=parseInt(n.options.pollingInterval,10),n.options.unauthorizedPollingInterval=parseInt(n.options.unauthorizedPollingInterval,10),n.options.unauthorizedRecoveryDuration=parseInt(n.options.unauthorizedRecoveryDuration,10)),n.setUri(e),n.shouldBePolling=!1,!n.options.host)return h(n);var i=(0,c.default)(n.uri).pathname.replace(/\//g,"");return n.views=new l.default(window.location.protocol+"//"+n.options.host+"/v/v1/"+i,window.location.protocol+"//"+n.options.host+"/view/v1/views/"+i),n.views.on("error",function(e){n.emit(u.default.ERROR,e)}),n.views.on("views",function(e){n.emit(u.default.VIEWERS,e)}),n.views.track(),n.views.get(),n.viewsInterval=setInterval(function(){n.views.get()},1e4),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),i(t,[{key:"modifyFormats",value:function(e){for(var t in e)e[t].encodings&&e[t].encodings.length&&("mp4-ws"===t&&e[t].origin&&-1===p.indexOf(e[t].origin.audioCodec)?e[t].origin=null:"mp4-hls"===t&&e[t].origin&&-1===v.indexOf(e[t].origin.audioCodec)&&(e[t].origin=null));return e}},{key:"load",value:function(e,t){var r=this;if(this.manifest||this.vod)return this.emit(u.default.MANIFEST,this.currentState),void(t&&t());(e||this.uri)&&("string"!=typeof e&&(t=e,e=null),this.setUri(e)?(0,s.default)({method:"GET",uri:this.uri,json:!0,useXDR:!0},function(e,n,i){if(!r.destroyed){var o=n?n.statusCode:0;f.default.debug("manifest received",{body:i,code:o,uri:r.uri,err:e?e.stack:void 0});var s=void 0;e?s=new Error(a.default.HTTP_SERVER_INTERNAL_ERROR):o>499?s=new Error(a.default.HTTP_SERVER_INTERNAL_ERROR):404===o?s=new Error(a.default.HTTP_SERVER_NOT_FOUND):403===o?s=new Error(a.default.HTTP_SERVER_FORBIDDEN):401===o?s=new Error(a.default.HTTP_SERVER_UNAUTHORIZED):o>399?s=new Error(a.default.HTTP_SERVER_UNEXPECTED_STATUS_CODE):r.validateResponse(i)||(s=new Error(a.default.HTTP_SERVER_UNEXPECTED_RESPONSE)),s&&r.emit(u.default.ERROR,s.message,{code:o,body:i});var l=void 0;404!==o&&i&&i.formats?200===o&&i.self&&(r.uri=i.self):l=u.default.OFFLINE,l||(r.formats=r.modifyFormats(i.formats),l=Object.keys(r.formats).length?u.default.ONLINE:u.default.OFFLINE),l!==r.currentState&&r.emit(l),r.currentState=l,r.pingUri=i&&i.ping?i.ping:null,r.type=i&&i.type?i.type:"live",r.emit(u.default.MANIFEST,r.currentState,o),r.setNextPoll(o),t&&t()}}):t&&t(new Error(a.default.INVALID_MEDIA_URL)))}},{key:"setNextPoll",value:function(e){var t=this;if(!this.vod){clearTimeout(this.pollingTimeout);var r=void 0;switch(e){case 401:case 403:this.noLongerUnauthorizedPolling?r=this.options.pollingInterval:(r=this.options.unauthorizedPollingInterval,this.unauthorizedRecoveryTimout||(this.unauthorizedRecoveryTimout=setTimeout(function(){t.noLongerUnauthorizedPolling=!0},this.options.unauthorizedRecoveryDuration)));break;default:this.noLongerUnauthorizedPolling=null,r=this.options.pollingInterval}this.pollingTimeout=setTimeout(function(){t.load()},r)}}},{key:"setManifest",value:function(e){this.type=null,this.formats={},"string"==typeof e?this.uri=e:e&&"object"===(void 0===e?"undefined":n(e))&&(this.uri=e.self,this.manifest=e,this.currentState=u.default.ONLINE,this.type=this.manifest.type,this.formats=this.manifest.formats)}},{key:"validateResponse",value:function(e){return!(!e||"object"!==(void 0===e?"undefined":n(e)))&&"object"===n(e.formats)}},{key:"setUri",value:function(e){return e?"string"==typeof e?(this.uri=e,!0):"object"===(void 0===e?"undefined":n(e))?(this.manifest=e,e.self&&(this.uri=e.self),!0):(this.emit(u.default.ERROR,a.default.INVALID_MEDIA_URL),!1):!!this.uri}},{key:"get",value:function(e){if(!this.formats[e])return{type:null,encodings:[],origin:null,manifest:null,audioCodec:null,videoCodec:null,state:u.default.ONLINE};var t=[];if(this.formats[e].encodings)t=this.formats[e].encodings.sort(function(e,t){return e.videoKbps+e.audioKbps>t.videoKbps+t.audioKbps?1:-1});else for(var r=Object.keys(this.formats[e]).filter(function(e){return!isNaN(e)}).sort(),n=0;n<r.length;n++)t.push(this.formats[e][r[n]]);var i=this.formats[e].origin;return i&&(i.origin=!0),{type:this.type,origin:i,encodings:t,audioCodec:this.formats[e].audioCodec,videoCodec:this.formats[e].videoCodec,manifest:this.formats[e].manifest,state:u.default.ONLINE}}},{key:"destroy",value:function(){this.views&&this.views.stopTracking(),clearInterval(this.viewsInterval),this.destroyed=!0,clearInterval(this.pollingTimeout)}},{key:"startInterval",value:function(){!this.options.pollingInterval||this.manifest||this.vod?this.shouldBePolling=!1:this.shouldBePolling=!0}},{key:"hasPlayableMedia",get:function(){return!(!this.uri&&!this.manifest)}},{key:"vod",get:function(){return"recorded"===this.type}}]),t}();r.default=y},{"./errors":19,"./events":20,"./logger":23,"./parse-url":26,"@livelyvideo/views":44,events:45,xhr:55}],26:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e){var t=document.createElement("a");return t.href=e,!!t.pathname&&{href:t.href,protocol:t.protocol,port:t.port,pathname:t.pathname,search:t.search,host:t.host||window.location.host}}},{}],27:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=y(e("events")),s=y(e("./detect")),l=y(e("./logger")),a=y(e("./store")),u=e("./stats"),c=y(e("./media-loader")),f=y(e("./errors")),d=y(e("./events")),h=y(e("./gcd")),v=y(e("./get-default-options"));e("./polyfills");var p=y(e("./storage-values"));function y(e){return e&&e.__esModule?e:{default:e}}function m(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var b=850,g={autoplay:!0,bitrate:void 0,bitrateTolerance:function(e){return 1.15*e},debug:!1,flashWmode:"transparent",flashFrameRate:60,fullscreenEl:"parent",forceDrivers:!1,incognito:!1,formats:null,maxBufferLength:30,maxBufferSize:6e7,muted:void 0,pollingInterval:1e4,unauthorizedPollingInterval:1e3,unauthorizedRecoveryDuration:5e3,posterURI:null,preset:void 0,recoverErrorCount:10,recoverTimeout:4e3,startTime:0,host:null,trackViews:!0,volume:1,origin:!1,flashlsPath:"../dist/flashlsChromeless.swf",strobeSwfPath:"../dist/StrobeMediaPlayback.swf",tfSwfPath:"../dist/thin.swf",avpPath:"../dist/avp.swf",hlsjsPath:null,writeLogsToConsole:!0},_=function(e){function t(e,r,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var o=m(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));switch(o.availableDrivers=[],void 0===e?"undefined":n(e)){case"string":o.el=document.querySelector(e);break;case"object":o.el=e;break;default:o.error(f.default.INVALID_EL)}if(o.options=(0,v.default)(i,g),o.store=new a.default,o.options.incognito?o.store={get:function(){},set:function(e,t){return t}}:o.store=new a.default,o.firstPlay=!0,void 0===o.options.muted){var u=o.store.get(p.default.muted);o.options.muted=null!==u?"true"===u:o.options.muted}var h=o.store.get(p.default.volume);o.options.volume=isNaN(parseFloat(h))?o.options.volume:parseFloat(h),o.options.bitrate&&!parseInt(o.options.bitrate,10)&&(o.error(f.default.INVALD_BITRATE),o.options.bitrate=void 0),void 0!==o.options.bitrate&&o.storeBitrate(o.options.bitrate);var y=parseInt(o.store.get(p.default.lockedKbps),10);if(o.options.bitrate=y||parseInt(o.options.bitrate,10)||null,o.estimatedKbps=parseInt(o.store.get(p.default.estimatedKbps),10)||b,o.isTryingToPlay=!1,o.shouldTryToPlay=o.options.autoplay,l.default.writeLogsToConsole=o.options.writeLogsToConsole,o.options.debug?l.default.setLevels({debug:!0,error:1,warn:1,info:1,timing:1}):l.default.setLevels(),o.trackFirstProgress(),!Array.isArray(o.options.drivers))return l.default.error("invalid drivers, must be an array",o.options.drivers),m(o);for(var _=0;_<o.options.drivers.length;_++)if("function"!=typeof o.options.drivers[_])return l.default.error("invalid drivers, each driver must type function, check driver at index "+_),m(o);var w=void 0;return!o.options.hijackingClicks&&o.options.autoplay&&s.default.modernMobile()&&(o.options.muted=!0,w=!0),o.mediaLoader=o.options.mediaLoader||new c.default(r,o.options),o.setDrivers(o.options.drivers),o.mediaLoader.on(d.default.ERROR,o.eventHandler(d.default.ERROR).bind(o)),o.mediaLoader.on(d.default.MANIFEST,o.eventHandler(d.default.MANIFEST).bind(o)),o.mediaLoader.on(d.default.VIEWERS,o.eventHandler(d.default.VIEWERS).bind(o)),o.mediaLoader.on(d.default.MANIFEST,function(e,t){if(o.mediaLoader.currentState===d.default.ONLINE)return o.watchForAudioSwitch()?(o.currentDriver.options.origin=!1,o.currentDriver.stop(),o.isTryingToPlay=!0,void o.currentDriver.play(function(e){o.shouldTryToPlay=!1,e&&o.emit(d.default.MEDIA_PLAY)})):void(o.shouldTryToPlay&&o.currentDriver&&o.play(function(e){e&&w&&o.currentDriver.muted&&(o.emit(d.default.NO_AUDIO),w=!1),s.default.any()&&(o.shouldTryToPlay=!1)}));401!==t&&403!==t||!o.currentDriver||o.stop()}),o.mediaLoader.on(d.default.ONLINE,function(){o.emit(d.default.ONLINE)}),o.mediaLoader.on(d.default.OFFLINE,function(){o.tryingToPlay&&(o.shouldTryToPlay=!0),o.emit(d.default.OFFLINE)}),o.mediaLoader.load(),o.mediaLoader.startInterval&&o.mediaLoader.startInterval(),o.options.hijackingClicks&&o.options.autoplay&&o.currentDriver&&o.currentDriver.elementPlay&&o.currentDriver.elementPlay(),o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),i(t,[{key:"trackFirstProgress",value:function(){var e=this;this.options.autoplay&&(this.autoplayProgressId=u.stats.start(u.STATS_EVENTS.AUTOPLAY_PROGRESS),this.once(d.default.MEDIA_TIMEUPDATE,function(){u.stats.stop(e.autoplayProgressId,{driver:e.currentDriver.driver})}))}},{key:"watchForAudioSwitch",value:function(){return!(!this.currentDriver||!this.currentDriver.options.origin)&&!this.mediaLoader.get(this.currentDriver.format).origin}},{key:"setOption",value:function(e,t){this.options[e]=t,this.currentDriver&&this.currentDriver.setOption(e,t)}},{key:"destroy",value:function(){this.mediaLoader&&this.mediaLoader.destroy&&(this.mediaLoader.removeAllListeners(d.default.MANIFEST),this.mediaLoader.destroy());var e=void 0;if(this.currentDriver){for(e in d.default)this.currentDriver.removeAllListeners(d.default[e]),this.currentDriver.removeAllListeners(d.default[e],this.eventHandler(d.default[e]));this.currentDriver.destroy()}this.removeAllListeners(d.default.MEDIA_PROGRESS),this.emit(d.default.DESTROY)}},{key:"storeBitrate",value:function(e){var t=this.options.bitrateTolerance?this.options.bitrateTolerance(e):e;this.store.set(p.default.lockedKbps,t)}},{key:"playOrigin",value:function(){this.options.origin=!0,this.store.set(p.default.origin,1),this.store.set(p.default.lockedKbps,null),this.currentDriver&&(this.currentDriver.options.origin=!0,this.currentDriver.elementPlay(),this.mediaLoader.hasPlayableMedia&&this.currentDriver.playOrigin())}},{key:"restart",value:function(){var e=this.tryingToPlay;this.stop(),this.shouldTryToPlay=e,this.mediaLoader.load()}},{key:"switchDrivers",value:function(e){this.options.drivers=e,this.setDrivers(e),this.restart()}},{key:"getState",value:function(){return this.mediaLoader.currentState}},{key:"eventHandler",value:function(e){var t=this;return function(){for(var r=arguments.length,n=Array(r),i=0;i<r;i++)n[i]=arguments[i];("error"!==e||t._events&&t._events.hasOwnProperty("error"))&&t.emit.apply(t,[e].concat(n))}}},{key:"error",value:function(e,t){this._events&&!this._events.hasOwnProperty("error")||this.emit(d.default.ERROR,e,t),l.default.warn(e)}},{key:"setDrivers",value:function(e){var t=void 0;this.availableDrivers=[];for(var r=0;r<e.length;r++)(t=e[r])&&t.isSupported()?(this.options.forceDrivers||t.isSupported())&&this.availableDrivers.push(t):l.default.debug("driver at index "+r+" is not supported");this.availableDrivers.length?this.driver=0:this.noDrivers()}},{key:"pause",value:function(){this.isTryingToPlay=!1,this.currentDriver&&this.currentDriver.pause(),this.emit(d.default.MEDIA_PAUSE)}},{key:"noDrivers",value:function(){this.mediaLoader.currentState===d.default.ONLINE&&this.error(f.default.NO_DRIVERS)}},{key:"play",value:function(e){var t=this;this.mediaLoader.hasPlayableMedia?this.currentDriver?(this.isTryingToPlay=!0,this.currentDriver.play(function(r){if(!r)return!1===r&&t.emit(d.default.MEDIA_PLAY_FAILED),t.isTryingToPlay=!1,void(e&&e(r));t.shouldTryToPlay=!1,"true"===t.store.get(p.default.muted)&&t.currentDriver.mute(),t.firstPlay&&t.vod&&t.options.startTime&&(t.currentDriver.currentTime=t.options.startTime),t.isTryingToPlay=!0,t.mediaLoader.state!==d.default.OFFLINE?(setTimeout(function(){t.emit(d.default.MEDIA_PLAY)}),t.firstPlay=!1,e&&e(r)):e&&e(r)})):this.noDrivers():this.currentDriver&&this.currentDriver.elementPlay(e)}},{key:"stop",value:function(){this.isTryingToPlay=!1,this.currentDriver&&this.currentDriver.stop(),this.emit(d.default.MEDIA_STOP)}},{key:"isTryingToPlayAudio",value:function(){return this.currentDriver?this.currentDriver.isTryingToPlayAudio(this.tryingToPlay):this.tryingToPlay}},{key:"playAudio",value:function(){this.currentDriver&&(this.muted&&this.unmute(),this.volume||(this.volume=1),this.currentDriver.playAudio&&this.currentDriver.playAudio())}},{key:"mute",value:function(){if(!this.currentDriver)return this.noDrivers(),null;var e=this.currentDriver.mute();return this.store.set(p.default.muted,String(e)),this.emit(d.default.MEDIA_MUTE),e}},{key:"unmute",value:function(){if(!this.currentDriver)return this.noDrivers(),null;var e=this.currentDriver.unmute();return this.store.set(p.default.muted,String(e)),this.emit(d.default.MEDIA_UNMUTE),e}},{key:"currentEncoding",value:function(){return this.currentDriver?this.currentDriver.pickEncoding():void 0}},{key:"supportsFullscreen",value:function(){return this.currentDriver?this.currentDriver.supportsFullscreen():null}},{key:"supportsVolume",value:function(){return this.currentDriver?this.currentDriver.supportsVolume():null}},{key:"location",get:function(){if(this.currentDriver)return this.currentDriver.location}},{key:"manifest",get:function(){return this.mediaLoader&&this.mediaLoader.uri?this.mediaLoader.uri:null}},{key:"bitrate",set:function(e){this.storeBitrate(e),this.currentDriver.bitrate=e}},{key:"driver",set:function(e){var t=this;if(this.availableDrivers[e]){var r=this.availableDrivers[e];this.currentDriver&&(this.currentDriver.destroy(),this.currentDriver=null),this.currentDriver=new r(this,this.mediaLoader,{bitrate:this.options.bitrate,estimatedKbps:this.estimatedKbps,volume:this.options.volume,muted:this.options.muted,debug:this.options.debug,recoverTimeout:this.options.recoverTimeout,recoverErrorCount:this.options.recoverErrorCount,maxBufferLength:this.options.maxBufferLength,maxBufferSize:this.options.maxBufferSize,preset:this.options.preset,flashlsPath:this.options.flashlsPath,tfSwfPath:this.options.tfSwfPath,strobeSwfPath:this.options.strobeSwfPath,avpPath:this.options.avpPath,hlsjsPath:this.options.hlsjsPath,posterURI:this.options.posterURI,flashFrameRate:this.options.flashFrameRate,flashWmode:this.options.flashWmode,origin:this.options.origin,mse:this.options.mse}),this.currentDriver.on(d.default.ERROR,function(r){var n=function(){var r=t.currentDriver.driver;if(t.currentDriver.destroy(),t.currentDriver=null,!t.availableDrivers.length)return t.shouldTryToPlay=!0,t.isTryingToPlay=!1,t.setDrivers(t.options.drivers),void l.default.info("driver list reset, will retry next poll",{driver:t.currentDriver.driver});t.availableDrivers.splice(e,1),t.driver=e,l.default.info("next driver",{driver:t.driver?t.driver.driver:null,lastDriver:r}),t.tryingToPlay&&t.play()};switch(r){case f.default.EMBED_SWF_FAILED:case f.default.DRIVER_NOT_SUPPORTED:n()}}),this.emit(d.default.SELECT_DRIVER,this.currentDriver),this.currentDriver.on(d.default.ESTIMATED_BW,function(e){t.store.set(p.default.estimatedKbps,parseInt(e,10)||600)}),this.currentDriver.on(d.default.MEDIA_ENDED,function(){t.isTryingToPlay=!1});for(var n in d.default)this.currentDriver.on(d.default[n],this.eventHandler(d.default[n]))}else this.noDrivers()}},{key:"duration",get:function(){return this.currentDriver?this.currentDriver.duration:1/0}},{key:"vod",get:function(){return this.mediaLoader?this.mediaLoader.vod:null}},{key:"bufferLength",get:function(){return this.currentDriver?this.currentDriver.bufferLength:0}},{key:"backBufferLength",get:function(){return this.currentDriver?this.currentDriver.backBufferLength:0}},{key:"currentTime",get:function(){return this.currentDriver?this.currentDriver.currentTime:0},set:function(e){this.currentDriver&&(this.currentDriver.currentTime=e)}},{key:"bufferTimes",get:function(){return this.currentDriver?this.currentDriver.bufferTimes:[]}},{key:"tryingToPlay",get:function(){return!!this.isTryingToPlay}},{key:"muted",get:function(){return this.currentDriver?this.currentDriver.muted:(this.noDrivers(),null)}},{key:"mediaData",get:function(){return this.currentDriver?this.currentDriver.data:null}},{key:"allMediaData",get:function(){for(var e=this.availableDrivers,t=[],r=void 0,n=0;n<e.length;n++)if((r=e[n]).isSupported&&r.isSupported(this.el)){var i=this.mediaLoader.get(r.format);if(!i.manifest)continue;i.driver=r.driver,t.push(i)}return t}},{key:"volume",set:function(e){if(this.currentDriver){var t=this.currentDriver.volume=e;return this.store.set(p.default.muted,0===t),this.store.set(p.default.volume,t),this.emit(d.default.MEDIA_VOLUME,t),t}},get:function(){return this.currentDriver?this.currentDriver.volume:0}},{key:"details",get:function(){return this.currentDriver?this.currentDriver.details:{}}},{key:"chosenLevel",get:function(){if(this.currentDriver)return this.currentDriver.chosenLevel}},{key:"currentLevel",get:function(){if(this.currentDriver)return this.currentDriver.currentLevel}},{key:"nextLevel",get:function(){if(this.currentDriver)return this.currentDriver.nextLevel}},{key:"aspectRatio",get:function(){if(!this.currentDriver)return null;var e=this.currentDriver.data;if(!e)return null;if(!e.encodings||!e.encodings.length)return null;if(!e.encodings[0].videoWidth||!e.encodings[0].videoHeight)return null;var t=(0,h.default)(e.encodings[0].videoWidth,e.encodings[0].videoHeight);return{width:e.encodings[0].videoWidth/t,height:e.encodings[0].videoHeight/t}}}]),t}();r.default=_},{"./detect":18,"./errors":19,"./events":20,"./gcd":21,"./get-default-options":22,"./logger":23,"./media-loader":25,"./polyfills":28,"./stats":30,"./storage-values":32,"./store":37,events:45}],28:[function(e,t,r){"use strict";var n,i,o,s,l,a,u,c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};"remove"in window.Element.prototype||(window.Element.prototype.remove=function(){this.parentNode&&this.parentNode.removeChild(this)}),"function"!=typeof Object.create&&(Object.create=(n=function(){},function(e,t){if(e!==Object(e)&&null!==e)throw TypeError("Argument must be an object, or null");n.prototype=e||{},void 0!==t&&Object.defineProperties(n.prototype,t);var r=new n;return n.prototype=null,r})),function(){for(var e=0,t=["ms","moz","webkit","o"],r=0;r<t.length&&!window.requestAnimationFrame;++r)window.requestAnimationFrame=window[t[r]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[r]+"CancelAnimationFrame"]||window[t[r]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t,r){var n=(new Date).getTime(),i=Math.max(0,16-(n-e)),o=window.setTimeout(function(){t(n+i)},i);return e=n+i,o}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})}(),i=window,o=Date.now?Date.now():+new Date,i.performance=i.performance||{},i.performance.now=i.performance.webkitNow||i.performance.mozNow||i.performance.msNow||function(){return(Date.now?Date.now():+new Date)-o},Object.keys||(Object.keys=(s=Object.prototype.hasOwnProperty,l=!{toString:null}.propertyIsEnumerable("toString"),u=(a=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"]).length,function(e){if("object"!==(void 0===e?"undefined":c(e))&&("function"!=typeof e||null===e))throw new TypeError("Object.keys called on non-object");var t=[],r=void 0,n=void 0;for(r in e)s.call(e,r)&&t.push(r);if(l)for(n=0;n<u;n++)s.call(e,a[n])&&t.push(a[n]);return t})),"document"in self&&("classList"in document.createElement("_")&&(!document.createElementNS||"classList"in document.createElementNS("http://www.w3.org/2000/svg","g"))?function(){var e=document.createElement("_");if(e.classList.add("c1","c2"),!e.classList.contains("c2")){var t=function(e){var t=DOMTokenList.prototype[e];DOMTokenList.prototype[e]=function(e){var r,n=arguments.length;for(r=0;r<n;r++)e=arguments[r],t.call(this,e)}};t("add"),t("remove")}if(e.classList.toggle("c3",!1),e.classList.contains("c3")){var r=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(e,t){return 1 in arguments&&!this.contains(e)==!t?t:r.call(this,e)}}e=null}():function(e){if("Element"in e){var t="classList",r="prototype",n=e.Element[r],i=Object,o=String[r].trim||function(){return this.replace(/^\s+|\s+$/g,"")},s=Array[r].indexOf||function(e){for(var t=0,r=this.length;t<r;t++)if(t in this&&this[t]===e)return t;return-1},l=function(e,t){this.name=e,this.code=DOMException[e],this.message=t},a=function(e,t){if(""===t)throw new l("SYNTAX_ERR","An invalid or illegal string was specified");if(/\s/.test(t))throw new l("INVALID_CHARACTER_ERR","String contains an invalid character");return s.call(e,t)},u=function(e){for(var t=o.call(e.getAttribute("class")||""),r=t?t.split(/\s+/):[],n=0,i=r.length;n<i;n++)this.push(r[n]);this._updateClassName=function(){e.setAttribute("class",this.toString())}},c=u[r]=[],f=function(){return new u(this)};if(l[r]=Error[r],c.item=function(e){return this[e]||null},c.contains=function(e){return-1!==a(this,e+="")},c.add=function(){var e,t=arguments,r=0,n=t.length,i=!1;do{e=t[r]+"",-1===a(this,e)&&(this.push(e),i=!0)}while(++r<n);i&&this._updateClassName()},c.remove=function(){var e,t,r=arguments,n=0,i=r.length,o=!1;do{for(e=r[n]+"",t=a(this,e);-1!==t;)this.splice(t,1),o=!0,t=a(this,e)}while(++n<i);o&&this._updateClassName()},c.toggle=function(e,t){e+="";var r=this.contains(e),n=r?!0!==t&&"remove":!1!==t&&"add";return n&&this[n](e),!0===t||!1===t?t:!r},c.toString=function(){return this.join(" ")},i.defineProperty){var d={get:f,enumerable:!0,configurable:!0};try{i.defineProperty(n,t,d)}catch(e){-2146823252===e.number&&(d.enumerable=!1,i.defineProperty(n,t,d))}}else i[r].__defineGetter__&&n.__defineGetter__(t,f)}}(self))},{}],29:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.default={AUTOPLAY_PROGRESS:"autoplay-first-progress",FIRST_LOAD:"first-load"}},{}],30:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.STATS_EVENTS=r.stats=void 0;var n=o(e("./stats")),i=o(e("./events"));function o(e){return e&&e.__esModule?e:{default:e}}var s=new n.default;r.stats=s,r.STATS_EVENTS=i.default},{"./events":29,"./stats":31}],31:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n,i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=e("../logger"),s=(n=o)&&n.__esModule?n:{default:n};var l=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.eventCounter=0,this.timings={}}return i(e,[{key:"start",value:function(e){var t=this.eventCounter++;return this.timings[t]={ms:Date.now(),name:e},t}},{key:"stop",value:function(e,t){if(this.timings[e]){var r=t||{};r.ms=Date.now()-this.timings[e].ms,s.default.timing(this.timings[e].name,r),delete this.timings[e]}}}]),e}();r.default=l},{"../logger":23}],32:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.default={muted:"lv_muted",volume:"lv_volume",lockedKbps:"lv_locked_kbps",estimatedKbps:"lv_estimated_kbps",autoLastKbps:"lv_auto_last_kbps",hideSuggestion:"lv_hide_suggestion",origin:"lv_origin",profile:"lv_origin"}},{}],33:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return n(e,[{key:"set",value:function(){console.error("an abstract method has been called")}},{key:"get",value:function(){console.error("an abstract method has been called")}}]),e}();r.default=i},{}],34:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n,i=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,i=!1,o=void 0;try{for(var s,l=e[Symbol.iterator]();!(n=(s=l.next()).done)&&(r.push(s.value),!t||r.length!==t);n=!0);}catch(e){i=!0,o=e}finally{try{!n&&l.return&&l.return()}finally{if(i)throw o}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=e("./base-driver"),l=(n=s)&&n.__esModule?n:{default:n};var a=new RegExp("\\s*;\\s*"),u=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,l.default),o(t,[{key:"parse",value:function(e){var t={};return e?(e.split(a).forEach(function(e){var r=e.split("="),n=i(r,2),o=n[0],s=n[1],l=decodeURIComponent(o),a=decodeURIComponent(s);t[l]=a}),t):t}},{key:"stringify",value:function(e){var t=[];for(var r in e)({}).hasOwnProperty.call(e,r)&&t.push(r+"="+e[r]);return t.join("; ")}},{key:"set",value:function(e,t){document.cookie=e+"="+t}},{key:"get",value:function(e){return this.parse(document.cookie)[e]||null}}]),t}();r.default=u},{"./base-driver":33}],35:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n,i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=e("./base-driver"),s=(n=o)&&n.__esModule?n:{default:n};var l=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s.default),i(t,[{key:"set",value:function(e,t){try{window.localStorage.setItem(e,t)}catch(e){}}},{key:"get",value:function(e){var t=null;try{t=window.localStorage.getItem(e)||null}catch(e){}return t}}]),t}();r.default=l},{"./base-driver":33}],36:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n,i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=e("./base-driver"),s=(n=o)&&n.__esModule?n:{default:n};var l={},a=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s.default),i(t,[{key:"set",value:function(e,t){l[e]=t}},{key:"get",value:function(e){return l[e]||null}}]),t}();r.default=a},{"./base-driver":33}],37:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=l(e("./drivers/cookie")),o=l(e("./drivers/local-storage")),s=l(e("./drivers/memory"));function l(e){return e&&e.__esModule?e:{default:e}}var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);try{if(window.localStorage)return void(this.driver=new o.default)}catch(e){}try{if("string"==typeof document.cookie)return void(this.driver=new i.default)}catch(e){}this.driver=new s.default}return n(e,[{key:"set",value:function(e,t){this.driver&&this.driver.set(e,t)}},{key:"get",value:function(e){if(this.driver)return this.driver.get(e)}}]),e}();r.default=a},{"./drivers/cookie":34,"./drivers/local-storage":35,"./drivers/memory":36}],38:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(){var e,t,r,o,s=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),n[t]=e>>>((3&t)<<3)&255;return n}();return s[6]=15&s[6]|64,s[8]=63&s[8]|128,e=s,r=t||0,(o=i)[e[r++]]+o[e[r++]]+o[e[r++]]+o[e[r++]]+"-"+o[e[r++]]+o[e[r++]]+"-"+o[e[r++]]+o[e[r++]]+"-"+o[e[r++]]+o[e[r++]]+"-"+o[e[r++]]+o[e[r++]]+o[e[r++]]+o[e[r++]]+o[e[r++]]+o[e[r++]]};var n=new Array(16);for(var i=[],o={},s=0;s<256;s++)i[s]=(s+256).toString(16).substr(1),o[i[s]]=s},{}],39:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=c(e("@livelyvideo/player-core/lib/base-driver")),o=c(e("@livelyvideo/player-core/lib/detect")),s=c(e("@livelyvideo/player-core/lib/events")),l=c(e("@livelyvideo/player-core/lib/errors")),a=c(e("lodash.noop")),u=c(e("swfobject-amd"));function c(e){return e&&e.__esModule?e:{default:e}}var f=0,d=function(e){function t(e,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r,n));return i.el=e.el,i.fragCounts=0,i.fragSize=0,i.fragDuration=0,i.fragDownloadTime=0,i.fragMaxTime=0,i.fragMinTime=0,i.bufferOverflowCount=0,i.bufferUnderflowCount=0,i.upshift=0,i.downshift=0,i.lastProgress=0,i.currentErrorCount=0,i.recentErrorCount=0,i.errors={},i.livelyPlayer=e,i.mediaLoader=r,i.options=n,i.currentVolume=i.options.volume,i.currentMuted=i.options.muted,i.playingUri=null,i.id=f++,i.cbs={},i.render(),i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),n(t,[{key:"render",value:function(){this.obj=document.createElement("div"),this.obj.addEventListener("click",function(e){e.preventDefault()}),this.el.appendChild(this.obj),this.obj.setAttribute("class","aiw-swf-container"),this.obj.setAttribute("id","aiw-swfhls-uniqid-"+this.id)}},{key:"handleEvent",value:function(e,t){switch(e){case"position":this.emitProgress(),this.emitTimeupdate();break;case"state":"PAUSED"===t[0]&&this.emit(s.default.MEDIA_PAUSE);break;case"PAUSED_BUFFERING":this.emit(s.default.MEDIA_STALL);break;case"levelLoaded":this.emit("levelLoaded")}}},{key:"getReady",value:function(e){var t=this,r=this.cbs.getReadyCb="flashlsReady"+this.id,n=this.cbs.handleEvent="flashlsHandleEvent"+this.id;this.cbs.flashlsCb="flashlsCb"+this.id,window[this.cbs.getReadyCb]=e,window[this.cbs.handleEvent]=this.handleEvent.bind(this),window[this.cbs.flashlsCb]=function(e,t){"ready"===e&&window[r](),window[n](e,t)},u.default.embedSWF(this.options.flashlsPath,this.obj.getAttribute("id"),"100%","100%","11.0.0","",{callback:this.cbs.flashlsCb},{scale:"noscale",wmode:this.options.flashWmode,allowscriptaccess:"always",allowFullScreen:"false",hls_initiallivemanifestsize:0,hls_lowbufferlength:0},{},function(e){t.swf=e.ref})}},{key:"pause",value:function(){return!(!this.swf||"function"!=typeof this.swf.playerPause)&&(this.swf.playerPause(),!0)}},{key:"mute",value:function(){return!(!this.swf||"function"!=typeof this.swf.playerVolume)&&(this.swf.playerVolume(0),this.currentMuted=!0,this.currentMuted)}},{key:"unmute",value:function(){return!(!this.swf||"function"!=typeof this.swf.playerVolume)&&(this.swf.playerVolume(100*this.currentVolume),this.currentMuted=!1,this.currentMuted)}},{key:"stop",value:function(){this.playingUri=null,this.pause()}},{key:"destroy",value:function(){this.destroyed=!0,this.stop(),this.obj.remove();for(var e in this.cbs)this.cbs[e]=null;this.swf&&this.swf.remove()}},{key:"play",value:function(e){var t=this,r=e||a.default;if(this.playingUri&&this.playingUri===this.manifest)return this.swf.playerResume(),void r(!0);this.getReady(function(){t.whenReady(function(){var e=t.manifest;t.location=e,e||t.mediaLoader.currentState!==s.default.ONLINE?(t.playingUri=e,t.swf.playerLoad(e),t.options.bitrate&&(t.bitrate=t.options.bitrate),t.swf.playerPlay(-1),t.currentMuted?t.swf.playerVolume(0):t.swf.playerVolume(100*t.currentVolume),t.once(s.default.MEDIA_PROGRESS,function(){r(!0),r=a.default})):t.emit(s.default.ERROR,l.default.DRIVER_NOT_SUPPORTED)})})}},{key:"duration",get:function(){return this.swf&&this.swf.getDuration?this.swf.getDuration():0}},{key:"supportsAutoplay",get:function(){return!0}},{key:"bufferLength",get:function(){return!(!this.swf||"function"!=typeof this.swf.getbufferLength)&&this.swf.getbufferLength()}},{key:"backBufferLength",get:function(){return!(!this.swf||"function"!=typeof this.swf.getbackBufferLength)&&this.swf.getbackBufferLength()}},{key:"bufferTimes",get:function(){return[[this.currentTime-this.backBufferLength,this.currentTime+this.bufferLength]]}},{key:"currentTime",get:function(){return!(!this.swf||"function"!=typeof this.swf.getPosition)&&this.swf.getPosition()},set:function(e){return!(!this.swf||"function"!=typeof this.swf.playerSeek)&&(this.swf.playerSeek(e),!0)}},{key:"currentLevel",get:function(){return this.swf?this.swf.getCurrentLevel():null}},{key:"bitrate",set:function(e){if(this.options.bitrate=e,!e)return this.swf.playerSetNextLevel(-1),void this.emit(s.default.MEDIA_PLAY);var t=this.data.encodings;if(t&&t.length&&this.swf){var r=void 0;for(r=0;r<t.length&&!(t[r].videoKbps+t[r].audioKbps>e);r++);this.swf.playerSetNextLevel(Math.max(r-1,0)),this.emit(s.default.MEDIA_PLAY)}}},{key:"volume",get:function(){return this.currentVolume},set:function(e){return this.currentVolume=e,this.swf?(void 0!==e&&this.swf.playerVolume(100*e),this.currentMuted&&this.unmute(),this.currentVolume):0}},{key:"muted",get:function(){return!(!this.swf||"function"!=typeof this.swf.getMuted)&&this.currentMuted}},{key:"details",get:function(){var e={};return(e=e||{}).volume=this.currentVolume,e.muted=this.currentMuted,e}},{key:"manifest",get:function(){var e=void 0;if(!(e=this.data.manifest))return null;var t=-1===e.indexOf("?")?"?":"&";return this.options.preset?e+=t+"preset="+this.options.preset:null===this.options.preset||o.default.any()||(e+=t+"preset=desktop"),e}}],[{key:"isSupported",value:function(){return u.default.hasFlashPlayerVersion("11.0.0")}},{key:"driver",get:function(){return"flashHls"}},{key:"format",get:function(){return"mp4-hls"}}]),t}();r.default=d},{"@livelyvideo/player-core/lib/base-driver":17,"@livelyvideo/player-core/lib/detect":18,"@livelyvideo/player-core/lib/errors":19,"@livelyvideo/player-core/lib/events":20,"lodash.noop":49,"swfobject-amd":52}],40:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t.on(window.Hls.Events.FRAG_LOADING,this.onFragLoading.bind(this)),t.on(window.Hls.Events.FRAG_LOAD_PROGRESS,this.onFragLoadProgress.bind(this)),t.on(window.Hls.Events.FRAG_LOADED,this.onFragLoaded.bind(this)),t.on(window.Hls.Events.ERROR,this.onError.bind(this)),this.lastLoadedFragLevel=0,this._autoLevelCapping=-1,this._nextAutoLevel=-1,this.hls=t,this.onCheck=this.checkFragProgress.bind(this),this.lastBws=[],this.lastBw=0,this.lastCalculated=0}return n(e,[{key:"getCurrentLevel",value:function(){return this.fragCurrent}},{key:"getNextLevel",value:function(){return this.nextAutoLevel}},{key:"destroy",value:function(){this.clearTimer()}},{key:"onFragLoading",value:function(e,t){this.clearTimer(this.timer),this.timer=setInterval(this.onCheck,100),this.fragCurrent=t.frag}},{key:"calculateLastBw",value:function(){this.lastCalculated=Date.now(),this.lastBws.splice(8);for(var e=0,t=0;t<this.lastBws.length;t++)e+=this.lastBws[t];e=Math.floor(e/this.lastBws.length),this.lastBw=e}},{key:"addBw",value:function(e){this.lastBws.unshift(e),this.calculateLastBw()}},{key:"onFragLoadProgress",value:function(e,t){if(!(this.lastBws.length>4)){this.lastfetchduration=(window.performance.now()-t.stats.trequest)/1e3;var r=8*t.stats.loaded/this.lastfetchduration;r&&this.addBw(r)}}},{key:"bufferedInfo",value:function(e,t,r){var n=[],i=void 0,o=void 0,s=void 0,l=void 0,a=void 0;for(e.sort(function(e,t){var r=e.start-t.start;return r||t.end-e.end}),a=0;a<e.length;a++){var u=n.length;if(u){var c=n[u-1].end;e[a].start-c<r?e[a].end>c&&(n[u-1].end=e[a].end):n.push(e[a])}else n.push(e[a])}if(n.length&&t<n[0].start)return{len:0,start:t,end:t,nextStart:n[0].start};for(a=0,i=0,o=s=t;a<n.length;a++){var f=n[a].start,d=n[a].end;if(t+r>=f&&t<d)o=f,i=(s=d)-t;else if(t+r<f){l=f;break}}return{len:i,start:o,end:s,nextStart:l}}},{key:"bufferInfo",value:function(e,t,r){if(e){var n=e.buffered,i=[],o=void 0;for(o=0;o<n.length;o++)i.push({start:n.start(o),end:n.end(o)});return this.bufferedInfo(i,t,r)}return{len:0,start:0,end:0,nextStart:void 0}}},{key:"checkFragProgress",value:function(){var e=this.hls,t=e.media,r=this.fragCurrent;if(t&&!t.paused&&t.readyState&&r.autoLevel&&r.level){var n=window.performance.now()-r.trequest;if(!(n<=500*r.duration)){var i=Math.max(1,1e3*r.loaded/n);r.expectedLen<r.loaded&&(r.expectedLen=r.loaded);var o=t.currentTime,s=(r.expectedLen-r.loaded)/i,l=this.bufferInfo(t,o,e.config.maxBufferHole).end-o;if(4*l<r.duration&&s>l){var a=void 0,u=void 0;for(u=r.level-1;u>=0&&!((a=r.duration*e.levels[u].bitrate/(5.6*i))<l);u--);a<s&&(u=Math.max(0,u),e.nextLoadLevel=u||0,r.loader.abort(),this.clearTimer(),e.trigger(window.Hls.Events.FRAG_LOAD_EMERGENCY_ABORTED,{frag:r}))}}}}},{key:"emergencyDrop",value:function(){this.hls.nextLoadLevel=Math.max(0,this.fragCurrent.level-1)||0,this.hls.nextLoadLevel>=this.fragCurrent.level||(this.clearTimer(),this.hls.trigger(window.Hls.Events.FRAG_LOAD_EMERGENCY_ABORTED,{frag:this.fragCurrent}))}},{key:"onFragLoaded",value:function(e,t){this.lastfetchduration=(window.performance.now()-t.stats.trequest)/1e3;var r=8*t.stats.loaded/this.lastfetchduration;r&&this.addBw(r),this.clearTimer(),this.lastLoadedFragLevel=t.frag.level,this._nextAutoLevel=-1}},{key:"onError",value:function(e,t){this.clearTimer()}},{key:"clearTimer",value:function(){this.timer&&(clearInterval(this.timer),this.timer=null)}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(e){this._autoLevelCapping=e}},{key:"nextAutoLevel",get:function(){var e=this.lastBw,t=this.hls,r=void 0,n=void 0;if(!t.levels)return-1;if(-1!==this._autoLevelCapping||!t.levels)return Math.min(this._autoLevelCapping,t.levels.length-1);if(n=t.levels.length-1,-1!==this._nextAutoLevel)return Math.min(this._nextAutoLevel,n,t.levels.length-1);for(r=0;r<=n;r++)if(.7*e<t.levels[r].bitrate)return Math.max(0,r-1);return r-1},set:function(e){this._nextAutoLevel=e}}]),e}();r.default=i},{}],41:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=f(e("@livelyvideo/player-core/lib/base-driver")),o=f(e("@livelyvideo/player-core/lib/detect")),s=f(e("@livelyvideo/player-core/lib/logger")),l=f(e("@livelyvideo/player-core/lib/events")),a=f(e("@livelyvideo/player-core/lib/errors")),u=f(e("lodash.noop")),c=f(e("./abr-controller"));function f(e){return e&&e.__esModule?e:{default:e}}var d,h,v=window.Hls,p=(d=document.getElementsByTagName("script"),(h=d[d.length-1])?h.src.split("?")[0].split("/").slice(0,-1).join("/")+"/hls.min.js":"https://cdn.jsdelivr.net/hls.js/latest/"),y=function(e){function t(e,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r,n));return i.el=document.createElement("video"),i.el.setAttribute("class","aiw-video"),i.options.posterURI&&i.el.setAttribute("poster",i.options.posterURI),i.livelyPlayer.el.appendChild(i.el),i.el.volume=i.options.volume,i.el.muted=i.options.muted,i.options.hlsjsPath=i.options.hlsjsPath||p,i.lastFrag=null,i.loadingHls=!1,i.recoverDecodingErrorDate=null,i.recoverSwapAudioCodecDate=null,i.loadHls(),i.currentLevelInterval=setTimeout(i.saveCurrentLevel.bind(i),1e3),i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),n(t,[{key:"saveCurrentLevel",value:function(){var e=this.currentLevel;if(e){var t=this.data.encodings[e];this.livelyPlayer.store.set("lv_auto_last_kbps",t.audioKbps+t.videoKbps)}}},{key:"reloadAndRestart",value:function(){var e=this;this.mediaLoader.load(function(){e.mediaLoader.currentState===l.default.ONLINE&&e.restart()})}},{key:"loadHls",value:function(e){var t=this,r=e||u.default;if(v)r();else if(this.loadingHls)setTimeout(function(){t.loadHls(r)},50);else{this.loadingHls=!0;var n=document.createElement("script");n.setAttribute("src",this.options.hlsjsPath),n.onload=function(){v=window.Hls,t.loadingHls=!1,r()},document.body.appendChild(n)}}},{key:"whenReady",value:function(e){var r=this;this.loadHls(function(){(function e(t,r,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,r);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,r,n)}if("value"in i)return i.value;var s=i.get;return void 0!==s?s.call(n):void 0})(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"whenReady",r).call(r,e)})}},{key:"playNow",value:function(e){var t=this,r=this.manifest,n=e||u.default;if(r||this.mediaLoader.currentState!==l.default.ONLINE){if(this.hls){if(this.mediaLoader.vod&&r===this.hls.url||this.hls.url===r)return this.elementPlay(),void n(!this.el.paused);this.destroyHls()}this.el.setAttribute("src",r);var i=function e(){t.destroyed||(document.removeEventListener("visibilitychange",e),t.hls=new v({abrController:c.default,seekHoleNudgeDuration:.5,debug:t.options.debug,maxBufferLength:t.options.maxBufferLength,maxBufferSize:t.options.maxBufferSize,fragLoadingTimeOut:3900}),t.listen(),s.default.setPlayer(t.mediaLoader.host,t.mediaLoader.publicId,t.format,r),t.hls.loadSource(r),t.hls.attachMedia(t.el),t.elementPlay(),t.mediaLoader.vod||t.hls.on(v.Events.BUFFER_APPENDED,function(){t.el&&t.el.buffered.length&&!t.el.paused&&t.el.buffered.end(t.el.buffered.length-1)-t.el.currentTime>25&&(s.default.error("player fell behind more than 25s, restarting"),t.reloadAndRestart())}),t.hls.on(v.Events.MEDIA_ATTACHED,function(){t.isAttached=!0}),t.hls.on(v.Events.MEDIA_DETACHED,function(){t.isAttached=!1}),t.hls.on(v.Events.MANIFEST_PARSED,function(){t.lastProgress=Date.now()}),null===t.options.bitrate?t.bitrateCap=null:isNaN(t.options.bitrate)||(t.bitrateCap=t.options.bitrate))};document.hidden?document.addEventListener("visibilitychange",i):i(),n(!this.el.paused)}else this.emit(l.default.ERROR,a.default.DRIVER_NOT_SUPPORTED)}},{key:"play",value:function(e){var t=this;!this.hls||this.el.paused?(this.el.onprogress=null,this.ready?this.playNow(e):this.whenReady(function(){t.playNow(e)})):e(!0)}},{key:"stop",value:function(){this.hls&&this.destroyHls()}},{key:"pause",value:function(){this.el.pause()}},{key:"destroy",value:function(){this.destroyed=!0,this.el.remove(),this.destroyHls()}},{key:"destroyHls",value:function(){this.hls&&(this.hls.detachMedia&&this.hls.detachMedia(),this.hls.destroy&&this.hls.destroy(),this.hls=null)}},{key:"recoverFromBufferSeekOverHole",value:function(){var e=this.data.encodings[this.currentLevel];e||(e=this.pickEncoding(this.options.bitrate||this.options.estimatedKbps)),e&&(this.options.bitrate=e.videoKbps+e.audioKbps),this.reloadAndRestart()}},{key:"ifNoProgress",value:function(e){var t=this,r=this.el.currentTime;setTimeout(function(){t.el.currentTime<=r&&e()},250)}},{key:"listen",value:function(){var e=this,t=void 0;this.hls.on(v.Events.ERROR,function(r,n){switch(n.details){case v.ErrorDetails.LEVEL_LOAD_ERROR:case v.ErrorDetails.FRAG_LOAD_TIMEOUT:return e.mediaLoader.vod?void e.handleError(l.default.ERROR,a.default.PLAYBACK_ERROR,n):e.mediaLoader.currentState===l.default.OFFLINE?void e.stop():(s.default.warn("level load reload and restart",r,n),e.reloadAndRestart(),t=e.el.currentTime,void setTimeout(function(){e.el.currentTime<=t&&(s.default.warn("level load reload and restart",r,n),e.reloadAndRestart())},100));case v.ErrorDetails.BUFFER_SEEK_OVER_HOLE:return void e.ifNoProgress(function(){e.recoverFromBufferSeekOverHole()});case v.ErrorDetails.BUFFER_APPEND_ERROR:case v.ErrorDetails.BUFFER_FULL_ERROR:e.bufferOverflowCount++;break;case v.ErrorDetails.FRAG_LOAD_ERROR:case v.ErrorDetails.FRAG_LOOP_LOADING_ERROR:case v.ErrorDetails.FRAG_DECRYPT_ERROR:case v.ErrorDetails.FRAG_PARSING_ERROR:case v.ErrorDetails.BUFFER_APPENDING_ERROR:case v.ErrorDetails.BUFFER_STALLED_ERROR:e.bufferUnderflowCount++}switch(n.type){case v.ErrorTypes.NETWORK_ERROR:n.details!==v.ErrorDetails.FRAG_LOAD_TIMEOUT?e.currentErrorCount++:n.details===v.ErrorDetails.LEVEL_LOAD_TIMEOUT&&(e.currentErrorCount=e.options.recoverErrorCount),e.handleError(l.default.ERROR,a.default.NETWORK_ERROR,n);break;case v.ErrorTypes.MEDIA_ERROR:if(n.fatal)return void e.handleMediaError();if(n.details===v.ErrorDetails.BUFFER_STALLED_ERROR)return void e.handleError(l.default.ERROR,a.default.PLAYBACK_ERROR,n);n.details===v.ErrorDetails.FRAG_LOOP_LOADING_ERROR&&e.currentErrorCount++,e.handleError(l.default.ERROR,a.default.PLAYBACK_ERROR,n);break;case v.ErrorTypes.OTHER_ERROR:e.currentErrorCount++,e.handleError(l.default.ERROR,a.default.UNKNOWN_ERROR,n);break;default:return void s.default.error("unhandled hlsjs error",r,n)}e.checkRestart(n),s.default.error(r,n)}),this.el.addEventListener("progress",function(){e.emitProgress()}),this.el.onended=function(){e.emit("ended")},this.el.addEventListener("timeupdate",function(){e.emitTimeupdate()}),this.el.addEventListener("error",function(t){var r=t.currentTarget.error;if(r)switch(r.code){case r.MEDIA_ERR_DECODE:e.handleMediaError();break;case r.MEDIA_ERR_SRC_NOT_SUPPORTED:e.emit(l.default.ERROR,a.default.DRIVER_NOT_SUPPORTED)}}),this.hls.on(v.Events.LEVEL_SWITCH,function(t,r){e.bitrateSwitch(r.level)}),this.hls.on(v.Events.FRAG_LOADED,function(t,r){e.loadedFrag(r.frag)})}},{key:"handleMediaError",value:function(){var e=this,t=window.performance.now();!this.recoverDecodingErrorDate||t-this.recoverDecodingErrorDate>3e3?(this.recoverDecodingErrorDate=t,this.hls.recoverMediaError()):(!this.recoverSwapAudioCodecDate||t-this.recoverSwapAudioCodecDate>3e3)&&(this.recoverSwapAudioCodecDate=t,this.hls.swapAudioCodec(),this.hls.recoverMediaError()),this.ifNoProgress(function(){e.recoverFromBufferSeekOverHole()})}},{key:"bitrateSwitch",value:function(e){e>this.currentLevel?this.upshift++:this.downshift++,this.emit(l.default.BITRATE_SWITCH)}},{key:"loadedFrag",value:function(e){var t=e;this.fragCounts++,t.request=this.lastFrag?t.trequest-this.lastFrag.trequest:t.trequest,this.lastFrag=t,this.fragSize+=t.loaded,this.fragDuration+=t.duration,this.fragDownloadTime+=t.request,this.fragMaxTime=Math.max(this.fragMaxTime,t.request),this.fragMinTime=Math.min(this.fragMinTime||t.request,t.request)}},{key:"ready",get:function(){return v&&this.manifest}},{key:"manifest",get:function(){var e=this.data;if(this.options.origin)return this.originLocation;if(t=e.manifest,!this.options.origin&&!e.encodings.length)return this.options.origin=!0,this.originLocation;var t=void 0;if(t=e.manifest,!this.options.origin&&!e.encodings.length)return this.options.origin=!0,this.originLocation;if(!t)return null;var r=-1===t.indexOf("?")?"?":"&";null===this.options.preset?t+=r:this.options.preset?t+=r+"preset="+this.options.preset:o.default.any()||(t+=r+"preset=desktop");var n=this.livelyPlayer.store.get("lv_auto_last_kbps");return n&&(t+="kbps="+n),t}},{key:"bitrateCap",set:function(e){if(this.options.bitrate=e,!e)return this.hls.abrController.autoLevelCapping=-1,void this.emit(l.default.MEDIA_PLAY);var t=this.data.encodings;if(t&&t.length&&this.hls){var r=void 0;for(r=0;r<t.length&&!(t[r].videoKbps+t[r].audioKbps>e);r++);this.hls.abrController.autoLevelCapping=Math.max(r-1,0),this.emit(l.default.MEDIA_PLAY)}}},{key:"bitrate",set:function(e){var t=this;if(this.bitrateCap=e,o.default.firefox()||this.mediaLoader.vod){var r=this.el.currentTime;if(this.stop(),!this.livelyPlayer.tryingToPlay)return void(this.mediaLoader.vod&&(this.el.currentTime=r));this.mediaLoader.vod&&(this.el.onloadedmetadata=function(){t.el.onloadedmetadata=null,t.el.currentTime=r}),this.play()}}},{key:"currentLevel",get:function(){if(this.hls&&this.hls.abrController.fragCurrent)return this.hls.abrController.fragCurrent.level}},{key:"nextLevel",get:function(){return this.hls?this.hls.abrController.nextAutoLevel:null}}],[{key:"isSupported",value:function(){return!o.default.winChrome51()&&(!(o.default.safari()&&!o.default.android()&&!o.default.chrome()&&!o.default.ie())&&(window.MediaSource&&window.MediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"')))}},{key:"driver",get:function(){return"hlsjs"}},{key:"format",get:function(){return"mp4-hls"}}]),t}();r.default=y},{"./abr-controller":40,"@livelyvideo/player-core/lib/base-driver":17,"@livelyvideo/player-core/lib/detect":18,"@livelyvideo/player-core/lib/errors":19,"@livelyvideo/player-core/lib/events":20,"@livelyvideo/player-core/lib/logger":23,"lodash.noop":49}],42:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function e(t,r,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,r);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,r,n)}if("value"in i)return i.value;var s=i.get;return void 0!==s?s.call(n):void 0},o=u(e("@livelyvideo/player-core/lib/base-driver")),s=u(e("@livelyvideo/player-core/lib/events")),l=u(e("@livelyvideo/player-core/lib/errors")),a=u(e("lodash.noop"));function u(e){return e&&e.__esModule?e:{default:e}}var c={1:"MEDIA_ERR_ABORTED",2:"MEDIA_ERR_NETWORK",3:"MEDIA_ERR_DECODE",4:"MEDIA_ERR_SRC_NOT_SUPPORTED"},f=250,d=function(e){function t(e,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r,n));return i.el=document.createElement("video"),i.el.setAttribute("class","aiw-video"),i.el.setAttribute("playsinline",!0),i.el.setAttribute("webkit-playsinline",!0),n.autoplay&&i.el.setAttribute("autoplay",!0),i.options.posterURI&&i.el.setAttribute("poster",i.options.posterURI),i.livelyPlayer.el.appendChild(i.el),i.el.volume=i.options.volume,i.el.muted=i.options.muted,i.el.addEventListener(s.default.ERROR,function(){i.el.getAttribute("src")&&(i.handleError(s.default.ERROR,l.default.UNKNOWN_ERROR,{fatal:!0,details:c[i.el.error.code]}),setTimeout(function(){i.livelyPlayer.tryingToPlay&&i.play()},f))}),i.el.addEventListener("webkitendfullscreen",function(){i.livelyPlayer.stop(),i.el.setAttribute("src",i.manifest)}),i.lastProgress=Date.now(),i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),n(t,[{key:"stop",value:function(){i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"stop",this).call(this),clearInterval(this.progressInterval)}},{key:"play",value:function(e){var r=this,n=e||a.default;i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"play",this).call(this,function(e){e&&(r.el.onprogress=function(){r.emitProgress()},r.el.onended=function(){r.emit("ended")},r.el.ontimeupdate=function(){r.fragCounts++,r.emitTimeupdate()}),n(e)})}}],[{key:"isSupported",value:function(){var e=document.createElement("video"),t=e.canPlayType&&("maybe"===e.canPlayType("application/vnd.apple.mpegURL")||"probably"===e.canPlayType("application/vnd.apple.mpegURL"));return e.remove(),t}},{key:"driver",get:function(){return"hls"}},{key:"format",get:function(){return"mp4-hls"}}]),t}();r.default=d},{"@livelyvideo/player-core/lib/base-driver":17,"@livelyvideo/player-core/lib/errors":19,"@livelyvideo/player-core/lib/events":20,"lodash.noop":49}],43:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n,i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=e("@livelyvideo/player-core/lib/base-driver"),s=(n=o)&&n.__esModule?n:{default:n};var l=function(e){function t(e,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r,n));return i.resetCounts(),i.errors={},i.livelyPlayer=e,i.mediaLoader=r,i.options=n,i.onceHandlerLock=!1,i.el=document.createElement("video"),i.el.setAttribute("type","video/mp4"),i.el.setAttribute("class","aiw-video"),n.autoplay&&i.el.setAttribute("autoplay",!0),i.options.posterURI&&i.el.setAttribute("poster",i.options.posterURI),i.livelyPlayer.el.appendChild(i.el),i.el.volume=i.options.volume,i.el.muted=i.options.muted,i.el.addEventListener("progress",function(){i.emitProgress()}),i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s.default),i(t,[{key:"manifest",get:function(){var e=this.pickEncoding(this.options.bitrate||this.options.estimatedKbps);return e?e.location:this.originLocation}}],[{key:"isSupported",value:function(){var e=document.createElement("video");return e.canPlayType&&e.canPlayType("video/mp4").replace(/no/,"")}},{key:"driver",get:function(){return"nativeMp4"}},{key:"format",get:function(){return"mp4-http"}}]),t}();r.default=l},{"@livelyvideo/player-core/lib/base-driver":17}],44:[function(e,t,r){(function(n){!function(e){"object"==typeof r&&void 0!==t?t.exports=e():("undefined"!=typeof window?window:void 0!==n?n:"undefined"!=typeof self?self:this).LivelyViews=e()}(function(){return function t(r,n,i){function o(l,a){if(!n[l]){if(!r[l]){var u="function"==typeof e&&e;if(!a&&u)return u(l,!0);if(s)return s(l,!0);var c=new Error("Cannot find module '"+l+"'");throw c.code="MODULE_NOT_FOUND",c}var f=n[l]={exports:{}};r[l][0].call(f.exports,function(e){var t=r[l][1][e];return o(t||e)},f,f.exports,t,r,n,i)}return n[l].exports}for(var s="function"==typeof e&&e,l=0;l<i.length;l++)o(i[l]);return o}({1:[function(e,t){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function n(e){return"function"==typeof e}function i(e){return"object"==typeof e&&null!==e}function o(e){return void 0===e}t.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(e){if("number"!=typeof e||0>e||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},r.prototype.emit=function(e){var t,r,s,l,a,u;if(this._events||(this._events={}),"error"===e&&(!this._events.error||i(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var c=new Error('Uncaught, unspecified "error" event. ('+t+")");throw c.context=t,c}if(o(r=this._events[e]))return!1;if(n(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:l=Array.prototype.slice.call(arguments,1),r.apply(this,l)}else if(i(r))for(l=Array.prototype.slice.call(arguments,1),u=r.slice(),s=u.length,a=0;s>a;a++)u[a].apply(this,l);return!0},r.prototype.addListener=function(e,t){var s;if(!n(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,n(t.listener)?t.listener:t),this._events[e]?i(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,i(this._events[e])&&!this._events[e].warned&&((s=o(this._maxListeners)?r.defaultMaxListeners:this._maxListeners)&&s>0&&this._events[e].length>s&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())),this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(e,t){function r(){this.removeListener(e,r),i||(i=!0,t.apply(this,arguments))}if(!n(t))throw TypeError("listener must be a function");var i=!1;return r.listener=t,this.on(e,r),this},r.prototype.removeListener=function(e,t){var r,o,s,l;if(!n(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(s=(r=this._events[e]).length,o=-1,r===t||n(r.listener)&&r.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(i(r)){for(l=s;l-- >0;)if(r[l]===t||r[l].listener&&r[l].listener===t){o=l;break}if(0>o)return this;1===r.length?(r.length=0,delete this._events[e]):r.splice(o,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},r.prototype.removeAllListeners=function(e){var t,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n(r=this._events[e]))this.removeListener(e,r);else if(r)for(;r.length;)this.removeListener(e,r[r.length-1]);return delete this._events[e],this},r.prototype.listeners=function(e){return this._events&&this._events[e]?n(this._events[e])?[this._events[e]]:this._events[e].slice():[]},r.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(n(t))return 1;if(t)return t.length}return 0},r.listenerCount=function(e,t){return e.listenerCount(t)}},{}],2:[function(){!function(e){"use strict";function t(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function r(e){return"string"!=typeof e&&(e=String(e)),e}function n(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return h.iterable&&(t[Symbol.iterator]=function(){return t}),t}function i(e){this.map={},e instanceof i?e.forEach(function(e,t){this.append(t,e)},this):Array.isArray(e)?e.forEach(function(e){this.append(e[0],e[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function o(e){return e.bodyUsed?Promise.reject(new TypeError("Already read")):void(e.bodyUsed=!0)}function s(e){return new Promise(function(t,r){e.onload=function(){t(e.result)},e.onerror=function(){r(e.error)}})}function l(e){var t=new FileReader,r=s(t);return t.readAsArrayBuffer(e),r}function a(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function u(){return this.bodyUsed=!1,this._initBody=function(e){if(this._bodyInit=e,e)if("string"==typeof e)this._bodyText=e;else if(h.blob&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(h.formData&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(h.searchParams&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else if(h.arrayBuffer&&h.blob&&p(e))this._bodyArrayBuffer=a(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!h.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(e)&&!y(e))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=a(e)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):h.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},h.blob&&(this.blob=function(){var e=o(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?o(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(l)}),this.text=function(){var e,t,r,n=o(this);if(n)return n;if(this._bodyBlob)return e=this._bodyBlob,t=new FileReader,r=s(t),t.readAsText(e),r;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),r=new Array(t.length),n=0;n<t.length;n++)r[n]=String.fromCharCode(t[n]);return r.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},h.formData&&(this.formData=function(){return this.text().then(f)}),this.json=function(){return this.text().then(JSON.parse)},this}function c(e,t){var r,n,o=(t=t||{}).body;if(e instanceof c){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new i(e.headers)),this.method=e.method,this.mode=e.mode,o||null==e._bodyInit||(o=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"omit",(t.headers||!this.headers)&&(this.headers=new i(t.headers)),this.method=(r=t.method||this.method||"GET",n=r.toUpperCase(),m.indexOf(n)>-1?n:r),this.mode=t.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&o)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(o)}function f(e){var t=new FormData;return e.trim().split("&").forEach(function(e){if(e){var r=e.split("="),n=r.shift().replace(/\+/g," "),i=r.join("=").replace(/\+/g," ");t.append(decodeURIComponent(n),decodeURIComponent(i))}}),t}function d(e,t){t||(t={}),this.type="default",this.status="status"in t?t.status:200,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new i(t.headers),this.url=t.url||"",this._initBody(e)}if(!e.fetch){var h={searchParams:"URLSearchParams"in e,iterable:"Symbol"in e&&"iterator"in Symbol,blob:"FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:"FormData"in e,arrayBuffer:"ArrayBuffer"in e};if(h.arrayBuffer)var v=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],p=function(e){return e&&DataView.prototype.isPrototypeOf(e)},y=ArrayBuffer.isView||function(e){return e&&v.indexOf(Object.prototype.toString.call(e))>-1};i.prototype.append=function(e,n){e=t(e),n=r(n);var i=this.map[e];this.map[e]=i?i+","+n:n},i.prototype.delete=function(e){delete this.map[t(e)]},i.prototype.get=function(e){return e=t(e),this.has(e)?this.map[e]:null},i.prototype.has=function(e){return this.map.hasOwnProperty(t(e))},i.prototype.set=function(e,n){this.map[t(e)]=r(n)},i.prototype.forEach=function(e,t){for(var r in this.map)this.map.hasOwnProperty(r)&&e.call(t,this.map[r],r,this)},i.prototype.keys=function(){var e=[];return this.forEach(function(t,r){e.push(r)}),n(e)},i.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),n(e)},i.prototype.entries=function(){var e=[];return this.forEach(function(t,r){e.push([r,t])}),n(e)},h.iterable&&(i.prototype[Symbol.iterator]=i.prototype.entries);var m=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];c.prototype.clone=function(){return new c(this,{body:this._bodyInit})},u.call(c.prototype),u.call(d.prototype),d.prototype.clone=function(){return new d(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new i(this.headers),url:this.url})},d.error=function(){var e=new d(null,{status:0,statusText:""});return e.type="error",e};var b=[301,302,303,307,308];d.redirect=function(e,t){if(-1===b.indexOf(t))throw new RangeError("Invalid status code");return new d(null,{status:t,headers:{location:e}})},e.Headers=i,e.Request=c,e.Response=d,e.fetch=function(e,t){return new Promise(function(r,n){var o=new c(e,t),s=new XMLHttpRequest;s.onload=function(){var e,t,n={status:s.status,statusText:s.statusText,headers:(e=s.getAllResponseHeaders()||"",t=new i,e.split(/\r?\n/).forEach(function(e){var r=e.split(":"),n=r.shift().trim();if(n){var i=r.join(":").trim();t.append(n,i)}}),t)};n.url="responseURL"in s?s.responseURL:n.headers.get("X-Request-URL");var o="response"in s?s.response:s.responseText;r(new d(o,n))},s.onerror=function(){n(new TypeError("Network request failed"))},s.ontimeout=function(){n(new TypeError("Network request failed"))},s.open(o.method,o.url,!0),"include"===o.credentials&&(s.withCredentials=!0),"responseType"in s&&h.blob&&(s.responseType="blob"),o.headers.forEach(function(e,t){s.setRequestHeader(t,e)}),s.send(void 0===o._bodyInit?null:o._bodyInit)})},e.fetch.polyfill=!0}}("undefined"!=typeof self?self:this)},{}],3:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();e("whatwg-fetch");var i,o=e("events"),s=(i=o)&&i.__esModule?i:{default:i},l=function(e){function t(e,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.postUri=e,n.getUri=r,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s["default"]),n(t,[{key:"track",value:function(){this.post(),this.interval=setInterval(this.post.bind(this),15e3)}},{key:"post",value:function(){var e=this;fetch(this.postUri,{method:"POST"}).then(function(t){t.status>399&&e.emit("error",new Error("failed post "+t.code))}).catch(function(t){e.emit("error",t)})}},{key:"get",value:function(){var e=this;fetch(this.getUri,{headers:{"Content-Type":"application/json"}}).then(function(t){return t.status>399?void e.emit("error",new Error("failed get "+t.code)):t.json()}).then(function(t){t&&t.current&&e.emit("views",t.current)}).catch(function(t){e.emit("error",t)})}},{key:"stopTracking",value:function(){clearInterval(this.interval)}}]),t}();r.default=l},{events:1,"whatwg-fetch":2}]},{},[3])(3)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],45:[function(e,t,r){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function i(e){return"function"==typeof e}function o(e){return"object"==typeof e&&null!==e}function s(e){return void 0===e}t.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,r,n,l,a,u;if(this._events||(this._events={}),"error"===e&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var c=new Error('Uncaught, unspecified "error" event. ('+t+")");throw c.context=t,c}if(s(r=this._events[e]))return!1;if(i(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:l=Array.prototype.slice.call(arguments,1),r.apply(this,l)}else if(o(r))for(l=Array.prototype.slice.call(arguments,1),n=(u=r.slice()).length,a=0;a<n;a++)u[a].apply(this,l);return!0},n.prototype.addListener=function(e,t){var r;if(!i(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,i(t.listener)?t.listener:t),this._events[e]?o(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,o(this._events[e])&&!this._events[e].warned&&(r=s(this._maxListeners)?n.defaultMaxListeners:this._maxListeners)&&r>0&&this._events[e].length>r&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(e,t){if(!i(t))throw TypeError("listener must be a function");var r=!1;function n(){this.removeListener(e,n),r||(r=!0,t.apply(this,arguments))}return n.listener=t,this.on(e,n),this},n.prototype.removeListener=function(e,t){var r,n,s,l;if(!i(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(s=(r=this._events[e]).length,n=-1,r===t||i(r.listener)&&r.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(o(r)){for(l=s;l-- >0;)if(r[l]===t||r[l].listener&&r[l].listener===t){n=l;break}if(n<0)return this;1===r.length?(r.length=0,delete this._events[e]):r.splice(n,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(i(r=this._events[e]))this.removeListener(e,r);else if(r)for(;r.length;)this.removeListener(e,r[r.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){return this._events&&this._events[e]?i(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(i(t))return 1;if(t)return t.length}return 0},n.listenerCount=function(e,t){return e.listenerCount(t)}},{}],46:[function(e,t,r){var n=e("is-function");t.exports=function(e,t,r){if(!n(t))throw new TypeError("iterator must be a function");arguments.length<3&&(r=this);"[object Array]"===i.call(e)?function(e,t,r){for(var n=0,i=e.length;n<i;n++)o.call(e,n)&&t.call(r,e[n],n,e)}(e,t,r):"string"==typeof e?function(e,t,r){for(var n=0,i=e.length;n<i;n++)t.call(r,e.charAt(n),n,e)}(e,t,r):function(e,t,r){for(var n in e)o.call(e,n)&&t.call(r,e[n],n,e)}(e,t,r)};var i=Object.prototype.toString,o=Object.prototype.hasOwnProperty},{"is-function":48}],47:[function(e,t,r){(function(e){var r;r="undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:{},t.exports=r}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],48:[function(e,t,r){t.exports=function(e){var t=n.call(e);return"[object Function]"===t||"function"==typeof e&&"[object RegExp]"!==t||"undefined"!=typeof window&&(e===window.setTimeout||e===window.alert||e===window.confirm||e===window.prompt)};var n=Object.prototype.toString},{}],49:[function(e,t,r){t.exports=function(){}},{}],50:[function(e,t,r){(function(e){var r="Expected a function",n=NaN,i="[object Symbol]",o=/^\s+|\s+$/g,s=/^[-+]0x[0-9a-f]+$/i,l=/^0b[01]+$/i,a=/^0o[0-7]+$/i,u=parseInt,c="object"==typeof e&&e&&e.Object===Object&&e,f="object"==typeof self&&self&&self.Object===Object&&self,d=c||f||Function("return this")(),h=Object.prototype.toString,v=Math.max,p=Math.min,y=function(){return d.Date.now()};function m(e,t,n){var i,o,s,l,a,u,c=0,f=!1,d=!1,h=!0;if("function"!=typeof e)throw new TypeError(r);function m(t){var r=i,n=o;return i=o=void 0,c=t,l=e.apply(n,r)}function _(e){var r=e-u;return void 0===u||r>=t||r<0||d&&e-c>=s}function w(){var e,r,n=y();if(_(n))return E(n);a=setTimeout(w,(r=t-((e=n)-u),d?p(r,s-(e-c)):r))}function E(e){return a=void 0,h&&i?m(e):(i=o=void 0,l)}function P(){var e,r=y(),n=_(r);if(i=arguments,o=this,u=r,n){if(void 0===a)return c=e=u,a=setTimeout(w,t),f?m(e):l;if(d)return a=setTimeout(w,t),m(u)}return void 0===a&&(a=setTimeout(w,t)),l}return t=g(t)||0,b(n)&&(f=!!n.leading,s=(d="maxWait"in n)?v(g(n.maxWait)||0,t):s,h="trailing"in n?!!n.trailing:h),P.cancel=function(){void 0!==a&&clearTimeout(a),c=0,i=u=o=a=void 0},P.flush=function(){return void 0===a?l:E(y())},P}function b(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function g(e){if("number"==typeof e)return e;if("symbol"==typeof(t=e)||(r=t)&&"object"==typeof r&&h.call(t)==i)return n;var t,r;if(b(e)){var c="function"==typeof e.valueOf?e.valueOf():e;e=b(c)?c+"":c}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(o,"");var f=l.test(e);return f||a.test(e)?u(e.slice(2),f?2:8):s.test(e)?n:+e}t.exports=function(e,t,n){var i=!0,o=!0;if("function"!=typeof e)throw new TypeError(r);return b(n)&&(i="leading"in n?!!n.leading:i,o="trailing"in n?!!n.trailing:o),m(e,t,{leading:i,maxWait:t,trailing:o})}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],51:[function(e,t,r){var n=e("trim"),i=e("for-each");t.exports=function(e){if(!e)return{};var t={};return i(n(e).split("\n"),function(e){var r,i=e.indexOf(":"),o=n(e.slice(0,i)).toLowerCase(),s=n(e.slice(i+1));void 0===t[o]?t[o]=s:(r=t[o],"[object Array]"===Object.prototype.toString.call(r)?t[o].push(s):t[o]=[t[o],s])}),t}},{"for-each":46,trim:54}],52:[function(e,t,r){var n,i;n=this,i=function(){var e,t,r,n,i,o,s="undefined",l="object",a="Shockwave Flash",u="application/x-shockwave-flash",c="SWFObjectExprInst",f="onreadystatechange",d=window,h=document,v=navigator,p=!1,y=[],m=[],b=[],g=[],_=!1,w=!1,E=!0,P=!1,O=function(){var e=typeof h.getElementById!=s&&typeof h.getElementsByTagName!=s&&typeof h.createElement!=s,t=v.userAgent.toLowerCase(),r=v.platform.toLowerCase(),n=/win/.test(r||t),i=/mac/.test(r||t),o=!!/webkit/.test(t)&&parseFloat(t.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")),c="Microsoft Internet Explorer"===v.appName,f=[0,0,0],y=null;if(typeof v.plugins!=s&&typeof v.plugins[a]==l)(y=v.plugins[a].description)&&typeof v.mimeTypes!=s&&v.mimeTypes[u]&&v.mimeTypes[u].enabledPlugin&&(p=!0,c=!1,y=y.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),f[0]=B(y.replace(/^(.*)\..*$/,"$1")),f[1]=B(y.replace(/^.*\.(.*)\s.*$/,"$1")),f[2]=/[a-zA-Z]/.test(y)?B(y.replace(/^.*[a-zA-Z]+(.*)$/,"$1")):0);else if(typeof d.ActiveXObject!=s)try{var m=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");m&&(y=m.GetVariable("$version"))&&(c=!0,f=[B((y=y.split(" ")[1].split(","))[0]),B(y[1]),B(y[2])])}catch(e){}return{w3:e,pv:f,wk:o,ie:c,win:n,mac:i}}();O.w3&&((typeof h.readyState!=s&&("complete"===h.readyState||"interactive"===h.readyState)||typeof h.readyState==s&&(h.getElementsByTagName("body")[0]||h.body))&&k(),_||(typeof h.addEventListener!=s&&h.addEventListener("DOMContentLoaded",k,!1),O.ie&&(h.attachEvent(f,function e(){"complete"==h.readyState&&(h.detachEvent(f,e),k())}),d==top&&function e(){if(!_){try{h.documentElement.doScroll("left")}catch(t){return void setTimeout(e,0)}k()}}()),O.wk&&function e(){_||(/loaded|complete/.test(h.readyState)?k():setTimeout(e,0))}()));function k(){if(!_&&document.getElementsByTagName("body")[0]){try{var e,t=U("span");t.style.display="none",(e=h.getElementsByTagName("body")[0].appendChild(t)).parentNode.removeChild(e),e=null,t=null}catch(e){return}_=!0;for(var r=y.length,n=0;n<r;n++)y[n]()}}function L(e){_?e():y[y.length]=e}function T(){var e=m.length;if(e>0)for(var t=0;t<e;t++){var r=m[t].id,n=m[t].callbackFn,i={success:!1,id:r};if(O.pv[0]>0){var o=F(r);if(o)if(!V(m[t].swfVersion)||O.wk&&O.wk<312)if(m[t].expressInstall&&D()){var l={};l.data=m[t].expressInstall,l.width=o.getAttribute("width")||"0",l.height=o.getAttribute("height")||"0",o.getAttribute("class")&&(l.styleclass=o.getAttribute("class")),o.getAttribute("align")&&(l.align=o.getAttribute("align"));for(var a={},u=o.getElementsByTagName("param"),c=u.length,f=0;f<c;f++)"movie"!=u[f].getAttribute("name").toLowerCase()&&(a[u[f].getAttribute("name")]=u[f].getAttribute("value"));A(l,a,r,n)}else S(o),n&&n(i);else q(r,!0),n&&(i.success=!0,i.ref=R(r),i.id=r,n(i))}else if(q(r,!0),n){var d=R(r);d&&typeof d.SetVariable!=s&&(i.success=!0,i.ref=d,i.id=d.id),n(i)}}}function R(e){var t=null,r=F(e);return r&&"OBJECT"===r.nodeName.toUpperCase()&&(t=typeof r.SetVariable!==s?r:r.getElementsByTagName(l)[0]||r),t}function D(){return!w&&V("6.0.65")&&(O.win||O.mac)&&!(O.wk&&O.wk<312)}function A(i,o,l,a){var u=F(l);if(l=N(l),w=!0,r=a||null,n={success:!1,id:l},u){"OBJECT"==u.nodeName.toUpperCase()?(e=j(u),t=null):(e=u,t=l),i.id=c,(typeof i.width==s||!/%$/.test(i.width)&&B(i.width)<310)&&(i.width="310"),(typeof i.height==s||!/%$/.test(i.height)&&B(i.height)<137)&&(i.height="137"),h.title=h.title.slice(0,47)+" - Flash Player Installation";var f=O.ie?"ActiveX":"PlugIn",v="MMredirectURL="+encodeURIComponent(d.location.toString().replace(/&/g,"%26"))+"&MMplayerType="+f+"&MMdoctitle="+h.title;if(typeof o.flashvars!=s?o.flashvars+="&"+v:o.flashvars=v,O.ie&&4!=u.readyState){var p=U("div");l+="SWFObjectNew",p.setAttribute("id",l),u.parentNode.insertBefore(p,u),u.style.display="none",M(u)}I(i,o,l)}}function S(e){if(O.ie&&4!=e.readyState){e.style.display="none";var t=U("div");e.parentNode.insertBefore(t,e),t.parentNode.replaceChild(j(e),t),M(e)}else e.parentNode.replaceChild(j(e),e)}function j(e){var t=U("div");if(O.win&&O.ie)t.innerHTML=e.innerHTML;else{var r=e.getElementsByTagName(l)[0];if(r){var n=r.childNodes;if(n)for(var i=n.length,o=0;o<i;o++)1==n[o].nodeType&&"PARAM"==n[o].nodeName||8==n[o].nodeType||t.appendChild(n[o].cloneNode(!0))}}return t}function I(e,t,r){var n,i,o,a,c=F(r);if(r=N(r),O.wk&&O.wk<312)return n;if(c){var f,d,h,v=O.ie?U("div"):U(l);typeof e.id==s&&(e.id=r);for(h in t)t.hasOwnProperty(h)&&"movie"!==h.toLowerCase()&&C(v,h,t[h]);O.ie&&(i=e.data,o=v.innerHTML,(a=U("div")).innerHTML="<object classid='clsid:D27CDB6E-AE6D-11cf-96B8-444553540000'><param name='movie' value='"+i+"'>"+o+"</object>",v=a.firstChild);for(f in e)e.hasOwnProperty(f)&&("styleclass"===(d=f.toLowerCase())?v.setAttribute("class",e[f]):"classid"!==d&&"data"!==d&&v.setAttribute(f,e[f]));O.ie?b[b.length]=e.id:(v.setAttribute("type",u),v.setAttribute("data",e.data)),c.parentNode.replaceChild(v,c),n=v}return n}function C(e,t,r){var n=U("param");n.setAttribute("name",t),n.setAttribute("value",r),e.appendChild(n)}function M(e){var t=F(e);t&&"OBJECT"==t.nodeName.toUpperCase()&&(O.ie?(t.style.display="none",function e(){if(4==t.readyState){for(var r in t)"function"==typeof t[r]&&(t[r]=null);t.parentNode.removeChild(t)}else setTimeout(e,10)}()):t.parentNode.removeChild(t))}function x(e){return e&&e.nodeType&&1===e.nodeType}function N(e){return x(e)?e.id:e}function F(e){if(x(e))return e;var t=null;try{t=h.getElementById(e)}catch(e){}return t}function U(e){return h.createElement(e)}function B(e){return parseInt(e,10)}function V(e){e+="";var t=O.pv,r=e.split(".");return r[0]=B(r[0]),r[1]=B(r[1])||0,r[2]=B(r[2])||0,t[0]>r[0]||t[0]==r[0]&&t[1]>r[1]||t[0]==r[0]&&t[1]==r[1]&&t[2]>=r[2]}function H(e,t,r,n){var l=h.getElementsByTagName("head")[0];if(l){var a="string"==typeof r?r:"screen";if(n&&(i=null,o=null),!i||o!=a){var u=U("style");u.setAttribute("type","text/css"),u.setAttribute("media",a),i=l.appendChild(u),O.ie&&typeof h.styleSheets!=s&&h.styleSheets.length>0&&(i=h.styleSheets[h.styleSheets.length-1]),o=a}i&&(typeof i.addRule!=s?i.addRule(e,t):typeof h.createTextNode!=s&&i.appendChild(h.createTextNode(e+" {"+t+"}")))}}function q(e,t){if(E){var r=t?"visible":"hidden",n=F(e);_&&n?n.style.visibility=r:"string"==typeof e&&H("#"+e,"visibility:"+r)}}function z(e){return null!=/[\\\"<>\.;]/.exec(e)&&typeof encodeURIComponent!=s?encodeURIComponent(e):e}y[0]=function(){p?function(){var e=h.getElementsByTagName("body")[0],t=U(l);t.setAttribute("style","visibility: hidden;"),t.setAttribute("type",u);var r=e.appendChild(t);if(r){var n=0;!function i(){if(typeof r.GetVariable!=s)try{var o=r.GetVariable("$version");o&&(o=o.split(" ")[1].split(","),O.pv=[B(o[0]),B(o[1]),B(o[2])])}catch(e){O.pv=[8,0,0]}else if(n<10)return n++,void setTimeout(i,10);e.removeChild(t),r=null,T()}()}else T()}():T()};O.ie&&window.attachEvent("onunload",function(){for(var e=g.length,t=0;t<e;t++)g[t][0].detachEvent(g[t][1],g[t][2]);for(var r=b.length,n=0;n<r;n++)M(b[n]);for(var i in O)O[i]=null;if(O=null,"undefined"!=typeof swfobject){for(var o in swfobject)swfobject[o]=null;swfobject=null}});return{registerObject:function(e,t,r,n){if(O.w3&&e&&t){var i={};i.id=e,i.swfVersion=t,i.expressInstall=r,i.callbackFn=n,m[m.length]=i,q(e,!1)}else n&&n({success:!1,id:e})},getObjectById:function(e){if(O.w3)return R(e)},embedSWF:function(e,t,r,n,i,o,a,u,c,f){var d=N(t),h={success:!1,id:d};O.w3&&!(O.wk&&O.wk<312)&&e&&t&&r&&n&&i?(q(d,!1),L(function(){r+="",n+="";var v={};if(c&&typeof c===l)for(var p in c)v[p]=c[p];v.data=e,v.width=r,v.height=n;var y={};if(u&&typeof u===l)for(var m in u)y[m]=u[m];if(a&&typeof a===l)for(var b in a)if(a.hasOwnProperty(b)){var g=P?encodeURIComponent(b):b,_=P?encodeURIComponent(a[b]):a[b];typeof y.flashvars!=s?y.flashvars+="&"+g+"="+_:y.flashvars=g+"="+_}if(V(i)){var w=I(v,y,t);v.id==d&&q(d,!0),h.success=!0,h.ref=w,h.id=w.id}else{if(o&&D())return v.data=o,void A(v,y,t,f);q(d,!0)}f&&f(h)})):f&&f(h)},switchOffAutoHideShow:function(){E=!1},enableUriEncoding:function(e){P=typeof e===s||e},ua:O,getFlashPlayerVersion:function(){return{major:O.pv[0],minor:O.pv[1],release:O.pv[2]}},hasFlashPlayerVersion:V,createSWF:function(e,t,r){return O.w3?I(e,t,r):void 0},showExpressInstall:function(e,t,r,n){O.w3&&D()&&A(e,t,r,n)},removeSWF:function(e){O.w3&&M(e)},createCSS:function(e,t,r,n){O.w3&&H(e,t,r,n)},addDomLoadEvent:L,addLoadEvent:function(e){if(typeof d.addEventListener!=s)d.addEventListener("load",e,!1);else if(typeof h.addEventListener!=s)h.addEventListener("load",e,!1);else if(typeof d.attachEvent!=s)n="onload",i=e,(r=d).attachEvent(n,i),g[g.length]=[r,n,i];else if("function"==typeof d.onload){var t=d.onload;d.onload=function(){t(),e()}}else d.onload=e;var r,n,i},getQueryParamValue:function(e){var t=h.location.search||h.location.hash;if(t){if(/\?/.test(t)&&(t=t.split("?")[1]),null==e)return z(t);for(var r=t.split("&"),n=0;n<r.length;n++)if(r[n].substring(0,r[n].indexOf("="))==e)return z(r[n].substring(r[n].indexOf("=")+1))}return""},expressInstallCallback:function(){if(w){var i=F(c);i&&e&&(i.parentNode.replaceChild(e,i),t&&(q(t,!0),O.ie&&(e.style.display="block")),r&&r(n)),w=!1}},version:"2.3"}},void 0!==t?t.exports=i():n.swfobject=i()},{}],53:[function(e,t,r){t.exports=function(e,t){var r=void 0!==e.textContent?"textContent":"innerText";return void 0!==t&&(e[r]=t),e[r]}},{}],54:[function(e,t,r){(r=t.exports=function(e){return e.replace(/^\s*|\s*$/g,"")}).left=function(e){return e.replace(/^\s*/,"")},r.right=function(e){return e.replace(/\s*$/,"")}},{}],55:[function(e,t,r){"use strict";var n=e("global/window"),i=e("is-function"),o=e("parse-headers"),s=e("xtend");function l(e,t,r){var n=e;return i(t)?(r=t,"string"==typeof e&&(n={uri:e})):n=s(t,{uri:e}),n.callback=r,n}function a(e,t,r){return u(t=l(e,t,r))}function u(e){if(void 0===e.callback)throw new Error("callback argument missing");var t=!1,r=function(r,n,i){t||(t=!0,e.callback(r,n,i))};function n(e){return clearTimeout(c),e instanceof Error||(e=new Error(""+(e||"Unknown XMLHttpRequest Error"))),e.statusCode=0,r(e,m)}function i(){if(!l){var t;clearTimeout(c),t=e.useXDR&&void 0===u.status?200:1223===u.status?204:u.status;var n=m,i=null;return 0!==t?(n={body:function(){var e=void 0;if(e=u.response?u.response:u.responseText||function(e){try{if("document"===e.responseType)return e.responseXML;var t=e.responseXML&&"parsererror"===e.responseXML.documentElement.nodeName;if(""===e.responseType&&!t)return e.responseXML}catch(e){}return null}(u),y)try{e=JSON.parse(e)}catch(e){}return e}(),statusCode:t,method:d,headers:{},url:f,rawRequest:u},u.getAllResponseHeaders&&(n.headers=o(u.getAllResponseHeaders()))):i=new Error("Internal XMLHttpRequest Error"),r(i,n,n.body)}}var s,l,u=e.xhr||null;u||(u=e.cors||e.useXDR?new a.XDomainRequest:new a.XMLHttpRequest);var c,f=u.url=e.uri||e.url,d=u.method=e.method||"GET",h=e.body||e.data,v=u.headers=e.headers||{},p=!!e.sync,y=!1,m={body:void 0,headers:{},statusCode:0,method:d,url:f,rawRequest:u};if("json"in e&&!1!==e.json&&(y=!0,v.accept||v.Accept||(v.Accept="application/json"),"GET"!==d&&"HEAD"!==d&&(v["content-type"]||v["Content-Type"]||(v["Content-Type"]="application/json"),h=JSON.stringify(!0===e.json?h:e.json))),u.onreadystatechange=function(){4===u.readyState&&setTimeout(i,0)},u.onload=i,u.onerror=n,u.onprogress=function(){},u.onabort=function(){l=!0},u.ontimeout=n,u.open(d,f,!p,e.username,e.password),p||(u.withCredentials=!!e.withCredentials),!p&&e.timeout>0&&(c=setTimeout(function(){if(!l){l=!0,u.abort("timeout");var e=new Error("XMLHttpRequest timeout");e.code="ETIMEDOUT",n(e)}},e.timeout)),u.setRequestHeader)for(s in v)v.hasOwnProperty(s)&&u.setRequestHeader(s,v[s]);else if(e.headers&&!function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}(e.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in e&&(u.responseType=e.responseType),"beforeSend"in e&&"function"==typeof e.beforeSend&&e.beforeSend(u),u.send(h||null),u}t.exports=a,a.XMLHttpRequest=n.XMLHttpRequest||function(){},a.XDomainRequest="withCredentials"in new a.XMLHttpRequest?a.XMLHttpRequest:n.XDomainRequest,function(e,t){for(var r=0;r<e.length;r++)t(e[r])}(["get","put","post","patch","head","delete"],function(e){a["delete"===e?"del":e]=function(t,r,n){return(r=l(t,r,n)).method=e.toUpperCase(),u(r)}})},{"global/window":47,"is-function":48,"parse-headers":51,xtend:56}],56:[function(e,t,r){t.exports=function(){for(var e={},t=0;t<arguments.length;t++){var r=arguments[t];for(var i in r)n.call(r,i)&&(e[i]=r[i])}return e};var n=Object.prototype.hasOwnProperty},{}],57:[function(e,t,r){t.exports={name:"@livelyvideo/stock-vod-player",version:"1.1.5",description:"Lively Video Stock VOD Player",author:"LivelyVideo",license:"proprietary",main:"dist/stock-vod-player.min.js",publishConfig:{"always-auth":!0,registry:"https://npm.livelyvideo.tv"},repository:{private:!0},files:["dist"],config:{docfolder:"stock-vod-js"},scripts:{babel:"rm -rf lib && babel src/js --out-dir lib",browserify:"browserify ./src/js/index.js -o dist/stock-vod-player.js -t [ babelify ] -s LivelyStockVodPlayer",build:"npm run babel ; npm run browserify ; npm run uglify","demo:build":"browserify ./demo/app.js -o demo/assets/demo.js -t [ babelify ]","demo:css":"node-sass --output-style compressed ./demo/main.scss > ./demo//assets/demo.css",demo:"http-server -p 8089 demo/assets/ -o",css:"mkdir -p dist && node-sass --output-style compressed ./src/scss/main.scss > ./dist/stock.min.css && node-sass --output-style compressed ./src/scss/main.scss > ./dist/stock.min.scss",docs:"mkdir -p ../../../../docs/clients/${npm_package_config_docfolder}/${npm_package_version} && npm run docs:jsdoc && npm run docs:readme && npm run docs:dist","docs:jsdoc":'jsdoc2md "src/**/*.js" > APIREFERENCE.md && cp APIREFERENCE.md ../../../../docs/clients/${npm_package_config_docfolder}/${npm_package_version}/APIREFERENCE.md && cp APIREFERENCE.md ../../../../docs/clients/${npm_package_config_docfolder}/APIREFERENCE.md',"docs:readme":"cp README.md ../../../../docs/clients/${npm_package_config_docfolder}/${npm_package_version}/README.md && cp README.md ../../../../docs/clients/${npm_package_config_docfolder}/README.md","docs:dist":"bestzip ../../../../docs/clients/${npm_package_config_docfolder}/${npm_package_version}/${npm_package_config_docfolder}-${npm_package_version}.zip dist/*",lint:"eslint .","lint:fix":"eslint . --fix","lint:watch":"esw -w .","pre-commit":"npm run lint && npm run build",uglify:"uglifyjs dist/stock-vod-player.js --compress --mangle -o dist/stock-vod-player.min.js"},devDependencies:{"babel-cli":"^6.18.0","babel-eslint":"^7.0.0","babel-plugin-transform-es2015-modules-commonjs":"^6.18.0","babel-preset-es2015":"^6.18.0","babel-register":"^6.18.0",babelify:"^7.3.0",bestzip:"^1.1.3",browserify:"^13.1.1",eslint:"^2.10.1","eslint-config-airbnb":"^9.0.1","eslint-plugin-import":"^1.8.0","eslint-plugin-jsx-a11y":"^2.2.2","eslint-plugin-react":"^5.1.1","eslint-watch":"^2.1.11","http-server":"^0.11.1","jsdoc-to-markdown":"^1.3.6","node-sass":"^3.10.1","uglify-js":"^3.0.20"},dependencies:{"@livelyvideo/player-controls":"^1.2.9","@livelyvideo/player-core":"^1.2.7","@livelyvideo/player-flash-hls-driver":"^1.2.6","@livelyvideo/player-hlsjs-driver":"^1.2.7","@livelyvideo/player-native-hls-driver":"^1.2.6","@livelyvideo/player-native-mp4-driver":"^1.2.7",add:"^2.0.6",yarn:"^0.24.6"}}},{}],58:[function(e,t,r){"use strict";"undefined"==typeof window?t.exports=function(){}:t.exports=e("./stock-vod-player").default},{"./stock-vod-player":59}],59:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=d(e("events")),o=d(e("@livelyvideo/player-core/lib/player")),s=d(e("@livelyvideo/player-hlsjs-driver/lib/driver")),l=d(e("@livelyvideo/player-native-hls-driver/lib/driver")),a=d(e("@livelyvideo/player-native-mp4-driver/lib/driver")),u=d(e("@livelyvideo/player-flash-hls-driver/lib/driver")),c=d(e("@livelyvideo/player-controls/lib/index")),f=d(e("../../package.json"));function d(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(e,r,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var f=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));f.el=e,f.playerEl=document.createElement("div"),f.controlsEl=document.createElement("div"),f.el.appendChild(f.playerEl),f.el.appendChild(f.controlsEl),n=n||{},(i=i||{}).messages=i.messages||{"Stream is currently offline":"Media is not available"};var d=[];if(n.drivers)for(var h=0;h<n.drivers.length;h++)switch(n.drivers[h]){case"hlsjs":d.push(s.default);break;case"hls":d.push(l.default);break;case"flashHls":d.push(u.default);break;case"mp4":d.push(a.default)}else d=[s.default,l.default];return n.drivers=d,f.player=new o.default(f.playerEl,r,n),f.controls=new c.default(f.controlsEl,i),f.controls.attach(f.player),f}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),n(t,[{key:"destroy",value:function(){this.playerEl.remove(),this.controlsEl.remove(),this.controls.destroy(),this.player.destroy()}}],[{key:"version",get:function(){return"LVSVP "+f.default.version}}]),t}();r.default=h},{"../../package.json":57,"@livelyvideo/player-controls/lib/index":6,"@livelyvideo/player-core/lib/player":27,"@livelyvideo/player-flash-hls-driver/lib/driver":39,"@livelyvideo/player-hlsjs-driver/lib/driver":41,"@livelyvideo/player-native-hls-driver/lib/driver":42,"@livelyvideo/player-native-mp4-driver/lib/driver":43,events:45}]},{},[58])(58)});
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{}],3:[function(require,module,exports){
(function (global){
!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).LivelyUpload=e()}}(function(){return function i(s,a,u){function l(t,e){if(!a[t]){if(!s[t]){var r="function"==typeof require&&require;if(!e&&r)return r(t,!0);if(c)return c(t,!0);var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}var o=a[t]={exports:{}};s[t][0].call(o.exports,function(e){return l(s[t][1][e]||e)},o,o.exports,i,s,a,u)}return a[t].exports}for(var c="function"==typeof require&&require,e=0;e<u.length;e++)l(u[e]);return l}({1:[function(e,t,r){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function u(e){return"function"==typeof e}function l(e){return"object"==typeof e&&null!==e}function c(e){return void 0===e}((t.exports=n).EventEmitter=n).prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if(!function(e){return"number"==typeof e}(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,r,n,o,i,s;if(this._events||(this._events={}),"error"===e&&(!this._events.error||l(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var a=new Error('Uncaught, unspecified "error" event. ('+t+")");throw a.context=t,a}if(c(r=this._events[e]))return!1;if(u(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:o=Array.prototype.slice.call(arguments,1),r.apply(this,o)}else if(l(r))for(o=Array.prototype.slice.call(arguments,1),n=(s=r.slice()).length,i=0;i<n;i++)s[i].apply(this,o);return!0},n.prototype.on=n.prototype.addListener=function(e,t){var r;if(!u(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,u(t.listener)?t.listener:t),this._events[e]?l(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,l(this._events[e])&&!this._events[e].warned&&(r=c(this._maxListeners)?n.defaultMaxListeners:this._maxListeners)&&0<r&&this._events[e].length>r&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},n.prototype.once=function(e,t){if(!u(t))throw TypeError("listener must be a function");var r=!1;function n(){this.removeListener(e,n),r||(r=!0,t.apply(this,arguments))}return n.listener=t,this.on(e,n),this},n.prototype.removeListener=function(e,t){var r,n,o,i;if(!u(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(o=(r=this._events[e]).length,n=-1,r===t||u(r.listener)&&r.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(l(r)){for(i=o;0<i--;)if(r[i]===t||r[i].listener&&r[i].listener===t){n=i;break}if(n<0)return this;1===r.length?(r.length=0,delete this._events[e]):r.splice(n,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(u(r=this._events[e]))this.removeListener(e,r);else if(r)for(;r.length;)this.removeListener(e,r[r.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){return this._events&&this._events[e]?u(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(u(t))return 1;if(t)return t.length}return 0},n.listenerCount=function(e,t){return e.listenerCount(t)}},{}],2:[function(e,t,r){r.endianness=function(){return"LE"},r.hostname=function(){return"undefined"!=typeof location?location.hostname:""},r.loadavg=function(){return[]},r.uptime=function(){return 0},r.freemem=function(){return Number.MAX_VALUE},r.totalmem=function(){return Number.MAX_VALUE},r.cpus=function(){return[]},r.type=function(){return"Browser"},r.release=function(){return"undefined"!=typeof navigator?navigator.appVersion:""},r.networkInterfaces=r.getNetworkInterfaces=function(){return{}},r.arch=function(){return"javascript"},r.platform=function(){return"browser"},r.tmpdir=r.tmpDir=function(){return"/tmp"},r.EOL="\n",r.homedir=function(){return"/"}},{}],3:[function(e,t,r){var n,o,i=t.exports={};function s(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function u(t){if(n===setTimeout)return setTimeout(t,0);if((n===s||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:s}catch(e){n=s}try{o="function"==typeof clearTimeout?clearTimeout:a}catch(e){o=a}}();var l,c=[],f=!1,p=-1;function d(){f&&l&&(f=!1,l.length?c=l.concat(c):p=-1,c.length&&h())}function h(){if(!f){var e=u(d);f=!0;for(var t=c.length;t;){for(l=c,c=[];++p<t;)l&&l[p].run();p=-1,t=c.length}l=null,f=!1,function(t){if(o===clearTimeout)return clearTimeout(t);if((o===a||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(t);try{o(t)}catch(e){try{return o.call(null,t)}catch(e){return o.call(this,t)}}}(e)}}function _(e,t){this.fun=e,this.array=t}function v(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];c.push(new _(e,t)),1!==c.length||f||u(h)},_.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=v,i.addListener=v,i.once=v,i.off=v,i.removeListener=v,i.removeAllListeners=v,i.emit=v,i.prependListener=v,i.prependOnceListener=v,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],4:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var o=h(e("babel-runtime/core-js/object/define-property")),n=h(e("babel-runtime/core-js/object/set-prototype-of")),i=h(e("babel-runtime/core-js/object/create")),s=h(e("babel-runtime/core-js/object/assign")),a=h(e("babel-runtime/core-js/object/get-prototype-of")),u=function(e,t,r){return t&&l(e.prototype,t),r&&l(e,r),e};function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),(0,o.default)(e,n.key,n)}}var c=h(e("@livelyvideo/logger-core/lib/source")),f=h(e("events")),p=h(e("deepmerge")),d=h(e("./package-json"));function h(e){return e&&e.__esModule?e:{default:e}}function _(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var v=new c.default(d.default),y={timeout:5e3,headers:{},bootstrap:{},loggerOptions:{}},b={Accept:"application/json"},m=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=(0,i.default)(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(n.default?(0,n.default)(e,t):e.__proto__=t)}(g,f.default),u(g,[{key:"destroy",value:function(){this._stopped=!0}},{key:"request",value:function(e){var t=this,r=0<arguments.length&&void 0!==e?e:function(){};if(this._fatalError)r(this._fatalError);else if(null===this._token){var n=!1,o=function(){n||(n=!0,r(null,t._token))},i=setTimeout(function(){t.removeListener("ready",o),n||(n=!0,r(new Error("authorization: timeout")))},this.options.timeout);this.once("ready",function(){clearTimeout(i),o()})}else r(null,this._token)}},{key:"refreshToken",value:function(e){var t=this;if(e)return this._token=e,void(null!==this._autorefresh&&(clearTimeout(this._autorefresh),this._autorefresh=null));null!==this._token&&(null!==this._autorefresh&&(clearTimeout(this._autorefresh),this._autorefresh=null),this._token=null,t._retryRequest())}},{key:"ensureToken",value:function(e){this._token?e():this.once("ready",function(){e()})}},{key:"_parseJSON",value:function(e){return e.text().then(function(e){if(e)try{return JSON.parse(e)}catch(e){throw e.fatal=!0,e}return{}})}},{key:"_retryRequest",value:function(){var e=this,t=this._retries[this._retry];t?setTimeout(function(){e._makeRequest()},t):this._makeRequest()}},{key:"_makeRequest",value:function(){var n=this;fetch(this._url,{credentials:"same-origin",headers:this._headers}).then(function(e){if(200<=e.status&&e.status<300)return n._parseJSON(e);if(401===e.status){var t=new Error("authorization: unauthorized");throw t.fatal=!0,t}if(403!==e.status)throw new Error("authorization: non-200 response code from auth server");var r=new Error("authorization: forbidden");throw r.fatal=!0,r}).then(function(e){n._token=e.token,n._retry=0,setTimeout(function(){n.emit("ready",{token:e.token})});var t=new Date(e.expire).getTime()-Date.now()-6e4;n._autorefresh=setTimeout(function(){n._autorefresh=null,n._stopped||n._retryRequest()},t)}).catch(function(e){if(n._token=null,e instanceof TypeError&&(e.fatal=!0),e.fatal)return n._fatalError=e,void n.emit("error",e.message||"",e);n.emit("log","network",e.message||"",e),n._retryRequest(),n._retry<n._retries.length-1&&n._retry++})}}]),g);function g(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,g);var n=_(this,(g.__proto__||(0,a.default)(g)).call(this));if(n.options=(0,p.default)(y,r),v.setOptions(n.options.loggerOptions),v.attachEmitter(n),n.options.host&&v.setInstanceOptions({host:n.options.host}),!e)return setTimeout(function(){return n.emit("error","scope is required")}),_(n);if(!t)return setTimeout(function(){return n.emit("error","authorization server url is required")}),_(n);if(-1===t.indexOf("?")?n._url=t+"?scope="+e:n._url=t+"&scope="+e,n._stopped=!1,n._fatalError=null,n._token=n.options.bootstrap.token||null,n._retries=[0,200,1e3,3e3],n._retry=0,n._autorefresh=null,n._headers=(0,s.default)({},b,r.headers),null===n._token)n._retryRequest();else if(n.options.bootstrap&&n.options.bootstrap.expire){var o=n.options.bootstrap.expire-Date.now()-6e4;n._autorefresh=setTimeout(function(){n._autorefresh=null,n._stopped||n._retryRequest()},o)}return n}r.default=m,t.exports=r.default},{"./package-json":5,"@livelyvideo/logger-core/lib/source":11,"babel-runtime/core-js/object/assign":30,"babel-runtime/core-js/object/create":31,"babel-runtime/core-js/object/define-property":32,"babel-runtime/core-js/object/get-prototype-of":33,"babel-runtime/core-js/object/set-prototype-of":35,deepmerge:145,events:1}],5:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default={version:"1.3.5",name:"@livelyvideo/auth-core"},t.exports=r.default},{}],6:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n,o=e("./auth-core"),i=(n=o)&&n.__esModule?n:{default:n};r.default=i.default,t.exports=r.default},{"./auth-core":4}],7:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.supportedLevels={error:0,warn:1,deprecated:1,info:2,debug:3,timing:3,network:3}},{}],8:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=function(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e};function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var s=l(e("serialize-error")),a=e("./const"),u=l(e("./package-json"));function l(e){return e&&e.__esModule?e:{default:e}}var c={host:null,interval:3e4,limit:500,maxRequestSize:1048576,reportLevel:"error"},f=null,p=(o(d,[{key:"setOptions",value:function(e){this.options=n({},c,e),this.options.host&&this._uri||(this._uri="https://"+this.options.host+"/client-logs")}},{key:"add",value:function(e){this.storage.push(e),a.supportedLevels[e.level]<=a.supportedLevels[this.options.reportLevel]?this.send():this.checkStorageLimit()}},{key:"send",value:function(){var t=this;if(this.storage.length&&this._uri){var r=this.storage;this.storage=[];var e={messages:r},n=void 0;try{n=JSON.stringify(e)}catch(e){return void this.storage.push({level:"error",package:u.default,source:"client",message:"Error stringifying batch. Dropped "+r.length+" logs.",error:(0,s.default)(e)})}this._byteLength(n)>this.options.maxRequestSize?this.storage.push({level:"error",package:u.default,source:"client",message:"Body exceeds maxRequestSize. Dropped "+r.length+" logs."}):fetch(this._uri,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:n}).then(this._handleFetchError).catch(function(e){t.storage.push({level:"network",package:u.default,source:"client",message:"Network failure. Dropped "+r.length+" logs.",error:(0,s.default)(e)})})}}},{key:"enable",value:function(){var e=this;this._uri&&(this._watchInterval=setInterval(function(){return e.send()},this.options.interval),"undefined"!=typeof window&&(this._watchUnload=this._eventHelper(window,"unload",function(){return e.send()})))}},{key:"disable",value:function(){this._watchInterval&&clearInterval(this._watchInterval),this._watchUnload&&this._watchUnload()}},{key:"checkStorageLimit",value:function(){this.options.limit&&this.storage.length>this.options.limit&&this.send()}},{key:"_handleFetchError",value:function(e){if(!e.ok)throw new TypeError(e.status,e.statusText);return e}},{key:"_byteLength",value:function(e){for(var t=e.length,r=e.length-1;0<=r;r--){var n=e.charCodeAt(r);127<n&&n<=2047?t++:2047<n&&n<=65535&&(t+=2),56320<=n&&n<=57343&&r--}return t}},{key:"_eventHelper",value:function(e,t,r){return e.addEventListener(t,r),function(){e.removeEventListener(t,r)}}}]),d);function d(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),f||((f=this).options=c,this.storage=[],f)}r.default=p,t.exports=r.default},{"./const":7,"./package-json":10,"serialize-error":151}],9:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},n=function(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e};function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var s=f(e("events")),a=f(e("serialize-error")),u=f(e("./instance")),l=f(e("./package-json")),c=e("./const");function f(e){return e&&e.__esModule?e:{default:e}}function p(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}var d={level:"warn",silent:!0,disable:!1,events:!0,name:l.default.name,version:l.default.version},h=(n(_,[{key:"setOptions",value:function(e,t,r){this.options=o({},this.options,e),t&&this.options.events&&this.attachEmitter(t,r)}},{key:"setInstanceOptions",value:function(e){this.instance.options.host&&e.host&&this.instance.options.host!==e.host?this.warn("Unable to set instance options. Host set to "+this.instance.options.host+" and cannot be set "+e.host+"."):(this.instance.setOptions(e),this.options.disable||this.enableInstance())}},{key:"enableInstance",value:function(){this.instance.enable()}},{key:"disableInstance",value:function(){this.instance.disable()}},{key:"instanceSend",value:function(){this.instance.send()}},{key:"setLevel",value:function(e){c.supportedLevels[e]?this.options.level=e:this.warn(e+" level is unsupported.")}},{key:"log",value:function(e){for(var t=arguments.length,r=Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var o;this._isWritable(e)&&(o=this.writer)[e].apply(o,r);var i=this._validateLog(e,r);i&&this.instance.add(i)}},{key:"debug",value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];this.log.apply(this,["debug"].concat(t))}},{key:"error",value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];this.log.apply(this,["error"].concat(t))}},{key:"info",value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];this.log.apply(this,["info"].concat(t))}},{key:"warn",value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];this.log.apply(this,["warn"].concat(t))}},{key:"deprecated",value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];this.log.apply(this,["deprecated"].concat(t))}},{key:"timing",value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];this.log.apply(this,["timing"].concat(t))}},{key:"network",value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];this.log.apply(this,["network"].concat(t))}},{key:"enable",value:function(){"undefined"!=typeof window?this.writer=window.console:console&&(this.writer=console),this.writer&&(this.writer.timing=this.writer.info,this.writer.deprecated=this.writer.warn,this.writer.network=this.writer.warn)}},{key:"disable",value:function(){this.writer={}}},{key:"attachEmitter",value:function(e,t){if(e instanceof s.default)for(var r=t||["error","log"],n=0;n<r.length;n++)e.on(r[n],function(){this[arguments[0]]||this.error.apply(this,p(Array.prototype.slice.call(arguments,1))),this[arguments[0]].apply(this,p(Array.prototype.slice.call(arguments,1)))}.bind(this,r[n]));else this.error("attachEmitter not supplied with instanceof EventEmitter")}},{key:"detachEmitter",value:function(e,t){if(e instanceof s.default)for(var r=t||["error","log"],n=0;n<r.length;n++)e.removeListener(r[n],function(){this[arguments[0]]||this.error.apply(this,p(Array.prototype.slice.call(arguments,1))),this[arguments[0]].apply(this,p(Array.prototype.slice.call(arguments,1)))}.bind(this,r[n]));else this.error("detachEmitter not supplied with instanceof EventEmitter")}},{key:"_isWritable",value:function(e){return!this.options.silent&&this.writer[e]&&this.writer[e].apply&&c.supportedLevels[e]<=c.supportedLevels[this.options.level]}},{key:"_validateLog",value:function(e,t){var r={package:{name:this.options.name,version:this.options.version},timestamp:(new Date).toISOString(),source:"client",userAgent:"undefined"!=typeof navigator?navigator.userAgent:"node",referrer:"undefined"!=typeof document?document.referrer:"node",level:e},n=t[t.length-1];switch(Object.prototype.toString.call(n)){case"[object Object]":r=o({},r,t.pop());break;case"[object Error]":r.error=(0,a.default)(t.pop());break;case"[object Array]":r.array=t.pop()}r.message=t.join(" ");try{JSON.stringify(r)}catch(e){return this.error("Dropped log due to invalid data structure",e),null}return r}}]),_);function _(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,_),this.options=o({},d,e),this.instance=new u.default,this.enable()}r.default=h,t.exports=r.default},{"./const":7,"./instance":8,"./package-json":10,events:1,"serialize-error":151}],10:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default={version:"1.1.1",name:"@livelyvideo/logger-core"},t.exports=r.default},{}],11:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n,o=e("./logger-core"),i=(n=o)&&n.__esModule?n:{default:n};r.default=i.default,t.exports=r.default},{"./logger-core":9}],12:[function(f,r,n){(function(t){!function(e){"object"==typeof n&&void 0!==r?r.exports=e():("undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:this).LivelyLocales=e()}(function(){return function i(s,a,u){function l(r,e){if(!a[r]){if(!s[r]){var t="function"==typeof f&&f;if(!e&&t)return t(r,!0);if(c)return c(r,!0);var n=new Error("Cannot find module '"+r+"'");throw n.code="MODULE_NOT_FOUND",n}var o=a[r]={exports:{}};s[r][0].call(o.exports,function(e){var t=s[r][1][e];return l(t||e)},o,o.exports,i,s,a,u)}return a[r].exports}for(var c="function"==typeof f&&f,e=0;e<u.length;e++)l(u[e]);return l}({1:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var i={},s={},a=(function(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),e}(u,[{key:"localize",value:function(e){var t;return(t=this.data[e])?t:(this.silent||this.warned[e]||(this.warned[e]=!0,this.name?console.warn("'"+e+"' has no translation in the provided '"+this.name+"' locale files or localization messages"):console.warn("'"+e+"' has no translation in the provided localization messages.")),e)}}]),u);function u(e,t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),e&&i[e]||t?(this.warned={},this.silent=r,this.name=e,this.data=i[e]||{},t&&Object.assign(this.data,t)):this.localize=function(e){return e}}[].map(function(e){var t=e.name.split("/")[2];i[t]=Object.assign({},i[t],e.module)});var l=new a;Object.keys(i).forEach(function(e){s[e]=new a(e)}),r.default=function(e,t,r){if(t){if("object"!==(void 0===t?"undefined":n(t)))throw new Error("Lively Localization instantiated with something other than a messages object",{messages:t});return new a(e,t,r)}return e&&s[e]?s[e]:l},t.exports=r.default},{}]},{},[1])(1)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],13:[function(e,t,r){arguments[4][7][0].apply(r,arguments)},{dup:7}],14:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),e("es6-promise/auto"),e("whatwg-fetch");var n,o=e("./logger-core"),i=(n=o)&&n.__esModule?n:{default:n};r.default=i.default,t.exports=r.default},{"./logger-core":16,"es6-promise/auto":147,"whatwg-fetch":152}],15:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=d(e("babel-runtime/core-js/array/from")),o=d(e("babel-runtime/core-js/object/assign")),i=d(e("babel-runtime/core-js/object/define-property")),s=d(e("babel-runtime/core-js/json/stringify")),a=o.default||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},u=function(e,t,r){return t&&l(e.prototype,t),r&&l(e,r),e};function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),(0,i.default)(e,n.key,n)}}var c=d(e("serialize-error")),f=e("./const"),p=d(e("./package-json"));function d(e){return e&&e.__esModule?e:{default:e}}function h(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return(0,n.default)(e)}var _={host:null,interval:3e4,limit:500,maxRequestSize:1048576,reportLevel:"error",noHttps:!1},v=null,y=(u(b,[{key:"setOptions",value:function(e){var t=function(e,t){var r={};for(var n in e)0<=t.indexOf(n)||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}(e,[]);this.options=a({},this.options,t),this._uri||(this.options.uri?this._uri=this.options.uri:this._uri=(this.options.noHttps?"http://":"https://")+this.options.host+"/client-logs")}},{key:"validateContext",value:function(e){var t=void 0;try{t=(0,s.default)(e)}catch(e){return this.addInstanceLog({level:"error",package:p.default,source:"client",message:"Error stringifying options context",error:(0,c.default)(e)}),!1}return t}},{key:"add",value:function(e){this.storage.push(e),f.supportedLevels[e.level]<=f.supportedLevels[this.options.reportLevel]?this.send():this.checkStorageLimit()}},{key:"addInstanceLog",value:function(e){var t=void 0;try{t=(0,s.default)(e)}catch(e){return}this.storage.push(t)}},{key:"send",value:function(){var t=this;if(this.storage.length&&this._uri){var r=this.storage.splice(0,this.options.limit),e=this.validateContext(this.options.context),n='{ "messages": [';r.map(function(e,t){n+=e,t!==r.length-1&&(n+=", ")}),n+="]",n+=e?', "context": '+e+" }":" }",this._byteLength(n)>this.options.maxRequestSize?this.addInstanceLog({level:"error",package:p.default,source:"client",message:"Body exceeds maxRequestSize. Dropped "+r.length+" logs."}):fetch(this._uri,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:n}).then(this._handleFetchError).catch(function(e){t.storage=[].concat(h(r),h(t.storage)),t.networkFailure=!0,t.addInstanceLog({level:"network",package:p.default,source:"client",message:"Network failure.",error:(0,c.default)(e)})})}}},{key:"enable",value:function(){var e=this;this._uri&&(this._watchInterval=setInterval(function(){return e.send()},this.options.interval),"undefined"!=typeof window&&(this._watchUnload=this._eventHelper(window,"unload",function(){return e.send()})))}},{key:"disable",value:function(){this._watchInterval&&clearInterval(this._watchInterval),this._watchUnload&&this._watchUnload()}},{key:"checkStorageLimit",value:function(){this.options.limit&&!this.networkFailure&&this.storage.length>=this.options.limit&&this.send()}},{key:"_handleFetchError",value:function(e){if(!e.ok)throw new TypeError(e.status,e.statusText);return this.networkFailure=!1,e}},{key:"_byteLength",value:function(e){for(var t=e.length,r=e.length-1;0<=r;r--){var n=e.charCodeAt(r);127<n&&n<=2047?t++:2047<n&&n<=65535&&(t+=2),56320<=n&&n<=57343&&r--}return t}},{key:"_eventHelper",value:function(e,t,r){return e.addEventListener(t,r),function(){e.removeEventListener(t,r)}}}]),b);function b(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,b),v||((v=this).options=_,this.storage=[],this.networkFailure=!1,this._handleFetchError=this._handleFetchError.bind(this),v)}r.default=y,t.exports=r.default},{"./const":13,"./package-json":17,"babel-runtime/core-js/array/from":28,"babel-runtime/core-js/json/stringify":29,"babel-runtime/core-js/object/assign":30,"babel-runtime/core-js/object/define-property":32,"serialize-error":151}],16:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=_(e("babel-runtime/core-js/array/from")),o=_(e("babel-runtime/core-js/object/assign")),i=_(e("babel-runtime/core-js/object/define-property")),s=_(e("babel-runtime/core-js/json/stringify")),a=o.default||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},u=function(e,t,r){return t&&l(e.prototype,t),r&&l(e,r),e};function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),(0,i.default)(e,n.key,n)}}var c=_(e("events")),f=_(e("serialize-error")),p=_(e("./instance")),d=_(e("./package-json")),h=e("./const");function _(e){return e&&e.__esModule?e:{default:e}}function v(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return(0,n.default)(e)}var y={level:"warn",remoteLevel:"info",silent:!0,disable:!1,events:!0,name:d.default.name,version:d.default.version},b=(u(m,[{key:"setOptions",value:function(e,t,r){this.options=a({},this.options,e),this.options.disable&&this.disableInstance(),t&&this.options.events&&this.attachEmitter(t,r)}},{key:"setInstanceOptions",value:function(e){this.instance.options.host&&e.host&&this.instance.options.host!==e.host?this.warn("Unable to set instance options. Host set to "+this.instance.options.host+" and cannot be set "+e.host+"."):this.instance.options.uri&&e.uri&&this.instance.options.uri!==e.uri?this.warn("Unable to set instance options. Host set to "+this.instance.options.uri+" and cannot be set "+e.uri+"."):(this.instance.setOptions(e),this.options.disable||this.enableInstance())}},{key:"enableInstance",value:function(){this.instance.enable()}},{key:"disableInstance",value:function(){this.instance.disable()}},{key:"instanceSend",value:function(){this.instance.send()}},{key:"setLevel",value:function(e){h.supportedLevels[e]?this.options.level=e:this.warn(e+" level is unsupported.")}},{key:"setRemoteLevel",value:function(e){h.supportedLevels[e]?this.options.remoteLevel=e:this.warn(e+" level is unsupported.")}},{key:"log",value:function(e){for(var t=arguments.length,r=Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var o;this._isWritable(e)&&(o=this.writer)[e].apply(o,r);var i=this._validateLog(e,r);i&&h.supportedLevels[e]<=h.supportedLevels[this.options.remoteLevel]&&this.instance.add(i)}},{key:"debug",value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];this.log.apply(this,["debug"].concat(t))}},{key:"error",value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];this.log.apply(this,["error"].concat(t))}},{key:"info",value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];this.log.apply(this,["info"].concat(t))}},{key:"warn",value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];this.log.apply(this,["warn"].concat(t))}},{key:"deprecated",value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];this.log.apply(this,["deprecated"].concat(t))}},{key:"timing",value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];this.log.apply(this,["timing"].concat(t))}},{key:"network",value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];this.log.apply(this,["network"].concat(t))}},{key:"enable",value:function(){"undefined"!=typeof window?this.writer=window.console:console&&(this.writer=console),this.writer&&(this.writer.timing=this.writer.info,this.writer.deprecated=this.writer.warn,this.writer.network=this.writer.warn)}},{key:"disable",value:function(){this.writer={}}},{key:"attachEmitter",value:function(e,t){if(e instanceof c.default)for(var r=t||["error","log"],n=0;n<r.length;n++)e.on(r[n],function(){this[arguments[0]]||this.error.apply(this,v(Array.prototype.slice.call(arguments,1))),this[arguments[0]].apply(this,v(Array.prototype.slice.call(arguments,1)))}.bind(this,r[n]));else this.error("attachEmitter not supplied with instanceof EventEmitter")}},{key:"detachEmitter",value:function(e,t){if(e instanceof c.default)for(var r=t||["error","log"],n=0;n<r.length;n++)e.removeListener(r[n],function(){this[arguments[0]]||this.error.apply(this,v(Array.prototype.slice.call(arguments,1))),this[arguments[0]].apply(this,v(Array.prototype.slice.call(arguments,1)))}.bind(this,r[n]));else this.error("detachEmitter not supplied with instanceof EventEmitter")}},{key:"_isWritable",value:function(e){return!this.options.silent&&this.writer[e]&&this.writer[e].apply&&h.supportedLevels[e]<=h.supportedLevels[this.options.level]}},{key:"_validateLog",value:function(e,t){var r={package:{name:this.options.name,version:this.options.version},time:(new Date).toISOString(),source:"client",userAgent:"undefined"!=typeof navigator?navigator.userAgent:"node",referrer:"undefined"!=typeof document?document.referrer:"node",level:e},n=t[t.length-1];switch(Object.prototype.toString.call(n)){case"[object Object]":r=a({},r,t.pop());break;case"[object Error]":r.error=(0,f.default)(t.pop());break;case"[object Array]":r.array=t.pop()}r.message=t.join(" ");var o=void 0;try{o=(0,s.default)(r)}catch(e){try{o=(0,s.default)(r,function(e,t){return e?""+t:t})}catch(e){return this.error("Dropped log due to invalid data structure",e),null}}return o}}]),m);function m(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,m),this.options=a({},y,e),this.instance=new p.default,this.enable()}r.default=b,t.exports=r.default},{"./const":13,"./instance":15,"./package-json":17,"babel-runtime/core-js/array/from":28,"babel-runtime/core-js/json/stringify":29,"babel-runtime/core-js/object/assign":30,"babel-runtime/core-js/object/define-property":32,events:1,"serialize-error":151}],17:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default={version:"1.3.4",name:"@livelyvideo/logger-core"},t.exports=r.default},{}],18:[function(e,t,r){arguments[4][11][0].apply(r,arguments)},{"./logger-core":16,dup:11}],19:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.default={UPLOAD_ERROR:"error",UPLOAD_START:"start",UPLOAD_SUCCESS:"success",UPLOAD_FAILURE:"failure",UPLOAD_ADDEDFILE:"addedfile",UPLOAD_REMOVEDFILE:"removedfile",UPLOAD_PROGRESS:"progress",UPLOAD_RECONNECTING:"reconnecting",UPLOAD_CONNECTED:"connected",UPLOAD_LOG:"log",UPLOAD_CORRUPT:"corrupt"},t.exports=r.default},{}],20:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=_(e("babel-runtime/core-js/symbol/iterator")),o=_(e("babel-runtime/core-js/symbol")),i=_(e("babel-runtime/core-js/object/define-property")),s=_(e("babel-runtime/core-js/object/set-prototype-of")),a=_(e("babel-runtime/core-js/object/create")),u=_(e("babel-runtime/core-js/object/get-prototype-of")),l="function"==typeof o.default&&"symbol"==typeof n.default?function(e){return typeof e}:function(e){return e&&"function"==typeof o.default&&e.constructor===o.default&&e!==o.default.prototype?"symbol":typeof e},c=function(e,t,r){return t&&f(e.prototype,t),r&&f(e,r),e};function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),(0,i.default)(e,n.key,n)}}e("es6-promise/auto"),e("whatwg-fetch"),e("classlist-polyfill");var p=_(e("@livelyvideo/utils/lib/createElement")),d=_(e("./is-mobile-js")),h=_(e("detect-browser"));function _(e){return e&&e.__esModule?e:{default:e}}var v=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=(0,a.default)(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(s.default?(0,s.default)(e,t):e.__proto__=t)}(y,_(e("./upload-core")).default),c(y,[{key:"selectFile",value:function(){this.uploadInput.click()}},{key:"destroy",value:function(){this._removeInputChangeListener(),this.el.parentNode.removeChild(this.el)}},{key:"_mount",value:function(e){var t=this;switch(void 0===e?"undefined":l(e)){case"string":this.el=document.querySelector(e);break;case"object":this.el=e;break;default:setTimeout(function(){return t.emit("error",new Error("The constructor has not been given a valid element or selector."))})}}},{key:"_render",value:function(){this.uploadInput=(0,p.default)({tagName:"input",className:this.options.bemPrefix+"__input",attributes:{type:"file"}}),this.uploadInput.setAttribute("accept",this.options.accept||""),d.default.any&&"ios"!==h.default.name||!this.options.multiple||this.uploadInput.setAttribute("multiple",""),this.el.appendChild(this.uploadInput),this._removeInputChangeListener=this._eventHelper(this.uploadInput,"change",this._selectFileChange)}},{key:"_selectFileChange",value:function(e){for(var t=e.target.files,r=0;r<t.length;r++)this.addFile(t[r])}},{key:"_eventHelper",value:function(e,t,r){return e.addEventListener(t,r),function(){e.removeEventListener(t,r)}}},{key:"isMobile",get:function(){return d.default}},{key:"isSupportedBrowser",get:function(){var e=!1;return window.File&&window.FileReader&&window.FileList&&window.Blob&&window.FormData&&document.querySelector&&(e=!0),e}}]),y);function y(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,y);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(y.__proto__||(0,u.default)(y)).call(this,t));return r._selectFileChange=r._selectFileChange.bind(r),r._mount(e),r._render(),r}r.default=v,t.exports=r.default},{"./is-mobile-js":21,"./upload-core":25,"@livelyvideo/utils/lib/createElement":26,"babel-runtime/core-js/object/create":31,"babel-runtime/core-js/object/define-property":32,"babel-runtime/core-js/object/get-prototype-of":33,"babel-runtime/core-js/object/set-prototype-of":35,"babel-runtime/core-js/symbol":37,"babel-runtime/core-js/symbol/iterator":38,"classlist-polyfill":40,"detect-browser":146,"es6-promise/auto":147,"whatwg-fetch":152}],21:[function(e,t,r){"use strict";function n(e,t){return e.test(t)}function o(e){var t=e||navigator.userAgent||"",r=t.split("[FBAN");if(void 0!==r[1]&&(t=r[0]),void 0!==(r=t.split("Twitter"))[1]&&(t=r[0]),this.apple={phone:n(a,t),ipod:n(u,t),tablet:!n(a,t)&&n(l,t),device:n(a,t)||n(u,t)||n(l,t)},this.amazon={phone:n(p,t),tablet:!n(p,t)&&n(d,t),device:n(p,t)||n(d,t)},this.android={phone:n(p,t)||n(c,t),tablet:!n(p,t)&&!n(c,t)&&(n(d,t)||n(f,t)),device:n(p,t)||n(d,t)||n(c,t)||n(f,t)},this.windows={phone:n(h,t),tablet:n(_,t),device:n(h,t)||n(_,t)},this.other={blackberry:n(v,t),blackberry10:n(y,t),opera:n(b,t),firefox:n(g,t),chrome:n(m,t),device:n(v,t)||n(y,t)||n(b,t)||n(g,t)||n(m,t)},this.seven_inch=n(w,t),this.any=this.apple.device||this.android.device||this.windows.device||this.other.device||this.seven_inch,this.phone=this.apple.phone||this.android.phone||this.windows.phone,this.tablet=this.apple.tablet||this.android.tablet||this.windows.tablet,"undefined"==typeof window)return this}function i(){var e=new o;return e.Class=o,e}var s,a,u,l,c,f,p,d,h,_,v,y,b,m,g,w;s=void 0,a=/iPhone/i,u=/iPod/i,l=/iPad/i,c=/(?=.*\bAndroid\b)(?=.*\bMobile\b)/i,f=/Android/i,p=/(?=.*\bAndroid\b)(?=.*\bSD4930UR\b)/i,d=/(?=.*\bAndroid\b)(?=.*\b(?:KFOT|KFTT|KFJWI|KFJWA|KFSOWI|KFTHWI|KFTHWA|KFAPWI|KFAPWA|KFARWI|KFASWI|KFSAWI|KFSAWA)\b)/i,h=/Windows Phone/i,_=/(?=.*\bWindows\b)(?=.*\bARM\b)/i,v=/BlackBerry/i,y=/BB10/i,b=/Opera Mini/i,m=/(CriOS|Chrome)(?=.*\bMobile\b)/i,g=/(?=.*\bFirefox\b)(?=.*\bMobile\b)/i,w=new RegExp("(?:Nexus 7|BNTV250|Kindle Fire|Silk|GT-P1000)","i"),void 0!==t&&t.exports&&"undefined"==typeof window?t.exports=o:void 0!==t&&t.exports&&"undefined"!=typeof window?t.exports=i():s.isMobile=i()},{}],22:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.default={ERROR_DUP_FILE:"This file has already been uploaded.",ERROR_FILE_NAME:"This file does not have a name.",ERROR_FILE_EXT:"This file extension is not supported.",ERROR_MISSING_BODY:"This file does not have any data.",ERROR_FILE_SIZE:"This file exceeds max file size.",ERROR_UNAUTH:"The user is not authorized to perform this action."},t.exports=r.default},{}],23:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default={version:"4.4.0",name:"@livelyvideo/upload-core"},t.exports=r.default},{}],24:[function(y,b,m){(function(n){"use strict";Object.defineProperty(m,"__esModule",{value:!0});var o=t(y("babel-runtime/core-js/object/define-property")),u=t(y("babel-runtime/core-js/object/keys")),p=t(y("babel-runtime/regenerator")),d=t(y("babel-runtime/core-js/promise")),e=function(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e};function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),(0,o.default)(e,n.key,n)}}var s=t(y("./is-mobile-js")),h=t(y("./events")),a=t(y("./legacy-messages"));function t(e){return e&&e.__esModule?e:{default:e}}function r(e){return function(){var a=e.apply(this,arguments);return new d.default(function(i,s){return function t(e,r){try{var n=a[e](r),o=n.value}catch(e){return void s(e)}if(!n.done)return d.default.resolve(o).then(function(e){t("next",e)},function(e){t("throw",e)});i(o)}("next")})}}var l,c,f,_=(e(v,[{key:"handleConnection",value:function(e){var r=this;return new d.default(function(t){switch(r._state){case"errored":return void t(!1);case"uninitialized":return void r._initialize(e,function(e){t(!e)});case"initializing":return void setTimeout(function(){t(!0)},500);default:r._sendChunk(e,function(e){t(!e)})}})}},{key:"report",value:function(e){var t=this.snapshot;t.reason=e,this.Upload.emit("log","error","report: "+(e||"No reason"),t)}},{key:"recover",value:function(){for(var e=this.Upload._uploadConnections,t=0;t<e.length;t++)e[t].xhr&&e[t].fileId===this.file.fileIdentifier&&e[t].xhr.abort();for(var r=0;r<this.chunks.length;r++)this.chunks[r].processed=!1,this.chunks[r].loaded=0;this._uploadPercent=0,this._uploadBytesLoaded=0,this._uploadSessionBytesLoaded=0,this._uploadIntervalBytesLoaded=0,this._uploadSpeedStart=null,this._uploadSpeed={bytesPerSecond:0,averageBytesPerSecond:0},this._state="uninitialized"}},{key:"destroy",value:function(){this.Upload._removeFileFromQueue(this.file),clearInterval(this._uploadSpeedInterval),this._uploadSpeed={bytesPerSecond:0,averageBytesPerSecond:0},this.file=null,this.Upload=null,this.options=null,this.chunks=null}},{key:"_initialize",value:(f=r(p.default.mark(function e(t,r){var n,o,i,s;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this._state="initializing",this.Upload.emit("log","info","_initialize",this.snapshot),e.prev=2,e.next=5,this._xhrRetry(this.options.url,null,t,{method:"POST",headers:{"Content-Type":"application/json","X-File-Name":this.file.name,"X-File-Size":this.file.size,"X-File-Identifier":this.file.fileIdentifier,"X-File-Status":!0,"X-Chunk-Total":this.file.chunkTotal}});case 5:if(n=e.sent,o=n.responseText?JSON.parse(n.responseText):{},400<=n.status)return i=this._requestErrorHandler(n,o,null,r),r(!i),e.abrupt("return");e.next=11;break;case 11:this._uploadId=o.id,this._trimChunks(o),this.Upload.emit(h.default.UPLOAD_START,this.file,this._uploadId),this.Upload.emit(h.default.UPLOAD_PROGRESS,this.file,this._uploadBytesLoaded,this.file.size,this._uploadPercent),this._state="initialized",s=Date.now(),this._uploadSpeedStart=s,this._uploadSpeedTime=s,t.xhr=null,r(),e.next=30;break;case 23:e.prev=23,e.t0=e.catch(2),t.xhr=null,this._state="errored",this.Upload.emit("log","error","_initialize: Error",{error:e.t0,snapshot:this.snapshot}),this.Upload.emit(h.default.UPLOAD_FAILURE,this.file,{message:"Failed to Initialize"}),r(!0);case 30:case"end":return e.stop()}},e,this,[[2,23]])})),function(e,t){return f.apply(this,arguments)})},{key:"_sendChunk",value:(c=r(p.default.mark(function e(t,r){var n,o,i,s,a,u,l;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this._getUnprocessedChunk()){e.next=5;break}return this._state="finalizing",r(),e.abrupt("return");case 5:if(n.processing=!0,n.chunkLast&&this._isProcessing())return n.processing=!1,setTimeout(function(){return r()},500),e.abrupt("return");e.next=10;break;case 10:if(o=this.file[this._sliceMethod](n.sliceStart,n.sliceEnd),e.prev=11,i=o,"file"===this.dataType)return e.next=16,this._validateBlob(o,n);e.next=21;break;case 16:return e.next=18,this._readFile(o);case 18:i=e.sent,this._checkZeroes(i)&&this.Upload.emit(h.default.UPLOAD_CORRUPT,this.file,{message:"Corrupted file"}),this.options.debug&&this._checkSum(i,n);case 21:return s=n.chunkLast?this.options.url+(this.options.wait?"?wait=true":""):this.options.url,e.next=24,this._xhrRetry(s,n,t,{method:"POST",data:i,headers:{"Content-Type":"application/octet-stream","X-File-Name":this.file.name,"X-File-Size":this.file.size,"X-File-Identifier":this.file.fileIdentifier,"X-Chunk-Last":n.chunkLast,"X-Chunk-Index":n.chunkIndex,"X-Chunk-Total":this.file.chunkTotal}});case 24:if(a=e.sent,u=a.responseText?JSON.parse(a.responseText):{},0===a.status)return o=null,n.processing=!1,n.loaded=0,t.xhr=null,r(),e.abrupt("return");e.next=33;break;case 33:if(400<=a.status)return l=this._requestErrorHandler(a,u,n,r),o=null,n.processing=!1,n.loaded=0,t.xhr=null,r(!l),e.abrupt("return");e.next=41;break;case 41:n.chunkLast&&(this.Upload.emit(h.default.UPLOAD_PROGRESS,this.file,this.file.size,this.file.size,100),this.Upload.emit(h.default.UPLOAD_SUCCESS,this.file,u["X-File-Retrieve-URL"],u["X-File-ID"])),o=null,n.processing=!1,n.processed=!0,t.xhr=null,r(),e.next=59;break;case 49:e.prev=49,e.t0=e.catch(11),o=null,n.processing=!1,n.loaded=0,t.xhr=null,this._state="errored",this.Upload.emit("log","error","_sendChunk: Error",{error:e.t0,snapshot:this.snapshot,chunk:n}),this.Upload.emit(h.default.UPLOAD_FAILURE,this.file,{message:"Failed to send"}),r(!0);case 59:n.chunkLast&&this.destroy();case 60:case"end":return e.stop()}},e,this,[[11,49]])})),function(e,t){return c.apply(this,arguments)})},{key:"_setSliceMethod",value:function(){"slice"in this.file?this._sliceMethod="slice":"mozSlice"in this.file?this._sliceMethod="mozSlice":"webkitSlice"in this.file?this._sliceMethod="webkitSlice":(this.Upload.emit("log","error","_setSliceMethod: No slice method found",this.snapshot),this.Upload.emit(h.default.UPLOAD_FAILURE,this.file,{message:"Upload not supported in this browser"}))}},{key:"_setFileChunkSize",value:function(e){var t=this.options.chunkSize,r=Math.ceil(e.size/t,t);e.chunkSize=t,e.chunkTotal=r}},{key:"_setFileIndentifier",value:function(e){var t=e.relativePath||e.webkitRelativePath||e.fileName||e.name;e.fileIdentifier=e.size+"-"+e.chunkTotal+"-"+t.replace(/[^0-9a-zA-Z_-]/gim,"")}},{key:"_setFileChunkOffsets",value:function(e){for(var t=[],r=0;r<e.chunkTotal;){var n=r*e.chunkSize,o={chunkIndex:r,chunkLast:r+1===e.chunkTotal,chunkTotal:e.chunkTotal,processing:!1,processed:!1,loaded:0,sliceStart:n,sliceEnd:(r+1)*e.chunkSize};t.push(o),r++}this.chunks=t}},{key:"_trimChunks",value:function(e){var t=[];if(e.last){if(e.missing.length)for(var r=0;r<e.missing.length;r++)t.push(e.missing[r]+e.last);for(var n=0;n<e.last;n++)-1===t.indexOf(n)&&(this.chunks[n].processed=!0,this._uploadBytesLoaded+=this.file.chunkSize)}this._uploadPercent=Math.round(this._uploadBytesLoaded/this.file.size*100)}},{key:"_validateBlob",value:(l=r(p.default.mark(function e(o,i){var s=this;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new d.default(function(t,r){function n(e){0!==e?i.chunkLast||o.size===this.file.chunkSize?(e<3&&this.Upload.emit("log","error","_validateBlob: Blob size recorrected. Waited "+1e3*e+" milliseconds.",{snapshot:this.snapshot,chunk:i}),t()):setTimeout(function(){n(--e)},1e3):r(new Error("Incorrect blob size. Waited "+1e3*e+" milliseconds."))}(n=n.bind(s))(3)}));case 3:case"end":return e.stop()}},e,this)})),function(e,t){return l.apply(this,arguments)})},{key:"_getUnprocessedChunk",value:function(){for(var e=0;e<this.chunks.length;e++){var t=this.chunks[e];if(!t.processing&&!t.processed)return t}return!1}},{key:"_isProcessing",value:function(){for(var e=0;e<this.chunks.length;e++){var t=this.chunks[e];if(!t.chunkLast&&(t.processing||!t.processed))return!0}return!1}},{key:"_readFile",value:function(n){var o=this;return new d.default(function(t,r){var e=new FileReader;e.onloadend=function(e){t(e.target.result)},e.onerror=function(e){if(s.default.android.device)return r(new Error("Enable the Storage permission for Firefox Android")),void o.Upload.emit("log","info","_readFile:onerror Android Storage Failure",{error:e.target.error,snapshot:o.snapshot});o.Upload.emit("log","error","_readFile:onerror",{error:e.target.error,snapshot:o.snapshot}),r(e.target.error)},e.readAsArrayBuffer(n)})}},{key:"_checkZeroes",value:function(e){for(var t=new DataView(e),r=0;r<e.byteLength;r++)if(0!==t.getUint8(r))return!1;return!0}},{key:"_checkSum",value:function(e,t){for(var r=new Uint8Array(e),n=0,o=0;o<r.length;o++)n+=r[o];this.Upload.emit("log","info","_checkSum",{result:n,snapshot:this.snapshot,chunk:t})}},{key:"_ensureChunkProgress",value:function(e){if(e.loaded!==this.file.chunkSize){var t=this.file.chunkSize-e.loaded;this._uploadIntervalBytesLoaded+=t,this._uploadSessionBytesLoaded+=t,this._uploadBytesLoaded+=t,this._uploadPercent=Math.round(this._uploadBytesLoaded/this.file.size*100),this.Upload.emit(h.default.UPLOAD_PROGRESS,this.file,this._uploadBytesLoaded,this.file.size,this._uploadPercent)}}},{key:"_onprogressHandler",value:function(e,t){var r=e.loaded-t.loaded;t.loaded=e.loaded,this._uploadIntervalBytesLoaded+=r,this._uploadSessionBytesLoaded+=r,this._uploadBytesLoaded+=r,this._uploadPercent=Math.round(this._uploadBytesLoaded/this.file.size*100),this.Upload.emit(h.default.UPLOAD_PROGRESS,this.file,this._uploadBytesLoaded,this.file.size,this._uploadPercent)}},{key:"_uploadSpeedHandler",value:function(){var e=Date.now(),t=(e-this._uploadSpeedTime)/1e3,r=(e-this._uploadSpeedStart)/1e3,n=t?this._uploadIntervalBytesLoaded/t:0,o=r?this._uploadSessionBytesLoaded/r:0;this._uploadSpeed={bytesPerSecond:Math.max(0,Math.round(n)),averageBytesPerSecond:Math.max(0,Math.round(o))},this._uploadIntervalBytesLoaded=0,this._uploadSpeedTime=e}},{key:"_xhrRetry",value:function(s,a,u,l){var e=this,c=1e3,f=!1;return new d.default(function(n,o){var t,i=(t=r(p.default.mark(function e(t){var r;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t,e.next=0===e.t0?3:1===e.t0?5:7;break;case 3:return c=1e3,e.abrupt("break",8);case 5:return c=5e3,e.abrupt("break",8);case 7:c=15e3;case 8:return e.prev=8,e.next=11,this._xhr(s,a,u,l);case 11:if(r=e.sent,f&&this.Upload.emit(h.default.UPLOAD_CONNECTED,this.file),401!==r.status){e.next=21;break}if(this._authRefresh){e.next=19;break}return this._authRefresh=!0,this.Upload.auth.refreshToken(),this.Upload.auth.once("ready",function(){i(t++)}),e.abrupt("return");case 19:return setTimeout(function(){i(t++)},c),e.abrupt("return");case 21:this._authRefresh=!1,n(r),e.next=34;break;case 25:if(e.prev=25,e.t1=e.catch(8),"Network"===e.t1.code)return f=!0,this.Upload.emit(h.default.UPLOAD_RECONNECTING,this.file,t),this.Upload.emit("log","network","_xhrRetry: "+e.t1.message+". "+t+" attempted retries.",{error:e.t1,snapshot:this.snapshot}),setTimeout(function(){i(t++)},c),e.abrupt("return");e.next=33;break;case 33:o(e.t1);case 34:case"end":return e.stop()}},e,this,[[8,25]])})),function(e){return t.apply(this,arguments)});(i=i.bind(e))(0)})}},{key:"_xhr",value:function(e,o,i,s){var a=this;return new d.default(function(t,r){var n=new XMLHttpRequest;n.open(s.method,e,!0),n.setRequestHeader("Authorization","Bearer "+a.Upload.options.token),(0,u.default)(s.headers).forEach(function(e){n.setRequestHeader(e,s.headers[e])}),(i.xhr=n).onload=function(){o&&a._ensureChunkProgress(o);var e={status:n.status,statusText:n.statusText,response:n.response,responseText:n.responseText};t(e)},n.onerror=function(){var e={status:n.status,statusText:n.statusText,response:n.response,responseText:n.responseText};a.Upload.emit("log","network","_xhr:onerror",{error:e,snapshot:a.snapshot,chunk:o});var t=new Error("Network request failed");t.code="Network",r(t)},n.onabort=function(){var e={status:n.status,statusText:n.statusText,response:n.response,responseText:n.responseText};t(e)},o&&n.upload&&(n.upload.onprogress=function(e){a._onprogressHandler(e,o)}),s.data?n.send(s.data):n.send()})}},{key:"_requestErrorHandler",value:function(e,t,r){return e.status<500?"BadRequestError"===t.code?(this.Upload.emit("log","info","_requestErrorHandler:BadRequestError",{snapshot:this.snapshot,response:t,request:e,chunk:r}),this.recover(),!1):(t.message=a.default[t.message]||t.message,this.Upload.emit(h.default.UPLOAD_FAILURE,this.file,t),!0):(this.Upload.emit("log","error","_requestErrorHandler: 500 Server Error",{snapshot:this.snapshot,response:t,request:e,chunk:r}),this.Upload.emit(h.default.UPLOAD_FAILURE,this.file,t),!0)}},{key:"snapshot",get:function(){return{fileName:this.file.name,fileSize:this.file.size,fileIdentifier:this.file.fileIdentifier,chunkTotal:this.file.chunkTotal,chunkSize:this.file.chunkSize,uploadId:this._uploadId,state:this._state}}},{key:"uploadSpeed",get:function(){return this._uploadSpeed}}]),v);function v(e,t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,v),this.dataType="buffer",n.File&&e instanceof File&&(this.dataType="file"),this.file=e,this.Upload=t,this.options=r,this._setSliceMethod(),this._setFileChunkSize(this.file),this._setFileChunkOffsets(this.file),this._setFileIndentifier(this.file),this._state="uninitialized",this._authRefresh=!1,this._uploadId=null,this._uploadPercent=0,this._uploadBytesLoaded=0,this._uploadSessionBytesLoaded=0,this._uploadIntervalBytesLoaded=0,this._uploadSpeedStart=null,this._uploadSpeed={bytesPerSecond:0,averageBytesPerSecond:0},this._uploadSpeedInterval=setInterval(this._uploadSpeedHandler.bind(this),2e3)}m.default=_,b.exports=m.default}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./events":19,"./is-mobile-js":21,"./legacy-messages":22,"babel-runtime/core-js/object/define-property":32,"babel-runtime/core-js/object/keys":34,"babel-runtime/core-js/promise":36,"babel-runtime/regenerator":39}],25:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var u=b(e("babel-runtime/core-js/promise")),o=b(e("babel-runtime/core-js/object/define-property")),n=b(e("babel-runtime/core-js/object/set-prototype-of")),i=b(e("babel-runtime/core-js/object/create")),s=b(e("babel-runtime/regenerator")),a=b(e("babel-runtime/core-js/object/get-prototype-of")),l=function(e,t,r){return t&&c(e.prototype,t),r&&c(e,r),e};function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),(0,o.default)(e,n.key,n)}}var f=b(e("@livelyvideo/auth-core/lib/source")),p=b(e("@livelyvideo/logger-core/lib/source")),d=b(e("events")),h=b(e("deepmerge")),_=b(e("./upload-chunked")),v=b(e("./package-json")),y=b(e("./events"));function b(e){return e&&e.__esModule?e:{default:e}}function m(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var g,w,j=new p.default(v.default),k={host:null,authUrl:null,token:null,accept:null,bemPrefix:"upload",autoSubmit:!0,chunkConnections:6,chunkSize:4194304,multiple:!0,https:!0,debug:!1,wait:!0,loggerOptions:{}},x=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=(0,i.default)(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(n.default?(0,n.default)(e,t):e.__proto__=t)}(O,d.default),l(O,[{key:"addBuffer",value:function(e,t){var r=e;t&&t.size&&t.name&&t.type?(r.size=t.size,r.name=t.name,r.type=t.type,this.addFile(r)):this.emit("error",new Error("Missing options for addBuffer. Options: "+!!t+", Size: "+!!t.size+", Name: "+!!t.name+", Type: "+!!t.type))}},{key:"addFile",value:function(e){var t=new _.default(e,this,this.options);this._uploadQueue.push(t),this._uploadListing.push(e),this.emit(y.default.UPLOAD_ADDEDFILE,e),this.options.autoSubmit&&this.start()}},{key:"removeFile",value:function(e){for(var t=0;t<this._uploadListing.length;t++)this._uploadListing[t]===e&&(this._uploadListing.splice(t,1),this.emit(y.default.UPLOAD_REMOVEDFILE,e))}},{key:"start",value:function(){var r=this;this._ensureAuth(function(){if(r._uploadQueue.length)for(var e=0;e<r._uploadConnections.length;e++){var t=r._uploadConnections[e];t.connected||r._runConnection(t)}})}},{key:"reset",value:function(e){var t=e?this._findUploader(e):this._uploadQueue[0];t&&t.recover()}},{key:"report",value:function(e,t){var r=e?this._findUploader(e):this._uploadQueue[0];r&&r.report(t)}},{key:"getUploadSpeed",value:function(e){var t=e?this._findUploader(e):this._uploadQueue[0];return t?t.uploadSpeed:null}},{key:"_removeFileFromQueue",value:function(e){for(var t=0;t<this._uploadQueue.length;t++)this._uploadQueue[t].file===e&&this._uploadQueue.splice(t,1)}},{key:"_findUploader",value:function(e){for(var t=0;t<this._uploadQueue.length;t++)if(this._uploadQueue[t].file.fileIdentifier===e.fileIdentifier)return this._uploadQueue[t];return null}},{key:"_validateOptions",value:function(e){var t=this,r=!0;return e||(setTimeout(function(){return t.emit("error",new Error('No options provided to constructor, "host" and "authUrl" required.'))}),r=!1),e.url&&setTimeout(function(){return t.emit("log","deprecated",'Option "url" has been deprecated.')}),e.chunkSize&&setTimeout(function(){return t.emit("log","deprecated",'Option "chunkSize" has been deprecated')}),e.version&&setTimeout(function(){return t.emit("log","deprecated",'Option "version" has been deprecated')}),e.host||(setTimeout(function(){return t.emit("error",new Error('No "host" option provided.'))}),r=!1),e.authUrl||(setTimeout(function(){return t.emit("error",new Error('No "authUrl" option provided.'))}),r=!1),r}},{key:"_authorize",value:function(){var t=this;this.options.token||(this.auth=new f.default("upload",this.options.authUrl),this.auth.on("ready",function(e){t.options.token=e.token}))}},{key:"_ensureAuth",value:function(e){this.options.token?e():this.auth.once("ready",function(){e()})}},{key:"_createUploadConnections",value:function(){for(var e=[],t=0;t<this.options.chunkConnections;t++)e.push({id:"connection-"+t,connected:!1,reset:!1,fileId:null,xhr:null});return e}},{key:"_runConnection",value:(g=s.default.mark(function e(t){var r,n;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.connected=!0,r=this._getValidUploader()){e.next=6;break}return t.fileId=!1,t.connected=!1,e.abrupt("return");case 6:return t.fileId=r.file.fileIdentifier,e.next=9,r.handleConnection(t);case 9:n=e.sent,(t.connected=n)&&this._runConnection(t);case 12:case"end":return e.stop()}},e,this)}),w=function(){var a=g.apply(this,arguments);return new u.default(function(i,s){return function t(e,r){try{var n=a[e](r),o=n.value}catch(e){return void s(e)}if(!n.done)return u.default.resolve(o).then(function(e){t("next",e)},function(e){t("throw",e)});i(o)}("next")})},function(e){return w.apply(this,arguments)})},{key:"_getValidUploader",value:function(){for(var e=0;e<this._uploadQueue.length;e++){var t=this._uploadQueue[e];if("errored"!==t._state&&"finalizing"!==t._state)return t}return null}},{key:"uploads",get:function(){return this._uploadListing}}]),O);function O(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,O);var t=m(this,(O.__proto__||(0,a.default)(O)).call(this));return j.setOptions(e.loggerOptions,t),t._validateOptions(e)?(t.options=(0,h.default)(k,e),t.options.host=t.options.host.replace(/^https?:\/\//i,""),t.options.url=(t.options.https?"https":"http")+"://"+t.options.host+"/api/upload/v3",j.setInstanceOptions({host:t.options.host}),t._ensureAuth=t._ensureAuth.bind(t),t._eventListeners=[],t._uploadConnections=t._createUploadConnections(),t._uploadQueue=[],t._uploadListing=[],t._authorize(),t):m(t)}r.default=x,t.exports=r.default},{"./events":19,"./package-json":23,"./upload-chunked":24,"@livelyvideo/auth-core/lib/source":6,"@livelyvideo/logger-core/lib/source":18,"babel-runtime/core-js/object/create":31,"babel-runtime/core-js/object/define-property":32,"babel-runtime/core-js/object/get-prototype-of":33,"babel-runtime/core-js/object/set-prototype-of":35,"babel-runtime/core-js/promise":36,"babel-runtime/regenerator":39,deepmerge:145,events:1}],26:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function e(t){var r=void 0,n=void 0,o=void 0;if(t.tagName){if(r=document.createElement(t.tagName),t.className&&(r.className=t.className),t.attributes)for(n in t.attributes)r.setAttribute(n,t.attributes[n]);void 0!==t.html&&(r.innerHTML=t.html)}else r=document.createDocumentFragment();if(t.text&&r.appendChild(document.createTextNode(t.text)),void 0===window.HTMLElement&&(window.HTMLElement=Element),t.childs&&t.childs.length)for(o=0;o<t.childs.length;o++)r.appendChild(t.childs[o]instanceof window.HTMLElement?t.childs[o]:e(t.childs[o]));if(t.events)for(var i in t.events)r.addEventListener(i,t.events[i]);return r},t.exports=r.default},{}],27:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n,o=e("events"),i=(n=o)&&n.__esModule?n:{default:n};r.default=function(t,r,n){if(!(t instanceof i.default))throw new Error("src must be an emitter");if(!(r instanceof i.default))throw new Error("dst must be an emitter");var o=t.emit;t.once("error",function(){}),t.emit=function(e){if(o.apply(t,arguments),!n||-1!==n.indexOf(e))return r.emit.apply(r,arguments)}.bind(t)},t.exports=r.default},{events:1}],28:[function(e,t,r){t.exports={default:e("core-js/library/fn/array/from"),__esModule:!0}},{"core-js/library/fn/array/from":41}],29:[function(e,t,r){t.exports={default:e("core-js/library/fn/json/stringify"),__esModule:!0}},{"core-js/library/fn/json/stringify":42}],30:[function(e,t,r){t.exports={default:e("core-js/library/fn/object/assign"),__esModule:!0}},{"core-js/library/fn/object/assign":43}],31:[function(e,t,r){t.exports={default:e("core-js/library/fn/object/create"),__esModule:!0}},{"core-js/library/fn/object/create":44}],32:[function(e,t,r){t.exports={default:e("core-js/library/fn/object/define-property"),__esModule:!0}},{"core-js/library/fn/object/define-property":45}],33:[function(e,t,r){t.exports={default:e("core-js/library/fn/object/get-prototype-of"),__esModule:!0}},{"core-js/library/fn/object/get-prototype-of":46}],34:[function(e,t,r){t.exports={default:e("core-js/library/fn/object/keys"),__esModule:!0}},{"core-js/library/fn/object/keys":47}],35:[function(e,t,r){t.exports={default:e("core-js/library/fn/object/set-prototype-of"),__esModule:!0}},{"core-js/library/fn/object/set-prototype-of":48}],36:[function(e,t,r){t.exports={default:e("core-js/library/fn/promise"),__esModule:!0}},{"core-js/library/fn/promise":49}],37:[function(e,t,r){t.exports={default:e("core-js/library/fn/symbol"),__esModule:!0}},{"core-js/library/fn/symbol":50}],38:[function(e,t,r){t.exports={default:e("core-js/library/fn/symbol/iterator"),__esModule:!0}},{"core-js/library/fn/symbol/iterator":51}],39:[function(e,t,r){t.exports=e("regenerator-runtime")},{"regenerator-runtime":149}],40:[function(e,t,r){"document"in window.self&&("classList"in document.createElement("_")&&(!document.createElementNS||"classList"in document.createElementNS("http://www.w3.org/2000/svg","g"))||function(e){"use strict";if("Element"in e){var t="classList",r="prototype",n=e.Element[r],o=Object,i=String[r].trim||function(){return this.replace(/^\s+|\s+$/g,"")},s=Array[r].indexOf||function(e){for(var t=0,r=this.length;t<r;t++)if(t in this&&this[t]===e)return t;return-1},a=function(e,t){this.name=e,this.code=DOMException[e],this.message=t},u=function(e,t){if(""===t)throw new a("SYNTAX_ERR","An invalid or illegal string was specified");if(/\s/.test(t))throw new a("INVALID_CHARACTER_ERR","String contains an invalid character");return s.call(e,t)},l=function(e){for(var t=i.call(e.getAttribute("class")||""),r=t?t.split(/\s+/):[],n=0,o=r.length;n<o;n++)this.push(r[n]);this._updateClassName=function(){e.setAttribute("class",this.toString())}},c=l[r]=[],f=function(){return new l(this)};if(a[r]=Error[r],c.item=function(e){return this[e]||null},c.contains=function(e){return-1!==u(this,e+="")},c.add=function(){for(var e,t=arguments,r=0,n=t.length,o=!1;-1===u(this,e=t[r]+"")&&(this.push(e),o=!0),++r<n;);o&&this._updateClassName()},c.remove=function(){var e,t,r=arguments,n=0,o=r.length,i=!1;do{for(t=u(this,e=r[n]+"");-1!==t;)this.splice(t,1),i=!0,t=u(this,e)}while(++n<o);i&&this._updateClassName()},c.toggle=function(e,t){e+="";var r=this.contains(e),n=r?!0!==t&&"remove":!1!==t&&"add";return n&&this[n](e),!0===t||!1===t?t:!r},c.toString=function(){return this.join(" ")},o.defineProperty){var p={get:f,enumerable:!0,configurable:!0};try{o.defineProperty(n,t,p)}catch(e){void 0!==e.number&&-2146823252!==e.number||(p.enumerable=!1,o.defineProperty(n,t,p))}}else o[r].__defineGetter__&&n.__defineGetter__(t,f)}}(window.self),function(){"use strict";var e=document.createElement("_");if(e.classList.add("c1","c2"),!e.classList.contains("c2")){var t=function(e){var n=DOMTokenList.prototype[e];DOMTokenList.prototype[e]=function(e){var t,r=arguments.length;for(t=0;t<r;t++)e=arguments[t],n.call(this,e)}};t("add"),t("remove")}if(e.classList.toggle("c3",!1),e.classList.contains("c3")){var r=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(e,t){return 1 in arguments&&!this.contains(e)==!t?t:r.call(this,e)}}e=null}())},{}],41:[function(e,t,r){e("../../modules/es6.string.iterator"),e("../../modules/es6.array.from"),t.exports=e("../../modules/_core").Array.from},{"../../modules/_core":59,"../../modules/es6.array.from":128,"../../modules/es6.string.iterator":138}],42:[function(e,t,r){var n=e("../../modules/_core"),o=n.JSON||(n.JSON={stringify:JSON.stringify});t.exports=function(e){return o.stringify.apply(o,arguments)}},{"../../modules/_core":59}],43:[function(e,t,r){e("../../modules/es6.object.assign"),t.exports=e("../../modules/_core").Object.assign},{"../../modules/_core":59,"../../modules/es6.object.assign":130}],44:[function(e,t,r){e("../../modules/es6.object.create");var n=e("../../modules/_core").Object;t.exports=function(e,t){return n.create(e,t)}},{"../../modules/_core":59,"../../modules/es6.object.create":131}],45:[function(e,t,r){e("../../modules/es6.object.define-property");var n=e("../../modules/_core").Object;t.exports=function(e,t,r){return n.defineProperty(e,t,r)}},{"../../modules/_core":59,"../../modules/es6.object.define-property":132}],46:[function(e,t,r){e("../../modules/es6.object.get-prototype-of"),t.exports=e("../../modules/_core").Object.getPrototypeOf},{"../../modules/_core":59,"../../modules/es6.object.get-prototype-of":133}],47:[function(e,t,r){e("../../modules/es6.object.keys"),t.exports=e("../../modules/_core").Object.keys},{"../../modules/_core":59,"../../modules/es6.object.keys":134}],48:[function(e,t,r){e("../../modules/es6.object.set-prototype-of"),t.exports=e("../../modules/_core").Object.setPrototypeOf},{"../../modules/_core":59,"../../modules/es6.object.set-prototype-of":135}],49:[function(e,t,r){e("../modules/es6.object.to-string"),e("../modules/es6.string.iterator"),e("../modules/web.dom.iterable"),e("../modules/es6.promise"),e("../modules/es7.promise.finally"),e("../modules/es7.promise.try"),t.exports=e("../modules/_core").Promise},{"../modules/_core":59,"../modules/es6.object.to-string":136,"../modules/es6.promise":137,"../modules/es6.string.iterator":138,"../modules/es7.promise.finally":140,"../modules/es7.promise.try":141,"../modules/web.dom.iterable":144}],50:[function(e,t,r){e("../../modules/es6.symbol"),e("../../modules/es6.object.to-string"),e("../../modules/es7.symbol.async-iterator"),e("../../modules/es7.symbol.observable"),t.exports=e("../../modules/_core").Symbol},{"../../modules/_core":59,"../../modules/es6.object.to-string":136,"../../modules/es6.symbol":139,"../../modules/es7.symbol.async-iterator":142,"../../modules/es7.symbol.observable":143}],51:[function(e,t,r){e("../../modules/es6.string.iterator"),e("../../modules/web.dom.iterable"),t.exports=e("../../modules/_wks-ext").f("iterator")},{"../../modules/_wks-ext":125,"../../modules/es6.string.iterator":138,"../../modules/web.dom.iterable":144}],52:[function(e,t,r){t.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},{}],53:[function(e,t,r){t.exports=function(){}},{}],54:[function(e,t,r){t.exports=function(e,t,r,n){if(!(e instanceof t)||void 0!==n&&n in e)throw TypeError(r+": incorrect invocation!");return e}},{}],55:[function(e,t,r){var n=e("./_is-object");t.exports=function(e){if(!n(e))throw TypeError(e+" is not an object!");return e}},{"./_is-object":79}],56:[function(e,t,r){var u=e("./_to-iobject"),l=e("./_to-length"),c=e("./_to-absolute-index");t.exports=function(a){return function(e,t,r){var n,o=u(e),i=l(o.length),s=c(r,i);if(a&&t!=t){for(;s<i;)if((n=o[s++])!=n)return!0}else for(;s<i;s++)if((a||s in o)&&o[s]===t)return a||s||0;return!a&&-1}}},{"./_to-absolute-index":116,"./_to-iobject":118,"./_to-length":119}],57:[function(e,t,r){var o=e("./_cof"),i=e("./_wks")("toStringTag"),s="Arguments"==o(function(){return arguments}());t.exports=function(e){var t,r,n;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),i))?r:s?o(t):"Object"==(n=o(t))&&"function"==typeof t.callee?"Arguments":n}},{"./_cof":58,"./_wks":126}],58:[function(e,t,r){var n={}.toString;t.exports=function(e){return n.call(e).slice(8,-1)}},{}],59:[function(e,t,r){var n=t.exports={version:"2.6.9"};"number"==typeof __e&&(__e=n)},{}],60:[function(e,t,r){"use strict";var n=e("./_object-dp"),o=e("./_property-desc");t.exports=function(e,t,r){t in e?n.f(e,t,o(0,r)):e[t]=r}},{"./_object-dp":92,"./_property-desc":105}],61:[function(e,t,r){var i=e("./_a-function");t.exports=function(n,o,e){if(i(n),void 0===o)return n;switch(e){case 1:return function(e){return n.call(o,e)};case 2:return function(e,t){return n.call(o,e,t)};case 3:return function(e,t,r){return n.call(o,e,t,r)}}return function(){return n.apply(o,arguments)}}},{"./_a-function":52}],62:[function(e,t,r){t.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},{}],63:[function(e,t,r){t.exports=!e("./_fails")(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},{"./_fails":68}],64:[function(e,t,r){var n=e("./_is-object"),o=e("./_global").document,i=n(o)&&n(o.createElement);t.exports=function(e){return i?o.createElement(e):{}}},{"./_global":70,"./_is-object":79}],65:[function(e,t,r){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},{}],66:[function(e,t,r){var a=e("./_object-keys"),u=e("./_object-gops"),l=e("./_object-pie");t.exports=function(e){var t=a(e),r=u.f;if(r)for(var n,o=r(e),i=l.f,s=0;o.length>s;)i.call(e,n=o[s++])&&t.push(n);return t}},{"./_object-gops":97,"./_object-keys":100,"./_object-pie":101}],67:[function(e,t,r){var _=e("./_global"),v=e("./_core"),y=e("./_ctx"),b=e("./_hide"),m=e("./_has"),g="prototype",w=function(e,t,r){var n,o,i,s=e&w.F,a=e&w.G,u=e&w.S,l=e&w.P,c=e&w.B,f=e&w.W,p=a?v:v[t]||(v[t]={}),d=p[g],h=a?_:u?_[t]:(_[t]||{})[g];for(n in a&&(r=t),r)(o=!s&&h&&void 0!==h[n])&&m(p,n)||(i=o?h[n]:r[n],p[n]=a&&"function"!=typeof h[n]?r[n]:c&&o?y(i,_):f&&h[n]==i?function(n){function e(e,t,r){if(this instanceof n){switch(arguments.length){case 0:return new n;case 1:return new n(e);case 2:return new n(e,t)}return new n(e,t,r)}return n.apply(this,arguments)}return e[g]=n[g],e}(i):l&&"function"==typeof i?y(Function.call,i):i,l&&((p.virtual||(p.virtual={}))[n]=i,e&w.R&&d&&!d[n]&&b(d,n,i)))};w.F=1,w.G=2,w.S=4,w.P=8,w.B=16,w.W=32,w.U=64,w.R=128,t.exports=w},{"./_core":59,"./_ctx":61,"./_global":70,"./_has":71,"./_hide":72}],68:[function(e,t,r){t.exports=function(e){try{return!!e()}catch(e){return!0}}},{}],69:[function(e,t,r){var p=e("./_ctx"),d=e("./_iter-call"),h=e("./_is-array-iter"),_=e("./_an-object"),v=e("./_to-length"),y=e("./core.get-iterator-method"),b={},m={};(r=t.exports=function(e,t,r,n,o){var i,s,a,u,l=o?function(){return e}:y(e),c=p(r,n,t?2:1),f=0;if("function"!=typeof l)throw TypeError(e+" is not iterable!");if(h(l)){for(i=v(e.length);f<i;f++)if((u=t?c(_(s=e[f])[0],s[1]):c(e[f]))===b||u===m)return u}else for(a=l.call(e);!(s=a.next()).done;)if((u=d(a,c,s.value,t))===b||u===m)return u}).BREAK=b,r.RETURN=m},{"./_an-object":55,"./_ctx":61,"./_is-array-iter":77,"./_iter-call":80,"./_to-length":119,"./core.get-iterator-method":127}],70:[function(e,t,r){var n=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},{}],71:[function(e,t,r){var n={}.hasOwnProperty;t.exports=function(e,t){return n.call(e,t)}},{}],72:[function(e,t,r){var n=e("./_object-dp"),o=e("./_property-desc");t.exports=e("./_descriptors")?function(e,t,r){return n.f(e,t,o(1,r))}:function(e,t,r){return e[t]=r,e}},{"./_descriptors":63,"./_object-dp":92,"./_property-desc":105}],73:[function(e,t,r){var n=e("./_global").document;t.exports=n&&n.documentElement},{"./_global":70}],74:[function(e,t,r){t.exports=!e("./_descriptors")&&!e("./_fails")(function(){return 7!=Object.defineProperty(e("./_dom-create")("div"),"a",{get:function(){return 7}}).a})},{"./_descriptors":63,"./_dom-create":64,"./_fails":68}],75:[function(e,t,r){t.exports=function(e,t,r){var n=void 0===r;switch(t.length){case 0:return n?e():e.call(r);case 1:return n?e(t[0]):e.call(r,t[0]);case 2:return n?e(t[0],t[1]):e.call(r,t[0],t[1]);case 3:return n?e(t[0],t[1],t[2]):e.call(r,t[0],t[1],t[2]);case 4:return n?e(t[0],t[1],t[2],t[3]):e.call(r,t[0],t[1],t[2],t[3])}return e.apply(r,t)}},{}],76:[function(e,t,r){var n=e("./_cof");t.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==n(e)?e.split(""):Object(e)}},{"./_cof":58}],77:[function(e,t,r){var n=e("./_iterators"),o=e("./_wks")("iterator"),i=Array.prototype;t.exports=function(e){return void 0!==e&&(n.Array===e||i[o]===e)}},{"./_iterators":85,"./_wks":126}],78:[function(e,t,r){var n=e("./_cof");t.exports=Array.isArray||function(e){return"Array"==n(e)}},{"./_cof":58}],79:[function(e,t,r){t.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},{}],80:[function(e,t,r){var i=e("./_an-object");t.exports=function(t,e,r,n){try{return n?e(i(r)[0],r[1]):e(r)}catch(e){var o=t.return;throw void 0!==o&&i(o.call(t)),e}}},{"./_an-object":55}],81:[function(e,t,r){"use strict";var n=e("./_object-create"),o=e("./_property-desc"),i=e("./_set-to-string-tag"),s={};e("./_hide")(s,e("./_wks")("iterator"),function(){return this}),t.exports=function(e,t,r){e.prototype=n(s,{next:o(1,r)}),i(e,t+" Iterator")}},{"./_hide":72,"./_object-create":91,"./_property-desc":105,"./_set-to-string-tag":110,"./_wks":126}],82:[function(e,t,r){"use strict";function m(){return this}var g=e("./_library"),w=e("./_export"),j=e("./_redefine"),k=e("./_hide"),x=e("./_iterators"),O=e("./_iter-create"),E=e("./_set-to-string-tag"),S=e("./_object-gpo"),L=e("./_wks")("iterator"),P=!([].keys&&"next"in[].keys()),A="values";t.exports=function(e,t,r,n,o,i,s){O(r,t,n);function a(e){if(!P&&e in h)return h[e];switch(e){case"keys":case A:return function(){return new r(this,e)}}return function(){return new r(this,e)}}var u,l,c,f=t+" Iterator",p=o==A,d=!1,h=e.prototype,_=h[L]||h["@@iterator"]||o&&h[o],v=_||a(o),y=o?p?a("entries"):v:void 0,b="Array"==t&&h.entries||_;if(b&&(c=S(b.call(new e)))!==Object.prototype&&c.next&&(E(c,f,!0),g||"function"==typeof c[L]||k(c,L,m)),p&&_&&_.name!==A&&(d=!0,v=function(){return _.call(this)}),g&&!s||!P&&!d&&h[L]||k(h,L,v),x[t]=v,x[f]=m,o)if(u={values:p?v:a(A),keys:i?v:a("keys"),entries:y},s)for(l in u)l in h||j(h,l,u[l]);else w(w.P+w.F*(P||d),t,u);return u}},{"./_export":67,"./_hide":72,"./_iter-create":81,"./_iterators":85,"./_library":86,"./_object-gpo":98,"./_redefine":107,"./_set-to-string-tag":110,"./_wks":126}],83:[function(e,t,r){var i=e("./_wks")("iterator"),s=!1;try{var n=[7][i]();n.return=function(){s=!0},Array.from(n,function(){throw 2})}catch(e){}t.exports=function(e,t){if(!t&&!s)return!1;var r=!1;try{var n=[7],o=n[i]();o.next=function(){return{done:r=!0}},n[i]=function(){return o},e(n)}catch(e){}return r}},{"./_wks":126}],84:[function(e,t,r){t.exports=function(e,t){return{value:t,done:!!e}}},{}],85:[function(e,t,r){t.exports={}},{}],86:[function(e,t,r){t.exports=!0},{}],87:[function(e,t,r){function n(e){a(e,o,{value:{i:"O"+ ++u,w:{}}})}var o=e("./_uid")("meta"),i=e("./_is-object"),s=e("./_has"),a=e("./_object-dp").f,u=0,l=Object.isExtensible||function(){return!0},c=!e("./_fails")(function(){return l(Object.preventExtensions({}))}),f=t.exports={KEY:o,NEED:!1,fastKey:function(e,t){if(!i(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!s(e,o)){if(!l(e))return"F";if(!t)return"E";n(e)}return e[o].i},getWeak:function(e,t){if(!s(e,o)){if(!l(e))return!0;if(!t)return!1;n(e)}return e[o].w},onFreeze:function(e){return c&&f.NEED&&l(e)&&!s(e,o)&&n(e),e}}},{"./_fails":68,"./_has":71,"./_is-object":79,"./_object-dp":92,"./_uid":122}],88:[function(e,t,r){var a=e("./_global"),u=e("./_task").set,l=a.MutationObserver||a.WebKitMutationObserver,c=a.process,f=a.Promise,p="process"==e("./_cof")(c);t.exports=function(){function e(){var e,t;for(p&&(e=c.domain)&&e.exit();r;){t=r.fn,r=r.next;try{t()}catch(e){throw r?o():n=void 0,e}}n=void 0,e&&e.enter()}var r,n,o;if(p)o=function(){c.nextTick(e)};else if(!l||a.navigator&&a.navigator.standalone)if(f&&f.resolve){var t=f.resolve(void 0);o=function(){t.then(e)}}else o=function(){u.call(a,e)};else{var i=!0,s=document.createTextNode("");new l(e).observe(s,{characterData:!0}),o=function(){s.data=i=!i}}return function(e){var t={fn:e,next:void 0};n&&(n.next=t),r||(r=t,o()),n=t}}},{"./_cof":58,"./_global":70,"./_task":115}],89:[function(e,t,r){"use strict";var o=e("./_a-function");function n(e){var r,n;this.promise=new e(function(e,t){if(void 0!==r||void 0!==n)throw TypeError("Bad Promise constructor");r=e,n=t}),this.resolve=o(r),this.reject=o(n)}t.exports.f=function(e){return new n(e)}},{"./_a-function":52}],90:[function(e,t,r){"use strict";var p=e("./_descriptors"),d=e("./_object-keys"),h=e("./_object-gops"),_=e("./_object-pie"),v=e("./_to-object"),y=e("./_iobject"),o=Object.assign;t.exports=!o||e("./_fails")(function(){var e={},t={},r=Symbol(),n="abcdefghijklmnopqrst";return e[r]=7,n.split("").forEach(function(e){t[e]=e}),7!=o({},e)[r]||Object.keys(o({},t)).join("")!=n})?function(e,t){for(var r=v(e),n=arguments.length,o=1,i=h.f,s=_.f;o<n;)for(var a,u=y(arguments[o++]),l=i?d(u).concat(i(u)):d(u),c=l.length,f=0;f<c;)a=l[f++],p&&!s.call(u,a)||(r[a]=u[a]);return r}:o},{"./_descriptors":63,"./_fails":68,"./_iobject":76,"./_object-gops":97,"./_object-keys":100,"./_object-pie":101,"./_to-object":120}],91:[function(n,e,t){function o(){}var i=n("./_an-object"),s=n("./_object-dps"),a=n("./_enum-bug-keys"),u=n("./_shared-key")("IE_PROTO"),l="prototype",c=function(){var e,t=n("./_dom-create")("iframe"),r=a.length;for(t.style.display="none",n("./_html").appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),c=e.F;r--;)delete c[l][a[r]];return c()};e.exports=Object.create||function(e,t){var r;return null!==e?(o[l]=i(e),r=new o,o[l]=null,r[u]=e):r=c(),void 0===t?r:s(r,t)}},{"./_an-object":55,"./_dom-create":64,"./_enum-bug-keys":65,"./_html":73,"./_object-dps":93,"./_shared-key":111}],92:[function(e,t,r){var n=e("./_an-object"),o=e("./_ie8-dom-define"),i=e("./_to-primitive"),s=Object.defineProperty;r.f=e("./_descriptors")?Object.defineProperty:function(e,t,r){if(n(e),t=i(t,!0),n(r),o)try{return s(e,t,r)}catch(e){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(e[t]=r.value),e}},{"./_an-object":55,"./_descriptors":63,"./_ie8-dom-define":74,"./_to-primitive":121}],93:[function(e,t,r){var s=e("./_object-dp"),a=e("./_an-object"),u=e("./_object-keys");t.exports=e("./_descriptors")?Object.defineProperties:function(e,t){a(e);for(var r,n=u(t),o=n.length,i=0;i<o;)s.f(e,r=n[i++],t[r]);return e}},{"./_an-object":55,"./_descriptors":63,"./_object-dp":92,"./_object-keys":100}],94:[function(e,t,r){var n=e("./_object-pie"),o=e("./_property-desc"),i=e("./_to-iobject"),s=e("./_to-primitive"),a=e("./_has"),u=e("./_ie8-dom-define"),l=Object.getOwnPropertyDescriptor;r.f=e("./_descriptors")?l:function(e,t){if(e=i(e),t=s(t,!0),u)try{return l(e,t)}catch(e){}if(a(e,t))return o(!n.f.call(e,t),e[t])}},{"./_descriptors":63,"./_has":71,"./_ie8-dom-define":74,"./_object-pie":101,"./_property-desc":105,"./_to-iobject":118,"./_to-primitive":121}],95:[function(e,t,r){var n=e("./_to-iobject"),o=e("./_object-gopn").f,i={}.toString,s="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(e){return s&&"[object Window]"==i.call(e)?function(e){try{return o(e)}catch(e){return s.slice()}}(e):o(n(e))}},{"./_object-gopn":96,"./_to-iobject":118}],96:[function(e,t,r){var n=e("./_object-keys-internal"),o=e("./_enum-bug-keys").concat("length","prototype");r.f=Object.getOwnPropertyNames||function(e){return n(e,o)}},{"./_enum-bug-keys":65,"./_object-keys-internal":99}],97:[function(e,t,r){r.f=Object.getOwnPropertySymbols},{}],98:[function(e,t,r){var n=e("./_has"),o=e("./_to-object"),i=e("./_shared-key")("IE_PROTO"),s=Object.prototype;t.exports=Object.getPrototypeOf||function(e){return e=o(e),n(e,i)?e[i]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?s:null}},{"./_has":71,"./_shared-key":111,"./_to-object":120}],99:[function(e,t,r){var s=e("./_has"),a=e("./_to-iobject"),u=e("./_array-includes")(!1),l=e("./_shared-key")("IE_PROTO");t.exports=function(e,t){var r,n=a(e),o=0,i=[];for(r in n)r!=l&&s(n,r)&&i.push(r);for(;t.length>o;)s(n,r=t[o++])&&(~u(i,r)||i.push(r));return i}},{"./_array-includes":56,"./_has":71,"./_shared-key":111,"./_to-iobject":118}],100:[function(e,t,r){var n=e("./_object-keys-internal"),o=e("./_enum-bug-keys");t.exports=Object.keys||function(e){return n(e,o)}},{"./_enum-bug-keys":65,"./_object-keys-internal":99}],101:[function(e,t,r){r.f={}.propertyIsEnumerable},{}],102:[function(e,t,r){var o=e("./_export"),i=e("./_core"),s=e("./_fails");t.exports=function(e,t){var r=(i.Object||{})[e]||Object[e],n={};n[e]=t(r),o(o.S+o.F*s(function(){r(1)}),"Object",n)}},{"./_core":59,"./_export":67,"./_fails":68}],103:[function(e,t,r){t.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}},{}],104:[function(e,t,r){var n=e("./_an-object"),o=e("./_is-object"),i=e("./_new-promise-capability");t.exports=function(e,t){if(n(e),o(t)&&t.constructor===e)return t;var r=i.f(e);return(0,r.resolve)(t),r.promise}},{"./_an-object":55,"./_is-object":79,"./_new-promise-capability":89}],105:[function(e,t,r){t.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},{}],106:[function(e,t,r){var o=e("./_hide");t.exports=function(e,t,r){for(var n in t)r&&e[n]?e[n]=t[n]:o(e,n,t[n]);return e}},{"./_hide":72}],107:[function(e,t,r){t.exports=e("./_hide")},{"./_hide":72}],108:[function(t,e,r){function o(e,t){if(i(e),!n(t)&&null!==t)throw TypeError(t+": can't set as prototype!")}var n=t("./_is-object"),i=t("./_an-object");e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,r,n){try{(n=t("./_ctx")(Function.call,t("./_object-gopd").f(Object.prototype,"__proto__").set,2))(e,[]),r=!(e instanceof Array)}catch(e){r=!0}return function(e,t){return o(e,t),r?e.__proto__=t:n(e,t),e}}({},!1):void 0),check:o}},{"./_an-object":55,"./_ctx":61,"./_is-object":79,"./_object-gopd":94}],109:[function(e,t,r){"use strict";var n=e("./_global"),o=e("./_core"),i=e("./_object-dp"),s=e("./_descriptors"),a=e("./_wks")("species");t.exports=function(e){var t="function"==typeof o[e]?o[e]:n[e];s&&t&&!t[a]&&i.f(t,a,{configurable:!0,get:function(){return this}})}},{"./_core":59,"./_descriptors":63,"./_global":70,"./_object-dp":92,"./_wks":126}],110:[function(e,t,r){var n=e("./_object-dp").f,o=e("./_has"),i=e("./_wks")("toStringTag");t.exports=function(e,t,r){e&&!o(e=r?e:e.prototype,i)&&n(e,i,{configurable:!0,value:t})}},{"./_has":71,"./_object-dp":92,"./_wks":126}],111:[function(e,t,r){var n=e("./_shared")("keys"),o=e("./_uid");t.exports=function(e){return n[e]||(n[e]=o(e))}},{"./_shared":112,"./_uid":122}],112:[function(e,t,r){var n=e("./_core"),o=e("./_global"),i="__core-js_shared__",s=o[i]||(o[i]={});(t.exports=function(e,t){return s[e]||(s[e]=void 0!==t?t:{})})("versions",[]).push({version:n.version,mode:e("./_library")?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},{"./_core":59,"./_global":70,"./_library":86}],113:[function(e,t,r){var o=e("./_an-object"),i=e("./_a-function"),s=e("./_wks")("species");t.exports=function(e,t){var r,n=o(e).constructor;return void 0===n||null==(r=o(n)[s])?t:i(r)}},{"./_a-function":52,"./_an-object":55,"./_wks":126}],114:[function(e,t,r){var u=e("./_to-integer"),l=e("./_defined");t.exports=function(a){return function(e,t){var r,n,o=String(l(e)),i=u(t),s=o.length;return i<0||s<=i?a?"":void 0:(r=o.charCodeAt(i))<55296||56319<r||i+1===s||(n=o.charCodeAt(i+1))<56320||57343<n?a?o.charAt(i):r:a?o.slice(i,i+2):n-56320+(r-55296<<10)+65536}}},{"./_defined":62,"./_to-integer":117}],115:[function(e,t,r){function n(){var e=+this;if(m.hasOwnProperty(e)){var t=m[e];delete m[e],t()}}function o(e){n.call(e.data)}var i,s,a,u=e("./_ctx"),l=e("./_invoke"),c=e("./_html"),f=e("./_dom-create"),p=e("./_global"),d=p.process,h=p.setImmediate,_=p.clearImmediate,v=p.MessageChannel,y=p.Dispatch,b=0,m={},g="onreadystatechange";h&&_||(h=function(e){for(var t=[],r=1;r<arguments.length;)t.push(arguments[r++]);return m[++b]=function(){l("function"==typeof e?e:Function(e),t)},i(b),b},_=function(e){delete m[e]},"process"==e("./_cof")(d)?i=function(e){d.nextTick(u(n,e,1))}:y&&y.now?i=function(e){y.now(u(n,e,1))}:v?(a=(s=new v).port2,s.port1.onmessage=o,i=u(a.postMessage,a,1)):p.addEventListener&&"function"==typeof postMessage&&!p.importScripts?(i=function(e){p.postMessage(e+"","*")},p.addEventListener("message",o,!1)):i=g in f("script")?function(e){c.appendChild(f("script"))[g]=function(){c.removeChild(this),n.call(e)}}:function(e){setTimeout(u(n,e,1),0)}),t.exports={set:h,clear:_}},{"./_cof":58,"./_ctx":61,"./_dom-create":64,"./_global":70,"./_html":73,"./_invoke":75}],116:[function(e,t,r){var n=e("./_to-integer"),o=Math.max,i=Math.min;t.exports=function(e,t){return(e=n(e))<0?o(e+t,0):i(e,t)}},{"./_to-integer":117}],117:[function(e,t,r){var n=Math.ceil,o=Math.floor;t.exports=function(e){return isNaN(e=+e)?0:(0<e?o:n)(e)}},{}],118:[function(e,t,r){var n=e("./_iobject"),o=e("./_defined");t.exports=function(e){return n(o(e))}},{"./_defined":62,"./_iobject":76}],119:[function(e,t,r){var n=e("./_to-integer"),o=Math.min;t.exports=function(e){return 0<e?o(n(e),9007199254740991):0}},{"./_to-integer":117}],120:[function(e,t,r){var n=e("./_defined");t.exports=function(e){return Object(n(e))}},{"./_defined":62}],121:[function(e,t,r){var o=e("./_is-object");t.exports=function(e,t){if(!o(e))return e;var r,n;if(t&&"function"==typeof(r=e.toString)&&!o(n=r.call(e)))return n;if("function"==typeof(r=e.valueOf)&&!o(n=r.call(e)))return n;if(!t&&"function"==typeof(r=e.toString)&&!o(n=r.call(e)))return n;throw TypeError("Can't convert object to primitive value")}},{"./_is-object":79}],122:[function(e,t,r){var n=0,o=Math.random();t.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+o).toString(36))}},{}],123:[function(e,t,r){var n=e("./_global").navigator;t.exports=n&&n.userAgent||""},{"./_global":70}],124:[function(e,t,r){var n=e("./_global"),o=e("./_core"),i=e("./_library"),s=e("./_wks-ext"),a=e("./_object-dp").f;t.exports=function(e){var t=o.Symbol||(o.Symbol=i?{}:n.Symbol||{});"_"==e.charAt(0)||e in t||a(t,e,{value:s.f(e)})}},{"./_core":59,"./_global":70,"./_library":86,"./_object-dp":92,"./_wks-ext":125}],125:[function(e,t,r){r.f=e("./_wks")},{"./_wks":126}],126:[function(e,t,r){var n=e("./_shared")("wks"),o=e("./_uid"),i=e("./_global").Symbol,s="function"==typeof i;(t.exports=function(e){return n[e]||(n[e]=s&&i[e]||(s?i:o)("Symbol."+e))}).store=n},{"./_global":70,"./_shared":112,"./_uid":122}],127:[function(e,t,r){var n=e("./_classof"),o=e("./_wks")("iterator"),i=e("./_iterators");t.exports=e("./_core").getIteratorMethod=function(e){if(null!=e)return e[o]||e["@@iterator"]||i[n(e)]}},{"./_classof":57,"./_core":59,"./_iterators":85,"./_wks":126}],128:[function(e,t,r){"use strict";var h=e("./_ctx"),n=e("./_export"),_=e("./_to-object"),v=e("./_iter-call"),y=e("./_is-array-iter"),b=e("./_to-length"),m=e("./_create-property"),g=e("./core.get-iterator-method");n(n.S+n.F*!e("./_iter-detect")(function(e){Array.from(e)}),"Array",{from:function(e,t,r){var n,o,i,s,a=_(e),u="function"==typeof this?this:Array,l=arguments.length,c=1<l?t:void 0,f=void 0!==c,p=0,d=g(a);if(f&&(c=h(c,2<l?r:void 0,2)),null==d||u==Array&&y(d))for(o=new u(n=b(a.length));p<n;p++)m(o,p,f?c(a[p],p):a[p]);else for(s=d.call(a),o=new u;!(i=s.next()).done;p++)m(o,p,f?v(s,c,[i.value,p],!0):i.value);return o.length=p,o}})},{"./_create-property":60,"./_ctx":61,"./_export":67,"./_is-array-iter":77,"./_iter-call":80,"./_iter-detect":83,"./_to-length":119,"./_to-object":120,"./core.get-iterator-method":127}],129:[function(e,t,r){"use strict";var n=e("./_add-to-unscopables"),o=e("./_iter-step"),i=e("./_iterators"),s=e("./_to-iobject");t.exports=e("./_iter-define")(Array,"Array",function(e,t){this._t=s(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,r=this._i++;return!e||r>=e.length?(this._t=void 0,o(1)):o(0,"keys"==t?r:"values"==t?e[r]:[r,e[r]])},"values"),i.Arguments=i.Array,n("keys"),n("values"),n("entries")},{"./_add-to-unscopables":53,"./_iter-define":82,"./_iter-step":84,"./_iterators":85,"./_to-iobject":118}],130:[function(e,t,r){var n=e("./_export");n(n.S+n.F,"Object",{assign:e("./_object-assign")})},{"./_export":67,"./_object-assign":90}],131:[function(e,t,r){var n=e("./_export");n(n.S,"Object",{create:e("./_object-create")})},{"./_export":67,"./_object-create":91}],132:[function(e,t,r){var n=e("./_export");n(n.S+n.F*!e("./_descriptors"),"Object",{defineProperty:e("./_object-dp").f})},{"./_descriptors":63,"./_export":67,"./_object-dp":92}],133:[function(e,t,r){var n=e("./_to-object"),o=e("./_object-gpo");e("./_object-sap")("getPrototypeOf",function(){return function(e){return o(n(e))}})},{"./_object-gpo":98,"./_object-sap":102,"./_to-object":120}],134:[function(e,t,r){var n=e("./_to-object"),o=e("./_object-keys");e("./_object-sap")("keys",function(){return function(e){return o(n(e))}})},{"./_object-keys":100,"./_object-sap":102,"./_to-object":120}],135:[function(e,t,r){var n=e("./_export");n(n.S,"Object",{setPrototypeOf:e("./_set-proto").set})},{"./_export":67,"./_set-proto":108}],136:[function(e,t,r){},{}],137:[function(r,e,t){"use strict";function n(){}function f(e){var t;return!(!v(e)||"function"!=typeof(t=e.then))&&t}function o(c,r){if(!c._n){c._n=!0;var n=c._c;j(function(){for(var u=c._v,l=1==c._s,e=0,t=function(e){var t,r,n,o=l?e.ok:e.fail,i=e.resolve,s=e.reject,a=e.domain;try{o?(l||(2==c._h&&I(c),c._h=1),!0===o?t=u:(a&&a.enter(),t=o(u),a&&(a.exit(),n=!0)),t===e.promise?s(L("Promise-chain cycle")):(r=f(t))?r.call(t,i,s):i(t)):s(u)}catch(e){a&&!n&&a.exit(),s(e)}};n.length>e;)t(n[e++]);c._c=[],c._n=!1,r&&!c._h&&N(c)})}}function i(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),o(t,!0))}var s,a,u,l,c=r("./_library"),p=r("./_global"),d=r("./_ctx"),h=r("./_classof"),_=r("./_export"),v=r("./_is-object"),y=r("./_a-function"),b=r("./_an-instance"),m=r("./_for-of"),g=r("./_species-constructor"),w=r("./_task").set,j=r("./_microtask")(),k=r("./_new-promise-capability"),x=r("./_perform"),O=r("./_user-agent"),E=r("./_promise-resolve"),S="Promise",L=p.TypeError,P=p.process,A=P&&P.versions,T=A&&A.v8||"",R=p[S],F="process"==h(P),U=a=k.f,M=!!function(){try{var e=R.resolve(1),t=(e.constructor={})[r("./_wks")("species")]=function(e){e(n,n)};return(F||"function"==typeof PromiseRejectionEvent)&&e.then(n)instanceof t&&0!==T.indexOf("6.6")&&-1===O.indexOf("Chrome/66")}catch(e){}}(),N=function(i){w.call(p,function(){var e,t,r,n=i._v,o=C(i);if(o&&(e=x(function(){F?P.emit("unhandledRejection",n,i):(t=p.onunhandledrejection)?t({promise:i,reason:n}):(r=p.console)&&r.error&&r.error("Unhandled promise rejection",n)}),i._h=F||C(i)?2:1),i._a=void 0,o&&e.e)throw e.v})},C=function(e){return 1!==e._h&&0===(e._a||e._c).length},I=function(t){w.call(p,function(){var e;F?P.emit("rejectionHandled",t):(e=p.onrejectionhandled)&&e({promise:t,reason:t._v})})},D=function(e){var r,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===e)throw L("Promise can't be resolved itself");(r=f(e))?j(function(){var t={_w:n,_d:!1};try{r.call(e,d(D,t,1),d(i,t,1))}catch(e){i.call(t,e)}}):(n._v=e,n._s=1,o(n,!1))}catch(e){i.call({_w:n,_d:!1},e)}}};M||(R=function(e){b(this,R,S,"_h"),y(e),s.call(this);try{e(d(D,this,1),d(i,this,1))}catch(e){i.call(this,e)}},(s=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=r("./_redefine-all")(R.prototype,{then:function(e,t){var r=U(g(this,R));return r.ok="function"!=typeof e||e,r.fail="function"==typeof t&&t,r.domain=F?P.domain:void 0,this._c.push(r),this._a&&this._a.push(r),this._s&&o(this,!1),r.promise},catch:function(e){return this.then(void 0,e)}}),u=function(){var e=new s;this.promise=e,this.resolve=d(D,e,1),this.reject=d(i,e,1)},k.f=U=function(e){return e===R||e===l?new u(e):a(e)}),_(_.G+_.W+_.F*!M,{Promise:R}),r("./_set-to-string-tag")(R,S),r("./_set-species")(S),l=r("./_core")[S],_(_.S+_.F*!M,S,{reject:function(e){var t=U(this);return(0,t.reject)(e),t.promise}}),_(_.S+_.F*(c||!M),S,{resolve:function(e){return E(c&&this===l?R:this,e)}}),_(_.S+_.F*!(M&&r("./_iter-detect")(function(e){R.all(e).catch(n)})),S,{all:function(e){var s=this,t=U(s),a=t.resolve,u=t.reject,r=x(function(){var n=[],o=0,i=1;m(e,!1,function(e){var t=o++,r=!1;n.push(void 0),i++,s.resolve(e).then(function(e){r||(r=!0,n[t]=e,--i||a(n))},u)}),--i||a(n)});return r.e&&u(r.v),t.promise},race:function(e){var t=this,r=U(t),n=r.reject,o=x(function(){m(e,!1,function(e){t.resolve(e).then(r.resolve,n)})});return o.e&&n(o.v),r.promise}})},{"./_a-function":52,"./_an-instance":54,"./_classof":57,"./_core":59,"./_ctx":61,"./_export":67,"./_for-of":69,"./_global":70,"./_is-object":79,"./_iter-detect":83,"./_library":86,"./_microtask":88,"./_new-promise-capability":89,"./_perform":103,"./_promise-resolve":104,"./_redefine-all":106,"./_set-species":109,"./_set-to-string-tag":110,"./_species-constructor":113,"./_task":115,"./_user-agent":123,"./_wks":126}],138:[function(e,t,r){"use strict";var n=e("./_string-at")(!0);e("./_iter-define")(String,"String",function(e){this._t=String(e),this._i=0},function(){var e,t=this._t,r=this._i;return r>=t.length?{value:void 0,done:!0}:(e=n(t,r),this._i+=e.length,{value:e,done:!1})})},{"./_iter-define":82,"./_string-at":114}],139:[function(e,t,r){"use strict";function n(e){var t=K[e]=A(D[H]);return t._k=e,t}function o(e,t){x(e);for(var r,n=j(t=S(t)),o=0,i=n.length;o<i;)te(e,r=n[o++],t[r]);return e}function i(e){var t=W.call(this,e=L(e,!0));return!(this===J&&c(K,e)&&!c(X,e))&&(!(t||!c(this,e)||!c(K,e)||c(this,q)&&this[q][e])||t)}function s(e,t){if(e=S(e),t=L(t,!0),e!==J||!c(K,t)||c(X,t)){var r=N(e,t);return!r||!c(K,t)||c(e,q)&&e[q][t]||(r.enumerable=!0),r}}function a(e){for(var t,r=I(S(e)),n=[],o=0;r.length>o;)c(K,t=r[o++])||t==q||t==h||n.push(t);return n}function u(e){for(var t,r=e===J,n=I(r?X:S(e)),o=[],i=0;n.length>i;)!c(K,t=n[i++])||r&&!c(J,t)||o.push(K[t]);return o}var l=e("./_global"),c=e("./_has"),f=e("./_descriptors"),p=e("./_export"),d=e("./_redefine"),h=e("./_meta").KEY,_=e("./_fails"),v=e("./_shared"),y=e("./_set-to-string-tag"),b=e("./_uid"),m=e("./_wks"),g=e("./_wks-ext"),w=e("./_wks-define"),j=e("./_enum-keys"),k=e("./_is-array"),x=e("./_an-object"),O=e("./_is-object"),E=e("./_to-object"),S=e("./_to-iobject"),L=e("./_to-primitive"),P=e("./_property-desc"),A=e("./_object-create"),T=e("./_object-gopn-ext"),R=e("./_object-gopd"),F=e("./_object-gops"),U=e("./_object-dp"),M=e("./_object-keys"),N=R.f,C=U.f,I=T.f,D=l.Symbol,B=l.JSON,z=B&&B.stringify,H="prototype",q=m("_hidden"),G=m("toPrimitive"),W={}.propertyIsEnumerable,V=v("symbol-registry"),K=v("symbols"),X=v("op-symbols"),J=Object[H],Q="function"==typeof D&&!!F.f,Y=l.QObject,$=!Y||!Y[H]||!Y[H].findChild,Z=f&&_(function(){return 7!=A(C({},"a",{get:function(){return C(this,"a",{value:7}).a}})).a})?function(e,t,r){var n=N(J,t);n&&delete J[t],C(e,t,r),n&&e!==J&&C(J,t,n)}:C,ee=Q&&"symbol"==typeof D.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof D},te=function(e,t,r){return e===J&&te(X,t,r),x(e),t=L(t,!0),x(r),c(K,t)?(r.enumerable?(c(e,q)&&e[q][t]&&(e[q][t]=!1),r=A(r,{enumerable:P(0,!1)})):(c(e,q)||C(e,q,P(1,{})),e[q][t]=!0),Z(e,t,r)):C(e,t,r)};Q||(d((D=function(e){if(this instanceof D)throw TypeError("Symbol is not a constructor!");var t=b(0<arguments.length?e:void 0),r=function(e){this===J&&r.call(X,e),c(this,q)&&c(this[q],t)&&(this[q][t]=!1),Z(this,t,P(1,e))};return f&&$&&Z(J,t,{configurable:!0,set:r}),n(t)})[H],"toString",function(){return this._k}),R.f=s,U.f=te,e("./_object-gopn").f=T.f=a,e("./_object-pie").f=i,F.f=u,f&&!e("./_library")&&d(J,"propertyIsEnumerable",i,!0),g.f=function(e){return n(m(e))}),p(p.G+p.W+p.F*!Q,{Symbol:D});for(var re="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),ne=0;re.length>ne;)m(re[ne++]);for(var oe=M(m.store),ie=0;oe.length>ie;)w(oe[ie++]);p(p.S+p.F*!Q,"Symbol",{for:function(e){return c(V,e+="")?V[e]:V[e]=D(e)},keyFor:function(e){if(!ee(e))throw TypeError(e+" is not a symbol!");for(var t in V)if(V[t]===e)return t},useSetter:function(){$=!0},useSimple:function(){$=!1}}),p(p.S+p.F*!Q,"Object",{create:function(e,t){return void 0===t?A(e):o(A(e),t)},defineProperty:te,defineProperties:o,getOwnPropertyDescriptor:s,getOwnPropertyNames:a,getOwnPropertySymbols:u});var se=_(function(){F.f(1)});p(p.S+p.F*se,"Object",{getOwnPropertySymbols:function(e){return F.f(E(e))}}),B&&p(p.S+p.F*(!Q||_(function(){var e=D();return"[null]"!=z([e])||"{}"!=z({a:e})||"{}"!=z(Object(e))})),"JSON",{stringify:function(e){for(var t,r,n=[e],o=1;o<arguments.length;)n.push(arguments[o++]);if(r=t=n[1],(O(t)||void 0!==e)&&!ee(e))return k(t)||(t=function(e,t){if("function"==typeof r&&(t=r.call(this,e,t)),!ee(t))return t}),n[1]=t,z.apply(B,n)}}),D[H][G]||e("./_hide")(D[H],G,D[H].valueOf),y(D,"Symbol"),y(Math,"Math",!0),y(l.JSON,"JSON",!0)},{"./_an-object":55,"./_descriptors":63,"./_enum-keys":66,"./_export":67,"./_fails":68,"./_global":70,"./_has":71,"./_hide":72,"./_is-array":78,"./_is-object":79,"./_library":86,"./_meta":87,"./_object-create":91,"./_object-dp":92,"./_object-gopd":94,"./_object-gopn":96,"./_object-gopn-ext":95,"./_object-gops":97,"./_object-keys":100,"./_object-pie":101,"./_property-desc":105,"./_redefine":107,"./_set-to-string-tag":110,"./_shared":112,"./_to-iobject":118,"./_to-object":120,"./_to-primitive":121,"./_uid":122,"./_wks":126,"./_wks-define":124,"./_wks-ext":125}],140:[function(e,t,r){"use strict";var n=e("./_export"),o=e("./_core"),i=e("./_global"),s=e("./_species-constructor"),a=e("./_promise-resolve");n(n.P+n.R,"Promise",{finally:function(t){var r=s(this,o.Promise||i.Promise),e="function"==typeof t;return this.then(e?function(e){return a(r,t()).then(function(){return e})}:t,e?function(e){return a(r,t()).then(function(){throw e})}:t)}})},{"./_core":59,"./_export":67,"./_global":70,"./_promise-resolve":104,"./_species-constructor":113}],141:[function(e,t,r){"use strict";var n=e("./_export"),o=e("./_new-promise-capability"),i=e("./_perform");n(n.S,"Promise",{try:function(e){var t=o.f(this),r=i(e);return(r.e?t.reject:t.resolve)(r.v),t.promise}})},{"./_export":67,"./_new-promise-capability":89,"./_perform":103}],142:[function(e,t,r){e("./_wks-define")("asyncIterator")},{"./_wks-define":124}],143:[function(e,t,r){e("./_wks-define")("observable")},{"./_wks-define":124}],144:[function(e,t,r){e("./es6.array.iterator");for(var n=e("./_global"),o=e("./_hide"),i=e("./_iterators"),s=e("./_wks")("toStringTag"),a="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),u=0;u<a.length;u++){var l=a[u],c=n[l],f=c&&c.prototype;f&&!f[s]&&o(f,s,l),i[l]=i.Array}},{"./_global":70,"./_hide":72,"./_iterators":85,"./_wks":126,"./es6.array.iterator":129}],145:[function(e,t,r){"use strict";var i=function(e){return function(e){return!!e&&"object"==typeof e}(e)&&function(e){var t=Object.prototype.toString.call(e);return"[object RegExp]"!==t&&"[object Date]"!==t}(e)};function s(e,t){return t&&!0===t.clone&&i(e)?a(function(e){return Array.isArray(e)?[]:{}}(e),e,t):e}function o(r,e,n){var o=r.slice();return e.forEach(function(e,t){void 0===o[t]?o[t]=s(e,n):i(e)?o[t]=a(r[t],e,n):-1===r.indexOf(e)&&o.push(s(e,n))}),o}function a(e,t,r){var n=Array.isArray(t);return n===Array.isArray(e)?n?((r||{arrayMerge:o}).arrayMerge||o)(e,t,r):function(t,r,n){var o={};return i(t)&&Object.keys(t).forEach(function(e){o[e]=s(t[e],n)}),Object.keys(r).forEach(function(e){i(r[e])&&t[e]?o[e]=a(t[e],r[e],n):o[e]=s(r[e],n)}),o}(e,t,r):s(t,r)}a.all=function(e,r){if(!Array.isArray(e)||e.length<2)throw new Error("first argument should be an array with at least two elements");return e.reduce(function(e,t){return a(e,t,r)})};var n=a;t.exports=n},{}],146:[function(i,s,e){(function(e){function r(t){var e=o([["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/],["Search Bot",/(nuhk)|(Googlebot)|(Yammybot)|(Openbot)|(Slurp)|(MSNBot)|(Ask Jeeves\/Teoma)|(ia_archiver)/]]).filter(function(e){return e.rule&&e.rule.test(t)})[0];return e?e.name:null}function t(){return"undefined"==typeof navigator&&void 0!==e?{name:"node",version:e.version.slice(1),os:i("os").type().toLowerCase()}:null}function n(n){var e=o([["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["vivaldi",/Vivaldi\/([0-9\.]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)$/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FBAV\/([0-9\.]+)/],["instagram",/Instagram\ ([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/]]);if(!n)return null;var t=e.map(function(e){var t=e.rule.exec(n),r=t&&t[1].split(/[._]/).slice(0,3);return r&&r.length<3&&(r=r.concat(1==r.length?[0,0]:[0])),t&&{name:e.name,version:r.join(".")}}).filter(Boolean)[0]||null;return t&&(t.os=r(n)),/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/i.test(n)&&((t=t||{}).bot=!0),t}function o(e){return e.map(function(e){return{name:e[0],rule:e[1]}})}s.exports={detect:function(){var e=t();return e||("undefined"!=typeof navigator?n(navigator.userAgent):null)},detectOS:r,getNodeVersion:t,parseUserAgent:n}}).call(this,i("_process"))},{_process:3,os:2}],147:[function(e,t,r){"use strict";t.exports=e("./").polyfill()},{"./":148}],148:[function(H,r,n){(function(B,z){var e,t;e=this,t=function(){"use strict";function u(e){return"function"==typeof e}var r=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},n=0,t=void 0,o=void 0,s=function(e,t){p[n]=e,p[n+1]=t,2===(n+=2)&&(o?o(d):b())};var e="undefined"!=typeof window?window:void 0,i=e||{},a=i.MutationObserver||i.WebKitMutationObserver,l="undefined"==typeof self&&void 0!==B&&"[object process]"==={}.toString.call(B),c="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function f(){var e=setTimeout;return function(){return e(d,1)}}var p=new Array(1e3);function d(){for(var e=0;e<n;e+=2){(0,p[e])(p[e+1]),p[e]=void 0,p[e+1]=void 0}n=0}var h,_,v,y,b=void 0;function m(e,t){var r=this,n=new this.constructor(j);void 0===n[w]&&M(n);var o=r._state;if(o){var i=arguments[o-1];s(function(){return F(o,n,i,r._result)})}else T(r,n,e,t);return n}function g(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(j);return S(t,e),t}b=l?function(){return B.nextTick(d)}:a?(_=0,v=new a(d),y=document.createTextNode(""),v.observe(y,{characterData:!0}),function(){y.data=_=++_%2}):c?((h=new MessageChannel).port1.onmessage=d,function(){return h.port2.postMessage(0)}):void 0===e&&"function"==typeof H?function(){try{var e=Function("return this")().require("vertx");return void 0!==(t=e.runOnLoop||e.runOnContext)?function(){t(d)}:f()}catch(e){return f()}}():f();var w=Math.random().toString(36).substring(2);function j(){}var k=void 0,x=1,O=2;function E(e,t,r){t.constructor===e.constructor&&r===m&&t.constructor.resolve===g?function(t,e){e._state===x?P(t,e._result):e._state===O?A(t,e._result):T(e,void 0,function(e){return S(t,e)},function(e){return A(t,e)})}(e,t):void 0===r?P(e,t):u(r)?function(e,n,o){s(function(t){var r=!1,e=function(e,t,r,n){try{e.call(t,r,n)}catch(e){return e}}(o,n,function(e){r||(r=!0,n!==e?S(t,e):P(t,e))},function(e){r||(r=!0,A(t,e))},t._label);!r&&e&&(r=!0,A(t,e))},e)}(e,t,r):P(e,t)}function S(t,e){if(t===e)A(t,new TypeError("You cannot resolve a promise with itself"));else if(function(e){var t=typeof e;return null!==e&&("object"==t||"function"==t)}(e)){var r=void 0;try{r=e.then}catch(e){return void A(t,e)}E(t,e,r)}else P(t,e)}function L(e){e._onerror&&e._onerror(e._result),R(e)}function P(e,t){e._state===k&&(e._result=t,e._state=x,0!==e._subscribers.length&&s(R,e))}function A(e,t){e._state===k&&(e._state=O,e._result=t,s(L,e))}function T(e,t,r,n){var o=e._subscribers,i=o.length;e._onerror=null,o[i]=t,o[i+x]=r,o[i+O]=n,0===i&&e._state&&s(R,e)}function R(e){var t=e._subscribers,r=e._state;if(0!==t.length){for(var n=void 0,o=void 0,i=e._result,s=0;s<t.length;s+=3)n=t[s],o=t[s+r],n?F(r,n,o,i):o(i);e._subscribers.length=0}}function F(e,t,r,n){var o=u(r),i=void 0,s=void 0,a=!0;if(o){try{i=r(n)}catch(e){a=!1,s=e}if(t===i)return void A(t,new TypeError("A promises callback cannot return that same promise."))}else i=n;t._state!==k||(o&&a?S(t,i):!1===a?A(t,s):e===x?P(t,i):e===O&&A(t,i))}var U=0;function M(e){e[w]=U++,e._state=void 0,e._result=void 0,e._subscribers=[]}var N=(C.prototype._enumerate=function(e){for(var t=0;this._state===k&&t<e.length;t++)this._eachEntry(e[t],t)},C.prototype._eachEntry=function(t,e){var r=this._instanceConstructor,n=r.resolve;if(n===g){var o=void 0,i=void 0,s=!1;try{o=t.then}catch(e){s=!0,i=e}if(o===m&&t._state!==k)this._settledAt(t._state,e,t._result);else if("function"!=typeof o)this._remaining--,this._result[e]=t;else if(r===I){var a=new r(j);s?A(a,i):E(a,t,o),this._willSettleAt(a,e)}else this._willSettleAt(new r(function(e){return e(t)}),e)}else this._willSettleAt(n(t),e)},C.prototype._settledAt=function(e,t,r){var n=this.promise;n._state===k&&(this._remaining--,e===O?A(n,r):this._result[t]=r),0===this._remaining&&P(n,this._result)},C.prototype._willSettleAt=function(e,t){var r=this;T(e,void 0,function(e){return r._settledAt(x,t,e)},function(e){return r._settledAt(O,t,e)})},C);function C(e,t){this._instanceConstructor=e,this.promise=new e(j),this.promise[w]||M(this.promise),r(t)?(this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?P(this.promise,this._result):(this.length=this.length||0,this._enumerate(t),0===this._remaining&&P(this.promise,this._result))):A(this.promise,new Error("Array Methods must be provided an Array"))}var I=(D.prototype.catch=function(e){return this.then(null,e)},D.prototype.finally=function(t){var r=this.constructor;return u(t)?this.then(function(e){return r.resolve(t()).then(function(){return e})},function(e){return r.resolve(t()).then(function(){throw e})}):this.then(t,t)},D);function D(e){this[w]=U++,this._result=this._state=void 0,this._subscribers=[],j!==e&&("function"!=typeof e&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof D?function(t,e){try{e(function(e){S(t,e)},function(e){A(t,e)})}catch(e){A(t,e)}}(this,e):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return I.prototype.then=m,I.all=function(e){return new N(this,e).promise},I.race=function(o){var i=this;return r(o)?new i(function(e,t){for(var r=o.length,n=0;n<r;n++)i.resolve(o[n]).then(e,t)}):new i(function(e,t){return t(new TypeError("You must pass an array to race."))})},I.resolve=g,I.reject=function(e){var t=new this(j);return A(t,e),t},I._setScheduler=function(e){o=e},I._setAsap=function(e){s=e},I._asap=s,I.polyfill=function(){var e=void 0;if(void 0!==z)e=z;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var r=null;try{r=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===r&&!t.cast)return}e.Promise=I},I.Promise=I},"object"==typeof n&&void 0!==r?r.exports=t():e.ES6Promise=t()}).call(this,H("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:3}],149:[function(e,t,r){var n=function(){return this}()||Function("return this")(),o=n.regeneratorRuntime&&0<=Object.getOwnPropertyNames(n).indexOf("regeneratorRuntime"),i=o&&n.regeneratorRuntime;if(n.regeneratorRuntime=void 0,t.exports=e("./runtime"),o)n.regeneratorRuntime=i;else try{delete n.regeneratorRuntime}catch(e){n.regeneratorRuntime=void 0}},{"./runtime":150}],150:[function(e,R,t){!function(e){"use strict";var u,t=Object.prototype,l=t.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",n=r.asyncIterator||"@@asyncIterator",i=r.toStringTag||"@@toStringTag",s="object"==typeof R,a=e.regeneratorRuntime;if(a)s&&(R.exports=a);else{(a=e.regeneratorRuntime=s?R.exports:{}).wrap=m;var c="suspendedStart",f="suspendedYield",p="executing",d="completed",h={},_={};_[o]=function(){return this};var v=Object.getPrototypeOf,y=v&&v(v(A([])));y&&y!==t&&l.call(y,o)&&(_=y);var b=k.prototype=w.prototype=Object.create(_);j.prototype=b.constructor=k,k.constructor=j,k[i]=j.displayName="GeneratorFunction",a.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===j||"GeneratorFunction"===(t.displayName||t.name))},a.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,k):(e.__proto__=k,i in e||(e[i]="GeneratorFunction")),e.prototype=Object.create(b),e},a.awrap=function(e){return{__await:e}},x(O.prototype),O.prototype[n]=function(){return this},a.AsyncIterator=O,a.async=function(e,t,r,n){var o=new O(m(e,t,r,n));return a.isGeneratorFunction(t)?o:o.next().then(function(e){return e.done?e.value:o.next()})},x(b),b[i]="Generator",b[o]=function(){return this},b.toString=function(){return"[object Generator]"},a.keys=function(r){var n=[];for(var e in r)n.push(e);return n.reverse(),function e(){for(;n.length;){var t=n.pop();if(t in r)return e.value=t,e.done=!1,e}return e.done=!0,e}},a.values=A,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=u,this.done=!1,this.delegate=null,this.method="next",this.arg=u,this.tryEntries.forEach(L),!e)for(var t in this)"t"===t.charAt(0)&&l.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=u)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function e(e,t){return i.type="throw",i.arg=r,n.next=e,t&&(n.method="next",n.arg=u),!!t}for(var t=this.tryEntries.length-1;0<=t;--t){var o=this.tryEntries[t],i=o.completion;if("root"===o.tryLoc)return e("end");if(o.tryLoc<=this.prev){var s=l.call(o,"catchLoc"),a=l.call(o,"finallyLoc");if(s&&a){if(this.prev<o.catchLoc)return e(o.catchLoc,!0);if(this.prev<o.finallyLoc)return e(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return e(o.catchLoc,!0)}else{if(!a)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return e(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;0<=r;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&l.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,h):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),L(r),h}},catch:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;L(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:A(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=u),h}}}function m(e,t,r,n){var o=t&&t.prototype instanceof w?t:w,i=Object.create(o.prototype),s=new P(n||[]);return i._invoke=function(i,s,a){var u=c;return function(e,t){if(u===p)throw new Error("Generator is already running");if(u===d){if("throw"===e)throw t;return T()}for(a.method=e,a.arg=t;;){var r=a.delegate;if(r){var n=E(r,a);if(n){if(n===h)continue;return n}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if(u===c)throw u=d,a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);u=p;var o=g(i,s,a);if("normal"===o.type){if(u=a.done?d:f,o.arg===h)continue;return{value:o.arg,done:a.done}}"throw"===o.type&&(u=d,a.method="throw",a.arg=o.arg)}}}(e,r,s),i}function g(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}function w(){}function j(){}function k(){}function x(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function O(u){var t;this._invoke=function(r,n){function e(){return new Promise(function(e,t){!function t(e,r,n,o){var i=g(u[e],u,r);if("throw"!==i.type){var s=i.arg,a=s.value;return a&&"object"==typeof a&&l.call(a,"__await")?Promise.resolve(a.__await).then(function(e){t("next",e,n,o)},function(e){t("throw",e,n,o)}):Promise.resolve(a).then(function(e){s.value=e,n(s)},o)}o(i.arg)}(r,n,e,t)})}return t=t?t.then(e,e):e()}}function E(e,t){var r=e.iterator[t.method];if(r===u){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=u,E(e,t),"throw"===t.method))return h;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return h}var n=g(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,h;var o=n.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=u),t.delegate=null,h):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,h)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function A(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,n=function e(){for(;++r<t.length;)if(l.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=u,e.done=!0,e};return n.next=n}}return{next:T}}function T(){return{value:u,done:!0}}}(function(){return this}()||Function("return this")())},{}],151:[function(e,t,r){"use strict";t.exports=function(e){return"object"==typeof e?function r(n,o){var i;i=Array.isArray(n)?[]:{};o.push(n);Object.keys(n).forEach(function(e){var t=n[e];"function"!=typeof t&&(t&&"object"==typeof t?-1!==o.indexOf(n[e])?i[e]="[Circular]":i[e]=r(n[e],o.slice(0)):i[e]=t)});"string"==typeof n.name&&(i.name=n.name);"string"==typeof n.message&&(i.message=n.message);"string"==typeof n.stack&&(i.stack=n.stack);return i}(e,[]):"function"==typeof e?"[Function: "+(e.name||"anonymous")+"]":e}},{}],152:[function(e,t,r){!function(e){"use strict";if(!e.fetch){var t="URLSearchParams"in e,r="Symbol"in e&&"iterator"in Symbol,s="FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),n="FormData"in e,o="ArrayBuffer"in e;if(o)var i=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],a=function(e){return e&&DataView.prototype.isPrototypeOf(e)},u=ArrayBuffer.isView||function(e){return e&&-1<i.indexOf(Object.prototype.toString.call(e))};h.prototype.append=function(e,t){e=f(e),t=p(t);var r=this.map[e];this.map[e]=r?r+","+t:t},h.prototype.delete=function(e){delete this.map[f(e)]},h.prototype.get=function(e){return e=f(e),this.has(e)?this.map[e]:null},h.prototype.has=function(e){return this.map.hasOwnProperty(f(e))},h.prototype.set=function(e,t){this.map[f(e)]=p(t)},h.prototype.forEach=function(e,t){for(var r in this.map)this.map.hasOwnProperty(r)&&e.call(t,this.map[r],r,this)},h.prototype.keys=function(){var r=[];return this.forEach(function(e,t){r.push(t)}),d(r)},h.prototype.values=function(){var t=[];return this.forEach(function(e){t.push(e)}),d(t)},h.prototype.entries=function(){var r=[];return this.forEach(function(e,t){r.push([t,e])}),d(r)},r&&(h.prototype[Symbol.iterator]=h.prototype.entries);var l=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];g.prototype.clone=function(){return new g(this,{body:this._bodyInit})},m.call(g.prototype),m.call(j.prototype),j.prototype.clone=function(){return new j(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new h(this.headers),url:this.url})},j.error=function(){var e=new j(null,{status:0,statusText:""});return e.type="error",e};var c=[301,302,303,307,308];j.redirect=function(e,t){if(-1===c.indexOf(t))throw new RangeError("Invalid status code");return new j(null,{status:t,headers:{location:e}})},e.Headers=h,e.Request=g,e.Response=j,e.fetch=function(o,i){return new Promise(function(r,e){var t=new g(o,i),n=new XMLHttpRequest;n.onload=function(){var e={status:n.status,statusText:n.statusText,headers:function(e){var o=new h;return e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(e){var t=e.split(":"),r=t.shift().trim();if(r){var n=t.join(":").trim();o.append(r,n)}}),o}(n.getAllResponseHeaders()||"")};e.url="responseURL"in n?n.responseURL:e.headers.get("X-Request-URL");var t="response"in n?n.response:n.responseText;r(new j(t,e))},n.onerror=function(){e(new TypeError("Network request failed"))},n.ontimeout=function(){e(new TypeError("Network request failed"))},n.open(t.method,t.url,!0),"include"===t.credentials?n.withCredentials=!0:"omit"===t.credentials&&(n.withCredentials=!1),"responseType"in n&&s&&(n.responseType="blob"),t.headers.forEach(function(e,t){n.setRequestHeader(t,e)}),n.send(void 0===t._bodyInit?null:t._bodyInit)})},e.fetch.polyfill=!0}function f(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function p(e){return"string"!=typeof e&&(e=String(e)),e}function d(t){var e={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return r&&(e[Symbol.iterator]=function(){return e}),e}function h(t){this.map={},t instanceof h?t.forEach(function(e,t){this.append(t,e)},this):Array.isArray(t)?t.forEach(function(e){this.append(e[0],e[1])},this):t&&Object.getOwnPropertyNames(t).forEach(function(e){this.append(e,t[e])},this)}function _(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function v(r){return new Promise(function(e,t){r.onload=function(){e(r.result)},r.onerror=function(){t(r.error)}})}function y(e){var t=new FileReader,r=v(t);return t.readAsArrayBuffer(e),r}function b(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function m(){return this.bodyUsed=!1,this._initBody=function(e){if(this._bodyInit=e)if("string"==typeof e)this._bodyText=e;else if(s&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(n&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(t&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else if(o&&s&&a(e))this._bodyArrayBuffer=b(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!o||!ArrayBuffer.prototype.isPrototypeOf(e)&&!u(e))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=b(e)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):t&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},s&&(this.blob=function(){var e=_(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?_(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(y)}),this.text=function(){var e=_(this);if(e)return e;if(this._bodyBlob)return function(e){var t=new FileReader,r=v(t);return t.readAsText(e),r}(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),r=new Array(t.length),n=0;n<t.length;n++)r[n]=String.fromCharCode(t[n]);return r.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},n&&(this.formData=function(){return this.text().then(w)}),this.json=function(){return this.text().then(JSON.parse)},this}function g(e,t){var r=(t=t||{}).body;if(e instanceof g){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new h(e.headers)),this.method=e.method,this.mode=e.mode,r||null==e._bodyInit||(r=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"omit",!t.headers&&this.headers||(this.headers=new h(t.headers)),this.method=function(e){var t=e.toUpperCase();return-1<l.indexOf(t)?t:e}(t.method||this.method||"GET"),this.mode=t.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&r)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(r)}function w(e){var o=new FormData;return e.trim().split("&").forEach(function(e){if(e){var t=e.split("="),r=t.shift().replace(/\+/g," "),n=t.join("=").replace(/\+/g," ");o.append(decodeURIComponent(r),decodeURIComponent(n))}}),o}function j(e,t){t=t||{},this.type="default",this.status=void 0===t.status?200:t.status,this.ok=200<=this.status&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new h(t.headers),this.url=t.url||"",this._initBody(e)}}("undefined"!=typeof self?self:this)},{}],153:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.EVENTS_ARRAY=void 0;var n,o=e("babel-runtime/core-js/object/keys"),i=(n=o)&&n.__esModule?n:{default:n};var s={LOG:"log",ERROR:"error",UPLOAD_START:"start",UPLOAD_SUCCESS:"success",UPLOAD_FAILURE:"failure",UPLOAD_ADDEDFILE:"addedfile",UPLOAD_REMOVEDFILE:"removedfile",UPLOAD_PROGRESS:"progress",UPLOAD_THUMBNAIL:"thumbnail",UPLOAD_RECONNECTING:"reconnecting",UPLOAD_CONNECTED:"connected",UPLOAD_LOG:"log",UPLOAD_ERROR:"error",UPLOAD_CORRUPT:"corrupt",FORM_DROP:"drop",FORM_DRAG:"drag",FORM_DRAGSTART:"dragstart",FORM_DRAGEND:"dragend",FORM_DRAGENTER:"dragenter",FORM_DRAGOVER:"dragover",FORM_DRAGLEAVE:"dragleave"};r.EVENTS_ARRAY=(0,i.default)(s).map(function(e){return s[e]});r.default=s},{"babel-runtime/core-js/object/keys":34}],154:[function(S,L,e){(function(r){"use strict";var e=w(S("babel-runtime/core-js/symbol/iterator")),t=w(S("babel-runtime/core-js/symbol")),o=w(S("babel-runtime/core-js/object/define-property")),n=w(S("babel-runtime/core-js/object/set-prototype-of")),i=w(S("babel-runtime/core-js/object/create")),s=w(S("babel-runtime/core-js/object/get-prototype-of")),a="function"==typeof t.default&&"symbol"==typeof e.default?function(e){return typeof e}:function(e){return e&&"function"==typeof t.default&&e.constructor===t.default&&e!==t.default.prototype?"symbol":typeof e},u=function(e,t,r){return t&&l(e.prototype,t),r&&l(e,r),e};function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),(0,o.default)(e,n.key,n)}}S("classlist-polyfill");var c=w(S("@livelyvideo/localization")),f=w(S("@livelyvideo/upload-core/lib")),p=w(S("@livelyvideo/logger-core/lib")),d=w(S("@livelyvideo/utils/lib/createElement")),h=w(S("@livelyvideo/utils/lib/forwardEvents")),_=w(S("deepmerge")),v=w(S("events")),y=w(S("./utils/formatBytes")),b=S("./events"),m=w(b),g=w(S("./package-json"));function w(e){return e&&e.__esModule?e:{default:e}}function j(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var k=new p.default(g.default),x={host:null,bemPrefix:"upload",messages:null,selectTarget:null,previewsTarget:null,loggerOptions:{}},O=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=(0,i.default)(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(n.default?(0,n.default)(e,t):e.__proto__=t)}(E,v.default),u(E,[{key:"destroy",value:function(){for(var e=0;e<this._eventListeners.length;e++)this._eventListeners.splice(e,1)[0]();this.el.parentNode.removeChild(this.el)}},{key:"start",value:function(){this.upload.start()}},{key:"addFile",value:function(e){this.upload.addedfile(e)}},{key:"removeFile",value:function(e){this.upload.removeFile(e)}},{key:"selectFile",value:function(){this.upload.selectFile()}},{key:"reset",value:function(){this.upload.reset()}},{key:"report",value:function(e,t){this.upload.report(e,t)}},{key:"getUploadSpeed",value:function(e){return this.upload.getUploadSpeed(e)}},{key:"_validateOptions",value:function(e){var t=this,r=!0;return e||(setTimeout(function(){return t.emit("error",new Error('No options provided to constructor, "host" and "authUrl" required.'))}),r=!1),e.host||(setTimeout(function(){return t.emit("error",new Error('No "host" option provided.'))}),r=!1),r}},{key:"_mount",value:function(e){var t=this;switch(void 0===e?"undefined":a(e)){case"string":this.el=document.querySelector(e);break;case"object":this.el=e;break;default:r.nextTick(function(){return t.emit(m.default.UPLOAD_ERROR,"The constructor has not been given a valid element or selector.")})}this.el.classList.add(this.options.bemPrefix)}},{key:"_renderUnsupported",value:function(){this.uploadUnsupported=(0,d.default)({tagName:"p",className:this.options.bemPrefix+"__unsupported",text:this.localize("Your browser does not support HTML5 upload. We recommend upgrading your browser.")}),this.el.appendChild(this.uploadUnsupported)}},{key:"_render",value:function(){this.uploadTitle=(0,d.default)({tagName:"div",className:this.options.bemPrefix+"__title",text:this.localize("Drop files here or click to upload.")}),this.uploadInfo=(0,d.default)({tagName:"div",className:this.options.bemPrefix+"__info",childs:[this.uploadTitle]}),this.el.appendChild(this.uploadInfo),this.options.previewsTarget?this.uploadPreviews=this.options.previewsTarget:(this.uploadPreviews=(0,d.default)({tagName:"div",className:this.options.bemPrefix+"__previews"}),this.el.appendChild(this.uploadPreviews)),this._initFormListeners()}},{key:"_initFormListeners",value:function(){var n=this;this.options.selectTarget?this._eventHelper(this.options.selectTarget,"click",function(){n.upload.selectFile()}):(this._eventHelper(this.el,"click",function(){n.upload.selectFile()}),this._eventHelper(this.el,m.default.FORM_DROP,function(e){e.preventDefault(),e.stopPropagation(),n.emit(m.default.FORM_DROP,e),n.el.classList.remove(n.options.bemPrefix+"--is-dragover");var t=e.dataTransfer.files;if(n.options.multiple)for(var r=0;r<t.length;r++)n.upload.addFile(t[r]);else n.upload.addFile(t[0])}),this._eventHelper(this.el,m.default.FORM_DRAG,function(e){e.preventDefault(),e.stopPropagation(),n.emit(m.default.FORM_DRAG,e)}),this._eventHelper(this.el,m.default.FORM_DRAGSTART,function(e){e.preventDefault(),e.stopPropagation(),n.emit(m.default.FORM_DRAGSTART,e)}),this._eventHelper(this.el,m.default.FORM_DRAGEND,function(e){e.preventDefault(),e.stopPropagation(),n.emit(m.default.FORM_DRAGEND,e),n.el.classList.remove(n.options.bemPrefix+"--is-dragover")}),this._eventHelper(this.el,m.default.FORM_DRAGENTER,function(e){e.preventDefault(),e.stopPropagation(),n.emit(m.default.FORM_DRAGENTER,e),n.el.classList.add(n.options.bemPrefix+"--is-dragover")}),this._eventHelper(this.el,m.default.FORM_DRAGOVER,function(e){e.preventDefault(),e.stopPropagation(),n.emit(m.default.FORM_DRAGOVER,e),n.el.classList.add(n.options.bemPrefix+"--is-dragover")}),this._eventHelper(this.el,m.default.FORM_DRAGLEAVE,function(e){e.preventDefault(),e.stopPropagation(),n.emit(m.default.FORM_DRAGLEAVE,e),n.el.classList.remove(n.options.bemPrefix+"--is-dragover")}))}},{key:"_constructUploadPreview",value:function(e,t){var r=this._constructPreviewDOM(),n=r.querySelector("."+this.options.bemPrefix+"__preview-info-name"),o=r.querySelector("."+this.options.bemPrefix+"__preview-info-size"),i=r.querySelector("."+this.options.bemPrefix+"__preview-thumbnail");return r.id="id-"+e.fileIdentifier,n.textContent=e.name,o.textContent=(0,y.default)(e.size),i.classList.add(this.options.bemPrefix+"__preview-thumbnail--"+t.substr(0,t.indexOf("/"))),r}},{key:"_constructPreviewDOM",value:function(){if(this._previewClone)return this._previewClone.cloneNode(!0);var e=(0,d.default)({tagName:"div",className:this.options.bemPrefix+"__preview-thumbnail"}),t=(0,d.default)({tagName:"div",className:this.options.bemPrefix+"__preview-info-name"}),r=(0,d.default)({tagName:"div",className:this.options.bemPrefix+"__preview-info-size"}),n=(0,d.default)({tagName:"div",className:this.options.bemPrefix+"__preview-info",childs:[t,r]}),o=(0,d.default)({tagName:"div",className:this.options.bemPrefix+"__preview-status",text:this.localize("Initializing")}),i=(0,d.default)({tagName:"div",className:this.options.bemPrefix+"__preview-speed"}),s=(0,d.default)({tagName:"div",className:this.options.bemPrefix+"__preview-state",childs:[o,i]}),a=(0,d.default)({tagName:"div",className:this.options.bemPrefix+"__preview-progress-fill"}),u=(0,d.default)({tagName:"div",className:this.options.bemPrefix+"__preview-progress",childs:[a]}),l=(0,d.default)({tagName:"div",className:this.options.bemPrefix+"__preview-data",childs:[n,u,s]}),c=(0,d.default)({tagName:"div",className:this.options.bemPrefix+"__preview",childs:[e,l]});return this._previewClone=c,this._previewClone.cloneNode(!0)}},{key:"_checkCurrentFiles",value:function(){this.uploadPreviews.children.length?this.el.classList.add(this.options.bemPrefix+"--added-files"):this.el.classList.remove(this.options.bemPrefix+"--added-files")}},{key:"_addedfileHandler",value:function(e){var t=this._constructUploadPreview(e,e.type);this.uploadPreviews.appendChild(t),this._checkCurrentFiles()}},{key:"_removedfileHandler",value:function(e){var t=this.uploadPreviews.querySelector("#id-"+e.fileIdentifier);t.parentElement.removeChild(t)}},{key:"_startHandler",value:function(e){var t=this.uploadPreviews.querySelector("#id-"+e.fileIdentifier),r=t.querySelector("."+this.options.bemPrefix+"__preview-status");t.className=this.options.bemPrefix+"__preview "+this.options.bemPrefix+"__preview--uploading",r.textContent=this.localize("Uploading")}},{key:"_progressHandler",value:function(e,t,r,n){var o=this.uploadPreviews.querySelector("#id-"+e.fileIdentifier),i=o.querySelector("."+this.options.bemPrefix+"__preview-progress-fill"),s=o.querySelector("."+this.options.bemPrefix+"__preview-status"),a=o.querySelector("."+this.options.bemPrefix+"__preview-speed"),u=this.getUploadSpeed(e);i.style.width=n+"%",a.textContent=(u.bytesPerSecond/1024/1024).toFixed(2)+" Mbps",s.textContent=this.localize("Uploading")}},{key:"_failureHandler",value:function(e,t){var r=this.uploadPreviews.querySelector("#id-"+e.fileIdentifier),n=r.querySelector("."+this.options.bemPrefix+"__preview-status");r.className=this.options.bemPrefix+"__preview "+this.options.bemPrefix+"__preview--failure",n.textContent=this.localize(t.message)}},{key:"_successHandler",value:function(e){var t=this.uploadPreviews.querySelector("#id-"+e.fileIdentifier),r=t.querySelector("."+this.options.bemPrefix+"__preview-status");t.className=this.options.bemPrefix+"__preview "+this.options.bemPrefix+"__preview--success",r.textContent=this.localize("Completed")}},{key:"_reconnectingHandler",value:function(e){var t=this.uploadPreviews.querySelector("#id-"+e.fileIdentifier),r=t.querySelector("."+this.options.bemPrefix+"__preview-status");t.className=this.options.bemPrefix+"__preview "+this.options.bemPrefix+"__preview--reconnecting",r.textContent=this.localize("Reconnecting")}},{key:"_connectedHandler",value:function(e){var t=this.uploadPreviews.querySelector("#id-"+e.fileIdentifier),r=t.querySelector("."+this.options.bemPrefix+"__preview-status");if(e.corrupt)return t.className=this.options.bemPrefix+"__preview "+this.options.bemPrefix+"__preview--corrupt",void(r.textContent=this.localize("Corrupt File"));t.className=this.options.bemPrefix+"__preview "+this.options.bemPrefix+"__preview--uploading",r.textContent=this.localize("Uploading")}},{key:"_corruptHandler",value:function(e){var t=this.uploadPreviews.querySelector("#id-"+e.fileIdentifier),r=t.querySelector("."+this.options.bemPrefix+"__preview-status");t.className=this.options.bemPrefix+"__preview "+this.options.bemPrefix+"__preview--corrupt",r.textContent=this.localize("Corrupt File"),e.corrupt=!0}},{key:"_eventHelper",value:function(e,t,r){e.addEventListener(t,r),this._eventListeners.push(function(){e.removeEventListener(t,r)})}}]),E);function E(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,E);var r=j(this,(E.__proto__||(0,s.default)(E)).call(this));if(k.setOptions(t.loggerOptions,r),!r._validateOptions(t))return j(r);r.options=(0,_.default)(x,t),r.options.host=r.options.host.replace(/^https?:\/\//i,""),r.options.messages=r.options.MESSAGES?r.options.MESSAGES:r.options.messages,k.setInstanceOptions({host:r.options.host}),r._mount(e);var n=new c.default(r.options.locale,r.options.messages);return r.localize=n.localize.bind(n),r._eventListeners=[],r.options.loggerOptions.events=!1,r.upload=new f.default(r.el,r.options),(0,h.default)(r.upload,r,b.EVENTS_ARRAY),r.upload.isSupportedBrowser?(r._startHandler=r._startHandler.bind(r),r._successHandler=r._successHandler.bind(r),r._failureHandler=r._failureHandler.bind(r),r._addedfileHandler=r._addedfileHandler.bind(r),r._removedfileHandler=r._removedfileHandler.bind(r),r._progressHandler=r._progressHandler.bind(r),r._reconnectingHandler=r._reconnectingHandler.bind(r),r._connectedHandler=r._connectedHandler.bind(r),r._corruptHandler=r._corruptHandler.bind(r),r.upload.on(m.default.UPLOAD_START,r._startHandler),r.upload.on(m.default.UPLOAD_SUCCESS,r._successHandler),r.upload.on(m.default.UPLOAD_FAILURE,r._failureHandler),r.upload.on(m.default.UPLOAD_ADDEDFILE,r._addedfileHandler),r.upload.on(m.default.UPLOAD_REMOVEDFILE,r._removedfileHandler),r.upload.on(m.default.UPLOAD_PROGRESS,r._progressHandler),r.upload.on(m.default.UPLOAD_RECONNECTING,r._reconnectingHandler),r.upload.on(m.default.UPLOAD_CONNECTED,r._connectedHandler),r.upload.on(m.default.UPLOAD_CORRUPT,r._corruptHandler),r._render(),r):(r._renderUnsupported(),j(r))}L.exports=O}).call(this,S("_process"))},{"./events":153,"./package-json":155,"./utils/formatBytes":156,"@livelyvideo/localization":12,"@livelyvideo/logger-core/lib":14,"@livelyvideo/upload-core/lib":20,"@livelyvideo/utils/lib/createElement":26,"@livelyvideo/utils/lib/forwardEvents":27,_process:3,"babel-runtime/core-js/object/create":31,"babel-runtime/core-js/object/define-property":32,"babel-runtime/core-js/object/get-prototype-of":33,"babel-runtime/core-js/object/set-prototype-of":35,"babel-runtime/core-js/symbol":37,"babel-runtime/core-js/symbol/iterator":38,"classlist-polyfill":40,deepmerge:145,events:1}],155:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default={version:"5.1.0",name:"@livelyvideo/upload"},t.exports=r.default},{}],156:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e,t){if(0===e)return"0 Byte";var r=t+1||3,n=Math.floor(Math.log(e)/Math.log(1e3));return parseFloat((e/Math.pow(1e3,n)).toFixed(r))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][n]},t.exports=r.default},{}]},{},[154])(154)});
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{}],4:[function(require,module,exports){
var isFunction = require('is-function')

module.exports = forEach

var toString = Object.prototype.toString
var hasOwnProperty = Object.prototype.hasOwnProperty

function forEach(list, iterator, context) {
    if (!isFunction(iterator)) {
        throw new TypeError('iterator must be a function')
    }

    if (arguments.length < 3) {
        context = this
    }
    
    if (toString.call(list) === '[object Array]')
        forEachArray(list, iterator, context)
    else if (typeof list === 'string')
        forEachString(list, iterator, context)
    else
        forEachObject(list, iterator, context)
}

function forEachArray(array, iterator, context) {
    for (var i = 0, len = array.length; i < len; i++) {
        if (hasOwnProperty.call(array, i)) {
            iterator.call(context, array[i], i, array)
        }
    }
}

function forEachString(string, iterator, context) {
    for (var i = 0, len = string.length; i < len; i++) {
        // no such thing as a sparse string.
        iterator.call(context, string.charAt(i), i, string)
    }
}

function forEachObject(object, iterator, context) {
    for (var k in object) {
        if (hasOwnProperty.call(object, k)) {
            iterator.call(context, object[k], k, object)
        }
    }
}

},{"is-function":6}],5:[function(require,module,exports){
(function (global){
var win;

if (typeof window !== "undefined") {
    win = window;
} else if (typeof global !== "undefined") {
    win = global;
} else if (typeof self !== "undefined"){
    win = self;
} else {
    win = {};
}

module.exports = win;

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{}],6:[function(require,module,exports){
module.exports = isFunction

var toString = Object.prototype.toString

function isFunction (fn) {
  var string = toString.call(fn)
  return string === '[object Function]' ||
    (typeof fn === 'function' && string !== '[object RegExp]') ||
    (typeof window !== 'undefined' &&
     // IE8 and below
     (fn === window.setTimeout ||
      fn === window.alert ||
      fn === window.confirm ||
      fn === window.prompt))
};

},{}],7:[function(require,module,exports){
var trim = require('trim')
  , forEach = require('for-each')
  , isArray = function(arg) {
      return Object.prototype.toString.call(arg) === '[object Array]';
    }

module.exports = function (headers) {
  if (!headers)
    return {}

  var result = {}

  forEach(
      trim(headers).split('\n')
    , function (row) {
        var index = row.indexOf(':')
          , key = trim(row.slice(0, index)).toLowerCase()
          , value = trim(row.slice(index + 1))

        if (typeof(result[key]) === 'undefined') {
          result[key] = value
        } else if (isArray(result[key])) {
          result[key].push(value)
        } else {
          result[key] = [ result[key], value ]
        }
      }
  )

  return result
}
},{"for-each":4,"trim":9}],8:[function(require,module,exports){
module.exports = function(node, value) {
  var text = (node.textContent !== undefined ?
    'textContent' : 'innerText'
  )

  if (typeof value != 'undefined') {
    node[text] = value
  }

  return node[text]
}

},{}],9:[function(require,module,exports){

exports = module.exports = trim;

function trim(str){
  return str.replace(/^\s*|\s*$/g, '');
}

exports.left = function(str){
  return str.replace(/^\s*/, '');
};

exports.right = function(str){
  return str.replace(/\s*$/, '');
};

},{}],10:[function(require,module,exports){
"use strict";
var window = require("global/window")
var isFunction = require("is-function")
var parseHeaders = require("parse-headers")
var xtend = require("xtend")

module.exports = createXHR
createXHR.XMLHttpRequest = window.XMLHttpRequest || noop
createXHR.XDomainRequest = "withCredentials" in (new createXHR.XMLHttpRequest()) ? createXHR.XMLHttpRequest : window.XDomainRequest

forEachArray(["get", "put", "post", "patch", "head", "delete"], function(method) {
    createXHR[method === "delete" ? "del" : method] = function(uri, options, callback) {
        options = initParams(uri, options, callback)
        options.method = method.toUpperCase()
        return _createXHR(options)
    }
})

function forEachArray(array, iterator) {
    for (var i = 0; i < array.length; i++) {
        iterator(array[i])
    }
}

function isEmpty(obj){
    for(var i in obj){
        if(obj.hasOwnProperty(i)) return false
    }
    return true
}

function initParams(uri, options, callback) {
    var params = uri

    if (isFunction(options)) {
        callback = options
        if (typeof uri === "string") {
            params = {uri:uri}
        }
    } else {
        params = xtend(options, {uri: uri})
    }

    params.callback = callback
    return params
}

function createXHR(uri, options, callback) {
    options = initParams(uri, options, callback)
    return _createXHR(options)
}

function _createXHR(options) {
    if(typeof options.callback === "undefined"){
        throw new Error("callback argument missing")
    }

    var called = false
    var callback = function cbOnce(err, response, body){
        if(!called){
            called = true
            options.callback(err, response, body)
        }
    }

    function readystatechange() {
        if (xhr.readyState === 4) {
            setTimeout(loadFunc, 0)
        }
    }

    function getBody() {
        // Chrome with requestType=blob throws errors arround when even testing access to responseText
        var body = undefined

        if (xhr.response) {
            body = xhr.response
        } else {
            body = xhr.responseText || getXml(xhr)
        }

        if (isJson) {
            try {
                body = JSON.parse(body)
            } catch (e) {}
        }

        return body
    }

    function errorFunc(evt) {
        clearTimeout(timeoutTimer)
        if(!(evt instanceof Error)){
            evt = new Error("" + (evt || "Unknown XMLHttpRequest Error") )
        }
        evt.statusCode = 0
        return callback(evt, failureResponse)
    }

    // will load the data & process the response in a special response object
    function loadFunc() {
        if (aborted) return
        var status
        clearTimeout(timeoutTimer)
        if(options.useXDR && xhr.status===undefined) {
            //IE8 CORS GET successful response doesn't have a status field, but body is fine
            status = 200
        } else {
            status = (xhr.status === 1223 ? 204 : xhr.status)
        }
        var response = failureResponse
        var err = null

        if (status !== 0){
            response = {
                body: getBody(),
                statusCode: status,
                method: method,
                headers: {},
                url: uri,
                rawRequest: xhr
            }
            if(xhr.getAllResponseHeaders){ //remember xhr can in fact be XDR for CORS in IE
                response.headers = parseHeaders(xhr.getAllResponseHeaders())
            }
        } else {
            err = new Error("Internal XMLHttpRequest Error")
        }
        return callback(err, response, response.body)
    }

    var xhr = options.xhr || null

    if (!xhr) {
        if (options.cors || options.useXDR) {
            xhr = new createXHR.XDomainRequest()
        }else{
            xhr = new createXHR.XMLHttpRequest()
        }
    }

    var key
    var aborted
    var uri = xhr.url = options.uri || options.url
    var method = xhr.method = options.method || "GET"
    var body = options.body || options.data
    var headers = xhr.headers = options.headers || {}
    var sync = !!options.sync
    var isJson = false
    var timeoutTimer
    var failureResponse = {
        body: undefined,
        headers: {},
        statusCode: 0,
        method: method,
        url: uri,
        rawRequest: xhr
    }

    if ("json" in options && options.json !== false) {
        isJson = true
        headers["accept"] || headers["Accept"] || (headers["Accept"] = "application/json") //Don't override existing accept header declared by user
        if (method !== "GET" && method !== "HEAD") {
            headers["content-type"] || headers["Content-Type"] || (headers["Content-Type"] = "application/json") //Don't override existing accept header declared by user
            body = JSON.stringify(options.json === true ? body : options.json)
        }
    }

    xhr.onreadystatechange = readystatechange
    xhr.onload = loadFunc
    xhr.onerror = errorFunc
    // IE9 must have onprogress be set to a unique function.
    xhr.onprogress = function () {
        // IE must die
    }
    xhr.onabort = function(){
        aborted = true;
    }
    xhr.ontimeout = errorFunc
    xhr.open(method, uri, !sync, options.username, options.password)
    //has to be after open
    if(!sync) {
        xhr.withCredentials = !!options.withCredentials
    }
    // Cannot set timeout with sync request
    // not setting timeout on the xhr object, because of old webkits etc. not handling that correctly
    // both npm's request and jquery 1.x use this kind of timeout, so this is being consistent
    if (!sync && options.timeout > 0 ) {
        timeoutTimer = setTimeout(function(){
            if (aborted) return
            aborted = true//IE9 may still call readystatechange
            xhr.abort("timeout")
            var e = new Error("XMLHttpRequest timeout")
            e.code = "ETIMEDOUT"
            errorFunc(e)
        }, options.timeout )
    }

    if (xhr.setRequestHeader) {
        for(key in headers){
            if(headers.hasOwnProperty(key)){
                xhr.setRequestHeader(key, headers[key])
            }
        }
    } else if (options.headers && !isEmpty(options.headers)) {
        throw new Error("Headers cannot be set on an XDomainRequest object")
    }

    if ("responseType" in options) {
        xhr.responseType = options.responseType
    }

    if ("beforeSend" in options &&
        typeof options.beforeSend === "function"
    ) {
        options.beforeSend(xhr)
    }

    // Microsoft Edge browser sends "undefined" when send is called with undefined value.
    // XMLHttpRequest spec says to pass null as body to indicate no body
    // See https://github.com/naugtur/xhr/issues/100.
    xhr.send(body || null)

    return xhr


}

function getXml(xhr) {
    // xhr.responseXML will throw Exception "InvalidStateError" or "DOMException"
    // See https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/responseXML.
    try {
        if (xhr.responseType === "document") {
            return xhr.responseXML
        }
        var firefoxBugTakenEffect = xhr.responseXML && xhr.responseXML.documentElement.nodeName === "parsererror"
        if (xhr.responseType === "" && !firefoxBugTakenEffect) {
            return xhr.responseXML
        }
    } catch (e) {}

    return null
}

function noop() {}

},{"global/window":5,"is-function":6,"parse-headers":7,"xtend":11}],11:[function(require,module,exports){
module.exports = extend

var hasOwnProperty = Object.prototype.hasOwnProperty;

function extend() {
    var target = {}

    for (var i = 0; i < arguments.length; i++) {
        var source = arguments[i]

        for (var key in source) {
            if (hasOwnProperty.call(source, key)) {
                target[key] = source[key]
            }
        }
    }

    return target
}

},{}]},{},[1]);
