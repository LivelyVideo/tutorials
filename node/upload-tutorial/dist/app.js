(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
'use strict';

var _upload = require('@livelyvideo/upload');

var _upload2 = _interopRequireDefault(_upload);

var _stockVodPlayer = require('@livelyvideo/stock-vod-player');

var _stockVodPlayer2 = _interopRequireDefault(_stockVodPlayer);

var _xhr = require('xhr');

var _xhr2 = _interopRequireDefault(_xhr);

var _textContent = require('text-content');

var _textContent2 = _interopRequireDefault(_textContent);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

/**
Set up the upload instance

Params:
	- html element
	- options
			url: (Required) Route to your upload api.
			authUrl: (Required) Route to your auth api.
			redirect: Defaults to null. The redirect route to your results template for cross-origin form compatibility.
			accept: Defaults to null. Sets the value of accept attribute on file input.
			supportLegacy: Defaults to true. Turn legacy support on or off.
			forceLegacy: Defaults to false. Helpful option to force use of legacy form for debugging.
			autoSubmit: Defaults to true. Automatically upload file when added to the uploader.
			MESSAGES: (Localization) Object containing list of message names and message strings.
				ERROR_NETWORK - Network error.
				ERROR_DUP_FILE - This file has already been uploaded.
				ERROR_FILE_NAME - This file does not have a name.
				ERROR_FILE_EXT - This file extension is not supported.
				ERROR_MISSING_BODY - This file does not have any data.
				ERROR_FILE_SIZE - This file exceeds max file size.
				ERROR_UNAUTH - The user is not authorized to perform this action.
				ERROR_DEFAULT - Error.
				ERROR_CANCEL - Upload has been canceled.
				ERROR_URL - Invalid url.
				ERROR_EL - The constructor has not been given a valid element or selector.
				UNSUPPORTED_BROWSER - Your browser does not support HTML5 upload. We recommend upgrading your browser.
				TITLE - Drop files here or click to upload.
				SUBTITLE - Max file size 48Mb.
				LEGACY_TITLE - Click to upload.
				LEGACY_SUBTITLE - File preview and drag and drop unavailable. Please upgrade your browser for a better experience. |
**/
var upload = new _upload2.default(document.querySelector('.upload'), {
	url: 'https://dev.livelyvideo.tv/api/upload/v2',
	authUrl: 'http://localhost:7000/access-token',
    supportLegacy: false
});
window.upload = upload;

// Play a video
/**
Function to load the stock player, triggered later by a click event on <a> tags generated by the "get listings" button

Params:
	- html element
	- manifest url, returned by the listings endpoint located in server.js
	- player options
		> autoplay: [true] autoplays the stream when it loads
		> bitrate: [undefined] null for adaptive when available, desired kbps otherwise
		> drivers: ["mp4", "nativeHls", "jsHls", "flash", lodef"] driver priority
		> debug: [false] enables debug logging
		> recoverErrorCount: [10] Playback error count to recover the entire driver on
		> forceDrivers:	[false]
		> muted: whether or not the driver is muted
		> pollingInterval: [10000] ms timeout to wait before polling again
		> volume: [0.75] 0-1 volume
	- controls options
		> popout: popout options
		> popout[].url: url for popout
		> popout[].width: width for popout in px
		> popout[].height: height for popout in px

Events:
	- error emitted with all errors
	- exit-fullscreen
	- enter-fullscreen
	- bitrate-switch
	- select-driver
	- manifest
	- play
	- stop
	- pause
	- stall
	- progress
	- timeupdate
	- mute
	- unmute
	- volume
	- online
	- offline
	- estimated-bw
	- user-active
	- user-idle
**/
var stockPlayer = void 0;
function loadPlayer(manifest) {
	return function (e) {
		e.preventDefault();
		if (stockPlayer) {
			stockPlayer.destroy();
		}

		window.stockPlayer = stockPlayer = new _stockVodPlayer2.default(document.querySelector('#player'), manifest, {
			drivers: ['hlsjs', 'hls', 'flashHls', 'mp4'],
			hlsjsPath: 'http://dailymotion.github.io/hls.js/dist/hls.js',
			flashlsPath: './flashlsChromeless.swf'
		});
	};
}

// Videos
var videosContainer = document.querySelector('.videos');

function loadVideos() {
	(0, _xhr2.default)({
		method: 'GET',
		uri: '/videos',
		json: true
	}, function (err, response, body) {
		if (err) {
			console.error('get videos error', err);
			return;
		}

		if (response.statusCode > 399) {
			console.error('get videos error', {
				code: response.statusCode,
				body: body
			});
			return;
		}

		while (videosContainer.children.length) {
			videosContainer.children[0].remove();
		}

		for (var i = 0; i < body.results.length; i++) {
			var videoEntry = document.createElement('div');
			var videoLink = document.createElement('a');
			videoLink.setAttribute('href', '#');
			videoEntry.appendChild(videoLink);

			videoLink.onclick = loadPlayer(body.results[i].manifest);
			(0, _textContent2.default)(videoLink, 'video uploaded by ' + body.results[i].userId + ' on ' + body.results[i].dateEnd);
			videosContainer.appendChild(videoEntry);
		}
	});
}

var loadVideosButton = document.querySelector('.loadvideos');
loadVideosButton.onclick = function () {
	loadVideos();
};
loadVideos();

},{"@livelyvideo/stock-vod-player":2,"@livelyvideo/upload":3,"text-content":8,"xhr":10}],2:[function(require,module,exports){
(function (global){
!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.LivelyStockVodPlayer=e()}}(function(){var e;return function t(e,r,n){function i(s,l){if(!r[s]){if(!e[s]){var a="function"==typeof require&&require;if(!l&&a)return a(s,!0);if(o)return o(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var c=r[s]={exports:{}};e[s][0].call(c.exports,function(t){var r=e[s][1][t];return i(r?r:t)},c,c.exports,t,e,r,n)}return r[s].exports}for(var o="function"==typeof require&&require,s=0;s<n.length;s++)i(n[s]);return i}({1:[function(e,t,r){"use strict";function n(e,t){var r=document.createElement(e);return r.classList.add.apply(r.classList,t),r}Object.defineProperty(r,"__esModule",{value:!0}),r["default"]=n},{}],2:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=e("events"),u=n(a),c=e("../create-element"),f=n(c),d=function(e){function t(e){i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.controls=e,r.livelyPlayer=e.livelyPlayer,r.bar=e.bar,r.el=f["default"]("div",["fullscreen"]),r.el.setAttribute("title","Full Screen"),r.bar.appendChild(r.el),r.el.addEventListener("click",r.toggleFullScreen.bind(r)),r}return s(t,e),l(t,[{key:"destroy",value:function(){this.el.remove()}},{key:"setIcon",value:function(){this.isFullscreen()?(this.el.classList.remove("fullscreen-exit"),this.el.classList.add("fullscreen-exit")):(this.el.classList.remove("fullscreen-exit"),this.el.classList.add("fullscreen-exit"))}},{key:"isFullscreen",value:function(){return!!(document.fullScreen||document.webkitIsFullScreen||document.mozFullScreen||document.msFullscreenElement||document.fullscreenElement)}},{key:"toggleFullScreen",value:function(){if(this.isFullscreen())return void(document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen());var e=this.livelyPlayer.el.parentNode;e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullScreen?e.webkitRequestFullScreen():e.msRequestFullscreen?e.msRequestFullscreen():this.livelyPlayer.el.webkitEnterFullscreen&&this.livelyPlayer.el.webkitEnterFullscreen()}}]),t}(u["default"]);r["default"]=d},{"../create-element":1,events:41}],3:[function(e,t,r){"use strict";function n(e){var t=void 0;if(e.getBoundingClientRect&&e.parentNode&&(t=e.getBoundingClientRect()),!t)return{top:0,left:0,right:0};var r=document.documentElement,n=document.body,i=r.clientTop||n.clientTop||0,o=r.clientLeft||n.clientLeft||0,s=window.pageYOffset||n.scrollTop,l=window.pageXOffset||n.scrollLeft,a=Math.floor(t.left+l-o);return{top:Math.floor(t.top+s-i),left:a,right:a+t.right}}Object.defineProperty(r,"__esModule",{value:!0}),r["default"]=n},{}],4:[function(e,t,r){"use strict";function n(e){var t=e.pageY,r=e.pageX;return e.changedTouches&&(t=e.changedTouches[0].pageY,r=e.changedTouches[0].pageX),{y:t,x:r}}Object.defineProperty(r,"__esModule",{value:!0}),r["default"]=n},{}],5:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=e("events"),u=n(a),c=e("@livelyvideo/player-core/lib/detect"),f=n(c),d=e("@livelyvideo/player-core/lib/get-default-options"),h=n(d),p=e("@livelyvideo/player-core/lib/logger"),v=n(p),y=e("./fullscreen"),m=n(y),b=e("./overlay"),g=n(b),E=e("./popout"),w=n(E),_=e("./playpause"),P=n(_),O=e("./progress"),k=n(O),L=e("./quality-selector"),T=n(L),R=e("./screen-interaction"),D=n(R),S=e("./volume"),A=n(S),I={controls:["overlay","playpause","fullscreen","popout","progress","quality-selector","volume"],popout:{url:"",width:480,height:280}},C=function(e){function t(e,r){i(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.el=e,n.bar=document.createElement("div"),n.controls=[],n.mobileControls=f["default"].any(),n.mobileControls&&n.el.classList.add("mobile"),n.el.classList.add("lvcontrols"),n.bar.classList.add("lvcontrols__bar"),n.el.appendChild(n.bar),n.options=h["default"](r,I),n.options.livelyPlayer&&n.attach(n.options.livelyPlayer),n}return s(t,e),l(t,[{key:"destroyControls",value:function(){for(var e=0;e<this.controls.length;e++)this.controls[e].destroy()}},{key:"destroy",value:function(){this.destroyControls(),this.bar.remove(),this.screenInteraction&&this.screenInteraction.destroy()}},{key:"attach",value:function(e){var t=this;this.livelyPlayer=e;for(var r=function(e){switch(e){case"fullscreen":t.controls.push(new m["default"](t));break;case"overlay":t.controls.push(new g["default"](t));break;case"playpause":t.controls.push(new P["default"](t));break;case"popout":t.controls.push(new w["default"](t));break;case"progress":t.controls.push(new k["default"](t));break;case"quality-selector":t.controls.push(new T["default"](t));break;case"volume":t.controls.push(new A["default"](t));break;default:v["default"].error("unrecognized control",e)}},n=0;n<this.options.controls.length;n++)r(this.options.controls[n]);this.screenInteraction=new D["default"](this.livelyPlayer.el),this.screenInteraction.on("user-active",function(){t.bar.classList.add("interacting")}),this.screenInteraction.on("user-idle",function(){t.bar.classList.remove("interacting")})}}]),t}(u["default"]);r["default"]=C},{"./fullscreen":2,"./overlay":6,"./playpause":7,"./popout":8,"./progress":9,"./quality-selector":10,"./screen-interaction":11,"./volume":12,"@livelyvideo/player-core/lib/detect":14,"@livelyvideo/player-core/lib/get-default-options":18,"@livelyvideo/player-core/lib/logger":19,events:41}],6:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=e("events"),u=n(a),c=e("../create-element"),f=n(c),d=function(e){function t(e){i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.controls=e,r.livelyPlayer=e.livelyPlayer,r.bar=e.bar,r.el=f["default"]("div",["big-button"]),r.el.setAttribute("title","Full Screen"),r.controls.el.appendChild(r.el),r.el.addEventListener("click",r.togglePlaying.bind(r)),r.livelyPlayer.on("play",r.setIcon.bind(r)),r.livelyPlayer.on("pause",r.setIcon.bind(r)),r.livelyPlayer.on("stop",r.setIcon.bind(r)),r.livelyPlayer.on("ended",r.setIcon.bind(r)),r.livelyPlayer.on("offline",r.setIcon.bind(r)),r}return s(t,e),l(t,[{key:"destroy",value:function(){this.el.remove()}},{key:"setIcon",value:function(){"offline"===this.livelyPlayer.getState()?(this.el.classList.remove("stopped"),this.el.classList.remove("playing"),this.el.classList.add("offline")):this.livelyPlayer.tryingToPlay?(this.el.classList.remove("stopped"),this.el.classList.remove("offline"),this.el.classList.add("playing")):(this.el.classList.remove("playing"),this.el.classList.remove("offline"),this.el.classList.add("stopped"))}},{key:"togglePlaying",value:function(){this.livelyPlayer.tryingToPlay?this.livelyPlayer.stop():this.livelyPlayer.play()}}]),t}(u["default"]);r["default"]=d},{"../create-element":1,events:41}],7:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=e("events"),u=n(a),c=e("../create-element"),f=n(c),d=function(e){function t(e){i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.controls=e,r.livelyPlayer=e.livelyPlayer,r.bar=e.bar,r.el=f["default"]("div",["play-button"]),r.el.setAttribute("title","Toggle play/pause"),r.bar.appendChild(r.el),r.el.addEventListener("click",r.togglePlaying.bind(r)),r.livelyPlayer.on("play",r.setIcon.bind(r)),r.livelyPlayer.on("pause",r.setIcon.bind(r)),r.livelyPlayer.on("stop",r.setIcon.bind(r)),r.livelyPlayer.on("ended",r.setIcon.bind(r)),r.setIcon(),r}return s(t,e),l(t,[{key:"destroy",value:function(){this.el.remove()}},{key:"setIcon",value:function(){this.livelyPlayer.tryingToPlay?(this.el.classList.remove("stopped"),this.el.classList.add("playing"),this.el.setAttribute("title","Pause")):(this.el.classList.remove("playing"),this.el.classList.add("stopped"),this.el.setAttribute("title","Play"))}},{key:"togglePlaying",value:function(){this.livelyPlayer.tryingToPlay?this.livelyPlayer.vod?this.livelyPlayer.pause():this.livelyPlayer.stop():this.livelyPlayer.play()}}]),t}(u["default"]);r["default"]=d},{"../create-element":1,events:41}],8:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=e("events"),u=n(a),c=e("@livelyvideo/player-core/lib/logger"),f=n(c),d=e("@livelyvideo/player-core/lib/parse-url"),h=n(d),p=e("../create-element"),v=n(p),y=function(e){function t(e){i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.options.popout&&e.options.popout.url?(r.popoutUrl=h["default"](e.options.popout.url),r.popoutUrl?(r.controls=e,r.livelyPlayer=e.livelyPlayer,r.bar=e.bar,r.popoutOptions="width="+e.options.popout.width+", height="+e.options.popout.height+", resizable=yes, scrollbars=no, titlebar=no",r.poppedoutPlayer=null,r.el=v["default"]("div",["popout-button"]),r.el.setAttribute("target","_blank"),r.el.setAttribute("title","Popout"),r.el.addEventListener("click",r.openPopout.bind(r)),r.bar.appendChild(r.el),r.el.addEventListener("click",r.openPopout.bind(r)),r):(f["default"].error("popout url is invalid"),o(r))):o(r)}return s(t,e),l(t,[{key:"destroy",value:function(){this.el&&this.el.remove()}},{key:"popoverStartPlaying",value:function(e){var t=this;return this.livelyPlayer?(this.livelyPlayer.play(),e&&(this.livelyPlayer.currentTime=e.currentTime,this.livelyPlayer.volume(e.volume)),void this.livelyPlayer.play(function(){e&&e.muted?t.livelyPlayer.mute():e&&!e.muted&&t.livelyPlayer.unmute()})):void f["default"].error("could not start playing on pop in, no player instance")}},{key:"openPopout",value:function(e){var t=this;if(!this.livelyPlayer)return void f["default"].error("could not attach popout, no player instance");if(this.poppedoutPlayer)return void this.poppedoutPlayer.focus();if(e.preventDefault(),this.poppedoutPlayer&&(this.poppedoutPlayer.onbeforeunload=null,this.poppedoutPlayer.onunload=null),this.livelyPlayer.vod){var r=this.popoutUrl.search?"&":"?";this.popoutUrl&&(this.popoutUrl.href+=r+"start"+this.livelyPlayer.currentTime)}this.poppedoutPlayer=window.open(this.popoutUrl.href,"_blank",this.popoutOptions),this.livelyPlayer.pause();var n=void 0,i=function(){t.poppedoutPlayer.closed||(delete t.poppedoutPlayer,setTimeout(function(){t.popoverStartPlaying(n)},20))};this.poppedoutPlayer.onmessage=function(e){n=e.data},setTimeout(function(){t.poppedoutPlayer.addEventListener("beforeunload",i)},250)}}]),t}(u["default"]);r["default"]=y},{"../create-element":1,"@livelyvideo/player-core/lib/logger":19,"@livelyvideo/player-core/lib/parse-url":22,events:41}],9:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=e("events"),u=n(a),c=e("@livelyvideo/player-core/lib/logger"),f=n(c),d=e("../get-el-position"),h=n(d),p=e("../get-pointer-position"),v=n(p),y=function(e){function t(e){i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.controls=e,r.livelyPlayer=e.livelyPlayer,r.bar=e.bar,r.rendered=!1,r.livelyPlayer.on("manifest",r.renderIfNotRendered.bind(r)),r.render(),r}return s(t,e),l(t,[{key:"renderIfNotRendered",value:function(){this.rendered||this.render()}},{key:"render",value:function(){var e=this;if(this.livelyPlayer.vod){this.rendered=!0,this.livelyPlayer.removeListener("manifest",this.renderIfNotRendered),this.el=document.createElement("div");var t=this.controls.screenInteraction.userInteraction?"progress interacting":"progress";this.el.setAttribute("class",t),this.progressBarEl=document.createElement("div"),this.progressBarEl.setAttribute("class","progress-bar"),this.sliderEl=document.createElement("div"),this.sliderEl.setAttribute("class","progress-slider"),this.sliderBufferEl=document.createElement("div"),this.sliderBufferEl.setAttribute("class","progress-slider-buffer"),this.sliderValueEl=document.createElement("div"),this.sliderValueEl.setAttribute("class","progress-slider-value"),this.controls.screenInteraction.on("user-active",function(){e.el.classList.add("interacting")}),this.controls.screenInteraction.on("user-idle",function(){e.el.classList.remove("interacting")}),this.nextTime=0,this.el.addEventListener("mousedown",function(t){e.startDrag(t)}),document.addEventListener("mouseup",function(t){e.stopDrag(t)}),document.addEventListener("mousemove",function(t){e.moveSlider(t)}),this.el.appendChild(this.progressBarEl),this.el.appendChild(this.sliderEl),this.el.appendChild(this.sliderBufferEl),this.el.appendChild(this.sliderValueEl),this.controls.el.appendChild(this.el),this.livelyPlayer.on("timeupdate",function(t){e.updateSliderValue(t)}),this.livelyPlayer.on("progress",function(t){e.updateSliderValue(t)})}}},{key:"calculateSeek",value:function(e){if(this.dragging){var t=(v["default"](e).x-h["default"](this.el).left)/this.el.getBoundingClientRect().width;t=Math.max(t,0),t=Math.min(t,1),this.nextTime=t*this.livelyPlayer.duration}}},{key:"updateSliderValue",value:function(){if(!this.dragging){for(var e=this.livelyPlayer,t=e.currentTime,r=t/e.duration,n=this.livelyPlayer.bufferTimes,i=void 0,o=0;o<n.length;o++)if(t>=n[o][0]&&t<=n[o][1]){i=n[o];break}if(i){var s=Math.max(Number((i[0]/e.duration).toFixed(2)),0),l=Math.max(Number((i[1]/e.duration).toFixed(2)),0);this.sliderBufferEl.style.left=100*s+"%",this.sliderBufferEl.style.width=100*(l-s)+"%"}else this.sliderBufferEl.style.width=0;this.sliderValueEl.style.left=100*r+"%"}}},{key:"moveSlider",value:function(e){this.dragging&&(this.sliderValueEl.style.left=v["default"](e).x-h["default"](this.el).left+"px")}},{key:"startDrag",value:function(){this.dragging=!0}},{key:"stopDrag",value:function(e){if(this.dragging){this.dragging=!1;var t=(v["default"](e).x-h["default"](this.el).left)/this.el.getBoundingClientRect().width;t=Math.max(t,0),t=Math.min(t,1);var r=t*this.livelyPlayer.duration;return isNaN(r)?void f["default"].error("attempted to set current time to NaN",r):void(this.livelyPlayer.currentTime=r)}}},{key:"destroy",value:function(){this.livelyPlayer.removeListener("manifest",this.renderIfNotRendered),this.livelyPlayer.removeListener("timeupdate",this.updateSliderValue),this.livelyPlayer.removeListener("progress",this.updateSliderValue),this.rendered&&(this.rendered=!1,this.el.remove(),this.progressBarEl.remove(),this.sliderEl.remove(),this.sliderBufferEl.remove(),this.sliderValueEl.remove(),document.removeEventListener("mouseup",this.stopDrag.bind(this)))}}]),t}(u["default"]);r["default"]=y},{"../get-el-position":3,"../get-pointer-position":4,"@livelyvideo/player-core/lib/logger":19,events:41}],10:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=e("events"),u=n(a),c=e("text-content"),f=n(c),d=function(e){function t(e){i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.controls=e,r.livelyPlayer=e.livelyPlayer,r.bar=e.bar,r.mediaData=null,r.encodings=[],r.el=document.createElement("div"),r.el.setAttribute("title","Quality Selector"),r.qualitiesEl=document.createElement("div"),r.qualitiesEl.setAttribute("class","qualities hidden"),r.el.appendChild(r.qualitiesEl),r.el.addEventListener("click",r.openQualitySelector.bind(r)),r.livelyPlayer.on("progress",function(){r.reclass()}),r.livelyPlayer.on("play",function(){r.render()}),r.controls.bar.appendChild(r.el),r}return s(t,e),l(t,[{key:"openQualitySelector",value:function(e){"qualities"!==this.qualitiesEl.getAttribute("class")&&(this.controls.screenInteraction.lockOpen(),this.qualitiesEl.setAttribute("class","qualities"),e.stopPropagation(),document.addEventListener("click",this.closeQualitySelector.bind(this)))}},{key:"closeQualitySelector",value:function(){this.controls.screenInteraction.releaseLockOpen(),document.removeEventListener("click",this.closeQualitySelector.bind(this)),this.qualitiesEl.setAttribute("class","qualities hidden")}},{key:"destroy",value:function(){document.removeEventListener("click",this.closeQualitySelector.bind(this)),this.qualitiesEl.remove(),this.el.remove()}},{key:"reclass",value:function(){var e=this.livelyPlayer.currentEncoding(),t=void 0,r=void 0;e||(t=this.currentLevel,r=this.nextLevel);for(var n=void 0,i=0;i<this.qualitiesEl.children.length;i++)n=this.qualitiesEl.children[i],i===t||e&&this.qualitiesEl.children[i].getAttribute("data-location")===e.location?n.classList.add("current-level"):n.classList.remove("current-level"),i===r?n.classList.add("next-level"):n.classList.remove("next-level")}},{key:"render",value:function(){var e=this;if(this.encodings.forEach(function(e){e.remove()}),this.encodings=[],this.mediaData=this.livelyPlayer.mediaData,!(this.mediaData&&this.mediaData.encodings&&this.mediaData.encodings.length))return void this.el.setAttribute("class","quality-selector hidden");this.el.setAttribute("class","quality-selector");for(var t=this.livelyPlayer.currentEncoding(),r=this.currentLevel,n=this.chosenLevel,i=this.nextLevel,o=function(o,s){var l=document.createElement("div"),a="quality",u=void 0;o.videoKbps&&(o.videoHeight?(f["default"](l,o.videoHeight+"p - "+(o.videoKbps+o.audioKbps)+"Kbps"),u=o.videoKbps+o.audioKbps,null!==n&&"undefined"!=typeof s&&s===n&&(a+=" selected"),null!==r&&"undefined"!=typeof s&&s===r&&(a+=" current-level"),null!==i&&"undefined"!=typeof s&&s===i&&(a+=" next-level")):(r--,n--,i--,f["default"](l,"Auto"),u=null,null===t&&(a+=" selected")),l.setAttribute("class",a),l.setAttribute("data-location",o.location),l.addEventListener("click",function(){e.livelyPlayer.bitrate=u,e.render()}),e.qualitiesEl.appendChild(l),e.encodings.push(l))};this.qualitiesEl.firstChild;)this.qualitiesEl.removeChild(this.qualitiesEl);this.mediaData.auto&&o({location:this.mediaData.manifest,videoKbps:!0}),this.mediaData.encodings.reverse().forEach(o)}},{key:"chosenLevel",get:function(){return this.mediaData.encodings?this.livelyPlayer.chosenLevel?this.mediaData.encodings.length-this.livelyPlayer.chosenLevel:this.livelyPlayer.chosenLevel:null}},{key:"currentLevel",get:function(){return this.mediaData.encodings?this.livelyPlayer.currentLevel?this.mediaData.encodings.length-this.livelyPlayer.currentLevel:this.livelyPlayer.currentLevel:null}},{key:"nextLevel",get:function(){return this.mediaData.encodings?this.livelyPlayer.nextLevel?this.mediaData.encodings.length-this.livelyPlayer.nextLevel:this.livelyPlayer.nextLevel:null}}]),t}(u["default"]);r["default"]=d},{events:41,"text-content":49}],11:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=e("events"),u=n(a),c=e("@livelyvideo/player-core/lib/detect"),f=n(c),d=e("@livelyvideo/player-core/lib/events"),h=n(d),p=e("lodash.throttle"),v=n(p),y=function(e){function t(e,r){i(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.targetEl=e,n.limit=r||250,n.mobileControls=f["default"].any(),n.userInteraction=null,n.userInteractionTimeout=null,n.disableReset=null,n.throttledSetUserInteraction=v["default"](n.setUserInteraction.bind(n),n.limit,{leading:!0,trailing:!1}),n.handleEvents(),n}return s(t,e),l(t,[{key:"handleEvents",value:function(){var e=this;return this.mobileControls?(this.setUserInteraction(),this.targetEl.addEventListener("touchstart",function(){e.forceInteraction()}),this.targetEl.addEventListener("touchend",function(){e.forceInteractionEnd()}),void this.targetEl.addEventListener("touchcancel",function(){e.forceInteractionEnd()})):(this.targetEl.addEventListener("mousemove",function(t){e.resetUserInteraction(),e.throttledSetUserInteraction(t)}),this.targetEl.addEventListener("mousedown",function(){e.forceInteraction()}),this.targetEl.addEventListener("mouseup",function(){e.forceInteractionEnd()}),void this.targetEl.addEventListener("mouseout",function(){e.forceInteractionEnd()}))}},{key:"forceInteraction",value:function(){this.disableReset=!0,clearTimeout(this.userInteractionTimeout),this.setUserInteraction()}},{key:"lockOpen",value:function(){this.lockedOpen=!0,clearTimeout(this.userInteractionTimeout)}},{key:"releaseLockOpen",value:function(){this.lockedOpen=!1,this.resetUserInteraction()}},{key:"forceInteractionEnd",value:function(){this.disableReset=!1,this.setUserInteraction()}},{key:"setUserInteraction",value:function(){this.userInteraction||(this.userInteraction=!0,this.emit(h["default"].USER_ACTIVE)),this.disableReset||this.resetUserInteraction()}},{key:"resetUserInteraction",value:function(){var e=this;clearTimeout(this.userInteractionTimeout),this.userInteractionTimeout=setTimeout(function(){e.lockedOpen||(e.userInteraction=!1,e.emit(h["default"].USER_IDLE))},2e3)}},{key:"destroy",value:function(){return this.mobileControls?(this.targetEl.removeEventListener("touchstart",this.forceInteraction.bind(this)),this.targetEl.removeEventListener("touchend",this.forceInteractionEnd.bind(this)),void this.targetEl.removeEventListener("touchcancel",this.forceInteractionEnd.bind(this))):(this.targetEl.removeEventListener("mousemove",this.throttledSetUserInteraction.bind(this)),this.targetEl.removeEventListener("mousedown",this.forceInteraction.bind(this)),this.targetEl.removeEventListener("mouseup",this.forceInteractionEnd.bind(this)),void this.targetEl.removeEventListener("mouseout",this.forceInteractionEnd.bind(this)))}}]),t}(u["default"]);r["default"]=y},{"@livelyvideo/player-core/lib/detect":14,"@livelyvideo/player-core/lib/events":16,events:41,"lodash.throttle":46}],12:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=e("events"),u=n(a),c=e("../get-el-position"),f=n(c),d=e("../get-pointer-position"),h=n(d),p=function(e){function t(e){i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.controls=e,r.livelyPlayer=e.livelyPlayer,r.bar=e.bar,r.el=document.createElement("div"),r.indicatorEl=document.createElement("div"),r.indicatorEl.setAttribute("title","Mute"),r.sliderEl=document.createElement("div"),r.sliderValueEl=document.createElement("div"),r.showingSlider=!1,r.hideSlider(),r.indicatorEl.setAttribute("class","indicator"),r.sliderValueEl.setAttribute("class","slider-value"),r.sliderEl.appendChild(r.sliderValueEl),r.setMutedClass(),r.indicatorEl.addEventListener("click",function(e){r.toggleMuted(e)}),r.indicatorEl.addEventListener("touch",function(e){r.toggleMuted(e)}),r.el.addEventListener("mouseover",function(){r.showingSlider=!0,r.showSlider()}),r.el.addEventListener("mouseout",function(){r.showingSlider=!1,r.hideSlider()}),r.sliderEl.addEventListener("click",function(e){r.clickVolume(e)}),r.sliderEl.addEventListener("mousedown",function(e){r.startDrag(e)}),r.el.appendChild(r.indicatorEl),r.el.appendChild(r.sliderEl),r.el.setAttribute("class","volume-bar"),r.bar.appendChild(r.el),r.livelyPlayer.on("mute",function(e){r.setMutedClass(e)}),r.livelyPlayer.on("unmute",function(e){r.setMutedClass(e)}),r.livelyPlayer.on("volume",function(e){r.updateVolume(e)}),r.livelyPlayer.on("play",function(e){r.setMutedClass(e)}),r.updateVolume(),r}return s(t,e),l(t,[{key:"updateVolume",value:function(){this.setMutedClass(),this.setVolume()}},{key:"setMutedClass",value:function(){var e=this.livelyPlayer.muted?"muted":"unmuted";this.indicatorEl.setAttribute("class","indicator "+e);var t=this.livelyPlayer.muted?"Unmute":"Mute";this.indicatorEl.setAttribute("title",t)}},{key:"startDrag",value:function(){this.dragging=!0,document.addEventListener("mousemove",this.calculateVolume.bind(this)),document.addEventListener("mouseup",this.stopDrag.bind(this)),document.addEventListener("mouseleave",this.stopDrag.bind(this))}},{key:"stopDrag",value:function(){this.dragging=!1,this.hideSlider(),document.removeEventListener("mouseup",this.stopDrag.bind(this)),document.removeEventListener("mouseleave",this.stopDrag.bind(this)),document.removeEventListener("mousemove",this.calculateVolume.bind(this))}},{key:"calculateVolume",value:function(e){if(this.dragging){var t=Math.floor(h["default"](e).x-f["default"](this.sliderEl).left)/100;t=Math.max(t,0),t=Math.min(t,1),
this.livelyPlayer.volume=t}}},{key:"clickVolume",value:function(e){this.dragging=!0,this.calculateVolume(e),this.dragging=!1}},{key:"setVolume",value:function(){this.sliderValueEl.style.width=Math.floor(100*this.livelyPlayer.volume)+"%"}},{key:"toggleMuted",value:function(){this.livelyPlayer.muted?this.livelyPlayer.unmute():this.livelyPlayer.mute()}},{key:"showSlider",value:function(){this.sliderEl.setAttribute("class","slider")}},{key:"hideSlider",value:function(){this.dragging||this.showingSlider||this.sliderEl.setAttribute("class","slider hidden")}},{key:"destroy",value:function(){this.el.remove(),this.indicatorEl.remove(),this.sliderEl.remove(),this.sliderValueEl.remove(),this.livelyPlayer.removeListener("mute",this.setMutedClass.bind(this)),this.livelyPlayer.removeListener("unmute",this.setMutedClass.bind(this)),this.livelyPlayer.removeListener("volume",this.updateVolume.bind(this)),this.livelyPlayer.removeListener("play",this.setMutedClass.bind(this))}}]),t}(u["default"]);r["default"]=p},{"../get-el-position":3,"../get-pointer-position":4,events:41}],13:[function(e,t,r){(function(t){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=e("events"),u=n(a),c=e("./logger"),f=n(c),d=e("./detect"),h=n(d),p=e("./errors"),v=n(p),y=e("./events"),m=n(y),b=function(e){function r(e,t,n){i(this,r);var s=o(this,(r.__proto__||Object.getPrototypeOf(r)).call(this));return s.resetCounts(),s.errors={},s.livelyPlayer=e,s.mediaLoader=t,s.options=n,s.onceHandlerLock=!1,s}return s(r,e),l(r,[{key:"resetCounts",value:function(){this.fragCounts=0,this.fragSize=0,this.fragDuration=0,this.fragDownloadTime=0,this.fragMaxTime=0,this.fragMinTime=0,this.bufferOverflowCount=0,this.bufferUnderflowCount=0,this.upshift=0,this.downshift=0,this.lastProgress=0,this.currentErrorCount=0,this.recentErrorCount=0}},{key:"pickEncoding",value:function(e){if(e&&(this.options.bitrate=e),!this.options.bitrate)return null;var t=this.data.encodings;return t.length?t[this.chosenLevel]:void 0}},{key:"whenReady",value:function(e){var t=this;if(!this.onceHandlerLock){var r=this.manifest;return r?void(e&&e()):this.mediaLoader.currentState===m["default"].ONLINE?void this.emit(m["default"].ERROR,v["default"].DRIVER_NOT_SUPPORTED):(this.onceHandlerLock=!0,void this.mediaLoader.once(m["default"].MANIFEST,function(){t.onceHandlerLock=!1,t.whenReady(e)}))}}},{key:"setOption",value:function(e,t){switch(this.options[e]=t,e){case"posterURI":this.el&&this.el.setAttribute("poster",t)}}},{key:"elementPlay",value:function(){if(this.el&&this.el.play){var e=this.el.play();"undefined"!=typeof Promise&&e instanceof Promise&&e["catch"](function(){})}}},{key:"attachListeners",value:function(){var e=this;this.el.onprogress=function(){e.emitProgress()},this.el.ontimeupdate=function(){e.fragCounts++,e.emitTimeupdate()}}},{key:"play",value:function(e){var r=this,n=e||function(){};return this.mediaLoader.vod&&this.manifest&&this.manifest===this.el.getAttribute("src")?(this.elementPlay(),void n(!this.el.paused)):(h["default"].any()&&this.elementPlay(),void this.whenReady(function(){var e=r.manifest;f["default"].setPlayer(r.mediaLoader.host,r.mediaLoader.publicId,r.format,e,r);var i=function(){r.el.onprogress=function(){r.emitProgress()},r.el.ontimeupdate=function(){r.fragCounts++,r.emitTimeupdate()}},o=function(){h["default"].iOS()&&r.el.getAttribute("src")===e||r.el.setAttribute("src",e)};o();var s=r.el.play();return s&&s.then?void s.then(function(){i(),n&&n(!0)})["catch"](function(e){f["default"].debug("video element play error caught",e.message),r.emit("video-el-error",{err:e}),n&&n(!1)}):(i(),void t.nextTick(function(){n&&n(!r.el.paused)}))}))}},{key:"stop",value:function(){this.el.setAttribute("src","")}},{key:"destroy",value:function(){this.el.remove(),this.stop()}},{key:"pause",value:function(){this.el.pause()}},{key:"unmute",value:function(){return this.el.muted=!1,this.el.muted}},{key:"mute",value:function(){return this.el.muted=!0,this.el.muted}},{key:"supportsFullscreen",value:function(){var e=document.createElement("video");return!!(document.fullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitSupportsFullscreen||document.webkitFullscreenEnabled||e.webkitRequestFullScreen||e.webkitEnterFullScreen)}},{key:"restart",value:function(){var e=this;this.lockRestart||(this.lockRestart=!0,this.currentErrorCount=0,this.recentErrorCount=0,this.stop(),this.play(function(){e.lockRestart=!1}))}},{key:"checkRestart",value:function(e){var t=this,r=e;this.recentErrorCount++,setTimeout(function(){t.recentErrorCount--,t.recentErrorCount=Math.max(t.recentErrorCount,0)},1e4),this.recentErrorCount>=this.options.recoverErrorCount&&(r.fatal=!0),this.currentErrorCount>=this.options.recoverErrorCount&&(r.fatal=!0),r.fatal&&!this.mediaLoader.vod&&this.restart()}},{key:"handleError",value:function(e,t,r){var n=t+":"+r.details;this.errors[n]||(this.errors[n]=0),this.errors[n]++;for(var i=arguments.length,o=Array(i>3?i-3:0),s=3;i>s;s++)o[s-3]=arguments[s];this.emit.apply(this,[e,t,r].concat(o))}},{key:"emitProgress",value:function(){this.lastProgress=window.performance.now(),this.emit(m["default"].MEDIA_PROGRESS)}},{key:"emitTimeupdate",value:function(){this.emit(m["default"].MEDIA_TIMEUPDATE)}},{key:"format",get:function(){return this.constructor.format}},{key:"driver",get:function(){return this.constructor.driver}},{key:"duration",get:function(){return this.el&&this.el.duration?this.el.duration:1/0}},{key:"bufferTimes",get:function(){for(var e=[],t=this.el.buffered.length,r=0;t>r;r++)e.push([this.el.buffered.start(r),this.el.buffered.end(r)]);return e}},{key:"volume",get:function(){return this.el.volume},set:function(e){return"undefined"!=typeof e&&(this.el.volume=e),this.el.muted&&e&&e>0&&this.unmute(),this.el.volume}},{key:"supportsAutoplay",get:function(){return!h["default"].any()}},{key:"supportsMobileAutoplay",get:function(){return!1}},{key:"supportsVolume",get:function(){return!0}},{key:"data",get:function(){var e=this.mediaLoader.get(this.format);return e.auto=!0,e}},{key:"chosenLevel",get:function(){if(!this.options.bitrate)return null;var e=this.data.encodings;if(!e.length)return void 0;var t=void 0;for(t=0;t<e.length&&!(e[t].videoWidth&&e[t].videoKbps+e[t].audioKbps>this.options.bitrate);t++);return t=Math.max(t-1,0)}},{key:"currentLevel",get:function(){return this.chosenLevel}},{key:"nextLevel",get:function(){return null}},{key:"manifest",get:function(){var e=this.pickEncoding(),t=void 0;if(t=e?e.location:this.data.manifest,!t)return null;var r=-1===t.indexOf("?")?"?":"&";return null===this.options.preset||(this.options.preset?t=""+t+r+"preset="+this.options.preset:h["default"].any()||(t=""+t+r+"preset=desktop")),t}},{key:"currentTime",get:function(){return this.el.currentTime},set:function(e){this.el.currentTime=e}},{key:"stopped",get:function(){return!!this.el.getAttribute("src","")}},{key:"bitrate",set:function(e){var t=this,r=this.el.currentTime;this.stop(),this.options.bitrate=e,this.mediaLoader.vod&&(this.el.onloadedmetadata=function(){t.el.onloadedmetadata=null,t.el.currentTime=r},this.el.oncanplay=function(){t.el.oncanplay=null,t.el.currentTime>=r||(t.el.currentTime=r)}),this.play(function(){t.emit(m["default"].BITRATE_SWITCH)})}},{key:"muted",get:function(){return!!this.el.muted}},{key:"paused",get:function(){return this.el.paused}},{key:"details",get:function(){return{bufferOverflowCount:this.bufferOverflowCount||0,bufferUnderflowCount:this.bufferUnderflowCount||0,downshift:this.downshift||0,errors:this.errors||{},muted:this.el&&this.el.muted,segments:this.fragCounts||0,segmentsSize:this.fragSize||0,segmentsDuration:this.fragDuration||0,segmentTotalDownloadTime:this.fragDownloadTime||0,segMaxTime:this.fragMaxTime||0,segMinTime:this.fragMinTime||0,upshift:this.upshift||0,volume:this.el&&this.el.volume?this.el.volume:0}}}],[{key:"isSupported",value:function(){f["default"].error("an abstract method has been called")}},{key:"defaultOptions",get:function(){return{adaptive:null,bitrate:null,muted:!1,volume:.75}}}]),r}(u["default"]);r["default"]=b}).call(this,e("_process"))},{"./detect":14,"./errors":15,"./events":16,"./logger":19,_process:40,events:41}],14:[function(e,t,r){"use strict";function n(e,t){return function(){return"undefined"==typeof i[e]&&(i[e]=t()),i[e]}}Object.defineProperty(r,"__esModule",{value:!0});var i={},o={winChrome51:n("winChrome51",function(){if(!o.windowsDesktop())return!1;if(!o.chrome())return!1;for(var e=navigator.userAgent.split(/\s*[;)(]\s*/),t=void 0,r=0;r<e.length;r++)if("Chrome"===e[r].slice(0,6)){t=e[r];break}if(!t)return!1;var n=t.split("/"),i=n[1].split(".");return parseInt(i[0],10)<52?!0:!1}),iPhone9:n("iPhone9",function(){if(!o.iPhone())return!1;for(var e=navigator.userAgent.split(/\s*[;)(]\s*/),t=void 0,r=void 0,n=0;n<e.length;n++){if("Version"===e[n].slice(0,7)){t=e[n];break}if(e.length>0&&"OS"===e[n]&&"iPhone"===e[n-1]){r=e[n+1];break}}if(!t&&!r)return!1;var i=r?r.split("_"):t.split("/");return parseFloat(i[1])<10?!0:!1}),windowsDesktop:n("windowsDesktop",function(){return/Windows/i.test(navigator.userAgent)}),chrome:n("chrome",function(){return/Chrome/i.test(navigator.userAgent)}),firefox:n("firefox",function(){return/Firefox/i.test(navigator.userAgent)}),ie:n("ie",function(){return/Trident/i.test(navigator.userAgent)}),edge:n("edge",function(){return/Edge\/\d+/.test(navigator.userAgent)}),safari:n("safari",function(){return/Safari/i.test(navigator.userAgent)}),windows:n("windows",function(){return/IEMobile/i.test(navigator.userAgent)}),android:n("android",function(){return/Android/i.test(navigator.userAgent)}),blackBerry:n("blackBerry",function(){return/BlackBerry/i.test(navigator.userAgent)}),iOS:n("iOS",function(){return/iPhone|iPad|iPod/i.test(navigator.userAgent)}),iPhone:n("iPhone",function(){return/iPhone/i.test(navigator.userAgent)}),any:n("any",function(){return o.android()||o.blackBerry()||o.iOS()||o.windows()})};r["default"]=o},{}],15:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={BAD_INPUT:"bad-input",DRIVER_NOT_SUPPORTED:"driver-not-supported",ELEMENT_REQUIRED:"element-required",EMBED_SWF_FAILED:"embedding-flash-swf-failed",GET_USER_MEDIA_FAILED:"get-user-media-failed",HTTP_SERVER_INTERNAL_ERROR:"http-server-internal-error",HTTP_SERVER_NOT_FOUND:"http-server-not-found",MANIFEST:"http-response",INVALID_CONTROLS:"invalid-controls-parent",INVALID_MEDIA_URL:"invalid-media-url",INVALID_POPOUT_URL:"invalid-popout-url",INVALID_EL:"invalid-element",WS_NETWORK_ERROR:"websocket-network-error",NETWORK_ERROR:"network-error",NO_DRIVERS:"no-valid-drivers",PLAYBACK_ERROR:"playback-error",UNKNOWN_DRIVER:"unknown-driver",UNKNOWN_ERROR:"unknown-error",UNRECOGNIZED_DRIVER:"unrecognized-driver",USER_REQUIRED:"user-required"};r["default"]=n},{}],16:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={EXIT_FULLSCREEN:"exit-fullscreen",ENTER_FULLSCREEN:"enter-fullscreen",ERROR:"error",BITRATE_SWITCH:"bitrate-switch",SELECT_DRIVER:"select-driver",MANIFEST:"manifest",MEDIA_ENDED:"ended",MEDIA_PLAY:"play",MEDIA_STOP:"stop",MEDIA_PAUSE:"pause",MEDIA_STALL:"stall",MEDIA_PROGRESS:"progress",MEDIA_TIMEUPDATE:"timeupdate",MEDIA_MUTE:"mute",MEDIA_UNMUTE:"unmute",MEDIA_VOLUME:"volume",ONLINE:"online",OFFLINE:"offline",ESTIMATED_BW:"estimated-bw",USER_ACTIVE:"user-active",USER_IDLE:"user-idle"};r["default"]=n},{}],17:[function(e,t,r){"use strict";function n(e,t){return 0===t?e:n(t,e%t)}Object.defineProperty(r,"__esModule",{value:!0}),r["default"]=n},{}],18:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r["default"]=function(e,t){var r=e?Object.create(e):{};if(!t)return r;for(var n in t)"undefined"==typeof r[n]&&(r[n]=t[n]);return r}},{}],19:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("./logger"),o=n(i),s=new o["default"];r["default"]=s},{"./logger":20}],20:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=e("../uuidv4"),l=n(s),a=["debug","error","info","warn","timing","deprecated"],u=function(){function e(){i(this,e),this.sessionKey=l["default"](),this.sessionQueryString="sessionId="+this.sessionKey,this.host=null,this.setLevels(),this.publicKey=null,this.format=null,this.encoding=null,this.disable(),this.enable(),this.logEntries=[]}return o(e,[{key:"setLevels",value:function(e){var t=e||{};this.levels={debug:t.debug||!1,error:t.error||1,warn:t.warn||1,info:t.info||1,timing:t.timing||0}}},{key:"setPlayer",value:function(e,t,r,n,i){this.host=e,this.publicKey=t,this.format=r,this.encoding=n,this.driver=i}},{key:"checkSet",value:function(){return!this.host||!this.publicKey||!this.format}},{key:"levelIsSupported",value:function(e){return-1!==a.indexOf(e)}},{key:"log",value:function(e){var t;if(!this.levelIsSupported(e))return void this.log("error","unsupported log level",{level:e});if(this.levels[e]&&this.writer[e]&&this.writer[e].apply){for(var r=arguments.length,n=Array(r>1?r-1:0),i=1;r>i;i++)n[i-1]=arguments[i];(t=this.writer)[e].apply(t,n),this.apiLogging&&this.host&&this.publicKey&&this.pushBatch(n)}}},{key:"disable",value:function(){this.writer={};for(var e=0;e<a.length;e++)this.writer[a[e]]=function(){}}},{key:"enable",value:function(){window.console&&(this.writer=window.console,this.writer.timing=this.writer.info,this.writer.deprecated=this.writer.info)}},{key:"argJoin",value:function(e,t){for(var r=[e],n=0;n<t.length;n++)r.push(t[n]);return r}},{key:"debug",value:function(){for(var e=arguments.length,t=Array(e),r=0;e>r;r++)t[r]=arguments[r];this.log.apply(this,["debug"].concat(t))}},{key:"error",value:function(){for(var e=arguments.length,t=Array(e),r=0;e>r;r++)t[r]=arguments[r];this.log.apply(this,["error"].concat(t))}},{key:"timing",value:function(){for(var e=arguments.length,t=Array(e),r=0;e>r;r++)t[r]=arguments[r];this.log.apply(this,["timing"].concat(t))}},{key:"info",value:function(){for(var e=arguments.length,t=Array(e),r=0;e>r;r++)t[r]=arguments[r];this.log.apply(this,["info"].concat(t))}},{key:"warn",value:function(){for(var e=arguments.length,t=Array(e),r=0;e>r;r++)t[r]=arguments[r];this.log.apply(this,["warn"].concat(t))}},{key:"deprecated",value:function(){for(var e=arguments.length,t=Array(e),r=0;e>r;r++)t[r]=arguments[r];this.log.apply(this,["deprecated"].concat(t))}}]),e}();r["default"]=u},{"../uuidv4":34}],21:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=e("events"),c=n(u),f=e("xhr"),d=n(f),h=e("./errors"),p=n(h),v=e("./events"),y=n(v),m=e("./parse-url"),b=n(m),g=e("./logger"),E=n(g),w=3e4,_=function(e){function t(e,r){i(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.currentState=y["default"].OFFLINE,n.formats={},n.options=r,n.host=n.options.host||window.location.host,n.setPublicId(e),n.publicId&&(n.options.pollingInterval=parseInt(n.options.pollingInterval,10)),n.options.viewUri&&(n.viewInteral=setInterval(n.trackView.bind(n),w)),n.setUri(e)?(n.trackView(),n.options.pollingInterval?n:o(n)):o(n)}return s(t,e),a(t,[{key:"load",value:function(){var e=this,t=void 0,r=void 0;return"function"==typeof(arguments.length<=0?void 0:arguments[0])?r=arguments.length<=0?void 0:arguments[0]:(t=arguments.length<=0?void 0:arguments[0],r=arguments.length<=1?void 0:arguments[1]),r||(r=function(){}),this.manifest||this.vod?(this.emit(y["default"].MANIFEST,this.currentState),void r()):t||this.uri?("string"!=typeof t||"http://"!==t.slice(0,7)&&"https://"!==t.slice(0,8)||(this.options.mediaLoaderUri=t),this.setUri(t)?void d["default"]({method:"GET",uri:this.uri,json:!0,useXDR:!0},function(t,n,i){var o=void 0;t?o=new Error(p["default"].HTTP_SERVER_INTERNAL_ERROR):n.statusCode>499?o=new Error(p["default"].HTTP_SERVER_INTERNAL_ERROR):n.statusCode>399?o=new Error(p["default"].HTTP_SERVER_NOT_FOUND):e.validateResponse(i)||(o=new Error(p["default"].HTTP_SERVER_UNEXPECTED_RESPONSE)),o&&e.emit(y["default"].ERROR,o.message);var s=void 0;404!==n.statusCode&&i&&i.formats?200===n.statusCode&&(e.uri=i.self):s=y["default"].OFFLINE,s||(e.formats=i.formats,s=Object.keys(i.formats).length?y["default"].ONLINE:y["default"].OFFLINE),e.type=i&&i.type?i.type:"live",e.vod&&clearInterval(e.pollingSetInterval),s!==e.currentState&&e.emit(s),e.currentState=s,e.emit(y["default"].MANIFEST,e.currentState),r()}):void r(new Error(p["default"].INVALID_MEDIA_URL))):void 0}},{key:"trackView",value:function(){this.options.viewUri&&d["default"]({method:"POST",uri:this.options.viewUri},function(e,t,r){e?E["default"].warn("track view failed",e):t.statusCode>399&&E["default"].warn("track view failed",{code:t.statusCode,body:r})})}},{key:"setPublicId",value:function(e){this.type=null,this.formats={},"string"==typeof e?this.publicId=e:"object"===("undefined"==typeof e?"undefined":l(e))&&(this.manifest=e,this.currentState=y["default"].ONLINE,this.type=this.manifest.type,this.formats=this.manifest.formats)}},{key:"validateResponse",value:function(e){return e&&"object"===("undefined"==typeof e?"undefined":l(e))?"object"!==l(e.formats)?!1:!0:!1}},{key:"setUri",value:function(e){return e?this.options.mediaLoaderUri?(this.uri=this.options.mediaLoaderUri,!0):(this.uri=b["default"](this.host).href,this.uri?(this.uri=""+this.uri+this.options.apiPrefix+"/"+e+this.options.apiSuffix,!0):(this.emit(y["default"].ERROR,p["default"].INVALID_MEDIA_URL),!1)):!!this.uri}},{key:"get",value:function(e){if(!this.formats[e])return{type:null,encodings:[],manifest:null,state:y["default"].ONLINE};var t=[];if(this.formats[e].encodings)t=this.formats[e].encodings.sort(function(e,t){return e.videoKbps+e.audioKbps>t.videoKbps+t.audioKbps?1:-1});else for(var r=Object.keys(this.formats[e]).filter(function(e){return!isNaN(e)}).sort(),n=0;n<r.length;n++)t.push(this.formats[e][r[n]]);return{type:this.type,encodings:t,manifest:this.formats[e].manifest,state:y["default"].ONLINE}}},{key:"destroy",value:function(){clearInterval(this.pollingSetInterval)}},{key:"startInterval",value:function(){var e=this;!this.options.pollingInterval||this.manifest||this.vod||(this.pollingSetInterval=setInterval(function(){e.load(e.publicId)},this.options.pollingInterval))}},{key:"vod",get:function(){return"recorded"===this.type}}]),t}(c["default"]);r["default"]=_},{"./errors":15,"./events":16,"./logger":19,"./parse-url":22,events:41,xhr:51}],22:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r["default"]=function(e){var t=document.createElement("a");return t.href=e,t.pathname?{href:t.href,protocol:t.protocol,port:t.port,pathname:t.pathname,search:t.search,host:t.host||window.location.host}:!1}},{}],23:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=e("events"),c=n(u),f=e("./logger"),d=n(f),h=e("./store"),p=n(h),v=e("./stats"),y=e("./media-loader"),m=n(y),b=e("./errors"),g=n(b),E=e("./events"),w=n(E),_=e("./gcd"),P=n(_),O=e("./get-default-options"),k=n(O);e("./polyfills");var L=e("./storage-values"),T=n(L),R=1800,D=600,S={apiPrefix:"/live",apiSuffix:".json",autoplay:!0,bitrate:void 0,debug:!1,flashWmode:"transparent",flashFrameRate:60,fullscreenEl:"parent",forceDrivers:!1,formats:null,maxBufferLength:30,maxBufferSize:6e7,muted:void 0,pollingInterval:1e4,posterURI:null,preset:void 0,recoverErrorCount:10,recoverTimeout:4e3,startTime:0,viewUri:null,volume:.75,flashlsPath:"../dist/flashlsChromeless.swf",strobeSwfPath:"../dist/StrobeMediaPlayback.swf",tfSwfPath:"../dist/thin.swf",avpPath:"../dist/avp.swf",hlsjsPath:null},A=function(e){function t(e,r,n){i(this,t);var s=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));switch(s.availableDrivers=[],"undefined"==typeof e?"undefined":l(e)){case"string":s.el=document.querySelector(e);break;case"object":s.el=e;break;default:s.error(g["default"].INVALID_EL)}if(s.options=k["default"](n,S),s.store=new p["default"],s.firstPlay=!0,"undefined"==typeof s.options.muted){var a=s.store.get(T["default"].muted);s.options.muted=null!==a?"true"===a:s.options.muted}var u=s.store.get(T["default"].volume);s.options.volume=isNaN(parseFloat(u))?s.options.volume:parseFloat(u),s.options.bitrate&&!parseInt(s.options.bitrate,10)&&(s.error(g["default"].INVALD_BITRATE),s.options.bitrate=void 0),"undefined"!=typeof s.options.bitrate&&s.storeBitrate(s.options.bitrate);var c=parseInt(s.store.get(T["default"].lockedKbps),10);if(s.options.bitrate=c||parseInt(s.options.bitrate,10)||null,s.estimatedKbps=parseInt(s.store.get(T["default"].estimatedKbps),10)||R,s.isTryingToPlay=!1,s.shouldTryToPlay=s.options.autoplay,s.options.debug?d["default"].setLevels({debug:!0,error:1,warn:1,info:1,timing:1}):d["default"].setLevels(),s.trackFirstProgress(),s.options.mediaLoaderUri&&d["default"].deprecated("mediaLoaderUri","second argument may now take a uri or publicId"),r)if("string"==typeof r)("http://"===r.slice(0,7)||"https://"===r.slice(0,8))&&(s.options.mediaLoaderUri=r);else if("object"===("undefined"==typeof r?"undefined":l(r)))s.options.mediaLoaderUri=r;else if(null!==r)return d["default"].error("invalid manifest",r),o(s);if(!Array.isArray(s.options.drivers))return d["default"].error("invalid drivers, must be an array",s.options.drivers),o(s);for(var f=0;f<s.options.drivers.length;f++)if("function"!=typeof s.options.drivers[f])return d["default"].error("invalid drivers, each driver must type function, check driver at index "+f),o(s);return s.mediaLoader=s.options.mediaLoader||new m["default"](r,s.options),s.setDrivers(s.options.drivers),s.mediaLoader.on(w["default"].ERROR,s.eventHandler(w["default"].ERROR).bind(s)),s.mediaLoader.on(w["default"].MANIFEST,s.eventHandler(w["default"].MANIFEST).bind(s)),s.mediaLoader.on(w["default"].MANIFEST,function(){return s.mediaLoader.currentState!==w["default"].ONLINE?void s.stop():void(s.shouldTryToPlay&&s.currentDriver&&(s.play(),s.currentDriver.supportsAutoplay||(s.shouldTryToPlay=!1)))}),s.mediaLoader.on(w["default"].ONLINE,function(){s.emit(w["default"].ONLINE)}),s.mediaLoader.on(w["default"].OFFLINE,function(){s.tryingToPlay&&(s.shouldTryToPlay=!0),s.emit(w["default"].OFFLINE)}),s.mediaLoader.load(),s.mediaLoader.startInterval&&s.mediaLoader.startInterval(),s.options.autoplay&&s.currentDriver&&s.currentDriver.elementPlay&&s.currentDriver.elementPlay(),s}return s(t,e),a(t,[{key:"trackFirstProgress",value:function(){var e=this;this.options.autoplay&&(this.autoplayProgressId=v.stats.start(v.STATS_EVENTS.AUTOPLAY_PROGRESS),this.once(w["default"].MEDIA_PROGRESS,function(){v.stats.stop(e.autoplayProgressId,{driver:e.currentDriver.driver})}))}},{key:"setOption",value:function(e,t){this.options[e]=t,this.currentDriver&&this.currentDriver.setOption(e,t)}},{key:"load",value:function(e,t){this.stop(),this.mediaLoader.setPublicId(e),this.mediaLoader.load(e,t)}},{key:"destroy",value:function(){this.mediaLoader.destroy&&(this.mediaLoader.removeAllListeners(w["default"].MANIFEST),this.mediaLoader.removeAllListeners(w["default"].ERROR),this.mediaLoader.destroy());var e=void 0;if(this.currentDriver){this.currentDriver.destroy();for(e in w["default"])this.currentDriver.removeAllListeners(w["default"][e]);this.currentDriver.removeAllListeners(w["default"][e],this.eventHandler(w["default"][e])),this.currentDriver.destroy()}this.removeAllListeners(w["default"].MEDIA_PROGRESS),this.emit(w["default"].DESTROY)}},{key:"storeBitrate",value:function(e){this.store.set(T["default"].lockedKbps,e)}},{key:"restart",value:function(){var e=this.tryingToPlay;this.stop(),this.shouldTryToPlay=e,this.mediaLoader.load()}},{key:"switchDrivers",value:function(e){this.options.drivers=e,this.setDrivers(e),this.restart()}},{key:"getState",value:function(){return this.mediaLoader.currentState}},{key:"eventHandler",value:function(e){var t=this;return function(){for(var r=arguments.length,n=Array(r),i=0;r>i;i++)n[i]=arguments[i];("error"!==e||t._events&&t._events.hasOwnProperty("error"))&&t.emit.apply(t,[e].concat(n))}}},{key:"error",value:function(e,t){(!this._events||this._events.hasOwnProperty("error"))&&this.emit(w["default"].ERROR,e,t),d["default"].warn(e)}},{key:"setDrivers",value:function(e){var t=void 0;this.availableDrivers=[];for(var r=0;r<e.length;r++)t=e[r],t&&t.isSupported()?(this.options.forceDrivers||t.isSupported())&&this.availableDrivers.push(t):d["default"].debug("driver at index "+r+" is not supported");return this.availableDrivers.length?void(this.driver=0):void this.noDrivers()}},{key:"pause",value:function(){this.isTryingToPlay=!1,this.currentDriver&&this.currentDriver.pause(),this.emit(w["default"].MEDIA_PAUSE)}},{key:"noDrivers",value:function(){this.mediaLoader.currentState===w["default"].ONLINE&&this.error(g["default"].NO_DRIVERS)}},{key:"play",value:function(){var e=this;return this.currentDriver?(this.isTryingToPlay=!0,void this.currentDriver.play(function(t){return t?(e.shouldTryToPlay=!1,"true"===e.store.get(T["default"].muted)&&e.currentDriver.mute(),e.firstPlay&&e.vod&&e.options.startTime&&(e.currentDriver.currentTime=e.options.startTime),e.isTryingToPlay=!0,void(e.mediaLoader.state!==w["default"].OFFLINE&&(e.emit(w["default"].MEDIA_PLAY),e.firstPlay=!1))):void(e.isTryingToPlay=!1)})):void this.noDrivers()}},{key:"stop",value:function(){this.isTryingToPlay=!1,this.currentDriver&&this.currentDriver.stop(),this.emit(w["default"].MEDIA_STOP)}},{key:"isTryingToPlayAudio",value:function(){return this.currentDriver?this.currentDriver.isTryingToPlayAudio(this.tryingToPlay):this.tryingToPlay}},{key:"mute",value:function(){if(!this.currentDriver)return this.noDrivers(),null;var e=this.currentDriver.mute();return this.store.set(T["default"].muted,String(e)),this.emit(w["default"].MEDIA_MUTE),e}},{key:"unmute",value:function(){if(!this.currentDriver)return this.noDrivers(),null;var e=this.currentDriver.unmute();return this.store.set(T["default"].muted,String(e)),this.emit(w["default"].MEDIA_UNMUTE),e}},{key:"currentEncoding",value:function(){return this.currentDriver?this.currentDriver.pickEncoding():void 0}},{key:"supportsFullscreen",value:function(){return this.currentDriver?this.currentDriver.supportsFullscreen():null}},{key:"supportsVolume",value:function(){return this.currentDriver?this.currentDriver.supportsVolume():null}},{key:"bitrate",set:function(e){this.storeBitrate(e),this.currentDriver.bitrate=e}},{key:"driver",set:function(e){var t=this;if(!this.availableDrivers[e])return void this.noDrivers();var r=this.availableDrivers[e];this.currentDriver&&this.currentDriver.destroy(),this.currentDriver=new r(this,this.mediaLoader,{bitrate:this.options.bitrate,estimatedKbps:this.estimatedKbps,volume:this.options.volume,muted:this.options.muted,debug:this.options.debug,recoverTimeout:this.options.recoverTimeout,recoverErrorCount:this.options.recoverErrorCount,maxBufferLength:this.options.maxBufferLength,maxBufferSize:this.options.maxBufferSize,preset:this.options.preset,flashlsPath:this.options.flashlsPath,tfSwfPath:this.options.tfSwfPath,strobeSwfPath:this.options.strobeSwfPath,avpPath:this.options.avpPath,hlsjsPath:this.options.hlsjsPath,posterURI:this.options.posterURI,flashFrameRate:this.options.flashFrameRate,flashWmode:this.options.flashWmode}),this.currentDriver.on(w["default"].ERROR,function(r){var n=function(){t.availableDrivers.length&&(t.currentDriver.destroy(),t.availableDrivers.splice(e,1),t.driver=e,t.tryingToPlay&&t.play())};switch(r){case g["default"].EMBED_SWF_FAILED:n();break;case g["default"].DRIVER_NOT_SUPPORTED:n()}}),this.emit(w["default"].SELECT_DRIVER,this.currentDriver),this.currentDriver.on(w["default"].ESTIMATED_BW,function(e){t.store.set(T["default"].estimatedKbps,parseInt(e,10)||D)}),this.currentDriver.on(w["default"].MEDIA_ENDED,function(){t.isTryingToPlay=!1});for(var n in w["default"])this.currentDriver.on(w["default"][n],this.eventHandler(w["default"][n]))}},{key:"duration",get:function(){return this.currentDriver?this.currentDriver.duration:1/0}},{key:"vod",get:function(){return this.mediaLoader?this.mediaLoader.vod:null}},{key:"bufferLength",get:function(){return this.currentDriver?this.currentDriver.bufferLength:0}},{key:"backBufferLength",get:function(){return this.currentDriver?this.currentDriver.backBufferLength:0}},{key:"currentTime",get:function(){return this.currentDriver?this.currentDriver.currentTime:0},set:function(e){this.currentDriver&&(this.currentDriver.currentTime=e)}},{key:"bufferTimes",get:function(){return this.currentDriver?this.currentDriver.bufferTimes:[]}},{key:"tryingToPlay",get:function(){return!!this.isTryingToPlay}},{key:"muted",get:function(){return this.currentDriver?this.currentDriver.muted:(this.noDrivers(),
null)}},{key:"mediaData",get:function(){return this.currentDriver?this.currentDriver.data:null}},{key:"allMediaData",get:function(){for(var e=this.availableDrivers,t=[],r=void 0,n=0;n<e.length;n++)if(r=e[n],r.isSupported&&r.isSupported(this.el)){var i=this.mediaLoader.get(r.format);if(!i.manifest)continue;i.driver=r.driver,t.push(i)}return t}},{key:"volume",set:function(e){if(!this.currentDriver)return void 0;var t=this.currentDriver.volume=e;return this.store.set(T["default"].muted,0===t),this.store.set(T["default"].volume,t),this.emit(w["default"].MEDIA_VOLUME,t),t},get:function(){return this.currentDriver?this.currentDriver.volume:0}},{key:"details",get:function(){return this.currentDriver?this.currentDriver.details:{}}},{key:"chosenLevel",get:function(){return this.currentDriver?this.currentDriver.chosenLevel:void 0}},{key:"currentLevel",get:function(){return this.currentDriver?this.currentDriver.currentLevel:void 0}},{key:"nextLevel",get:function(){return this.currentDriver?this.currentDriver.nextLevel:void 0}},{key:"aspectRatio",get:function(){if(!this.currentDriver)return null;var e=this.currentDriver.data;if(!e)return null;if(!e.encodings||!e.encodings.length)return null;if(!e.encodings[0].videoWidth||!e.encodings[0].videoHeight)return null;var t=P["default"](e.encodings[0].videoWidth,e.encodings[0].videoHeight);return{width:e.encodings[0].videoWidth/t,height:e.encodings[0].videoHeight/t}}}]),t}(c["default"]);r["default"]=A},{"./errors":15,"./events":16,"./gcd":17,"./get-default-options":18,"./logger":19,"./media-loader":21,"./polyfills":24,"./stats":26,"./storage-values":28,"./store":33,events:41}],24:[function(){"use strict";var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};"remove"in window.Element.prototype||(window.Element.prototype.remove=function(){this.parentNode&&this.parentNode.removeChild(this)}),"function"!=typeof Object.create&&(Object.create=function(e){var t=function(){};return function(r,n){if(r!==Object(r)&&null!==r)throw TypeError("Argument must be an object, or null");t.prototype=r||{},n!==e&&Object.defineProperties(t.prototype,n);var i=new t;return t.prototype=null,i}}()),function(){for(var e=0,t=["ms","moz","webkit","o"],r=0;r<t.length&&!window.requestAnimationFrame;++r)window.requestAnimationFrame=window[t[r]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[r]+"CancelAnimationFrame"]||window[t[r]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t){var r=(new Date).getTime(),n=Math.max(0,16-(r-e)),i=window.setTimeout(function(){t(r+n)},n);return e=r+n,i}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})}(),function(e){var t=Date.now?Date.now():+new Date;e.performance=e.performance||{},e.performance.now=e.performance.webkitNow||e.performance.mozNow||e.performance.msNow||function(){return(Date.now?Date.now():+new Date)-t}}(window),Object.keys||(Object.keys=function(){var t=Object.prototype.hasOwnProperty,r=!{toString:null}.propertyIsEnumerable("toString"),n=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],i=n.length;return function(o){if("object"!==("undefined"==typeof o?"undefined":e(o))&&("function"!=typeof o||null===o))throw new TypeError("Object.keys called on non-object");var s=[],l=void 0,a=void 0;for(l in o)t.call(o,l)&&s.push(l);if(r)for(a=0;i>a;a++)t.call(o,n[a])&&s.push(n[a]);return s}}()),"document"in self&&("classList"in document.createElement("_")&&(!document.createElementNS||"classList"in document.createElementNS("http://www.w3.org/2000/svg","g"))?!function(){var e=document.createElement("_");if(e.classList.add("c1","c2"),!e.classList.contains("c2")){var t=function(e){var t=DOMTokenList.prototype[e];DOMTokenList.prototype[e]=function(e){var r,n=arguments.length;for(r=0;n>r;r++)e=arguments[r],t.call(this,e)}};t("add"),t("remove")}if(e.classList.toggle("c3",!1),e.classList.contains("c3")){var r=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(e,t){return 1 in arguments&&!this.contains(e)==!t?t:r.call(this,e)}}e=null}():!function(e){if("Element"in e){var t="classList",r="prototype",n=e.Element[r],i=Object,o=String[r].trim||function(){return this.replace(/^\s+|\s+$/g,"")},s=Array[r].indexOf||function(e){for(var t=0,r=this.length;r>t;t++)if(t in this&&this[t]===e)return t;return-1},l=function(e,t){this.name=e,this.code=DOMException[e],this.message=t},a=function(e,t){if(""===t)throw new l("SYNTAX_ERR","An invalid or illegal string was specified");if(/\s/.test(t))throw new l("INVALID_CHARACTER_ERR","String contains an invalid character");return s.call(e,t)},u=function(e){for(var t=o.call(e.getAttribute("class")||""),r=t?t.split(/\s+/):[],n=0,i=r.length;i>n;n++)this.push(r[n]);this._updateClassName=function(){e.setAttribute("class",this.toString())}},c=u[r]=[],f=function(){return new u(this)};if(l[r]=Error[r],c.item=function(e){return this[e]||null},c.contains=function(e){return e+="",-1!==a(this,e)},c.add=function(){var e,t=arguments,r=0,n=t.length,i=!1;do e=t[r]+"",-1===a(this,e)&&(this.push(e),i=!0);while(++r<n);i&&this._updateClassName()},c.remove=function(){var e,t,r=arguments,n=0,i=r.length,o=!1;do for(e=r[n]+"",t=a(this,e);-1!==t;)this.splice(t,1),o=!0,t=a(this,e);while(++n<i);o&&this._updateClassName()},c.toggle=function(e,t){e+="";var r=this.contains(e),n=r?t!==!0&&"remove":t!==!1&&"add";return n&&this[n](e),t===!0||t===!1?t:!r},c.toString=function(){return this.join(" ")},i.defineProperty){var d={get:f,enumerable:!0,configurable:!0};try{i.defineProperty(n,t,d)}catch(h){-2146823252===h.number&&(d.enumerable=!1,i.defineProperty(n,t,d))}}else i[r].__defineGetter__&&n.__defineGetter__(t,f)}}(self))},{}],25:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={AUTOPLAY_PROGRESS:"autoplay-first-progress",FIRST_LOAD:"first-load"};r["default"]=n},{}],26:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0}),r.STATS_EVENTS=r.stats=void 0;var i=e("./stats"),o=n(i),s=e("./events"),l=n(s),a=new o["default"];r.stats=a,r.STATS_EVENTS=l["default"]},{"./events":25,"./stats":27}],27:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=e("../logger"),l=n(s),a=function(){function e(){i(this,e),this.eventCounter=0,this.timings={}}return o(e,[{key:"start",value:function(e){var t=this.eventCounter++;return this.timings[t]={ms:Date.now(),name:e},t}},{key:"stop",value:function(e,t){if(this.timings[e]){var r=t||{};r.ms=Date.now()-this.timings[e].ms,l["default"].timing(this.timings[e].name,r),delete this.timings[e]}}}]),e}();r["default"]=a},{"../logger":19}],28:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={muted:"lv_muted",volume:"lv_volume",lockedKbps:"lv_locked_kbps",estimatedKbps:"lv_estimated_kbps",autoLastKbps:"lv_auto_last_kbps",hideSuggestion:"lv_hide_suggestion"};r["default"]=n},{}],29:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=function(){function e(){n(this,e)}return i(e,[{key:"set",value:function(){console.error("an abstract method has been called")}},{key:"get",value:function(){console.error("an abstract method has been called")}}]),e}();r["default"]=o},{}],30:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var l=function(){function e(e,t){var r=[],n=!0,i=!1,o=void 0;try{for(var s,l=e[Symbol.iterator]();!(n=(s=l.next()).done)&&(r.push(s.value),!t||r.length!==t);n=!0);}catch(a){i=!0,o=a}finally{try{!n&&l["return"]&&l["return"]()}finally{if(i)throw o}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=e("./base-driver"),c=n(u),f=new RegExp("\\s*;\\s*"),d=function(e){function t(){return i(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s(t,e),a(t,[{key:"parse",value:function(e){var t={};return e?(e.split(f).forEach(function(e){var r=e.split("="),n=l(r,2),i=n[0],o=n[1],s=decodeURIComponent(i),a=decodeURIComponent(o);t[s]=a}),t):t}},{key:"stringify",value:function(e){var t=[];for(var r in e)({}).hasOwnProperty.call(e,r)&&t.push(r+"="+e[r]);return t.join("; ")}},{key:"set",value:function(e,t){document.cookie=e+"="+t}},{key:"get",value:function(e){var t=this.parse(document.cookie);return t[e]||null}}]),t}(c["default"]);r["default"]=d},{"./base-driver":29}],31:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=e("./base-driver"),u=n(a),c=function(e){function t(){return i(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s(t,e),l(t,[{key:"set",value:function(e,t){try{window.localStorage.setItem(e,t)}catch(r){}}},{key:"get",value:function(e){var t=null;try{t=window.localStorage.getItem(e)||null}catch(r){}return t}}]),t}(u["default"]);r["default"]=c},{"./base-driver":29}],32:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=e("./base-driver"),u=n(a),c={},f=function(e){function t(){return i(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s(t,e),l(t,[{key:"set",value:function(e,t){c[e]=t}},{key:"get",value:function(e){return c[e]||null}}]),t}(u["default"]);r["default"]=f},{"./base-driver":29}],33:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=e("./drivers/cookie"),l=n(s),a=e("./drivers/local-storage"),u=n(a),c=e("./drivers/memory"),f=n(c),d=function(){function e(){i(this,e);try{if(window.localStorage)return void(this.driver=new u["default"])}catch(t){}try{if("string"==typeof document.cookie)return void(this.driver=new l["default"])}catch(t){}this.driver=new f["default"]}return o(e,[{key:"set",value:function(e,t){this.driver&&this.driver.set(e,t)}},{key:"get",value:function(e){return this.driver?this.driver.get(e):void 0}}]),e}();r["default"]=d},{"./drivers/cookie":30,"./drivers/local-storage":31,"./drivers/memory":32}],34:[function(e,t,r){"use strict";function n(){for(var e,t=0;16>t;t++)0===(3&t)&&(e=4294967296*Math.random()),o[t]=e>>>((3&t)<<3)&255;return o}function i(e,t){var r=t||0,n=s;return n[e[r++]]+n[e[r++]]+n[e[r++]]+n[e[r++]]+"-"+n[e[r++]]+n[e[r++]]+"-"+n[e[r++]]+n[e[r++]]+"-"+n[e[r++]]+n[e[r++]]+"-"+n[e[r++]]+n[e[r++]]+n[e[r++]]+n[e[r++]]+n[e[r++]]+n[e[r++]]}Object.defineProperty(r,"__esModule",{value:!0}),r["default"]=function(){var e=n();return e[6]=15&e[6]|64,e[8]=63&e[8]|128,i(e)};for(var o=new Array(16),s=[],l={},a=0;256>a;a++)s[a]=(a+256).toString(16).substr(1),l[s[a]]=a},{}],35:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=e("@livelyvideo/player-core/lib/base-driver"),u=n(a),c=e("@livelyvideo/player-core/lib/detect"),f=n(c),d=e("@livelyvideo/player-core/lib/events"),h=n(d),p=e("@livelyvideo/player-core/lib/errors"),v=n(p),y=e("lodash.noop"),m=n(y),b=e("swfobject-amd"),g=n(b),E="11.0.0",w="aiw-swfhls-uniqid",_=0,P=function(e){function t(e,r,n){i(this,t);var s=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r,n));return s.el=e.el,s.fragCounts=0,s.fragSize=0,s.fragDuration=0,s.fragDownloadTime=0,s.fragMaxTime=0,s.fragMinTime=0,s.bufferOverflowCount=0,s.bufferUnderflowCount=0,s.upshift=0,s.downshift=0,s.lastProgress=0,s.currentErrorCount=0,s.recentErrorCount=0,s.errors={},s.livelyPlayer=e,s.mediaLoader=r,s.options=n,s.currentVolume=s.options.volume,s.currentMuted=s.options.muted,s.playingUri=null,s.id=_++,s.cbs={},s.render(),s}return s(t,e),l(t,[{key:"render",value:function(){this.obj=document.createElement("div"),this.obj.addEventListener("click",function(e){e.preventDefault()}),this.el.appendChild(this.obj),this.obj.setAttribute("class","aiw-swf-container"),this.obj.setAttribute("id",w+"-"+this.id)}},{key:"handleEvent",value:function(e,t){switch(e){case"position":this.emitProgress(),this.emitTimeupdate();break;case"state":"PAUSED"===t[0]&&this.emit(h["default"].MEDIA_PAUSE);break;case"PAUSED_BUFFERING":this.emit(h["default"].MEDIA_STALL);break;case"levelLoaded":this.emit("levelLoaded")}}},{key:"getReady",value:function(e){var t=this,r=this.cbs.getReadyCb="flashlsReady"+this.id,n=this.cbs.handleEvent="flashlsHandleEvent"+this.id;this.cbs.flashlsCb="flashlsCb"+this.id,window[this.cbs.getReadyCb]=e,window[this.cbs.handleEvent]=this.handleEvent.bind(this),window[this.cbs.flashlsCb]=function(e,t){"ready"===e&&window[r](),window[n](e,t)},g["default"].embedSWF(this.options.flashlsPath,this.obj.getAttribute("id"),"100%","100%",E,"",{callback:this.cbs.flashlsCb},{scale:"noscale",wmode:this.options.flashWmode,allowscriptaccess:"always",allowFullScreen:"false",hls_initiallivemanifestsize:0,hls_lowbufferlength:0},{},function(e){t.swf=e.ref})}},{key:"pause",value:function(){return this.swf&&"function"==typeof this.swf.playerPause?(this.swf.playerPause(),!0):!1}},{key:"mute",value:function(){return this.swf&&"function"==typeof this.swf.playerVolume?(this.swf.playerVolume(0),this.currentMuted=!0,this.currentMuted):!1}},{key:"unmute",value:function(){return this.swf&&"function"==typeof this.swf.playerVolume?(this.swf.playerVolume(100*this.currentVolume),this.currentMuted=!1,this.currentMuted):!1}},{key:"stop",value:function(){this.playingUri=null,this.pause()}},{key:"destroy",value:function(){this.stop(),this.obj.remove();for(var e in this.cbs)this.cbs[e]=null;this.swf&&this.swf.remove()}},{key:"play",value:function(e){var t=this,r=e||m["default"];return this.playingUri&&this.playingUri===this.manifest?(this.swf.playerResume(),void r(!0)):void this.getReady(function(){t.whenReady(function(){var e=t.manifest;return e||t.mediaLoader.currentState!==h["default"].ONLINE?(t.playingUri=e,t.swf.playerLoad(e),t.options.bitrate&&t.switchBitrate(t.options.bitrate),t.swf.playerPlay(-1),t.swf.playerVolume(t.currentMuted?0:100*t.currentVolume),void t.once(h["default"].MEDIA_PROGRESS,function(){r(!0),r=m["default"]})):void t.emit(h["default"].ERROR,v["default"].DRIVER_NOT_SUPPORTED)})})}},{key:"duration",get:function(){return this.swf&&this.swf.getDuration?this.swf.getDuration():0}},{key:"supportsAutoplay",get:function(){return!0}},{key:"bufferLength",get:function(){return this.swf&&"function"==typeof this.swf.getbufferLength?this.swf.getbufferLength():!1}},{key:"backBufferLength",get:function(){return this.swf&&"function"==typeof this.swf.getbackBufferLength?this.swf.getbackBufferLength():!1}},{key:"bufferTimes",get:function(){return[[this.currentTime-this.backBufferLength,this.currentTime+this.bufferLength]]}},{key:"currentTime",get:function(){return this.swf&&"function"==typeof this.swf.getPosition?this.swf.getPosition():!1},set:function(e){return this.swf&&"function"==typeof this.swf.playerSeek?(this.swf.playerSeek(e),!0):!1}},{key:"currentLevel",get:function(){return this.swf?this.swf.getCurrentLevel():null}},{key:"bitrate",set:function(e){if(this.options.bitrate=e,!e)return this.swf.playerSetNextLevel(-1),void this.emit(h["default"].MEDIA_PLAY);var t=this.data.encodings;if(t&&t.length&&this.swf){var r=void 0;for(r=0;r<t.length&&!(t[r].videoKbps+t[r].audioKbps>e);r++);this.swf.playerSetNextLevel(Math.max(r-1,0)),this.emit(h["default"].MEDIA_PLAY)}}},{key:"volume",get:function(){return this.currentVolume},set:function(e){return this.currentVolume=e,this.swf?("undefined"!=typeof e&&this.swf.playerVolume(100*e),this.currentMuted&&this.unmute(),this.currentVolume):0}},{key:"muted",get:function(){return this.swf&&"function"==typeof this.swf.getMuted?this.currentMuted:!1}},{key:"details",get:function(){var e={};return e=e||{},e.volume=this.currentVolume,e.muted=this.currentMuted,e}},{key:"manifest",get:function(){var e=void 0;if(e=this.data.manifest,!e)return null;var t=-1===e.indexOf("?")?"?":"&";return this.options.preset?e+=t+"preset="+this.options.preset:null===this.options.preset||f["default"].any()||(e+=t+"preset=desktop"),e}}],[{key:"isSupported",value:function(){return g["default"].hasFlashPlayerVersion(E)}},{key:"driver",get:function(){return"flashHls"}},{key:"format",get:function(){return"mp4-hls"}}]),t}(u["default"]);r["default"]=P},{"@livelyvideo/player-core/lib/base-driver":13,"@livelyvideo/player-core/lib/detect":14,"@livelyvideo/player-core/lib/errors":15,"@livelyvideo/player-core/lib/events":16,"lodash.noop":45,"swfobject-amd":48}],36:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=8,s=function(){function e(t){n(this,e),t.on(window.Hls.Events.FRAG_LOADING,this.onFragLoading.bind(this)),t.on(window.Hls.Events.FRAG_LOAD_PROGRESS,this.onFragLoadProgress.bind(this)),t.on(window.Hls.Events.FRAG_LOADED,this.onFragLoaded.bind(this)),t.on(window.Hls.Events.ERROR,this.onError.bind(this)),this.lastLoadedFragLevel=0,this._autoLevelCapping=-1,this._nextAutoLevel=-1,this.hls=t,this.onCheck=this.checkFragProgress.bind(this),this.lastBws=[],this.lastBw=0,this.lastCalculated=0}return i(e,[{key:"getCurrentLevel",value:function(){return this.fragCurrent}},{key:"getNextLevel",value:function(){return this.nextAutoLevel}},{key:"destroy",value:function(){this.clearTimer()}},{key:"onFragLoading",value:function(e,t){this.clearTimer(this.timer),this.timer=setInterval(this.onCheck,100),this.fragCurrent=t.frag}},{key:"calculateLastBw",value:function(){this.lastCalculated=Date.now(),this.lastBws.splice(o);for(var e=0,t=0;t<this.lastBws.length;t++)e+=this.lastBws[t];e=Math.floor(e/this.lastBws.length),this.lastBw=e}},{key:"addBw",value:function(e){this.lastBws.unshift(e),this.calculateLastBw()}},{key:"onFragLoadProgress",value:function(e,t){if(!(this.lastBws.length>o/2)){this.lastfetchduration=(window.performance.now()-t.stats.trequest)/1e3;var r=8*t.stats.loaded/this.lastfetchduration;r&&this.addBw(r)}}},{key:"bufferedInfo",value:function(e,t,r){var n=[],i=void 0,o=void 0,s=void 0,l=void 0,a=void 0;for(e.sort(function(e,t){var r=e.start-t.start;return r?r:t.end-e.end}),a=0;a<e.length;a++){var u=n.length;if(u){var c=n[u-1].end;e[a].start-c<r?e[a].end>c&&(n[u-1].end=e[a].end):n.push(e[a])}else n.push(e[a])}if(n.length&&t<n[0].start)return{len:0,start:t,end:t,nextStart:n[0].start};for(a=0,i=0,o=s=t;a<n.length;a++){var f=n[a].start,d=n[a].end;if(t+r>=f&&d>t)o=f,s=d,i=s-t;else if(f>t+r){l=f;break}}return{len:i,start:o,end:s,nextStart:l}}},{key:"bufferInfo",value:function(e,t,r){if(e){var n=e.buffered,i=[],o=void 0;for(o=0;o<n.length;o++)i.push({start:n.start(o),end:n.end(o)});return this.bufferedInfo(i,t,r)}return{len:0,start:0,end:0,nextStart:void 0}}},{key:"checkFragProgress",value:function(){var e=this.hls,t=e.media,r=this.fragCurrent;if(t&&!t.paused&&t.readyState&&r.autoLevel&&r.level){var n=window.performance.now()-r.trequest;if(!(n<=500*r.duration)){var i=Math.max(1,1e3*r.loaded/n);r.expectedLen<r.loaded&&(r.expectedLen=r.loaded);var o=t.currentTime,s=(r.expectedLen-r.loaded)/i,l=this.bufferInfo(t,o,e.config.maxBufferHole).end-o;if(4*l<r.duration&&s>l){var a=void 0,u=void 0;for(u=r.level-1;u>=0&&(a=r.duration*e.levels[u].bitrate/(5.6*i),!(l>a));u--);s>a&&(u=Math.max(0,u),e.nextLoadLevel=u,r.loader.abort(),this.clearTimer(),e.trigger(window.Hls.Events.FRAG_LOAD_EMERGENCY_ABORTED,{frag:r}))}}}}},{key:"emergencyDrop",value:function(){this.hls.nextLoadLevel=Math.max(0,this.fragCurrent.level-1),this.hls.nextLoadLevel>=this.fragCurrent.level||(this.clearTimer(),this.hls.trigger(window.Hls.Events.FRAG_LOAD_EMERGENCY_ABORTED,{frag:this.fragCurrent}))}},{key:"onFragLoaded",value:function(e,t){this.lastfetchduration=(window.performance.now()-t.stats.trequest)/1e3;var r=8*t.stats.loaded/this.lastfetchduration;r&&this.addBw(r),this.clearTimer(),this.lastLoadedFragLevel=t.frag.level,this._nextAutoLevel=-1}},{key:"onError",value:function(){this.clearTimer()}},{key:"clearTimer",value:function(){this.timer&&(clearInterval(this.timer),this.timer=null)}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(e){this._autoLevelCapping=e}},{key:"nextAutoLevel",get:function(){var e=this.lastBw,t=this.hls,r=void 0,n=void 0,i=void 0;if(-1!==this._autoLevelCapping||!t.levels)return this._autoLevelCapping;if(i=t.levels.length-1,-1!==this._nextAutoLevel)return Math.min(this._nextAutoLevel,i);for(n=0;i>=n;n++)if(r=.7*e,r<t.levels[n].bitrate)return Math.max(0,n-1);return n-1},set:function(e){this._nextAutoLevel=e}}]),e}();r["default"]=s},{}],37:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=function R(e,t,r){null===e&&(e=Function.prototype);var n=Object.getOwnPropertyDescriptor(e,t);if(void 0===n){var i=Object.getPrototypeOf(e);return null===i?void 0:R(i,t,r)}if("value"in n)return n.value;var o=n.get;return void 0===o?void 0:o.call(r)},c=e("@livelyvideo/player-core/lib/base-driver"),f=n(c),d=e("@livelyvideo/player-core/lib/detect"),h=n(d),p=e("@livelyvideo/player-core/lib/logger"),v=n(p),y=e("@livelyvideo/player-core/lib/events"),m=n(y),b=e("@livelyvideo/player-core/lib/errors"),g=n(b),E=e("lodash.noop"),w=n(E),_=e("./abr-controller"),P=n(_),O=50,k=window.Hls,L=function(){var e=document.getElementsByTagName("script"),t=e[e.length-1].src.split("?")[0];return t.split("/").slice(0,-1).join("/")+"/hls.min.js"}(),T=function(e){function t(e,r,n){i(this,t);var s=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r,n));return s.el=document.createElement("video"),s.el.setAttribute("class","aiw-video"),s.options.posterURI&&s.el.setAttribute("poster",s.options.posterURI),s.livelyPlayer.el.appendChild(s.el),s.el.volume=s.options.volume,s.el.muted=s.options.muted,s.options.hlsjsPath=s.options.hlsjsPath||L,s.lastFrag=null,s.loadingHls=!1,s.recoverDecodingErrorDate=null,s.recoverSwapAudioCodecDate=null,s.loadHls(),s.currentLevelInterval=setTimeout(s.saveCurrentLevel.bind(s),1e3),s}return s(t,e),a(t,[{key:"saveCurrentLevel",value:function(){var e=this.currentLevel;if(e){var t=this.data.encodings[e];this.livelyPlayer.store.set("lv_auto_last_kbps",t.audioKbps+t.videoKbps)}}},{key:"loadHls",value:function(e){var t=this,r=e||w["default"];if(k)return void r();if(this.loadingHls)return void setTimeout(function(){t.loadHls(r)},O);this.loadingHls=!0;var n=document.createElement("script");n.setAttribute("src",this.options.hlsjsPath),n.onload=function(){k=window.Hls,t.loadingHls=!1,r()},document.body.appendChild(n)}},{key:"whenReady",value:function(e){var r=this;this.loadHls(function(){u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"whenReady",r).call(r,e)})}},{key:"playNow",value:function(e){var t=this,r=this.manifest,n=e||w["default"];if(!r&&this.mediaLoader.currentState===m["default"].ONLINE)return void this.emit(m["default"].ERROR,g["default"].DRIVER_NOT_SUPPORTED);if(this.hls){if(this.mediaLoader.vod&&r===this.hls.url||this.hls.url===r)return this.elementPlay(),void n(!0);this.destroyHls()}this.el.setAttribute("src",r),this.hls=new k({abrController:P["default"],seekHoleNudgeDuration:.5,debug:this.options.debug,maxBufferLength:this.options.maxBufferLength,maxBufferSize:this.options.maxBufferSize,fragLoadingTimeOut:3900,fragLoadingMaxRetry:2,liveSyncDuration:4}),this.listen(),v["default"].setPlayer(this.mediaLoader.host,this.mediaLoader.publicId,this.format,r),this.hls.loadSource(r),this.hls.attachMedia(this.el),this.elementPlay(),this.hls.on(k.Events.MEDIA_ATTACHED,function(){t.isAttached=!0}),this.hls.on(k.Events.MEDIA_DETACHED,function(){t.isAttached=!1}),this.hls.on(k.Events.MANIFEST_PARSED,function(){t.lastProgress=Date.now()}),null===this.options.bitrate?this.bitrateCap=null:isNaN(this.options.bitrate)||(this.bitrateCap=this.options.bitrate),n(!0)}},{key:"play",value:function(e){var t=this;if(!this.hls||this.el.paused)return this.el.onprogress=null,this.ready?void this.playNow(e):void this.whenReady(function(){t.playNow(e)})}},{key:"switchBitrate",value:function(e){var t=this;if(this.bitrateCap=e,h["default"].firefox()||this.mediaLoader.vod){var r=function(){var e=t.el.currentTime;return t.stop(),t.livelyPlayer.isTryingToPlay()?void t.play(function(){t.mediaLoader.vod&&(t.el.currentTime=e)}):(t.mediaLoader.vod&&(t.el.currentTime=e),{v:void 0})}();if("object"===("undefined"==typeof r?"undefined":l(r)))return r.v}}},{key:"stop",value:function(){this.hls&&this.hls.destroy()}},{key:"pause",value:function(){this.el.pause()}},{key:"destroy",value:function(){this.el.remove(),this.hls&&this.destroyHls()}},{key:"destroyHls",value:function(){this.hls.detachMedia&&this.hls.detachMedia(),this.hls.destroy&&this.hls.destroy(),this.hls=null}},{key:"listen",value:function(){var e=this;this.hls.on(k.Events.ERROR,function(t,r){switch(r.details){case k.ErrorDetails.BUFFER_SEEK_OVER_HOLE:return void e.handleError(m["default"].ERROR,g["default"].PLAYBACK_ERROR,r);case k.ErrorDetails.BUFFER_APPEND_ERROR:case k.ErrorDetails.BUFFER_FULL_ERROR:e.bufferOverflowCount++;break;case k.ErrorDetails.FRAG_LOAD_ERROR:case k.ErrorDetails.FRAG_LOOP_LOADING_ERROR:case k.ErrorDetails.FRAG_LOAD_TIMEOUT:case k.ErrorDetails.FRAG_DECRYPT_ERROR:case k.ErrorDetails.FRAG_PARSING_ERROR:case k.ErrorDetails.BUFFER_APPENDING_ERROR:case k.ErrorDetails.BUFFER_STALLED_ERROR:e.bufferUnderflowCount++}switch(r.type){case k.ErrorTypes.NETWORK_ERROR:r.details!==k.ErrorDetails.FRAG_LOAD_TIMEOUT?e.currentErrorCount++:r.details===k.ErrorDetails.LEVEL_LOAD_TIMEOUT&&(e.currentErrorCount=e.options.recoverErrorCount),e.handleError(m["default"].ERROR,g["default"].NETWORK_ERROR,r);break;case k.ErrorTypes.MEDIA_ERROR:if(r.fatal)return void e.handleMediaError();if(r.details===k.ErrorDetails.BUFFER_STALLED_ERROR)return void e.handleError(m["default"].ERROR,g["default"].PLAYBACK_ERROR,r);r.details===k.ErrorDetails.FRAG_LOOP_LOADING_ERROR&&e.currentErrorCount++,e.handleError(m["default"].ERROR,g["default"].PLAYBACK_ERROR,r);break;case k.ErrorTypes.OTHER_ERROR:e.currentErrorCount++,e.handleError(m["default"].ERROR,g["default"].UNKNOWN_ERROR,r);

break;default:return void v["default"].error("unhandled hlsjs error",t,r)}e.checkRestart(r),v["default"].error(t,r)}),this.el.addEventListener("progress",function(){e.emitProgress()}),this.el.onended=function(){e.emit("ended")},this.el.addEventListener("timeupdate",function(){e.emitTimeupdate()}),this.el.addEventListener("error",function(t){var r=t.currentTarget.error;if(r)switch(r.code){case r.MEDIA_ERR_DECODE:e.handleMediaError();break;case r.MEDIA_ERR_SRC_NOT_SUPPORTED:e.emit(m["default"].ERROR,g["default"].DRIVER_NOT_SUPPORTED)}}),this.hls.on(k.Events.LEVEL_SWITCH,function(t,r){e.bitrateSwitch(r.level)}),this.hls.on(k.Events.FRAG_LOADED,function(t,r){e.loadedFrag(r.frag)})}},{key:"handleMediaError",value:function(){var e=window.performance.now();!this.recoverDecodingErrorDate||e-this.recoverDecodingErrorDate>3e3?(this.recoverDecodingErrorDate=e,this.hls.recoverMediaError()):(!this.recoverSwapAudioCodecDate||e-this.recoverSwapAudioCodecDate>3e3)&&(this.recoverSwapAudioCodecDate=e,this.hls.swapAudioCodec(),this.hls.recoverMediaError())}},{key:"bitrateSwitch",value:function(e){e>this.currentLevel?this.upshift++:this.downshift++,this.emit(m["default"].BITRATE_SWITCH)}},{key:"loadedFrag",value:function(e){var t=e;this.fragCounts++,t.request=this.lastFrag?t.trequest-this.lastFrag.trequest:t.trequest,this.lastFrag=t,this.fragSize+=t.loaded,this.fragDuration+=t.duration,this.fragDownloadTime+=t.request,this.fragMaxTime=Math.max(this.fragMaxTime,t.request),this.fragMinTime=Math.min(this.fragMinTime||t.request,t.request)}},{key:"ready",get:function(){return k&&this.manifest}},{key:"manifest",get:function(){var e=void 0;if(e=this.data.manifest,!e)return null;var t=-1===e.indexOf("?")?"?":"&";null===this.options.preset?e+=t:this.options.preset?e+=t+"preset="+this.options.preset:h["default"].any()||(e+=t+"preset=desktop");var r=this.livelyPlayer.store.get("lv_auto_last_kbps");return r&&(e+="kbps="+r),e}},{key:"bitrateCap",set:function(e){if(this.options.bitrate=e,!e)return this.hls.abrController.autoLevelCapping=-1,void this.emit(m["default"].MEDIA_PLAY);var t=this.data.encodings;if(t&&t.length&&this.hls){var r=void 0;for(r=0;r<t.length&&!(t[r].videoKbps+t[r].audioKbps>e);r++);this.hls.abrController.autoLevelCapping=Math.max(r-1,0),this.emit(m["default"].MEDIA_PLAY)}}},{key:"currentLevel",get:function(){return this.hls&&this.hls.abrController.fragCurrent?this.hls.abrController.fragCurrent.level:void 0}},{key:"nextLevel",get:function(){return this.hls?this.hls.abrController.nextAutoLevel:null}}],[{key:"isSupported",value:function(){return h["default"].winChrome51()?!1:h["default"].android()?!1:!h["default"].safari()||h["default"].android()||h["default"].chrome()||h["default"].ie()?window.MediaSource&&window.MediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'):!1}},{key:"driver",get:function(){return"hlsjs"}},{key:"format",get:function(){return"mp4-hls"}}]),t}(f["default"]);r["default"]=T},{"./abr-controller":36,"@livelyvideo/player-core/lib/base-driver":13,"@livelyvideo/player-core/lib/detect":14,"@livelyvideo/player-core/lib/errors":15,"@livelyvideo/player-core/lib/events":16,"@livelyvideo/player-core/lib/logger":19,"lodash.noop":45}],38:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=function _(e,t,r){null===e&&(e=Function.prototype);var n=Object.getOwnPropertyDescriptor(e,t);if(void 0===n){var i=Object.getPrototypeOf(e);return null===i?void 0:_(i,t,r)}if("value"in n)return n.value;var o=n.get;return void 0===o?void 0:o.call(r)},u=e("@livelyvideo/player-core/lib/base-driver"),c=n(u),f=e("@livelyvideo/player-core/lib/detect"),d=n(f),h=e("@livelyvideo/player-core/lib/events"),p=n(h),v=e("@livelyvideo/player-core/lib/errors"),y=n(v),m=e("lodash.noop"),b=n(m),g={1:"MEDIA_ERR_ABORTED",2:"MEDIA_ERR_NETWORK",3:"MEDIA_ERR_DECODE",4:"MEDIA_ERR_SRC_NOT_SUPPORTED"},E=250,w=function(e){function t(e,r,n){i(this,t);var s=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r,n));return s.el=document.createElement("video"),s.el.setAttribute("class","aiw-video"),s.el.setAttribute("playsinline",!0),s.el.setAttribute("webkit-playsinline",!0),n.autoplay&&s.el.setAttribute("autoplay",!0),s.options.posterURI&&s.el.setAttribute("poster",s.options.posterURI),s.livelyPlayer.el.appendChild(s.el),s.el.volume=s.options.volume,s.el.muted=s.options.muted,s.el.addEventListener(p["default"].ERROR,function(){s.el.getAttribute("src")&&(s.handleError(p["default"].ERROR,y["default"].UNKNOWN_ERROR,{fatal:!0,details:g[s.el.error.code]}),setTimeout(function(){s.livelyPlayer.tryingToPlay&&s.play()},E))}),s.lastProgress=Date.now(),s}return s(t,e),l(t,[{key:"stop",value:function(){a(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"stop",this).call(this),clearInterval(this.progressInterval)}},{key:"play",value:function(e){var r=this,n=e||b["default"];a(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"play",this).call(this,function(e){e&&(r.el.onprogress=function(){r.emitProgress()},r.el.onended=function(){r.emit("ended")},r.el.ontimeupdate=function(){r.fragCounts++,r.emitTimeupdate()}),n(e)})}}],[{key:"isSupported",value:function(){if(d["default"].iPhone9())return!1;var e=document.createElement("video"),t=e.canPlayType&&("maybe"===e.canPlayType("application/vnd.apple.mpegURL")||"probably"===e.canPlayType("application/vnd.apple.mpegURL"));return e.remove(),t}},{key:"driver",get:function(){return"hls"}},{key:"format",get:function(){return"mp4-hls"}}]),t}(c["default"]);r["default"]=w},{"@livelyvideo/player-core/lib/base-driver":13,"@livelyvideo/player-core/lib/detect":14,"@livelyvideo/player-core/lib/errors":15,"@livelyvideo/player-core/lib/events":16,"lodash.noop":45}],39:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=e("@livelyvideo/player-core/lib/base-driver"),u=n(a),c=function(e){function t(e,r,n){i(this,t);var s=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r,n));return s.resetCounts(),s.errors={},s.livelyPlayer=e,s.mediaLoader=r,s.options=n,s.onceHandlerLock=!1,s.el=document.createElement("video"),s.el.setAttribute("type","video/mp4"),s.el.setAttribute("class","aiw-video"),n.autoplay&&s.el.setAttribute("autoplay",!0),s.options.posterURI&&s.el.setAttribute("poster",s.options.posterURI),s.livelyPlayer.el.appendChild(s.el),s.el.volume=s.options.volume,s.el.muted=s.options.muted,s.el.addEventListener("progress",function(){s.emitProgress()}),s}return s(t,e),l(t,[{key:"manifest",get:function(){var e=this.pickEncoding(this.options.bitrate||this.options.estimatedKbps);return e?e.location:null}}],[{key:"isSupported",value:function(){var e=document.createElement("video");return e.canPlayType&&e.canPlayType("video/mp4").replace(/no/,"")}},{key:"driver",get:function(){return"nativeMp4"}},{key:"format",get:function(){return"mp4-http"}}]),t}(u["default"]);r["default"]=c},{"@livelyvideo/player-core/lib/base-driver":13}],40:[function(e,t){function r(){throw new Error("setTimeout has not been defined")}function n(){throw new Error("clearTimeout has not been defined")}function i(e){if(c===setTimeout)return setTimeout(e,0);if((c===r||!c)&&setTimeout)return c=setTimeout,setTimeout(e,0);try{return c(e,0)}catch(t){try{return c.call(null,e,0)}catch(t){return c.call(this,e,0)}}}function o(e){if(f===clearTimeout)return clearTimeout(e);if((f===n||!f)&&clearTimeout)return f=clearTimeout,clearTimeout(e);try{return f(e)}catch(t){try{return f.call(null,e)}catch(t){return f.call(this,e)}}}function s(){v&&h&&(v=!1,h.length?p=h.concat(p):y=-1,p.length&&l())}function l(){if(!v){var e=i(s);v=!0;for(var t=p.length;t;){for(h=p,p=[];++y<t;)h&&h[y].run();y=-1,t=p.length}h=null,v=!1,o(e)}}function a(e,t){this.fun=e,this.array=t}function u(){}var c,f,d=t.exports={};!function(){try{c="function"==typeof setTimeout?setTimeout:r}catch(e){c=r}try{f="function"==typeof clearTimeout?clearTimeout:n}catch(e){f=n}}();var h,p=[],v=!1,y=-1;d.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];p.push(new a(e,t)),1!==p.length||v||i(l)},a.prototype.run=function(){this.fun.apply(null,this.array)},d.title="browser",d.browser=!0,d.env={},d.argv=[],d.version="",d.versions={},d.on=u,d.addListener=u,d.once=u,d.off=u,d.removeListener=u,d.removeAllListeners=u,d.emit=u,d.binding=function(){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(){throw new Error("process.chdir is not supported")},d.umask=function(){return 0}},{}],41:[function(e,t){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function n(e){return"function"==typeof e}function i(e){return"number"==typeof e}function o(e){return"object"==typeof e&&null!==e}function s(e){return void 0===e}t.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(e){if(!i(e)||0>e||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},r.prototype.emit=function(e){var t,r,i,l,a,u;if(this._events||(this._events={}),"error"===e&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;var c=new Error('Uncaught, unspecified "error" event. ('+t+")");throw c.context=t,c}if(r=this._events[e],s(r))return!1;if(n(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:l=Array.prototype.slice.call(arguments,1),r.apply(this,l)}else if(o(r))for(l=Array.prototype.slice.call(arguments,1),u=r.slice(),i=u.length,a=0;i>a;a++)u[a].apply(this,l);return!0},r.prototype.addListener=function(e,t){var i;if(!n(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,n(t.listener)?t.listener:t),this._events[e]?o(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,o(this._events[e])&&!this._events[e].warned&&(i=s(this._maxListeners)?r.defaultMaxListeners:this._maxListeners,i&&i>0&&this._events[e].length>i&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())),this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(e,t){function r(){this.removeListener(e,r),i||(i=!0,t.apply(this,arguments))}if(!n(t))throw TypeError("listener must be a function");var i=!1;return r.listener=t,this.on(e,r),this},r.prototype.removeListener=function(e,t){var r,i,s,l;if(!n(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(r=this._events[e],s=r.length,i=-1,r===t||n(r.listener)&&r.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(o(r)){for(l=s;l-->0;)if(r[l]===t||r[l].listener&&r[l].listener===t){i=l;break}if(0>i)return this;1===r.length?(r.length=0,delete this._events[e]):r.splice(i,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},r.prototype.removeAllListeners=function(e){var t,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(r=this._events[e],n(r))this.removeListener(e,r);else if(r)for(;r.length;)this.removeListener(e,r[r.length-1]);return delete this._events[e],this},r.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?n(this._events[e])?[this._events[e]]:this._events[e].slice():[]},r.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(n(t))return 1;if(t)return t.length}return 0},r.listenerCount=function(e,t){return e.listenerCount(t)}},{}],42:[function(e,t){function r(e,t,r){if(!s(t))throw new TypeError("iterator must be a function");arguments.length<3&&(r=this),"[object Array]"===l.call(e)?n(e,t,r):"string"==typeof e?i(e,t,r):o(e,t,r)}function n(e,t,r){for(var n=0,i=e.length;i>n;n++)a.call(e,n)&&t.call(r,e[n],n,e)}function i(e,t,r){for(var n=0,i=e.length;i>n;n++)t.call(r,e.charAt(n),n,e)}function o(e,t,r){for(var n in e)a.call(e,n)&&t.call(r,e[n],n,e)}var s=e("is-function");t.exports=r;var l=Object.prototype.toString,a=Object.prototype.hasOwnProperty},{"is-function":44}],43:[function(e,t){(function(e){t.exports="undefined"!=typeof window?window:"undefined"!=typeof e?e:"undefined"!=typeof self?self:{}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],44:[function(e,t){function r(e){var t=n.call(e);return"[object Function]"===t||"function"==typeof e&&"[object RegExp]"!==t||"undefined"!=typeof window&&(e===window.setTimeout||e===window.alert||e===window.confirm||e===window.prompt)}t.exports=r;var n=Object.prototype.toString},{}],45:[function(e,t){function r(){}t.exports=r},{}],46:[function(e,t){(function(e){function r(e,t,r){function n(t){var r=v,n=y;return v=y=void 0,O=t,b=e.apply(n,r)}function o(e){return O=e,g=setTimeout(c,t),k?n(e):b}function s(e){var r=e-E,n=e-O,i=t-r;return L?_(i,m-n):i}function u(e){var r=e-E,n=e-O;return void 0===E||r>=t||0>r||L&&n>=m}function c(){var e=P();return u(e)?f(e):void(g=setTimeout(c,s(e)))}function f(e){return g=void 0,T&&v?n(e):(v=y=void 0,b)}function d(){void 0!==g&&clearTimeout(g),O=0,v=E=y=g=void 0}function h(){return void 0===g?b:f(P())}function p(){var e=P(),r=u(e);if(v=arguments,y=this,E=e,r){if(void 0===g)return o(E);if(L)return g=setTimeout(c,t),n(E)}return void 0===g&&(g=setTimeout(c,t)),b}var v,y,m,b,g,E,O=0,k=!1,L=!1,T=!0;if("function"!=typeof e)throw new TypeError(a);return t=l(t)||0,i(r)&&(k=!!r.leading,L="maxWait"in r,m=L?w(l(r.maxWait)||0,t):m,T="trailing"in r?!!r.trailing:T),p.cancel=d,p.flush=h,p}function n(e,t,n){var o=!0,s=!0;if("function"!=typeof e)throw new TypeError(a);return i(n)&&(o="leading"in n?!!n.leading:o,s="trailing"in n?!!n.trailing:s),r(e,t,{leading:o,maxWait:t,trailing:s})}function i(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function o(e){return!!e&&"object"==typeof e}function s(e){return"symbol"==typeof e||o(e)&&E.call(e)==c}function l(e){if("number"==typeof e)return e;if(s(e))return u;if(i(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=i(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(f,"");var r=h.test(e);return r||p.test(e)?v(e.slice(2),r?2:8):d.test(e)?u:+e}var a="Expected a function",u=0/0,c="[object Symbol]",f=/^\s+|\s+$/g,d=/^[-+]0x[0-9a-f]+$/i,h=/^0b[01]+$/i,p=/^0o[0-7]+$/i,v=parseInt,y="object"==typeof e&&e&&e.Object===Object&&e,m="object"==typeof self&&self&&self.Object===Object&&self,b=y||m||Function("return this")(),g=Object.prototype,E=g.toString,w=Math.max,_=Math.min,P=function(){return b.Date.now()};t.exports=n}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],47:[function(e,t){var r=e("trim"),n=e("for-each"),i=function(e){return"[object Array]"===Object.prototype.toString.call(e)};t.exports=function(e){if(!e)return{};var t={};return n(r(e).split("\n"),function(e){var n=e.indexOf(":"),o=r(e.slice(0,n)).toLowerCase(),s=r(e.slice(n+1));"undefined"==typeof t[o]?t[o]=s:i(t[o])?t[o].push(s):t[o]=[t[o],s]}),t}},{"for-each":42,trim:50}],48:[function(t,r){!function(t,n){"undefined"!=typeof r?r.exports=n():"function"==typeof e&&"undefined"!=typeof e.amd?e(n):t.swfobject=n()}(this,function(){function e(){if(!G&&document.getElementsByTagName("body")[0]){try{var e,t=m("span");t.style.display="none",e=F.getElementsByTagName("body")[0].appendChild(t),e.parentNode.removeChild(e),e=null,t=null}catch(r){return}G=!0;for(var n=V.length,i=0;n>i;i++)V[i]()}}function t(e){G?e():V[V.length]=e}function r(e){if(typeof N.addEventListener!=S)N.addEventListener("load",e,!1);else if(typeof F.addEventListener!=S)F.addEventListener("load",e,!1);else if(typeof N.attachEvent!=S)g(N,"onload",e);else if("function"==typeof N.onload){var t=N.onload;N.onload=function(){t(),e()}}else N.onload=e}function n(){var e=F.getElementsByTagName("body")[0],t=m(A);t.setAttribute("style","visibility: hidden;"),t.setAttribute("type",j);var r=e.appendChild(t);if(r){var n=0;!function o(){if(typeof r.GetVariable!=S)try{var s=r.GetVariable("$version");s&&(s=s.split(" ")[1].split(","),$.pv=[b(s[0]),b(s[1]),b(s[2])])}catch(l){$.pv=[8,0,0]}else if(10>n)return n++,void setTimeout(o,10);e.removeChild(t),r=null,i()}()}else i()}function i(){var e=q.length;if(e>0)for(var t=0;e>t;t++){var r=q[t].id,n=q[t].callbackFn,i={success:!1,id:r};if($.pv[0]>0){var u=y(r);if(u)if(!E(q[t].swfVersion)||$.wk&&$.wk<312)if(q[t].expressInstall&&s()){var c={};c.data=q[t].expressInstall,c.width=u.getAttribute("width")||"0",c.height=u.getAttribute("height")||"0",u.getAttribute("class")&&(c.styleclass=u.getAttribute("class")),u.getAttribute("align")&&(c.align=u.getAttribute("align"));for(var f={},d=u.getElementsByTagName("param"),h=d.length,p=0;h>p;p++)"movie"!=d[p].getAttribute("name").toLowerCase()&&(f[d[p].getAttribute("name")]=d[p].getAttribute("value"));l(c,f,r,n)}else a(u),n&&n(i);else _(r,!0),n&&(i.success=!0,i.ref=o(r),i.id=r,n(i))}else if(_(r,!0),n){var v=o(r);v&&typeof v.SetVariable!=S&&(i.success=!0,i.ref=v,i.id=v.id),n(i)}}}function o(e){var t=null,r=y(e);return r&&"OBJECT"===r.nodeName.toUpperCase()&&(t=typeof r.SetVariable!==S?r:r.getElementsByTagName(A)[0]||r),t}function s(){return!W&&E("6.0.65")&&($.win||$.mac)&&!($.wk&&$.wk<312)}function l(e,t,r,n){var i=y(r);if(r=v(r),W=!0,L=n||null,T={success:!1,id:r},i){"OBJECT"==i.nodeName.toUpperCase()?(O=u(i),k=null):(O=i,k=r),e.id=M,(typeof e.width==S||!/%$/.test(e.width)&&b(e.width)<310)&&(e.width="310"),(typeof e.height==S||!/%$/.test(e.height)&&b(e.height)<137)&&(e.height="137"),F.title=F.title.slice(0,47)+" - Flash Player Installation";var o=$.ie?"ActiveX":"PlugIn",s="MMredirectURL="+encodeURIComponent(N.location.toString().replace(/&/g,"%26"))+"&MMplayerType="+o+"&MMdoctitle="+F.title;if(typeof t.flashvars!=S?t.flashvars+="&"+s:t.flashvars=s,$.ie&&4!=i.readyState){var l=m("div");r+="SWFObjectNew",l.setAttribute("id",r),i.parentNode.insertBefore(l,i),i.style.display="none",h(i)}f(e,t,r)}}function a(e){if($.ie&&4!=e.readyState){e.style.display="none";var t=m("div");e.parentNode.insertBefore(t,e),t.parentNode.replaceChild(u(e),t),h(e)}else e.parentNode.replaceChild(u(e),e)}function u(e){var t=m("div");if($.win&&$.ie)t.innerHTML=e.innerHTML;else{var r=e.getElementsByTagName(A)[0];if(r){var n=r.childNodes;if(n)for(var i=n.length,o=0;i>o;o++)1==n[o].nodeType&&"PARAM"==n[o].nodeName||8==n[o].nodeType||t.appendChild(n[o].cloneNode(!0))}}return t}function c(e,t){var r=m("div");return r.innerHTML="<object classid='clsid:D27CDB6E-AE6D-11cf-96B8-444553540000'><param name='movie' value='"+e+"'>"+t+"</object>",r.firstChild}function f(e,t,r){var n,i=y(r);if(r=v(r),$.wk&&$.wk<312)return n;if(i){var o,s,l,a=m($.ie?"div":A);typeof e.id==S&&(e.id=r);for(l in t)t.hasOwnProperty(l)&&"movie"!==l.toLowerCase()&&d(a,l,t[l]);$.ie&&(a=c(e.data,a.innerHTML));for(o in e)e.hasOwnProperty(o)&&(s=o.toLowerCase(),"styleclass"===s?a.setAttribute("class",e[o]):"classid"!==s&&"data"!==s&&a.setAttribute(o,e[o]));$.ie?H[H.length]=e.id:(a.setAttribute("type",j),a.setAttribute("data",e.data)),i.parentNode.replaceChild(a,i),n=a}return n}function d(e,t,r){var n=m("param");n.setAttribute("name",t),n.setAttribute("value",r),e.appendChild(n)}function h(e){var t=y(e);t&&"OBJECT"==t.nodeName.toUpperCase()&&($.ie?(t.style.display="none",function r(){if(4==t.readyState){for(var e in t)"function"==typeof t[e]&&(t[e]=null);t.parentNode.removeChild(t)}else setTimeout(r,10)}()):t.parentNode.removeChild(t))}function p(e){return e&&e.nodeType&&1===e.nodeType}function v(e){return p(e)?e.id:e}function y(e){if(p(e))return e;var t=null;try{t=F.getElementById(e)}catch(r){}return t}function m(e){return F.createElement(e)}function b(e){return parseInt(e,10)}function g(e,t,r){e.attachEvent(t,r),K[K.length]=[e,t,r]}function E(e){e+="";var t=$.pv,r=e.split(".");return r[0]=b(r[0]),r[1]=b(r[1])||0,r[2]=b(r[2])||0,t[0]>r[0]||t[0]==r[0]&&t[1]>r[1]||t[0]==r[0]&&t[1]==r[1]&&t[2]>=r[2]?!0:!1}function w(e,t,r,n){var i=F.getElementsByTagName("head")[0];if(i){var o="string"==typeof r?r:"screen";if(n&&(R=null,D=null),!R||D!=o){var s=m("style");s.setAttribute("type","text/css"),s.setAttribute("media",o),R=i.appendChild(s),$.ie&&typeof F.styleSheets!=S&&F.styleSheets.length>0&&(R=F.styleSheets[F.styleSheets.length-1]),D=o}R&&(typeof R.addRule!=S?R.addRule(e,t):typeof F.createTextNode!=S&&R.appendChild(F.createTextNode(e+" {"+t+"}")))}}function _(e,t){if(X){var r=t?"visible":"hidden",n=y(e);G&&n?n.style.visibility=r:"string"==typeof e&&w("#"+e,"visibility:"+r)}}function P(e){var t=/[\\\"<>\.;]/,r=null!=t.exec(e);return r&&typeof encodeURIComponent!=S?encodeURIComponent(e):e}{var O,k,L,T,R,D,S="undefined",A="object",I="Shockwave Flash",C="ShockwaveFlash.ShockwaveFlash",j="application/x-shockwave-flash",M="SWFObjectExprInst",x="onreadystatechange",N=window,F=document,U=navigator,B=!1,V=[],q=[],H=[],K=[],G=!1,W=!1,X=!0,z=!1,$=function(){var e=typeof F.getElementById!=S&&typeof F.getElementsByTagName!=S&&typeof F.createElement!=S,t=U.userAgent.toLowerCase(),r=U.platform.toLowerCase(),n=/win/.test(r?r:t),i=/mac/.test(r?r:t),o=/webkit/.test(t)?parseFloat(t.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):!1,s="Microsoft Internet Explorer"===U.appName,l=[0,0,0],a=null;if(typeof U.plugins!=S&&typeof U.plugins[I]==A)a=U.plugins[I].description,a&&typeof U.mimeTypes!=S&&U.mimeTypes[j]&&U.mimeTypes[j].enabledPlugin&&(B=!0,s=!1,a=a.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),l[0]=b(a.replace(/^(.*)\..*$/,"$1")),l[1]=b(a.replace(/^.*\.(.*)\s.*$/,"$1")),l[2]=/[a-zA-Z]/.test(a)?b(a.replace(/^.*[a-zA-Z]+(.*)$/,"$1")):0);else if(typeof N.ActiveXObject!=S)try{var u=new ActiveXObject(C);u&&(a=u.GetVariable("$version"),a&&(s=!0,a=a.split(" ")[1].split(","),l=[b(a[0]),b(a[1]),b(a[2])]))}catch(c){}return{w3:e,pv:l,wk:o,ie:s,win:n,mac:i}}();!function(){$.w3&&((typeof F.readyState!=S&&("complete"===F.readyState||"interactive"===F.readyState)||typeof F.readyState==S&&(F.getElementsByTagName("body")[0]||F.body))&&e(),G||(typeof F.addEventListener!=S&&F.addEventListener("DOMContentLoaded",e,!1),$.ie&&(F.attachEvent(x,function t(){"complete"==F.readyState&&(F.detachEvent(x,t),e())}),N==top&&!function r(){if(!G){try{F.documentElement.doScroll("left")}catch(t){return void setTimeout(r,0)}e()}}()),$.wk&&!function n(){return G?void 0:/loaded|complete/.test(F.readyState)?void e():void setTimeout(n,0)}()))}()}V[0]=function(){B?n():i()};!function(){$.ie&&window.attachEvent("onunload",function(){for(var e=K.length,t=0;e>t;t++)K[t][0].detachEvent(K[t][1],K[t][2]);for(var r=H.length,n=0;r>n;n++)h(H[n]);for(var i in $)$[i]=null;if($=null,"undefined"!=typeof swfobject){for(var o in swfobject)swfobject[o]=null;swfobject=null}})}();return{registerObject:function(e,t,r,n){if($.w3&&e&&t){var i={};i.id=e,i.swfVersion=t,i.expressInstall=r,i.callbackFn=n,q[q.length]=i,_(e,!1)}else n&&n({success:!1,id:e})},getObjectById:function(e){return $.w3?o(e):void 0},embedSWF:function(e,r,n,i,o,a,u,c,d,h){var p=v(r),y={success:!1,id:p};$.w3&&!($.wk&&$.wk<312)&&e&&r&&n&&i&&o?(_(p,!1),t(function(){n+="",i+="";var t={};if(d&&typeof d===A)for(var v in d)t[v]=d[v];t.data=e,t.width=n,t.height=i;var m={};if(c&&typeof c===A)for(var b in c)m[b]=c[b];if(u&&typeof u===A)for(var g in u)if(u.hasOwnProperty(g)){var w=z?encodeURIComponent(g):g,P=z?encodeURIComponent(u[g]):u[g];typeof m.flashvars!=S?m.flashvars+="&"+w+"="+P:m.flashvars=w+"="+P}if(E(o)){var O=f(t,m,r);t.id==p&&_(p,!0),y.success=!0,y.ref=O,y.id=O.id}else{if(a&&s())return t.data=a,void l(t,m,r,h);_(p,!0)}h&&h(y)})):h&&h(y)},switchOffAutoHideShow:function(){X=!1},enableUriEncoding:function(e){z=typeof e===S?!0:e},ua:$,getFlashPlayerVersion:function(){return{major:$.pv[0],minor:$.pv[1],release:$.pv[2]}},hasFlashPlayerVersion:E,createSWF:function(e,t,r){return $.w3?f(e,t,r):void 0},showExpressInstall:function(e,t,r,n){$.w3&&s()&&l(e,t,r,n)},removeSWF:function(e){$.w3&&h(e)},createCSS:function(e,t,r,n){$.w3&&w(e,t,r,n)},addDomLoadEvent:t,addLoadEvent:r,getQueryParamValue:function(e){var t=F.location.search||F.location.hash;if(t){if(/\?/.test(t)&&(t=t.split("?")[1]),null==e)return P(t);for(var r=t.split("&"),n=0;n<r.length;n++)if(r[n].substring(0,r[n].indexOf("="))==e)return P(r[n].substring(r[n].indexOf("=")+1))}return""},expressInstallCallback:function(){if(W){var e=y(M);e&&O&&(e.parentNode.replaceChild(O,e),k&&(_(k,!0),$.ie&&(O.style.display="block")),L&&L(T)),W=!1}},version:"2.3"}})},{}],49:[function(e,t){t.exports=function(e,t){var r=void 0!==e.textContent?"textContent":"innerText";return"undefined"!=typeof t&&(e[r]=t),e[r]}},{}],50:[function(e,t,r){function n(e){return e.replace(/^\s*|\s*$/g,"")}r=t.exports=n,r.left=function(e){return e.replace(/^\s*/,"")},r.right=function(e){return e.replace(/\s*$/,"")}},{}],51:[function(e,t){"use strict";function r(e,t){for(var r=0;r<e.length;r++)t(e[r])}function n(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}function i(e,t,r){var n=e;return c(t)?(r=t,"string"==typeof e&&(n={uri:e})):n=d(t,{uri:e}),n.callback=r,n}function o(e,t,r){return t=i(e,t,r),s(t)}function s(e){function t(){4===d.readyState&&s()}function r(){var e=void 0;if(e=d.response?d.response:d.responseText||l(d),w)try{e=JSON.parse(e)}catch(t){}return e}function i(e){return clearTimeout(v),e instanceof Error||(e=new Error(""+(e||"Unknown XMLHttpRequest Error"))),e.statusCode=0,u(e,c)}function s(){if(!p){var t;clearTimeout(v),t=e.useXDR&&void 0===d.status?200:1223===d.status?204:d.status;var n=c,i=null;return 0!==t?(n={body:r(),statusCode:t,method:m,headers:{},url:y,rawRequest:d},d.getAllResponseHeaders&&(n.headers=f(d.getAllResponseHeaders()))):i=new Error("Internal XMLHttpRequest Error"),u(i,n,n.body)}}if("undefined"==typeof e.callback)throw new Error("callback argument missing");var a=!1,u=function(t,r,n){a||(a=!0,e.callback(t,r,n))},c={body:void 0,headers:{},statusCode:0,method:m,url:y,rawRequest:d},d=e.xhr||null;d||(d=e.cors||e.useXDR?new o.XDomainRequest:new o.XMLHttpRequest);var h,p,v,y=d.url=e.uri||e.url,m=d.method=e.method||"GET",b=e.body||e.data||null,g=d.headers=e.headers||{},E=!!e.sync,w=!1;if("json"in e&&(w=!0,g.accept||g.Accept||(g.Accept="application/json"),"GET"!==m&&"HEAD"!==m&&(g["content-type"]||g["Content-Type"]||(g["Content-Type"]="application/json"),b=JSON.stringify(e.json))),d.onreadystatechange=t,d.onload=s,d.onerror=i,d.onprogress=function(){},d.ontimeout=i,d.open(m,y,!E,e.username,e.password),E||(d.withCredentials=!!e.withCredentials),!E&&e.timeout>0&&(v=setTimeout(function(){p=!0,d.abort("timeout");var e=new Error("XMLHttpRequest timeout");e.code="ETIMEDOUT",i(e)},e.timeout)),d.setRequestHeader)for(h in g)g.hasOwnProperty(h)&&d.setRequestHeader(h,g[h]);else if(e.headers&&!n(e.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in e&&(d.responseType=e.responseType),"beforeSend"in e&&"function"==typeof e.beforeSend&&e.beforeSend(d),d.send(b),d}function l(e){if("document"===e.responseType)return e.responseXML;var t=204===e.status&&e.responseXML&&"parsererror"===e.responseXML.documentElement.nodeName;return""!==e.responseType||t?null:e.responseXML}function a(){}var u=e("global/window"),c=e("is-function"),f=e("parse-headers"),d=e("xtend");t.exports=o,o.XMLHttpRequest=u.XMLHttpRequest||a,o.XDomainRequest="withCredentials"in new o.XMLHttpRequest?o.XMLHttpRequest:u.XDomainRequest,r(["get","put","post","patch","head","delete"],function(e){o["delete"===e?"del":e]=function(t,r,n){return r=i(t,r,n),r.method=e.toUpperCase(),s(r)}})},{"global/window":43,"is-function":44,"parse-headers":47,xtend:52}],52:[function(e,t){function r(){for(var e={},t=0;t<arguments.length;t++){var r=arguments[t];for(var i in r)n.call(r,i)&&(e[i]=r[i])}return e}t.exports=r;var n=Object.prototype.hasOwnProperty},{}],53:[function(e,t){"use strict";t.exports="undefined"==typeof window?function(){}:e("./stock-vod-player")["default"]},{"./stock-vod-player":54}],54:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=e("events"),u=n(a),c=e("@livelyvideo/player-core/lib/player"),f=n(c),d=e("@livelyvideo/player-hlsjs-driver/lib/driver"),h=n(d),p=e("@livelyvideo/player-native-hls-driver/lib/driver"),v=n(p),y=e("@livelyvideo/player-native-mp4-driver/lib/driver"),m=n(y),b=e("@livelyvideo/player-flash-hls-driver/lib/driver"),g=n(b),E=e("@livelyvideo/player-controls/lib/index"),w=n(E),_=function(e){function t(e,r,n,s){i(this,t);var l=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));l.el=e,l.playerEl=document.createElement("div"),l.controlsEl=document.createElement("div"),l.el.appendChild(l.playerEl),l.el.appendChild(l.controlsEl);var a=[];if(n.drivers)for(var u=0;u<n.drivers.length;u++)switch(n.drivers[u]){case"hlsjs":a.push(h["default"]);break;case"hls":a.push(v["default"]);break;case"flashHls":a.push(g["default"]);break;case"mp4":a.push(m["default"])}else a=[h["default"]];return n.drivers=a,
l.player=new f["default"](l.playerEl,r,n),l.controls=new w["default"](l.controlsEl,s),l.controls.attach(l.player),l}return s(t,e),l(t,[{key:"destroy",value:function(){this.playerEl.remove(),this.controlsEl.remove(),this.controls.destroy(),this.player.destroy()}}]),t}(u["default"]);r["default"]=_},{"@livelyvideo/player-controls/lib/index":5,"@livelyvideo/player-core/lib/player":23,"@livelyvideo/player-flash-hls-driver/lib/driver":35,"@livelyvideo/player-hlsjs-driver/lib/driver":37,"@livelyvideo/player-native-hls-driver/lib/driver":38,"@livelyvideo/player-native-mp4-driver/lib/driver":39,events:41}]},{},[53])(53)});
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{}],3:[function(require,module,exports){
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.LivelyUpload=e():t.LivelyUpload=e()}(this,function(){return function(t){function e(n){if(r[n])return r[n].exports;var i=r[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var r={};return e.m=t,e.c=r,e.i=function(t){return t},e.d=function(t,e,r){Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var r=t&&t.__esModule?function(){return t["default"]}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=17)}([function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.EVENTS={UPLOAD_START:"start",UPLOAD_SUCCESS:"success",UPLOAD_FAILURE:"failure",UPLOAD_ADDEDFILE:"addedfile",UPLOAD_CONFIG:"config",UPLOAD_PROGRESS:"progress",UPLOAD_THUMBNAIL:"thumbnail",FORM_DROP:"drop",FORM_DRAG:"drag",FORM_DRAGSTART:"dragstart",FORM_DRAGEND:"dragend",FORM_DRAGENTER:"dragenter",FORM_DRAGOVER:"dragover",FORM_DRAGLEAVE:"dragleave"},e.MESSAGES={ERROR_NETWORK:"Network error.",ERROR_DUP_FILE:"This file has already been uploaded.",ERROR_FILE_NAME:"This file does not have a name.",ERROR_FILE_EXT:"This file extension is not supported.",ERROR_MISSING_BODY:"This file does not have any data.",ERROR_FILE_SIZE:"This file exceeds max file size.",ERROR_UNAUTH:"The user is not authorized to perform this action.",ERROR_DEFAULT:"Error.",ERROR_CANCEL:"Upload has been canceled.",ERROR_URL:"Invalid url",ERROR_EL:"The constructor has not been given a valid element or selector.",UNSUPPORTED_BROWSER:"Your browser does not support HTML5 upload. We recommend upgrading your browser.",TITLE:"Drop files here or click to upload.",SUBTITLE:"Max file size 48Mb.",LEGACY_TITLE:"Click to upload.",LEGACY_SUBTITLE:"File preview and drag and drop unavailable. Please upgrade your browser for a better experience."}},function(t,e){!function(t){"use strict";function e(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function r(t){return"string"!=typeof t&&(t=String(t)),t}function n(t){var e={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return y.iterable&&(e[Symbol.iterator]=function(){return e}),e}function i(t){this.map={},t instanceof i?t.forEach(function(t,e){this.append(e,t)},this):t&&Object.getOwnPropertyNames(t).forEach(function(e){this.append(e,t[e])},this)}function o(t){return t.bodyUsed?Promise.reject(new TypeError("Already read")):void(t.bodyUsed=!0)}function s(t){return new Promise(function(e,r){t.onload=function(){e(t.result)},t.onerror=function(){r(t.error)}})}function u(t){var e=new FileReader;return e.readAsArrayBuffer(t),s(e)}function a(t){var e=new FileReader;return e.readAsText(t),s(e)}function l(){return this.bodyUsed=!1,this._initBody=function(t){if(this._bodyInit=t,"string"==typeof t)this._bodyText=t;else if(y.blob&&Blob.prototype.isPrototypeOf(t))this._bodyBlob=t;else if(y.formData&&FormData.prototype.isPrototypeOf(t))this._bodyFormData=t;else if(y.searchParams&&URLSearchParams.prototype.isPrototypeOf(t))this._bodyText=t.toString();else if(t){if(!y.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(t))throw new Error("unsupported BodyInit type")}else this._bodyText="";this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):y.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},y.blob?(this.blob=function(){var t=o(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this.blob().then(u)},this.text=function(){var t=o(this);if(t)return t;if(this._bodyBlob)return a(this._bodyBlob);if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)}):this.text=function(){var t=o(this);return t?t:Promise.resolve(this._bodyText)},y.formData&&(this.formData=function(){return this.text().then(h)}),this.json=function(){return this.text().then(JSON.parse)},this}function f(t){var e=t.toUpperCase();return v.indexOf(e)>-1?e:t}function c(t,e){e=e||{};var r=e.body;if(c.prototype.isPrototypeOf(t)){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new i(t.headers)),this.method=t.method,this.mode=t.mode,r||(r=t._bodyInit,t.bodyUsed=!0)}else this.url=t;if(this.credentials=e.credentials||this.credentials||"omit",!e.headers&&this.headers||(this.headers=new i(e.headers)),this.method=f(e.method||this.method||"GET"),this.mode=e.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&r)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(r)}function h(t){var e=new FormData;return t.trim().split("&").forEach(function(t){if(t){var r=t.split("="),n=r.shift().replace(/\+/g," "),i=r.join("=").replace(/\+/g," ");e.append(decodeURIComponent(n),decodeURIComponent(i))}}),e}function p(t){var e=new i,r=(t.getAllResponseHeaders()||"").trim().split("\n");return r.forEach(function(t){var r=t.trim().split(":"),n=r.shift().trim(),i=r.join(":").trim();e.append(n,i)}),e}function d(t,e){e||(e={}),this.type="default",this.status=e.status,this.ok=this.status>=200&&this.status<300,this.statusText=e.statusText,this.headers=e.headers instanceof i?e.headers:new i(e.headers),this.url=e.url||"",this._initBody(t)}if(!t.fetch){var y={searchParams:"URLSearchParams"in t,iterable:"Symbol"in t&&"iterator"in Symbol,blob:"FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(t){return!1}}(),formData:"FormData"in t,arrayBuffer:"ArrayBuffer"in t};i.prototype.append=function(t,n){t=e(t),n=r(n);var i=this.map[t];i||(i=[],this.map[t]=i),i.push(n)},i.prototype["delete"]=function(t){delete this.map[e(t)]},i.prototype.get=function(t){var r=this.map[e(t)];return r?r[0]:null},i.prototype.getAll=function(t){return this.map[e(t)]||[]},i.prototype.has=function(t){return this.map.hasOwnProperty(e(t))},i.prototype.set=function(t,n){this.map[e(t)]=[r(n)]},i.prototype.forEach=function(t,e){Object.getOwnPropertyNames(this.map).forEach(function(r){this.map[r].forEach(function(n){t.call(e,n,r,this)},this)},this)},i.prototype.keys=function(){var t=[];return this.forEach(function(e,r){t.push(r)}),n(t)},i.prototype.values=function(){var t=[];return this.forEach(function(e){t.push(e)}),n(t)},i.prototype.entries=function(){var t=[];return this.forEach(function(e,r){t.push([r,e])}),n(t)},y.iterable&&(i.prototype[Symbol.iterator]=i.prototype.entries);var v=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];c.prototype.clone=function(){return new c(this)},l.call(c.prototype),l.call(d.prototype),d.prototype.clone=function(){return new d(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new i(this.headers),url:this.url})},d.error=function(){var t=new d(null,{status:0,statusText:""});return t.type="error",t};var _=[301,302,303,307,308];d.redirect=function(t,e){if(_.indexOf(e)===-1)throw new RangeError("Invalid status code");return new d(null,{status:e,headers:{location:t}})},t.Headers=i,t.Request=c,t.Response=d,t.fetch=function(t,e){return new Promise(function(r,n){function i(){return"responseURL"in s?s.responseURL:/^X-Request-URL:/m.test(s.getAllResponseHeaders())?s.getResponseHeader("X-Request-URL"):void 0}var o;o=c.prototype.isPrototypeOf(t)&&!e?t:new c(t,e);var s=new XMLHttpRequest;s.onload=function(){var t={status:s.status,statusText:s.statusText,headers:p(s),url:i()},e="response"in s?s.response:s.responseText;r(new d(e,t))},s.onerror=function(){n(new TypeError("Network request failed"))},s.ontimeout=function(){n(new TypeError("Network request failed"))},s.open(o.method,o.url,!0),"include"===o.credentials&&(s.withCredentials=!0),"responseType"in s&&y.blob&&(s.responseType="blob"),o.headers.forEach(function(t,e){s.setRequestHeader(e,t)}),s.send("undefined"==typeof o._bodyInit?null:o._bodyInit)})},t.fetch.polyfill=!0}}("undefined"!=typeof self?self:this)},function(t,e){"use strict";function r(t){var e=void 0,n=void 0,i=void 0;if(t.tagName){if(e=document.createElement(t.tagName),t.className&&(e.className=t.className),t.attributes)for(n in t.attributes)e.setAttribute(n,t.attributes[n]);void 0!==t.html&&(e.innerHTML=t.html)}else e=document.createDocumentFragment();if(t.text&&e.appendChild(document.createTextNode(t.text)),void 0===window.HTMLElement&&(window.HTMLElement=Element),t.childs&&t.childs.length)for(i=0;i<t.childs.length;i++)e.appendChild(t.childs[i]instanceof window.HTMLElement?t.childs[i]:r(t.childs[i]));return e}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=r,t.exports=e["default"]},function(t,e){/*! @source http://purl.eligrey.com/github/classList.js/blob/master/classList.js*/
"document"in window.self&&("classList"in document.createElement("_")&&(!document.createElementNS||"classList"in document.createElementNS("http://www.w3.org/2000/svg","g"))?!function(){"use strict";var t=document.createElement("_");if(t.classList.add("c1","c2"),!t.classList.contains("c2")){var e=function(t){var e=DOMTokenList.prototype[t];DOMTokenList.prototype[t]=function(t){var r,n=arguments.length;for(r=0;r<n;r++)t=arguments[r],e.call(this,t)}};e("add"),e("remove")}if(t.classList.toggle("c3",!1),t.classList.contains("c3")){var r=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(t,e){return 1 in arguments&&!this.contains(t)==!e?e:r.call(this,t)}}t=null}():!function(t){"use strict";if("Element"in t){var e="classList",r="prototype",n=t.Element[r],i=Object,o=String[r].trim||function(){return this.replace(/^\s+|\s+$/g,"")},s=Array[r].indexOf||function(t){for(var e=0,r=this.length;e<r;e++)if(e in this&&this[e]===t)return e;return-1},u=function(t,e){this.name=t,this.code=DOMException[t],this.message=e},a=function(t,e){if(""===e)throw new u("SYNTAX_ERR","An invalid or illegal string was specified");if(/\s/.test(e))throw new u("INVALID_CHARACTER_ERR","String contains an invalid character");return s.call(t,e)},l=function(t){for(var e=o.call(t.getAttribute("class")||""),r=e?e.split(/\s+/):[],n=0,i=r.length;n<i;n++)this.push(r[n]);this._updateClassName=function(){t.setAttribute("class",this.toString())}},f=l[r]=[],c=function(){return new l(this)};if(u[r]=Error[r],f.item=function(t){return this[t]||null},f.contains=function(t){return t+="",a(this,t)!==-1},f.add=function(){var t,e=arguments,r=0,n=e.length,i=!1;do t=e[r]+"",a(this,t)===-1&&(this.push(t),i=!0);while(++r<n);i&&this._updateClassName()},f.remove=function(){var t,e,r=arguments,n=0,i=r.length,o=!1;do for(t=r[n]+"",e=a(this,t);e!==-1;)this.splice(e,1),o=!0,e=a(this,t);while(++n<i);o&&this._updateClassName()},f.toggle=function(t,e){t+="";var r=this.contains(t),n=r?e!==!0&&"remove":e!==!1&&"add";return n&&this[n](t),e===!0||e===!1?e:!r},f.toString=function(){return this.join(" ")},i.defineProperty){var h={get:c,enumerable:!0,configurable:!0};try{i.defineProperty(n,e,h)}catch(p){p.number===-2146823252&&(h.enumerable=!1,i.defineProperty(n,e,h))}}else i[r].__defineGetter__&&n.__defineGetter__(e,c)}}(window.self))},function(t,e,r){"use strict";(function(e){function r(t){return t instanceof e||t instanceof Date||t instanceof RegExp}function n(t){if(t instanceof e){var r=new e(t.length);return t.copy(r),r}if(t instanceof Date)return new Date(t.getTime());if(t instanceof RegExp)return new RegExp(t);throw new Error("Unexpected situation")}function i(t){var e=[];return t.forEach(function(t,s){"object"==typeof t&&null!==t?Array.isArray(t)?e[s]=i(t):r(t)?e[s]=n(t):e[s]=o({},t):e[s]=t}),e}var o=t.exports=function(){if(arguments.length<1||"object"!=typeof arguments[0])return!1;if(arguments.length<2)return arguments[0];var t,e,s=arguments[0],u=Array.prototype.slice.call(arguments,1);return u.forEach(function(u){"object"!=typeof u||Array.isArray(u)||Object.keys(u).forEach(function(a){return e=s[a],t=u[a],t===s?void 0:"object"!=typeof t||null===t?void(s[a]=t):Array.isArray(t)?void(s[a]=i(t)):r(t)?void(s[a]=n(t)):"object"!=typeof e||null===e||Array.isArray(e)?void(s[a]=o({},t)):void(s[a]=o(e,t))})}),s}}).call(e,r(6).Buffer)},function(t,e){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function n(t){return"function"==typeof t}function i(t){return"number"==typeof t}function o(t){return"object"==typeof t&&null!==t}function s(t){return void 0===t}t.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(t){if(!i(t)||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},r.prototype.emit=function(t){var e,r,i,u,a,l;if(this._events||(this._events={}),"error"===t&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if(e=arguments[1],e instanceof Error)throw e;var f=new Error('Uncaught, unspecified "error" event. ('+e+")");throw f.context=e,f}if(r=this._events[t],s(r))return!1;if(n(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:u=Array.prototype.slice.call(arguments,1),r.apply(this,u)}else if(o(r))for(u=Array.prototype.slice.call(arguments,1),l=r.slice(),i=l.length,a=0;a<i;a++)l[a].apply(this,u);return!0},r.prototype.addListener=function(t,e){var i;if(!n(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,n(e.listener)?e.listener:e),this._events[t]?o(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,o(this._events[t])&&!this._events[t].warned&&(i=s(this._maxListeners)?r.defaultMaxListeners:this._maxListeners,i&&i>0&&this._events[t].length>i&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace())),this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(t,e){function r(){this.removeListener(t,r),i||(i=!0,e.apply(this,arguments))}if(!n(e))throw TypeError("listener must be a function");var i=!1;return r.listener=e,this.on(t,r),this},r.prototype.removeListener=function(t,e){var r,i,s,u;if(!n(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(r=this._events[t],s=r.length,i=-1,r===e||n(r.listener)&&r.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(o(r)){for(u=s;u-- >0;)if(r[u]===e||r[u].listener&&r[u].listener===e){i=u;break}if(i<0)return this;1===r.length?(r.length=0,delete this._events[t]):r.splice(i,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},r.prototype.removeAllListeners=function(t){var e,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(r=this._events[t],n(r))this.removeListener(t,r);else if(r)for(;r.length;)this.removeListener(t,r[r.length-1]);return delete this._events[t],this},r.prototype.listeners=function(t){var e;return e=this._events&&this._events[t]?n(this._events[t])?[this._events[t]]:this._events[t].slice():[]},r.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(n(e))return 1;if(e)return e.length}return 0},r.listenerCount=function(t,e){return t.listenerCount(e)}},function(t,e,r){"use strict";(function(t,n){function i(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(e){return!1}}function o(){return t.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(e,r){if(o()<r)throw new RangeError("Invalid typed array length");return t.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(r),e.__proto__=t.prototype):(null===e&&(e=new t(r)),e.length=r),e}function t(e,r,n){if(!(t.TYPED_ARRAY_SUPPORT||this instanceof t))return new t(e,r,n);if("number"==typeof e){if("string"==typeof r)throw new Error("If encoding is specified then the first argument must be a string");return f(this,e)}return u(this,e,r,n)}function u(t,e,r,n){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?p(t,e,r,n):"string"==typeof e?c(t,e,r):d(t,e)}function a(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function l(t,e,r,n){return a(e),e<=0?s(t,e):void 0!==r?"string"==typeof n?s(t,e).fill(r,n):s(t,e).fill(r):s(t,e)}function f(e,r){if(a(r),e=s(e,r<0?0:0|y(r)),!t.TYPED_ARRAY_SUPPORT)for(var n=0;n<r;++n)e[n]=0;return e}function c(e,r,n){if("string"==typeof n&&""!==n||(n="utf8"),!t.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var i=0|_(r,n);e=s(e,i);var o=e.write(r,n);return o!==i&&(e=e.slice(0,o)),e}function h(t,e){var r=e.length<0?0:0|y(e.length);t=s(t,r);for(var n=0;n<r;n+=1)t[n]=255&e[n];return t}function p(e,r,n,i){if(r.byteLength,n<0||r.byteLength<n)throw new RangeError("'offset' is out of bounds");if(r.byteLength<n+(i||0))throw new RangeError("'length' is out of bounds");return r=void 0===n&&void 0===i?new Uint8Array(r):void 0===i?new Uint8Array(r,n):new Uint8Array(r,n,i),t.TYPED_ARRAY_SUPPORT?(e=r,e.__proto__=t.prototype):e=h(e,r),e}function d(e,r){if(t.isBuffer(r)){var n=0|y(r.length);return e=s(e,n),0===e.length?e:(r.copy(e,0,0,n),e)}if(r){if("undefined"!=typeof ArrayBuffer&&r.buffer instanceof ArrayBuffer||"length"in r)return"number"!=typeof r.length||J(r.length)?s(e,0):h(e,r);if("Buffer"===r.type&&Q(r.data))return h(e,r.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function y(t){if(t>=o())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o().toString(16)+" bytes");return 0|t}function v(e){return+e!=e&&(e=0),t.alloc(+e)}function _(e,r){if(t.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var i=!1;;)switch(r){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return z(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return X(e).length;default:if(i)return z(e).length;r=(""+r).toLowerCase(),i=!0}}function m(t,e,r){var n=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if(r>>>=0,e>>>=0,r<=e)return"";for(t||(t="utf8");;)switch(t){case"hex":return k(this,e,r);case"utf8":case"utf-8":return L(this,e,r);case"ascii":return U(this,e,r);case"latin1":case"binary":return N(this,e,r);case"base64":return T(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return D(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function g(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function b(e,r,n,i,o){if(0===e.length)return-1;if("string"==typeof n?(i=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=o?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(o)return-1;n=e.length-1}else if(n<0){if(!o)return-1;n=0}if("string"==typeof r&&(r=t.from(r,i)),t.isBuffer(r))return 0===r.length?-1:E(e,r,n,i,o);if("number"==typeof r)return r=255&r,t.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(e,r,n):Uint8Array.prototype.lastIndexOf.call(e,r,n):E(e,[r],n,i,o);throw new TypeError("val must be string, number or Buffer")}function E(t,e,r,n,i){function o(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}var s=1,u=t.length,a=e.length;if(void 0!==n&&(n=String(n).toLowerCase(),"ucs2"===n||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;s=2,u/=2,a/=2,r/=2}var l;if(i){var f=-1;for(l=r;l<u;l++)if(o(t,l)===o(e,f===-1?0:l-f)){if(f===-1&&(f=l),l-f+1===a)return f*s}else f!==-1&&(l-=l-f),f=-1}else for(r+a>u&&(r=u-a),l=r;l>=0;l--){for(var c=!0,h=0;h<a;h++)if(o(t,l+h)!==o(e,h)){c=!1;break}if(c)return l}return-1}function w(t,e,r,n){r=Number(r)||0;var i=t.length-r;n?(n=Number(n),n>i&&(n=i)):n=i;var o=e.length;if(o%2!==0)throw new TypeError("Invalid hex string");n>o/2&&(n=o/2);for(var s=0;s<n;++s){var u=parseInt(e.substr(2*s,2),16);if(isNaN(u))return s;t[r+s]=u}return s}function S(t,e,r,n){return K(z(e,t.length-r),t,r,n)}function R(t,e,r,n){return K(q(e),t,r,n)}function A(t,e,r,n){return R(t,e,r,n)}function P(t,e,r,n){return K(X(e),t,r,n)}function O(t,e,r,n){return K(W(e,t.length-r),t,r,n)}function T(t,e,r){return 0===e&&r===t.length?Z.fromByteArray(t):Z.fromByteArray(t.slice(e,r))}function L(t,e,r){r=Math.min(t.length,r);for(var n=[],i=e;i<r;){var o=t[i],s=null,u=o>239?4:o>223?3:o>191?2:1;if(i+u<=r){var a,l,f,c;switch(u){case 1:o<128&&(s=o);break;case 2:a=t[i+1],128===(192&a)&&(c=(31&o)<<6|63&a,c>127&&(s=c));break;case 3:a=t[i+1],l=t[i+2],128===(192&a)&&128===(192&l)&&(c=(15&o)<<12|(63&a)<<6|63&l,c>2047&&(c<55296||c>57343)&&(s=c));break;case 4:a=t[i+1],l=t[i+2],f=t[i+3],128===(192&a)&&128===(192&l)&&128===(192&f)&&(c=(15&o)<<18|(63&a)<<12|(63&l)<<6|63&f,c>65535&&c<1114112&&(s=c))}}null===s?(s=65533,u=1):s>65535&&(s-=65536,n.push(s>>>10&1023|55296),s=56320|1023&s),n.push(s),i+=u}return x(n)}function x(t){var e=t.length;if(e<=tt)return String.fromCharCode.apply(String,t);for(var r="",n=0;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=tt));return r}function U(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;i<r;++i)n+=String.fromCharCode(127&t[i]);return n}function N(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;i<r;++i)n+=String.fromCharCode(t[i]);return n}function k(t,e,r){var n=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>n)&&(r=n);for(var i="",o=e;o<r;++o)i+=G(t[o]);return i}function D(t,e,r){for(var n=t.slice(e,r),i="",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function M(t,e,r){if(t%1!==0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}function B(e,r,n,i,o,s){if(!t.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(r>o||r<s)throw new RangeError('"value" argument is out of bounds');if(n+i>e.length)throw new RangeError("Index out of range")}function C(t,e,r,n){e<0&&(e=65535+e+1);for(var i=0,o=Math.min(t.length-r,2);i<o;++i)t[r+i]=(e&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function F(t,e,r,n){e<0&&(e=4294967295+e+1);for(var i=0,o=Math.min(t.length-r,4);i<o;++i)t[r+i]=e>>>8*(n?i:3-i)&255}function I(t,e,r,n,i,o){if(r+n>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function j(t,e,r,n,i){return i||I(t,e,r,4,3.4028234663852886e38,-3.4028234663852886e38),$.write(t,e,r,n,23,4),r+4}function H(t,e,r,n,i){return i||I(t,e,r,8,1.7976931348623157e308,-1.7976931348623157e308),$.write(t,e,r,n,52,8),r+8}function V(t){if(t=Y(t).replace(et,""),t.length<2)return"";for(;t.length%4!==0;)t+="=";return t}function Y(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function G(t){return t<16?"0"+t.toString(16):t.toString(16)}function z(t,e){e=e||1/0;for(var r,n=t.length,i=null,o=[],s=0;s<n;++s){if(r=t.charCodeAt(s),r>55295&&r<57344){if(!i){if(r>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(s+1===n){(e-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(e-=3)>-1&&o.push(239,191,189),i=r;continue}r=(i-55296<<10|r-56320)+65536}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((e-=1)<0)break;o.push(r)}else if(r<2048){if((e-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function q(t){for(var e=[],r=0;r<t.length;++r)e.push(255&t.charCodeAt(r));return e}function W(t,e){for(var r,n,i,o=[],s=0;s<t.length&&!((e-=2)<0);++s)r=t.charCodeAt(s),n=r>>8,i=r%256,o.push(i),o.push(n);return o}function X(t){return Z.toByteArray(V(t))}function K(t,e,r,n){for(var i=0;i<n&&!(i+r>=e.length||i>=t.length);++i)e[i+r]=t[i];return i}function J(t){return t!==t}var Z=r(11),$=r(12),Q=r(13);e.Buffer=t,e.SlowBuffer=v,e.INSPECT_MAX_BYTES=50,t.TYPED_ARRAY_SUPPORT=void 0!==n.TYPED_ARRAY_SUPPORT?n.TYPED_ARRAY_SUPPORT:i(),e.kMaxLength=o(),t.poolSize=8192,t._augment=function(e){return e.__proto__=t.prototype,e},t.from=function(t,e,r){return u(null,t,e,r)},t.TYPED_ARRAY_SUPPORT&&(t.prototype.__proto__=Uint8Array.prototype,t.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&t[Symbol.species]===t&&Object.defineProperty(t,Symbol.species,{value:null,configurable:!0})),t.alloc=function(t,e,r){return l(null,t,e,r)},t.allocUnsafe=function(t){return f(null,t)},t.allocUnsafeSlow=function(t){return f(null,t)},t.isBuffer=function(t){return!(null==t||!t._isBuffer)},t.compare=function(e,r){if(!t.isBuffer(e)||!t.isBuffer(r))throw new TypeError("Arguments must be Buffers");if(e===r)return 0;for(var n=e.length,i=r.length,o=0,s=Math.min(n,i);o<s;++o)if(e[o]!==r[o]){n=e[o],i=r[o];break}return n<i?-1:i<n?1:0},t.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},t.concat=function(e,r){if(!Q(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return t.alloc(0);var n;if(void 0===r)for(r=0,n=0;n<e.length;++n)r+=e[n].length;var i=t.allocUnsafe(r),o=0;for(n=0;n<e.length;++n){var s=e[n];if(!t.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(i,o),o+=s.length}return i},t.byteLength=_,t.prototype._isBuffer=!0,t.prototype.swap16=function(){var t=this.length;if(t%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)g(this,e,e+1);return this},t.prototype.swap32=function(){var t=this.length;if(t%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)g(this,e,e+3),g(this,e+1,e+2);return this},t.prototype.swap64=function(){var t=this.length;if(t%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)g(this,e,e+7),g(this,e+1,e+6),g(this,e+2,e+5),g(this,e+3,e+4);return this},t.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?L(this,0,t):m.apply(this,arguments)},t.prototype.equals=function(e){if(!t.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===t.compare(this,e)},t.prototype.inspect=function(){var t="",r=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(t+=" ... ")),"<Buffer "+t+">"},t.prototype.compare=function(e,r,n,i,o){if(!t.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===r&&(r=0),void 0===n&&(n=e?e.length:0),void 0===i&&(i=0),void 0===o&&(o=this.length),r<0||n>e.length||i<0||o>this.length)throw new RangeError("out of range index");if(i>=o&&r>=n)return 0;if(i>=o)return-1;if(r>=n)return 1;if(r>>>=0,n>>>=0,i>>>=0,o>>>=0,this===e)return 0;for(var s=o-i,u=n-r,a=Math.min(s,u),l=this.slice(i,o),f=e.slice(r,n),c=0;c<a;++c)if(l[c]!==f[c]){s=l[c],u=f[c];break}return s<u?-1:u<s?1:0},t.prototype.includes=function(t,e,r){return this.indexOf(t,e,r)!==-1},t.prototype.indexOf=function(t,e,r){return b(this,t,e,r,!0)},t.prototype.lastIndexOf=function(t,e,r){return b(this,t,e,r,!1)},t.prototype.write=function(t,e,r,n){if(void 0===e)n="utf8",r=this.length,e=0;else if(void 0===r&&"string"==typeof e)n=e,r=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e=0|e,isFinite(r)?(r=0|r,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-e;if((void 0===r||r>i)&&(r=i),t.length>0&&(r<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return w(this,t,e,r);case"utf8":case"utf-8":return S(this,t,e,r);case"ascii":return R(this,t,e,r);case"latin1":case"binary":return A(this,t,e,r);case"base64":return P(this,t,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,t,e,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},t.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var tt=4096;t.prototype.slice=function(e,r){var n=this.length;e=~~e,r=void 0===r?n:~~r,e<0?(e+=n,e<0&&(e=0)):e>n&&(e=n),r<0?(r+=n,r<0&&(r=0)):r>n&&(r=n),r<e&&(r=e);var i;if(t.TYPED_ARRAY_SUPPORT)i=this.subarray(e,r),i.__proto__=t.prototype;else{var o=r-e;i=new t(o,(void 0));for(var s=0;s<o;++s)i[s]=this[s+e]}return i},t.prototype.readUIntLE=function(t,e,r){t=0|t,e=0|e,r||M(t,e,this.length);for(var n=this[t],i=1,o=0;++o<e&&(i*=256);)n+=this[t+o]*i;return n},t.prototype.readUIntBE=function(t,e,r){t=0|t,e=0|e,r||M(t,e,this.length);for(var n=this[t+--e],i=1;e>0&&(i*=256);)n+=this[t+--e]*i;return n},t.prototype.readUInt8=function(t,e){return e||M(t,1,this.length),this[t]},t.prototype.readUInt16LE=function(t,e){return e||M(t,2,this.length),this[t]|this[t+1]<<8},t.prototype.readUInt16BE=function(t,e){return e||M(t,2,this.length),this[t]<<8|this[t+1]},t.prototype.readUInt32LE=function(t,e){return e||M(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},t.prototype.readUInt32BE=function(t,e){return e||M(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},t.prototype.readIntLE=function(t,e,r){t=0|t,e=0|e,r||M(t,e,this.length);for(var n=this[t],i=1,o=0;++o<e&&(i*=256);)n+=this[t+o]*i;return i*=128,n>=i&&(n-=Math.pow(2,8*e)),n},t.prototype.readIntBE=function(t,e,r){t=0|t,e=0|e,r||M(t,e,this.length);for(var n=e,i=1,o=this[t+--n];n>0&&(i*=256);)o+=this[t+--n]*i;return i*=128,o>=i&&(o-=Math.pow(2,8*e)),o},t.prototype.readInt8=function(t,e){return e||M(t,1,this.length),128&this[t]?(255-this[t]+1)*-1:this[t]},t.prototype.readInt16LE=function(t,e){e||M(t,2,this.length);var r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},t.prototype.readInt16BE=function(t,e){e||M(t,2,this.length);var r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},t.prototype.readInt32LE=function(t,e){return e||M(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},t.prototype.readInt32BE=function(t,e){return e||M(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},t.prototype.readFloatLE=function(t,e){return e||M(t,4,this.length),$.read(this,t,!0,23,4)},t.prototype.readFloatBE=function(t,e){return e||M(t,4,this.length),$.read(this,t,!1,23,4)},t.prototype.readDoubleLE=function(t,e){return e||M(t,8,this.length),$.read(this,t,!0,52,8)},t.prototype.readDoubleBE=function(t,e){return e||M(t,8,this.length),$.read(this,t,!1,52,8)},t.prototype.writeUIntLE=function(t,e,r,n){if(t=+t,e=0|e,r=0|r,!n){var i=Math.pow(2,8*r)-1;B(this,t,e,r,i,0)}var o=1,s=0;for(this[e]=255&t;++s<r&&(o*=256);)this[e+s]=t/o&255;return e+r},t.prototype.writeUIntBE=function(t,e,r,n){if(t=+t,e=0|e,r=0|r,!n){var i=Math.pow(2,8*r)-1;B(this,t,e,r,i,0)}var o=r-1,s=1;for(this[e+o]=255&t;--o>=0&&(s*=256);)this[e+o]=t/s&255;return e+r},t.prototype.writeUInt8=function(e,r,n){return e=+e,r=0|r,n||B(this,e,r,1,255,0),t.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[r]=255&e,r+1},t.prototype.writeUInt16LE=function(e,r,n){return e=+e,r=0|r,n||B(this,e,r,2,65535,0),t.TYPED_ARRAY_SUPPORT?(this[r]=255&e,this[r+1]=e>>>8):C(this,e,r,!0),r+2},t.prototype.writeUInt16BE=function(e,r,n){return e=+e,r=0|r,n||B(this,e,r,2,65535,0),t.TYPED_ARRAY_SUPPORT?(this[r]=e>>>8,this[r+1]=255&e):C(this,e,r,!1),r+2},t.prototype.writeUInt32LE=function(e,r,n){return e=+e,r=0|r,n||B(this,e,r,4,4294967295,0),t.TYPED_ARRAY_SUPPORT?(this[r+3]=e>>>24,this[r+2]=e>>>16,this[r+1]=e>>>8,this[r]=255&e):F(this,e,r,!0),r+4},t.prototype.writeUInt32BE=function(e,r,n){return e=+e,r=0|r,n||B(this,e,r,4,4294967295,0),t.TYPED_ARRAY_SUPPORT?(this[r]=e>>>24,this[r+1]=e>>>16,this[r+2]=e>>>8,this[r+3]=255&e):F(this,e,r,!1),r+4},t.prototype.writeIntLE=function(t,e,r,n){if(t=+t,e=0|e,!n){var i=Math.pow(2,8*r-1);B(this,t,e,r,i-1,-i)}var o=0,s=1,u=0;for(this[e]=255&t;++o<r&&(s*=256);)t<0&&0===u&&0!==this[e+o-1]&&(u=1),this[e+o]=(t/s>>0)-u&255;return e+r},t.prototype.writeIntBE=function(t,e,r,n){if(t=+t,e=0|e,!n){var i=Math.pow(2,8*r-1);B(this,t,e,r,i-1,-i)}var o=r-1,s=1,u=0;for(this[e+o]=255&t;--o>=0&&(s*=256);)t<0&&0===u&&0!==this[e+o+1]&&(u=1),this[e+o]=(t/s>>0)-u&255;return e+r},t.prototype.writeInt8=function(e,r,n){return e=+e,r=0|r,n||B(this,e,r,1,127,-128),t.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[r]=255&e,r+1},t.prototype.writeInt16LE=function(e,r,n){return e=+e,r=0|r,n||B(this,e,r,2,32767,-32768),t.TYPED_ARRAY_SUPPORT?(this[r]=255&e,this[r+1]=e>>>8):C(this,e,r,!0),r+2},t.prototype.writeInt16BE=function(e,r,n){return e=+e,r=0|r,n||B(this,e,r,2,32767,-32768),t.TYPED_ARRAY_SUPPORT?(this[r]=e>>>8,this[r+1]=255&e):C(this,e,r,!1),r+2},t.prototype.writeInt32LE=function(e,r,n){return e=+e,r=0|r,n||B(this,e,r,4,2147483647,-2147483648),t.TYPED_ARRAY_SUPPORT?(this[r]=255&e,this[r+1]=e>>>8,this[r+2]=e>>>16,this[r+3]=e>>>24):F(this,e,r,!0),r+4},t.prototype.writeInt32BE=function(e,r,n){return e=+e,r=0|r,n||B(this,e,r,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),t.TYPED_ARRAY_SUPPORT?(this[r]=e>>>24,this[r+1]=e>>>16,this[r+2]=e>>>8,this[r+3]=255&e):F(this,e,r,!1),r+4},t.prototype.writeFloatLE=function(t,e,r){return j(this,t,e,!0,r)},t.prototype.writeFloatBE=function(t,e,r){return j(this,t,e,!1,r)},t.prototype.writeDoubleLE=function(t,e,r){return H(this,t,e,!0,r)},t.prototype.writeDoubleBE=function(t,e,r){return H(this,t,e,!1,r)},t.prototype.copy=function(e,r,n,i){if(n||(n=0),i||0===i||(i=this.length),r>=e.length&&(r=e.length),r||(r=0),i>0&&i<n&&(i=n),i===n)return 0;if(0===e.length||0===this.length)return 0;if(r<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-r<i-n&&(i=e.length-r+n);var o,s=i-n;if(this===e&&n<r&&r<i)for(o=s-1;o>=0;--o)e[o+r]=this[o+n];else if(s<1e3||!t.TYPED_ARRAY_SUPPORT)for(o=0;o<s;++o)e[o+r]=this[o+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+s),r);return s},t.prototype.fill=function(e,r,n,i){if("string"==typeof e){if("string"==typeof r?(i=r,r=0,n=this.length):"string"==typeof n&&(i=n,n=this.length),1===e.length){var o=e.charCodeAt(0);o<256&&(e=o)}if(void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!t.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else"number"==typeof e&&(e=255&e);if(r<0||this.length<r||this.length<n)throw new RangeError("Out of range index");if(n<=r)return this;r>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0);var s;if("number"==typeof e)for(s=r;s<n;++s)this[s]=e;else{var u=t.isBuffer(e)?e:z(new t(e,i).toString()),a=u.length;for(s=0;s<n-r;++s)this[s+r]=u[s%a]}return this};var et=/[^+\/0-9A-Za-z-_]/g}).call(e,r(6).Buffer,r(15))},function(t,e,r){!function(e,n){t.exports=n(r(14))}(this,function(t){return function(t){function e(n){if(r[n])return r[n].exports;var i=r[n]={exports:{},id:n,loaded:!1};return t[n].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var r={};return e.m=t,e.c=r,e.p="",e(0)}([function(t,e,r){r(1),t.exports=r(2)},function(e,r){e.exports=t},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=r(3),o=n(i),s=r(40),u=n(s),a=r(45),l=n(a),f=r(46),c=n(f),h=r(50),p=n(h),d=r(85),y=n(d),v=r(93),_={timeout:5e3,headers:{}},m={Accept:"application/json"},g=function(t){function e(t,r){var n=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];(0,l["default"])(this,e);var i=(0,p["default"])(this,(0,u["default"])(e).call(this));if(!t)throw new Error("scope is required");if(!r)throw new Error("authorization server url is required");return i._options=(0,o["default"])({},_,n),r.indexOf("?")===-1?i._url=r+"?scope="+t:i._url=r+"&scope="+t,i._fatalError=null,i._token=null,i._retries=[0,200,1e3,3e3],i._retry=0,i._autorefresh=null,i._headers=(0,o["default"])({},m,n.headers),i._retryRequest(),i}return(0,y["default"])(e,t),(0,c["default"])(e,[{key:"request",value:function(){var t=this,e=arguments.length<=0||void 0===arguments[0]?function(){}:arguments[0];if(this._fatalError)return void e(this._fatalError);if(null!==this._token)return void e(null,this._token);var r=!1,n=function(){r||(r=!0,e(null,t._token))},i=function(){r||(r=!0,e(new Error("authorization: timeout")))},o=setTimeout(function(){t.removeListener("ready",n),i()},this._options.timeout);this.once("ready",function(){clearTimeout(o),n()})}},{key:"refreshToken",value:function(){var t=this;null!==this._token&&(null!==this._autorefresh&&(clearTimeout(this._autorefresh),this._autorefresh=null),this._token=null,function(){t._retryRequest()}())}},{key:"_retryRequest",value:function(){var t=this,e=this._retries[this._retry];return e?void setTimeout(function(){t._makeRequest()},e):void this._makeRequest()}},{key:"_makeRequest",value:function(){var t=this;fetch(this._url,{credentials:"same-origin",headers:this._headers}).then(function(t){if(t.status>=200&&t.status<300)return t.json();if(401===t.status){var e=new Error("authorization: unauthorized");throw e.fatal=!0,e}if(403===t.status){var r=new Error("authorization: forbidden");throw r.fatal=!0,r}throw new Error("authorization: non-200 response code from auth server")}).then(function(e){t._token=e.token,t._retry=0,t.emit("ready",{token:e.token});var r=new Date(e.expire).getTime()-Date.now()-6e4;t._autorefresh=setTimeout(function(){t._autorefresh=null,t._retryRequest()},r)})["catch"](function(e){return t._token=null,e.fatal?void(t._fatalError=e):(t._retryRequest(),void(t._retry<t._retries.length-1&&t._retry++))})}}]),e}(v.EventEmitter);e["default"]=g,t.exports=e["default"]},function(t,e,r){t.exports={"default":r(4),__esModule:!0}},function(t,e,r){r(5),t.exports=r(8).Object.assign},function(t,e,r){var n=r(6);n(n.S+n.F,"Object",{assign:r(21)})},function(t,e,r){var n=r(7),i=r(8),o=r(9),s=r(11),u="prototype",a=function(t,e,r){var l,f,c,h=t&a.F,p=t&a.G,d=t&a.S,y=t&a.P,v=t&a.B,_=t&a.W,m=p?i:i[e]||(i[e]={}),g=m[u],b=p?n:d?n[e]:(n[e]||{})[u];p&&(r=e);for(l in r)f=!h&&b&&void 0!==b[l],f&&l in m||(c=f?b[l]:r[l],m[l]=p&&"function"!=typeof b[l]?r[l]:v&&f?o(c,n):_&&b[l]==c?function(t){var e=function(e,r,n){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,r)}return new t(e,r,n)}return t.apply(this,arguments)};return e[u]=t[u],e}(c):y&&"function"==typeof c?o(Function.call,c):c,y&&((m.virtual||(m.virtual={}))[l]=c,t&a.R&&g&&!g[l]&&s(g,l,c)))};a.F=1,a.G=2,a.S=4,a.P=8,a.B=16,a.W=32,a.U=64,a.R=128,t.exports=a},function(t,e){var r=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},function(t,e){var r=t.exports={version:"2.4.0"};"number"==typeof __e&&(__e=r)},function(t,e,r){var n=r(10);t.exports=function(t,e,r){if(n(t),void 0===e)return t;switch(r){case 1:return function(r){return t.call(e,r)};case 2:return function(r,n){return t.call(e,r,n)};case 3:return function(r,n,i){return t.call(e,r,n,i)}}return function(){return t.apply(e,arguments)}}},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e,r){var n=r(12),i=r(20);t.exports=r(16)?function(t,e,r){return n.f(t,e,i(1,r))}:function(t,e,r){return t[e]=r,t}},function(t,e,r){var n=r(13),i=r(15),o=r(19),s=Object.defineProperty;e.f=r(16)?Object.defineProperty:function(t,e,r){if(n(t),e=o(e,!0),n(r),i)try{return s(t,e,r)}catch(u){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(t[e]=r.value),t}},function(t,e,r){var n=r(14);t.exports=function(t){if(!n(t))throw TypeError(t+" is not an object!");return t}},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e,r){t.exports=!r(16)&&!r(17)(function(){return 7!=Object.defineProperty(r(18)("div"),"a",{
get:function(){return 7}}).a})},function(t,e,r){t.exports=!r(17)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,e){t.exports=function(t){try{return!!t()}catch(e){return!0}}},function(t,e,r){var n=r(14),i=r(7).document,o=n(i)&&n(i.createElement);t.exports=function(t){return o?i.createElement(t):{}}},function(t,e,r){var n=r(14);t.exports=function(t,e){if(!n(t))return t;var r,i;if(e&&"function"==typeof(r=t.toString)&&!n(i=r.call(t)))return i;if("function"==typeof(r=t.valueOf)&&!n(i=r.call(t)))return i;if(!e&&"function"==typeof(r=t.toString)&&!n(i=r.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e,r){"use strict";var n=r(22),i=r(37),o=r(38),s=r(39),u=r(26),a=Object.assign;t.exports=!a||r(17)(function(){var t={},e={},r=Symbol(),n="abcdefghijklmnopqrst";return t[r]=7,n.split("").forEach(function(t){e[t]=t}),7!=a({},t)[r]||Object.keys(a({},e)).join("")!=n})?function(t,e){for(var r=s(t),a=arguments.length,l=1,f=i.f,c=o.f;a>l;)for(var h,p=u(arguments[l++]),d=f?n(p).concat(f(p)):n(p),y=d.length,v=0;y>v;)c.call(p,h=d[v++])&&(r[h]=p[h]);return r}:a},function(t,e,r){var n=r(23),i=r(36);t.exports=Object.keys||function(t){return n(t,i)}},function(t,e,r){var n=r(24),i=r(25),o=r(29)(!1),s=r(33)("IE_PROTO");t.exports=function(t,e){var r,u=i(t),a=0,l=[];for(r in u)r!=s&&n(u,r)&&l.push(r);for(;e.length>a;)n(u,r=e[a++])&&(~o(l,r)||l.push(r));return l}},function(t,e){var r={}.hasOwnProperty;t.exports=function(t,e){return r.call(t,e)}},function(t,e,r){var n=r(26),i=r(28);t.exports=function(t){return n(i(t))}},function(t,e,r){var n=r(27);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==n(t)?t.split(""):Object(t)}},function(t,e){var r={}.toString;t.exports=function(t){return r.call(t).slice(8,-1)}},function(t,e){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},function(t,e,r){var n=r(25),i=r(30),o=r(32);t.exports=function(t){return function(e,r,s){var u,a=n(e),l=i(a.length),f=o(s,l);if(t&&r!=r){for(;l>f;)if(u=a[f++],u!=u)return!0}else for(;l>f;f++)if((t||f in a)&&a[f]===r)return t||f||0;return!t&&-1}}},function(t,e,r){var n=r(31),i=Math.min;t.exports=function(t){return t>0?i(n(t),9007199254740991):0}},function(t,e){var r=Math.ceil,n=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?n:r)(t)}},function(t,e,r){var n=r(31),i=Math.max,o=Math.min;t.exports=function(t,e){return t=n(t),t<0?i(t+e,0):o(t,e)}},function(t,e,r){var n=r(34)("keys"),i=r(35);t.exports=function(t){return n[t]||(n[t]=i(t))}},function(t,e,r){var n=r(7),i="__core-js_shared__",o=n[i]||(n[i]={});t.exports=function(t){return o[t]||(o[t]={})}},function(t,e){var r=0,n=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++r+n).toString(36))}},function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e){e.f={}.propertyIsEnumerable},function(t,e,r){var n=r(28);t.exports=function(t){return Object(n(t))}},function(t,e,r){t.exports={"default":r(41),__esModule:!0}},function(t,e,r){r(42),t.exports=r(8).Object.getPrototypeOf},function(t,e,r){var n=r(39),i=r(43);r(44)("getPrototypeOf",function(){return function(t){return i(n(t))}})},function(t,e,r){var n=r(24),i=r(39),o=r(33)("IE_PROTO"),s=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=i(t),n(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?s:null}},function(t,e,r){var n=r(6),i=r(8),o=r(17);t.exports=function(t,e){var r=(i.Object||{})[t]||Object[t],s={};s[t]=e(r),n(n.S+n.F*o(function(){r(1)}),"Object",s)}},function(t,e){"use strict";e.__esModule=!0,e["default"]=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0;var i=r(47),o=n(i);e["default"]=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),(0,o["default"])(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}()},function(t,e,r){t.exports={"default":r(48),__esModule:!0}},function(t,e,r){r(49);var n=r(8).Object;t.exports=function(t,e,r){return n.defineProperty(t,e,r)}},function(t,e,r){var n=r(6);n(n.S+n.F*!r(16),"Object",{defineProperty:r(12).f})},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0;var i=r(51),o=n(i);e["default"]=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==("undefined"==typeof e?"undefined":(0,o["default"])(e))&&"function"!=typeof e?t:e}},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0;var i=r(52),o=n(i),s=r(71),u=n(s),a="function"==typeof u["default"]&&"symbol"==typeof o["default"]?function(t){return typeof t}:function(t){return t&&"function"==typeof u["default"]&&t.constructor===u["default"]?"symbol":typeof t};e["default"]="function"==typeof u["default"]&&"symbol"===a(o["default"])?function(t){return"undefined"==typeof t?"undefined":a(t)}:function(t){return t&&"function"==typeof u["default"]&&t.constructor===u["default"]?"symbol":"undefined"==typeof t?"undefined":a(t)}},function(t,e,r){t.exports={"default":r(53),__esModule:!0}},function(t,e,r){r(54),r(66),t.exports=r(70).f("iterator")},function(t,e,r){"use strict";var n=r(55)(!0);r(56)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,r=this._i;return r>=e.length?{value:void 0,done:!0}:(t=n(e,r),this._i+=t.length,{value:t,done:!1})})},function(t,e,r){var n=r(31),i=r(28);t.exports=function(t){return function(e,r){var o,s,u=String(i(e)),a=n(r),l=u.length;return a<0||a>=l?t?"":void 0:(o=u.charCodeAt(a),o<55296||o>56319||a+1===l||(s=u.charCodeAt(a+1))<56320||s>57343?t?u.charAt(a):o:t?u.slice(a,a+2):(o-55296<<10)+(s-56320)+65536)}}},function(t,e,r){"use strict";var n=r(57),i=r(6),o=r(58),s=r(11),u=r(24),a=r(59),l=r(60),f=r(64),c=r(43),h=r(65)("iterator"),p=!([].keys&&"next"in[].keys()),d="@@iterator",y="keys",v="values",_=function(){return this};t.exports=function(t,e,r,m,g,b,E){l(r,e,m);var w,S,R,A=function(t){if(!p&&t in L)return L[t];switch(t){case y:return function(){return new r(this,t)};case v:return function(){return new r(this,t)}}return function(){return new r(this,t)}},P=e+" Iterator",O=g==v,T=!1,L=t.prototype,x=L[h]||L[d]||g&&L[g],U=x||A(g),N=g?O?A("entries"):U:void 0,k="Array"==e?L.entries||x:x;if(k&&(R=c(k.call(new t)),R!==Object.prototype&&(f(R,P,!0),n||u(R,h)||s(R,h,_))),O&&x&&x.name!==v&&(T=!0,U=function(){return x.call(this)}),n&&!E||!p&&!T&&L[h]||s(L,h,U),a[e]=U,a[P]=_,g)if(w={values:O?U:A(v),keys:b?U:A(y),entries:N},E)for(S in w)S in L||o(L,S,w[S]);else i(i.P+i.F*(p||T),e,w);return w}},function(t,e){t.exports=!0},function(t,e,r){t.exports=r(11)},function(t,e){t.exports={}},function(t,e,r){"use strict";var n=r(61),i=r(20),o=r(64),s={};r(11)(s,r(65)("iterator"),function(){return this}),t.exports=function(t,e,r){t.prototype=n(s,{next:i(1,r)}),o(t,e+" Iterator")}},function(t,e,r){var n=r(13),i=r(62),o=r(36),s=r(33)("IE_PROTO"),u=function(){},a="prototype",l=function(){var t,e=r(18)("iframe"),n=o.length,i="<",s=">";for(e.style.display="none",r(63).appendChild(e),e.src="javascript:",t=e.contentWindow.document,t.open(),t.write(i+"script"+s+"document.F=Object"+i+"/script"+s),t.close(),l=t.F;n--;)delete l[a][o[n]];return l()};t.exports=Object.create||function(t,e){var r;return null!==t?(u[a]=n(t),r=new u,u[a]=null,r[s]=t):r=l(),void 0===e?r:i(r,e)}},function(t,e,r){var n=r(12),i=r(13),o=r(22);t.exports=r(16)?Object.defineProperties:function(t,e){i(t);for(var r,s=o(e),u=s.length,a=0;u>a;)n.f(t,r=s[a++],e[r]);return t}},function(t,e,r){t.exports=r(7).document&&document.documentElement},function(t,e,r){var n=r(12).f,i=r(24),o=r(65)("toStringTag");t.exports=function(t,e,r){t&&!i(t=r?t:t.prototype,o)&&n(t,o,{configurable:!0,value:e})}},function(t,e,r){var n=r(34)("wks"),i=r(35),o=r(7).Symbol,s="function"==typeof o,u=t.exports=function(t){return n[t]||(n[t]=s&&o[t]||(s?o:i)("Symbol."+t))};u.store=n},function(t,e,r){r(67);for(var n=r(7),i=r(11),o=r(59),s=r(65)("toStringTag"),u=["NodeList","DOMTokenList","MediaList","StyleSheetList","CSSRuleList"],a=0;a<5;a++){var l=u[a],f=n[l],c=f&&f.prototype;c&&!c[s]&&i(c,s,l),o[l]=o.Array}},function(t,e,r){"use strict";var n=r(68),i=r(69),o=r(59),s=r(25);t.exports=r(56)(Array,"Array",function(t,e){this._t=s(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,r=this._i++;return!t||r>=t.length?(this._t=void 0,i(1)):"keys"==e?i(0,r):"values"==e?i(0,t[r]):i(0,[r,t[r]])},"values"),o.Arguments=o.Array,n("keys"),n("values"),n("entries")},function(t,e){t.exports=function(){}},function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},function(t,e,r){e.f=r(65)},function(t,e,r){t.exports={"default":r(72),__esModule:!0}},function(t,e,r){r(73),r(82),r(83),r(84),t.exports=r(8).Symbol},function(t,e,r){"use strict";var n=r(7),i=r(24),o=r(16),s=r(6),u=r(58),a=r(74).KEY,l=r(17),f=r(34),c=r(64),h=r(35),p=r(65),d=r(70),y=r(75),v=r(76),_=r(77),m=r(78),g=r(13),b=r(25),E=r(19),w=r(20),S=r(61),R=r(79),A=r(81),P=r(12),O=r(22),T=A.f,L=P.f,x=R.f,U=n.Symbol,N=n.JSON,k=N&&N.stringify,D="prototype",M=p("_hidden"),B=p("toPrimitive"),C={}.propertyIsEnumerable,F=f("symbol-registry"),I=f("symbols"),j=f("op-symbols"),H=Object[D],V="function"==typeof U,Y=n.QObject,G=!Y||!Y[D]||!Y[D].findChild,z=o&&l(function(){return 7!=S(L({},"a",{get:function(){return L(this,"a",{value:7}).a}})).a})?function(t,e,r){var n=T(H,e);n&&delete H[e],L(t,e,r),n&&t!==H&&L(H,e,n)}:L,q=function(t){var e=I[t]=S(U[D]);return e._k=t,e},W=V&&"symbol"==typeof U.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof U},X=function(t,e,r){return t===H&&X(j,e,r),g(t),e=E(e,!0),g(r),i(I,e)?(r.enumerable?(i(t,M)&&t[M][e]&&(t[M][e]=!1),r=S(r,{enumerable:w(0,!1)})):(i(t,M)||L(t,M,w(1,{})),t[M][e]=!0),z(t,e,r)):L(t,e,r)},K=function(t,e){g(t);for(var r,n=_(e=b(e)),i=0,o=n.length;o>i;)X(t,r=n[i++],e[r]);return t},J=function(t,e){return void 0===e?S(t):K(S(t),e)},Z=function(t){var e=C.call(this,t=E(t,!0));return!(this===H&&i(I,t)&&!i(j,t))&&(!(e||!i(this,t)||!i(I,t)||i(this,M)&&this[M][t])||e)},$=function(t,e){if(t=b(t),e=E(e,!0),t!==H||!i(I,e)||i(j,e)){var r=T(t,e);return!r||!i(I,e)||i(t,M)&&t[M][e]||(r.enumerable=!0),r}},Q=function(t){for(var e,r=x(b(t)),n=[],o=0;r.length>o;)i(I,e=r[o++])||e==M||e==a||n.push(e);return n},tt=function(t){for(var e,r=t===H,n=x(r?j:b(t)),o=[],s=0;n.length>s;)!i(I,e=n[s++])||r&&!i(H,e)||o.push(I[e]);return o};V||(U=function(){if(this instanceof U)throw TypeError("Symbol is not a constructor!");var t=h(arguments.length>0?arguments[0]:void 0),e=function(r){this===H&&e.call(j,r),i(this,M)&&i(this[M],t)&&(this[M][t]=!1),z(this,t,w(1,r))};return o&&G&&z(H,t,{configurable:!0,set:e}),q(t)},u(U[D],"toString",function(){return this._k}),A.f=$,P.f=X,r(80).f=R.f=Q,r(38).f=Z,r(37).f=tt,o&&!r(57)&&u(H,"propertyIsEnumerable",Z,!0),d.f=function(t){return q(p(t))}),s(s.G+s.W+s.F*!V,{Symbol:U});for(var et="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),rt=0;et.length>rt;)p(et[rt++]);for(var et=O(p.store),rt=0;et.length>rt;)y(et[rt++]);s(s.S+s.F*!V,"Symbol",{"for":function(t){return i(F,t+="")?F[t]:F[t]=U(t)},keyFor:function(t){if(W(t))return v(F,t);throw TypeError(t+" is not a symbol!")},useSetter:function(){G=!0},useSimple:function(){G=!1}}),s(s.S+s.F*!V,"Object",{create:J,defineProperty:X,defineProperties:K,getOwnPropertyDescriptor:$,getOwnPropertyNames:Q,getOwnPropertySymbols:tt}),N&&s(s.S+s.F*(!V||l(function(){var t=U();return"[null]"!=k([t])||"{}"!=k({a:t})||"{}"!=k(Object(t))})),"JSON",{stringify:function(t){if(void 0!==t&&!W(t)){for(var e,r,n=[t],i=1;arguments.length>i;)n.push(arguments[i++]);return e=n[1],"function"==typeof e&&(r=e),!r&&m(e)||(e=function(t,e){if(r&&(e=r.call(this,t,e)),!W(e))return e}),n[1]=e,k.apply(N,n)}}}),U[D][B]||r(11)(U[D],B,U[D].valueOf),c(U,"Symbol"),c(Math,"Math",!0),c(n.JSON,"JSON",!0)},function(t,e,r){var n=r(35)("meta"),i=r(14),o=r(24),s=r(12).f,u=0,a=Object.isExtensible||function(){return!0},l=!r(17)(function(){return a(Object.preventExtensions({}))}),f=function(t){s(t,n,{value:{i:"O"+ ++u,w:{}}})},c=function(t,e){if(!i(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!o(t,n)){if(!a(t))return"F";if(!e)return"E";f(t)}return t[n].i},h=function(t,e){if(!o(t,n)){if(!a(t))return!0;if(!e)return!1;f(t)}return t[n].w},p=function(t){return l&&d.NEED&&a(t)&&!o(t,n)&&f(t),t},d=t.exports={KEY:n,NEED:!1,fastKey:c,getWeak:h,onFreeze:p}},function(t,e,r){var n=r(7),i=r(8),o=r(57),s=r(70),u=r(12).f;t.exports=function(t){var e=i.Symbol||(i.Symbol=o?{}:n.Symbol||{});"_"==t.charAt(0)||t in e||u(e,t,{value:s.f(t)})}},function(t,e,r){var n=r(22),i=r(25);t.exports=function(t,e){for(var r,o=i(t),s=n(o),u=s.length,a=0;u>a;)if(o[r=s[a++]]===e)return r}},function(t,e,r){var n=r(22),i=r(37),o=r(38);t.exports=function(t){var e=n(t),r=i.f;if(r)for(var s,u=r(t),a=o.f,l=0;u.length>l;)a.call(t,s=u[l++])&&e.push(s);return e}},function(t,e,r){var n=r(27);t.exports=Array.isArray||function(t){return"Array"==n(t)}},function(t,e,r){var n=r(25),i=r(80).f,o={}.toString,s="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],u=function(t){try{return i(t)}catch(e){return s.slice()}};t.exports.f=function(t){return s&&"[object Window]"==o.call(t)?u(t):i(n(t))}},function(t,e,r){var n=r(23),i=r(36).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return n(t,i)}},function(t,e,r){var n=r(38),i=r(20),o=r(25),s=r(19),u=r(24),a=r(15),l=Object.getOwnPropertyDescriptor;e.f=r(16)?l:function(t,e){if(t=o(t),e=s(e,!0),a)try{return l(t,e)}catch(r){}if(u(t,e))return i(!n.f.call(t,e),t[e])}},function(t,e){},function(t,e,r){r(75)("asyncIterator")},function(t,e,r){r(75)("observable")},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0;var i=r(86),o=n(i),s=r(90),u=n(s),a=r(51),l=n(a);e["default"]=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof e?"undefined":(0,l["default"])(e)));t.prototype=(0,u["default"])(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(o["default"]?(0,o["default"])(t,e):t.__proto__=e)}},function(t,e,r){t.exports={"default":r(87),__esModule:!0}},function(t,e,r){r(88),t.exports=r(8).Object.setPrototypeOf},function(t,e,r){var n=r(6);n(n.S,"Object",{setPrototypeOf:r(89).set})},function(t,e,r){var n=r(14),i=r(13),o=function(t,e){if(i(t),!n(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,n){try{n=r(9)(Function.call,r(81).f(Object.prototype,"__proto__").set,2),n(t,[]),e=!(t instanceof Array)}catch(i){e=!0}return function(t,r){return o(t,r),e?t.__proto__=r:n(t,r),t}}({},!1):void 0),check:o}},function(t,e,r){t.exports={"default":r(91),__esModule:!0}},function(t,e,r){r(92);var n=r(8).Object;t.exports=function(t,e){return n.create(t,e)}},function(t,e,r){var n=r(6);n(n.S,"Object",{create:r(61)})},function(t,e){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function n(t){return"function"==typeof t}function i(t){return"number"==typeof t}function o(t){return"object"==typeof t&&null!==t}function s(t){return void 0===t}t.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(t){if(!i(t)||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},r.prototype.emit=function(t){var e,r,i,u,a,l;if(this._events||(this._events={}),"error"===t&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if(e=arguments[1],e instanceof Error)throw e;var f=new Error('Uncaught, unspecified "error" event. ('+e+")");throw f.context=e,f}if(r=this._events[t],s(r))return!1;if(n(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:u=Array.prototype.slice.call(arguments,1),r.apply(this,u)}else if(o(r))for(u=Array.prototype.slice.call(arguments,1),l=r.slice(),i=l.length,a=0;a<i;a++)l[a].apply(this,u);return!0},r.prototype.addListener=function(t,e){var i;if(!n(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,n(e.listener)?e.listener:e),this._events[t]?o(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,o(this._events[t])&&!this._events[t].warned&&(i=s(this._maxListeners)?r.defaultMaxListeners:this._maxListeners,i&&i>0&&this._events[t].length>i&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace())),this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(t,e){function r(){this.removeListener(t,r),i||(i=!0,e.apply(this,arguments))}if(!n(e))throw TypeError("listener must be a function");var i=!1;return r.listener=e,this.on(t,r),this},r.prototype.removeListener=function(t,e){var r,i,s,u;if(!n(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(r=this._events[t],s=r.length,i=-1,r===e||n(r.listener)&&r.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(o(r)){for(u=s;u-- >0;)if(r[u]===e||r[u].listener&&r[u].listener===e){i=u;break}if(i<0)return this;1===r.length?(r.length=0,delete this._events[t]):r.splice(i,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},r.prototype.removeAllListeners=function(t){var e,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(r=this._events[t],n(r))this.removeListener(t,r);else if(r)for(;r.length;)this.removeListener(t,r[r.length-1]);return delete this._events[t],this},r.prototype.listeners=function(t){var e;return e=this._events&&this._events[t]?n(this._events[t])?[this._events[t]]:this._events[t].slice():[]},r.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(n(e))return 1;if(e)return e.length}return 0},r.listenerCount=function(t,e){return t.listenerCount(e)}}])})},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();r(1);var o=r(0),s=function(){function t(e,r){n(this,t),this.file=e,this.Upload=r,this.options=r.options,this.file_size=this.file.size,this.chunk_size=102400,this.range_start=0,this.range_end=this.chunk_size,this.xLast=!1,this.is_paused=!1,"mozSlice"in this.file?this.slice_method="mozSlice":"webkitSlice"in this.file?this.slice_method="webkitSlice":this.slice_method="slice"}return i(t,[{key:"sendOptions",value:function(){var t=this;return this.options.maxFileSize<this.file.size?void this.emit(o.EVENTS.UPLOAD_FAILURE,this.file,{message:"ERROR_FILE_SIZE"}):void fetch(""+this.options.url,{method:"post",mode:"cors",headers:{Authorization:"Bearer "+this.options.token,"X-File-Name":this.file.name}}).then(function(e){return e.ok?(t.Upload.emit(o.EVENTS.UPLOAD_PROGRESS,t.range_start,t.file_size),t.Upload.emit(o.EVENTS.UPLOAD_START,t.file),t.sendChunk()):e.json()}).then(function(e){e&&e.message&&t.Upload.emit(o.EVENTS.UPLOAD_FAILURE,t.file,e)})["catch"](function(){return t.Upload.emit(o.EVENTS.UPLOAD_FAILURE,t.file,{message:"ERROR_NETWORK"})})}},{key:"sendChunk",value:function(){var t=this;this.range_end>this.file_size&&(this.range_end=this.file_size,this.xLast=!0);var e=this.file[this.slice_method](this.range_start,this.range_end),r={Authorization:"Bearer "+this.options.token,"X-File-Name":this.file.name,"Content-Type":"application/octet-stream"};this.xLast&&(r["X-Last"]=!0),fetch(""+this.options.url,{method:"POST",mode:"cors",body:e,headers:r}).then(function(e){return e.ok?(t.range_start=parseInt(e.headers.get("X-Byte-Offset"),10),t.onChunkComplete()):e.json()}).then(function(e){e&&e.message&&t.Upload.emit(o.EVENTS.UPLOAD_FAILURE,t.file,e)})["catch"](function(){return t.Upload.emit(o.EVENTS.UPLOAD_FAILURE,t.file,{message:"ERROR_NETWORK"})})}},{key:"onChunkComplete",value:function(){return this.range_end===this.file_size?(this.Upload.emit(o.EVENTS.UPLOAD_SUCCESS,this.file),void this.Upload.emit(o.EVENTS.UPLOAD_PROGRESS,this.range_end,this.file_size)):(this.range_end=this.range_start+this.chunk_size,this.Upload.emit(o.EVENTS.UPLOAD_PROGRESS,this.range_start,this.file_size),void(this.is_paused||this.sendChunk()))}},{key:"start",value:function(){this.sendOptions()}},{key:"toggle",value:function(){this.is_paused=!this.is_paused,this.Upload.emit(o.EVENTS.UPLOAD_PAUSE,this.file,this.is_paused),this.is_paused||this.sendChunk()}},{key:"cancel",value:function(){this.Upload.emit(o.EVENTS.UPLOAD_FAILURE,this.file,{message:"ERROR_CANCEL"}),this.destroy()}},{key:"destroy",value:function(){this.is_paused=!0,this.file=!1}}]),t}();e["default"]=s,t.exports=e["default"]},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),s=r(2),u=n(s),a=r(0),l=function(){function t(e,r){i(this,t),this.file=e,this.Upload=r,this.options=r.options,this.responseHandler=this.responseHandler.bind(this),this.firstLoad=!0,this.renderIframe()}return o(t,[{key:"renderIframe",value:function(){this.iframe=(0,u["default"])({tagName:"iframe",className:"upload__iframe",attributes:{name:"postform",src:"about:none;",style:"display:none;"}}),this.iframe.onload=this.responseHandler,this.Upload.el.appendChild(this.iframe)}},{key:"start",value:function(){this.Upload.uploadForm.submit(),this.Upload.emit(a.EVENTS.UPLOAD_START,this.file)}},{key:"responseHandler",value:function(){if(this.firstLoad)return void(this.firstLoad=!1);try{var t=JSON.parse(this.iframe.contentWindow.document.body.innerText);if(200===t.status)return void this.Upload.emit(a.EVENTS.UPLOAD_SUCCESS,this.file);this.Upload.emit(a.EVENTS.UPLOAD_FAILURE,this.file,t)}catch(e){this.Upload.emit(a.EVENTS.UPLOAD_FAILURE,this.file,{message:"ERROR_NETWORK"})}}},{key:"destroy",value:function(){this.iframe.parentNode.removeChild(this.iframe)}}]),t}();e["default"]=l,t.exports=e["default"]},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},a=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();r(3),r(1);var l=r(5),f=n(l),c=r(4),h=n(c),p=r(7),d=n(p),y=r(8),v=n(y),_=r(9),m=n(_),g=r(2),b=n(g),E=r(0),w={url:null,authUrl:null,token:null,redirect:null,accept:null,bemPrefix:"upload",supportLegacy:!0,forceLegacy:!1,autoSubmit:!0,MESSAGES:E.MESSAGES},S=function(t){function e(t,r){i(this,e);var n=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.options=(0,h["default"])(w,r||{}),n.options.url=n.options.url.indexOf("://")===-1?location.protocol+"//"+n.options.url:n.options.url,n.options.authUrl=n.options.authUrl.indexOf("://")===-1?location.protocol+"//"+n.options.authUrl:n.options.authUrl,n.selectFileChange=n.selectFileChange.bind(n),n.eventListeners=[],n.currentFile=null,n.isCurrentlyUploading=!1,n.mount(t),n.options.token||(n.auth=new d["default"]("upload",n.options.authUrl),n.auth.on("ready",function(t){n.options.token=t.token})),n.browserSupported=n.isBrowserSupported(),n.legacyMode=n.options.supportLegacy&&!n.browserSupported||n.options.forceLegacy,n.browserSupported||n.legacyMode?(n.render(),n):(n.renderUnsupported(),o(n))}return s(e,t),a(e,[{key:"mount",value:function(t){switch("undefined"==typeof t?"undefined":u(t)){case"string":this.el=document.querySelector(t);break;case"object":this.el=t;break;default:this.emit(E.EVENTS.UPLOAD_ERROR,this.options.MESSAGES.ERROR_EL)}}},{key:"isBrowserSupported",value:function(){var t=!1;return window.File&&window.FileReader&&window.FileList&&window.Blob&&window.FormData&&document.querySelector&&(t=!0),t}},{key:"render",value:function(){this.uploadForm=(0,b["default"])({tagName:"form",className:this.options.bemPrefix+"__form",attributes:{action:this.options.url+"/multipart",method:"POST",encoding:"multipart/form-data",enctype:"multipart/form-data",target:"postform",file:this.file}}),this.uploadInput=(0,b["default"])({tagName:"input",className:this.options.bemPrefix+"__input",attributes:{name:"fileBegin",type:"file"}}),this.options.accept&&this.uploadInput.setAttribute("accept",this.options.accept),this.uploadAuth=(0,b["default"])({tagName:"input",attributes:{type:"hidden",name:"Authorization",value:"Bearer "+this.options.token}}),this.uploadName=(0,b["default"])({tagName:"input",attributes:{type:"hidden",name:"files"}}),this.uploadRedirect=(0,b["default"])({tagName:"input",attributes:{type:"hidden",name:"redirect",value:this.options.redirect}}),this.uploadForm.appendChild(this.uploadInput),this.uploadForm.appendChild(this.uploadAuth),this.uploadForm.appendChild(this.uploadName),this.uploadForm.appendChild(this.uploadRedirect),this.el.appendChild(this.uploadForm),this.eventHelper(this.uploadInput,"change",this.selectFileChange)}},{key:"renderUnsupported",value:function(){this.uploadUnsupported=(0,b["default"])({tagName:"p",className:this.options.bemPrefix+"__unsupported",text:this.options.MESSAGES.UNSUPPORTED_BROWSER}),this.el.appendChild(this.uploadUnsupported)}},{key:"getConfig",value:function(){var t=this;fetch(this.options.url+"/config",{method:"GET",mode:"cors",headers:{Authorization:"Bearer "+this.options.token}}).then(function(e){return e.ok?e.json():t.emit(E.EVENTS.UPLOAD_FAILURE,t.file,{message:"ERROR_NETWORK"})}).then(function(e){t.emit(E.EVENTS.UPLOAD_CONFIG,e),t.options.maxFileSize=e.maxFileSize})["catch"](function(){return t.emit(E.EVENTS.UPLOAD_FAILURE,t.file,{message:"ERROR_NETWORK"})})}},{key:"selectFile",value:function(){this.uploadInput.click()}},{key:"selectFileChange",value:function(t){if(this.legacyMode){var e=this.uploadInput.value.match(/[^\/\\]+$/);return this.uploadName.setAttribute("value",e),void this.uploadFile()}this.uploadName.setAttribute("value",t.target.files[0]);var r=t.target.files[0];this.addFile(r)}},{key:"addFile",value:function(t){this.currentFile=t,this.readFile(t),this.uploadFile(t),this.emit(E.EVENTS.UPLOAD_ADDEDFILE,t)}},{key:"uploadFile",value:function(t){this.currentUploader&&(this.currentUploader.destroy(),this.currentUploader=!1),this.currentUploader=this.legacyMode?new m["default"]({},this):new v["default"](t,this),this.options.autoSubmit&&this.currentUploader.start()}},{key:"startUpload",value:function(){this.currentUploader&&this.currentUploader.start()}},{key:"toggleUpload",value:function(){this.currentUploader&&this.currentUploader.toggle()}},{key:"cancelUpload",value:function(){this.currentUploader&&this.currentUploader.cancel()}},{key:"readFile",value:function(t){if(this.browserSupported&&""!==t.type){var e=new FileReader,r=function(e){this.emit(E.EVENTS.UPLOAD_THUMBNAIL,t,e.target.result)}.bind(this);e.onload=r,e.readAsDataURL(t)}}},{key:"eventHelper",value:function(t,e,r){t.addEventListener(e,r);var n=function(){t.removeEventListener(e,r)};this.eventListeners.push(n)}},{key:"destroy",value:function(){for(var t=0;t<this.eventListeners.length;t++)this.eventListeners.splice(t,1)[0]();this.el.parentNode.removeChild(this.el)}}]),e}(f["default"]);e["default"]=S,t.exports=e["default"]},function(t,e){"use strict";function r(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=0,r=t.length;e<r;++e)u[e]=t[e],a[t.charCodeAt(e)]=e;a["-".charCodeAt(0)]=62,a["_".charCodeAt(0)]=63}function n(t){var e,r,n,i,o,s,u=t.length;if(u%4>0)throw new Error("Invalid string. Length must be a multiple of 4");o="="===t[u-2]?2:"="===t[u-1]?1:0,s=new l(3*u/4-o),n=o>0?u-4:u;var f=0;for(e=0,r=0;e<n;e+=4,r+=3)i=a[t.charCodeAt(e)]<<18|a[t.charCodeAt(e+1)]<<12|a[t.charCodeAt(e+2)]<<6|a[t.charCodeAt(e+3)],s[f++]=i>>16&255,s[f++]=i>>8&255,s[f++]=255&i;return 2===o?(i=a[t.charCodeAt(e)]<<2|a[t.charCodeAt(e+1)]>>4,s[f++]=255&i):1===o&&(i=a[t.charCodeAt(e)]<<10|a[t.charCodeAt(e+1)]<<4|a[t.charCodeAt(e+2)]>>2,s[f++]=i>>8&255,s[f++]=255&i),s}function i(t){return u[t>>18&63]+u[t>>12&63]+u[t>>6&63]+u[63&t]}function o(t,e,r){for(var n,o=[],s=e;s<r;s+=3)n=(t[s]<<16)+(t[s+1]<<8)+t[s+2],o.push(i(n));return o.join("")}function s(t){for(var e,r=t.length,n=r%3,i="",s=[],a=16383,l=0,f=r-n;l<f;l+=a)s.push(o(t,l,l+a>f?f:l+a));return 1===n?(e=t[r-1],i+=u[e>>2],i+=u[e<<4&63],i+="=="):2===n&&(e=(t[r-2]<<8)+t[r-1],i+=u[e>>10],i+=u[e>>4&63],i+=u[e<<2&63],i+="="),s.push(i),s.join("")}e.toByteArray=n,e.fromByteArray=s;var u=[],a=[],l="undefined"!=typeof Uint8Array?Uint8Array:Array;r()},function(t,e){e.read=function(t,e,r,n,i){var o,s,u=8*i-n-1,a=(1<<u)-1,l=a>>1,f=-7,c=r?i-1:0,h=r?-1:1,p=t[e+c];for(c+=h,o=p&(1<<-f)-1,p>>=-f,f+=u;f>0;o=256*o+t[e+c],c+=h,f-=8);for(s=o&(1<<-f)-1,o>>=-f,f+=n;f>0;s=256*s+t[e+c],c+=h,f-=8);if(0===o)o=1-l;else{if(o===a)return s?NaN:(p?-1:1)*(1/0);s+=Math.pow(2,n),o-=l}return(p?-1:1)*s*Math.pow(2,o-n)},e.write=function(t,e,r,n,i,o){var s,u,a,l=8*o-i-1,f=(1<<l)-1,c=f>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:o-1,d=n?1:-1,y=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(u=isNaN(e)?1:0,s=f):(s=Math.floor(Math.log(e)/Math.LN2),e*(a=Math.pow(2,-s))<1&&(s--,a*=2),e+=s+c>=1?h/a:h*Math.pow(2,1-c),e*a>=2&&(s++,a/=2),s+c>=f?(u=0,s=f):s+c>=1?(u=(e*a-1)*Math.pow(2,i),s+=c):(u=e*Math.pow(2,c-1)*Math.pow(2,i),s=0));i>=8;t[r+p]=255&u,p+=d,u/=256,i-=8);for(s=s<<i|u,l+=i;l>0;t[r+p]=255&s,p+=d,s/=256,l-=8);t[r+p-d]|=128*y}},function(t,e){var r={}.toString;t.exports=Array.isArray||function(t){
return"[object Array]"==r.call(t)}},function(t,e,r){r(1),t.exports=self.fetch.bind(self)},function(t,e){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(n){"object"==typeof window&&(r=window)}t.exports=r},function(t,e){"use strict";function r(t,e){if(0===t)return"0 Byte";var r=1e3,n=e+1||3,i=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],o=Math.floor(Math.log(t)/Math.log(r));return parseFloat((t/Math.pow(r,o)).toFixed(n))+" "+i[o]}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=r,t.exports=e["default"]},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},a=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();r(3);var l=r(5),f=n(l),c=r(4),h=n(c),p=r(10),d=n(p),y=r(2),v=n(y),_=r(16),m=n(_),g=r(0),b={url:null,authUrl:null,token:null,redirect:null,accept:null,bemPrefix:"upload",supportLegacy:!0,forceLegacy:!1,autoSubmit:!0,pause:!0,cancel:!0,MESSAGES:g.MESSAGES},E=function(t,e){if(t instanceof f["default"]&&e instanceof f["default"]){var r=t.emit;t.emit=function(){return e.emit.apply(e,arguments),r.apply(this,arguments)}.bind(t)}},w=function(t){function e(t,r){i(this,e);var n=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.options=(0,h["default"])(b,r||{}),n.mount(t),n.eventListeners=[],n.upload=new d["default"](n.el,n.options),E(n.upload,n),n.upload.browserSupported||n.upload.legacyMode?n.upload.legacyMode?(n.initLegacy(),n.legacyStartHandler=n.legacyStartHandler.bind(n),n.legacySuccessHandler=n.legacySuccessHandler.bind(n),n.legacyFailureHandler=n.legacyFailureHandler.bind(n),n.upload.on(g.EVENTS.UPLOAD_START,n.legacyStartHandler),n.upload.on(g.EVENTS.UPLOAD_SUCCESS,n.legacySuccessHandler),n.upload.on(g.EVENTS.UPLOAD_FAILURE,n.legacyFailureHandler),n):(n.initModern(),n.startHandler=n.startHandler.bind(n),n.progressHandler=n.progressHandler.bind(n),n.successHandler=n.successHandler.bind(n),n.failureHandler=n.failureHandler.bind(n),n.thumbnailHandler=n.thumbnailHandler.bind(n),n.addedfileHandler=n.addedfileHandler.bind(n),n.pauseHandler=n.pauseHandler.bind(n),n.upload.on(g.EVENTS.UPLOAD_START,n.startHandler),n.upload.on(g.EVENTS.UPLOAD_PROGRESS,n.progressHandler),n.upload.on(g.EVENTS.UPLOAD_SUCCESS,n.successHandler),n.upload.on(g.EVENTS.UPLOAD_FAILURE,n.failureHandler),n.upload.on(g.EVENTS.UPLOAD_THUMBNAIL,n.thumbnailHandler),n.upload.on(g.EVENTS.UPLOAD_ADDEDFILE,n.addedfileHandler),n.upload.on(g.EVENTS.UPLOAD_PAUSE,n.pauseHandler),o(n)):o(n)}return s(e,t),a(e,[{key:"mount",value:function(t){switch("undefined"==typeof t?"undefined":u(t)){case"string":this.el=document.querySelector(t);break;case"object":this.el=t;break;default:this.emit(g.EVENTS.UPLOAD_FAILURE,{message:this.options.MESSAGES.ERROR_EL})}this.el.classList.add(this.options.bemPrefix)}},{key:"render",value:function(t){this.uploadContainer=(0,v["default"])({tagName:"div",className:this.options.bemPrefix+"__container"}),this.uploadPreview=(0,v["default"])({tagName:"div",className:this.options.bemPrefix+"__preview"}),this.uploadTitle=(0,v["default"])({tagName:"label",className:this.options.bemPrefix+"__title",text:t?this.options.MESSAGES.LEGACY_TITLE:this.options.MESSAGES.TITLE}),this.uploadSubTitle=(0,v["default"])({tagName:"label",className:this.options.bemPrefix+"__sub-title",text:t?this.options.MESSAGES.LEGACY_SUBTITLE:this.options.MESSAGES.SUBTITLE}),this.uploadError=(0,v["default"])({tagName:"div",className:this.options.bemPrefix+"__error"}),this.uploadContainer.appendChild(this.uploadPreview),this.uploadContainer.appendChild(this.uploadTitle),this.uploadContainer.appendChild(this.uploadSubTitle),this.uploadContainer.appendChild(this.uploadError),this.el.appendChild(this.uploadContainer)}},{key:"renderControls",value:function(){var t=this;(this.options.pause||this.options.cancel)&&(this.uploadControls=(0,v["default"])({tagName:"div",className:this.options.bemPrefix+"__controls"}),this.options.pause&&(this.uploadPauseButton=(0,v["default"])({tagName:"button",className:this.options.bemPrefix+"__pause-button",text:"Pause Upload",attributes:{disabled:!0}}),this.eventHelper(this.uploadPauseButton,"click",function(e){e.preventDefault(),e.stopPropagation(),t.upload.toggleUpload()}),this.uploadControls.appendChild(this.uploadPauseButton)),this.options.cancel&&(this.uploadCancelButton=(0,v["default"])({tagName:"button",className:this.options.bemPrefix+"__cancel-button",text:"Cancel Upload",attributes:{disabled:!0}}),this.eventHelper(this.uploadCancelButton,"click",function(e){e.preventDefault(),e.stopPropagation(),t.upload.cancelUpload()}),this.uploadControls.appendChild(this.uploadCancelButton)),this.uploadContainer.appendChild(this.uploadControls))}},{key:"renderProgress",value:function(){this.uploadProgress&&this.uploadProgress.parentNode.removeChild(this.uploadProgress),this.uploadProgress=(0,v["default"])({tagName:"div",className:this.options.bemPrefix+"__progress"}),this.uploadPreview.appendChild(this.uploadProgress)}},{key:"initModern",value:function(){var t=this;this.render(),this.renderControls(),this.eventHelper(this.el,g.EVENTS.FORM_DROP,function(e){e.preventDefault(),e.stopPropagation(),t.emit(g.EVENTS.FORM_DROP,e),t.el.classList.remove(t.options.bemPrefix+"--is-dragover"),t.upload.addFile(e.dataTransfer.files[0])}),this.eventHelper(this.el,g.EVENTS.FORM_DRAG,function(e){e.preventDefault(),e.stopPropagation(),t.emit(g.EVENTS.FORM_DRAG,e)}),this.eventHelper(this.el,g.EVENTS.FORM_DRAGSTART,function(e){e.preventDefault(),e.stopPropagation(),t.emit(g.EVENTS.FORM_DRAGSTART,e)}),this.eventHelper(this.el,g.EVENTS.FORM_DRAGEND,function(e){e.preventDefault(),e.stopPropagation(),t.emit(g.EVENTS.FORM_DRAGEND,e),t.el.classList.remove(t.options.bemPrefix+"--is-dragover")}),this.eventHelper(this.el,g.EVENTS.FORM_DRAGENTER,function(e){e.preventDefault(),e.stopPropagation(),t.emit(g.EVENTS.FORM_DRAGENTER,e),t.el.classList.add(t.options.bemPrefix+"--is-dragover")}),this.eventHelper(this.el,g.EVENTS.FORM_DRAGOVER,function(e){e.preventDefault(),e.stopPropagation(),t.emit(g.EVENTS.FORM_DRAGOVER,e),t.el.classList.add(t.options.bemPrefix+"--is-dragover")}),this.eventHelper(this.el,g.EVENTS.FORM_DRAGLEAVE,function(e){e.preventDefault(),e.stopPropagation(),t.emit(g.EVENTS.FORM_DRAGLEAVE,e),t.el.classList.remove(t.options.bemPrefix+"--is-dragover")}),this.eventHelper(this.el,"click",function(){t.upload.selectFile()})}},{key:"initLegacy",value:function(){var t=this;this.render(!0),this.el.classList.add("upload--is-legacy"),this.eventHelper(this.el,"click",function(){t.upload.selectFile()})}},{key:"startHandler",value:function(){this.renderProgress(),this.uploadError.innerText="",this.uploadError.classList.remove("upload__error--active"),this.uploadPauseButton&&(this.uploadPauseButton.classList.add("upload__pause-button--is-enabled"),this.uploadPauseButton.disabled=!1),this.uploadCancelButton&&(this.uploadCancelButton.classList.add("upload__cancel-button--is-enabled"),this.uploadCancelButton.disabled=!1)}},{key:"progressHandler",value:function(t,e){this.uploadProgress&&(this.uploadProgress.style.paddingBottom=parseFloat(Math.round(t/e*100))+"%")}},{key:"successHandler",value:function(){var t=this;setTimeout(function(){t.uploadProgress.classList.add(t.options.bemPrefix+"__progress--complete"),t.uploadPauseButton&&(t.uploadPauseButton.classList.remove("upload__pause-button--is-enabled"),t.uploadPauseButton.disabled=!0),t.uploadCancelButton&&(t.uploadCancelButton.classList.remove("upload__cancel-button--is-enabled"),t.uploadCancelButton.disabled=!0)},1e3)}},{key:"failureHandler",value:function(t,e){this.renderProgress(),this.uploadError.innerText=this.options.MESSAGES[e.message],this.uploadError.classList.add("upload__error--active"),this.uploadProgress.classList.add("upload__progress--error"),this.uploadPauseButton&&(this.uploadPauseButton.classList.remove("upload__pause-button--is-enabled"),this.uploadPauseButton.disabled=!0),this.uploadCancelButton&&(this.uploadCancelButton.classList.remove("upload__cancel-button--is-enabled"),this.uploadCancelButton.disabled=!0)}},{key:"thumbnailHandler",value:function(t,e){this.uploadPreview.style.backgroundImage=e?"url("+(e?e:"")+")":null,this.uploadPreview.style.backgroundSize=e?"cover":null}},{key:"addedfileHandler",value:function(t){this.uploadTitle.innerText=t.name,this.uploadSubTitle.innerText=(0,m["default"])(t.size)}},{key:"pauseHandler",value:function(t,e){return e?(this.uploadPauseButton.classList.add("upload__pause-button--paused"),void this.uploadProgress.classList.add("upload__progress--paused")):(this.uploadPauseButton.classList.remove("upload__pause-button--paused"),void this.uploadProgress.classList.remove("upload__progress--paused"))}},{key:"legacyStartHandler",value:function(){this.renderProgress(),this.uploadProgress.classList.add(this.options.bemPrefix+"__progress--loading"),this.uploadError.innerText=""}},{key:"legacySuccessHandler",value:function(){var t=this;setTimeout(function(){t.uploadProgress.classList.remove(t.options.bemPrefix+"__progress--loading"),t.uploadProgress.classList.add(t.options.bemPrefix+"__progress--complete")},1e3)}},{key:"legacyFailureHandler",value:function(t,e){this.renderProgress(),this.uploadError.innerText=this.options.MESSAGES[e.message],this.uploadError.classList.add("upload__error--active"),this.uploadProgress.classList.add("upload__progress--error")}},{key:"eventHelper",value:function(t,e,r){t.addEventListener(e,r);var n=function(){t.removeEventListener(e,r)};this.eventListeners.push(n)}},{key:"destroy",value:function(){for(var t=0;t<this.eventListeners.length;t++)this.eventListeners.splice(t,1)[0]();this.el.parentNode.removeChild(this.el)}}]),e}(f["default"]);e["default"]=w,t.exports=e["default"]}])});
},{}],4:[function(require,module,exports){
var isFunction = require('is-function')

module.exports = forEach

var toString = Object.prototype.toString
var hasOwnProperty = Object.prototype.hasOwnProperty

function forEach(list, iterator, context) {
    if (!isFunction(iterator)) {
        throw new TypeError('iterator must be a function')
    }

    if (arguments.length < 3) {
        context = this
    }
    
    if (toString.call(list) === '[object Array]')
        forEachArray(list, iterator, context)
    else if (typeof list === 'string')
        forEachString(list, iterator, context)
    else
        forEachObject(list, iterator, context)
}

function forEachArray(array, iterator, context) {
    for (var i = 0, len = array.length; i < len; i++) {
        if (hasOwnProperty.call(array, i)) {
            iterator.call(context, array[i], i, array)
        }
    }
}

function forEachString(string, iterator, context) {
    for (var i = 0, len = string.length; i < len; i++) {
        // no such thing as a sparse string.
        iterator.call(context, string.charAt(i), i, string)
    }
}

function forEachObject(object, iterator, context) {
    for (var k in object) {
        if (hasOwnProperty.call(object, k)) {
            iterator.call(context, object[k], k, object)
        }
    }
}

},{"is-function":6}],5:[function(require,module,exports){
(function (global){
if (typeof window !== "undefined") {
    module.exports = window;
} else if (typeof global !== "undefined") {
    module.exports = global;
} else if (typeof self !== "undefined"){
    module.exports = self;
} else {
    module.exports = {};
}

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{}],6:[function(require,module,exports){
module.exports = isFunction

var toString = Object.prototype.toString

function isFunction (fn) {
  var string = toString.call(fn)
  return string === '[object Function]' ||
    (typeof fn === 'function' && string !== '[object RegExp]') ||
    (typeof window !== 'undefined' &&
     // IE8 and below
     (fn === window.setTimeout ||
      fn === window.alert ||
      fn === window.confirm ||
      fn === window.prompt))
};

},{}],7:[function(require,module,exports){
var trim = require('trim')
  , forEach = require('for-each')
  , isArray = function(arg) {
      return Object.prototype.toString.call(arg) === '[object Array]';
    }

module.exports = function (headers) {
  if (!headers)
    return {}

  var result = {}

  forEach(
      trim(headers).split('\n')
    , function (row) {
        var index = row.indexOf(':')
          , key = trim(row.slice(0, index)).toLowerCase()
          , value = trim(row.slice(index + 1))

        if (typeof(result[key]) === 'undefined') {
          result[key] = value
        } else if (isArray(result[key])) {
          result[key].push(value)
        } else {
          result[key] = [ result[key], value ]
        }
      }
  )

  return result
}
},{"for-each":4,"trim":9}],8:[function(require,module,exports){
module.exports = function(node, value) {
  var text = (node.textContent !== undefined ?
    'textContent' : 'innerText'
  )

  if (typeof value != 'undefined') {
    node[text] = value
  }

  return node[text]
}

},{}],9:[function(require,module,exports){

exports = module.exports = trim;

function trim(str){
  return str.replace(/^\s*|\s*$/g, '');
}

exports.left = function(str){
  return str.replace(/^\s*/, '');
};

exports.right = function(str){
  return str.replace(/\s*$/, '');
};

},{}],10:[function(require,module,exports){
"use strict";
var window = require("global/window")
var isFunction = require("is-function")
var parseHeaders = require("parse-headers")
var xtend = require("xtend")

module.exports = createXHR
createXHR.XMLHttpRequest = window.XMLHttpRequest || noop
createXHR.XDomainRequest = "withCredentials" in (new createXHR.XMLHttpRequest()) ? createXHR.XMLHttpRequest : window.XDomainRequest

forEachArray(["get", "put", "post", "patch", "head", "delete"], function(method) {
    createXHR[method === "delete" ? "del" : method] = function(uri, options, callback) {
        options = initParams(uri, options, callback)
        options.method = method.toUpperCase()
        return _createXHR(options)
    }
})

function forEachArray(array, iterator) {
    for (var i = 0; i < array.length; i++) {
        iterator(array[i])
    }
}

function isEmpty(obj){
    for(var i in obj){
        if(obj.hasOwnProperty(i)) return false
    }
    return true
}

function initParams(uri, options, callback) {
    var params = uri

    if (isFunction(options)) {
        callback = options
        if (typeof uri === "string") {
            params = {uri:uri}
        }
    } else {
        params = xtend(options, {uri: uri})
    }

    params.callback = callback
    return params
}

function createXHR(uri, options, callback) {
    options = initParams(uri, options, callback)
    return _createXHR(options)
}

function _createXHR(options) {
    if(typeof options.callback === "undefined"){
        throw new Error("callback argument missing")
    }

    var called = false
    var callback = function cbOnce(err, response, body){
        if(!called){
            called = true
            options.callback(err, response, body)
        }
    }

    function readystatechange() {
        if (xhr.readyState === 4) {
            loadFunc()
        }
    }

    function getBody() {
        // Chrome with requestType=blob throws errors arround when even testing access to responseText
        var body = undefined

        if (xhr.response) {
            body = xhr.response
        } else {
            body = xhr.responseText || getXml(xhr)
        }

        if (isJson) {
            try {
                body = JSON.parse(body)
            } catch (e) {}
        }

        return body
    }

    var failureResponse = {
                body: undefined,
                headers: {},
                statusCode: 0,
                method: method,
                url: uri,
                rawRequest: xhr
            }

    function errorFunc(evt) {
        clearTimeout(timeoutTimer)
        if(!(evt instanceof Error)){
            evt = new Error("" + (evt || "Unknown XMLHttpRequest Error") )
        }
        evt.statusCode = 0
        return callback(evt, failureResponse)
    }

    // will load the data & process the response in a special response object
    function loadFunc() {
        if (aborted) return
        var status
        clearTimeout(timeoutTimer)
        if(options.useXDR && xhr.status===undefined) {
            //IE8 CORS GET successful response doesn't have a status field, but body is fine
            status = 200
        } else {
            status = (xhr.status === 1223 ? 204 : xhr.status)
        }
        var response = failureResponse
        var err = null

        if (status !== 0){
            response = {
                body: getBody(),
                statusCode: status,
                method: method,
                headers: {},
                url: uri,
                rawRequest: xhr
            }
            if(xhr.getAllResponseHeaders){ //remember xhr can in fact be XDR for CORS in IE
                response.headers = parseHeaders(xhr.getAllResponseHeaders())
            }
        } else {
            err = new Error("Internal XMLHttpRequest Error")
        }
        return callback(err, response, response.body)
    }

    var xhr = options.xhr || null

    if (!xhr) {
        if (options.cors || options.useXDR) {
            xhr = new createXHR.XDomainRequest()
        }else{
            xhr = new createXHR.XMLHttpRequest()
        }
    }

    var key
    var aborted
    var uri = xhr.url = options.uri || options.url
    var method = xhr.method = options.method || "GET"
    var body = options.body || options.data || null
    var headers = xhr.headers = options.headers || {}
    var sync = !!options.sync
    var isJson = false
    var timeoutTimer

    if ("json" in options) {
        isJson = true
        headers["accept"] || headers["Accept"] || (headers["Accept"] = "application/json") //Don't override existing accept header declared by user
        if (method !== "GET" && method !== "HEAD") {
            headers["content-type"] || headers["Content-Type"] || (headers["Content-Type"] = "application/json") //Don't override existing accept header declared by user
            body = JSON.stringify(options.json)
        }
    }

    xhr.onreadystatechange = readystatechange
    xhr.onload = loadFunc
    xhr.onerror = errorFunc
    // IE9 must have onprogress be set to a unique function.
    xhr.onprogress = function () {
        // IE must die
    }
    xhr.ontimeout = errorFunc
    xhr.open(method, uri, !sync, options.username, options.password)
    //has to be after open
    if(!sync) {
        xhr.withCredentials = !!options.withCredentials
    }
    // Cannot set timeout with sync request
    // not setting timeout on the xhr object, because of old webkits etc. not handling that correctly
    // both npm's request and jquery 1.x use this kind of timeout, so this is being consistent
    if (!sync && options.timeout > 0 ) {
        timeoutTimer = setTimeout(function(){
            aborted=true//IE9 may still call readystatechange
            xhr.abort("timeout")
            var e = new Error("XMLHttpRequest timeout")
            e.code = "ETIMEDOUT"
            errorFunc(e)
        }, options.timeout )
    }

    if (xhr.setRequestHeader) {
        for(key in headers){
            if(headers.hasOwnProperty(key)){
                xhr.setRequestHeader(key, headers[key])
            }
        }
    } else if (options.headers && !isEmpty(options.headers)) {
        throw new Error("Headers cannot be set on an XDomainRequest object")
    }

    if ("responseType" in options) {
        xhr.responseType = options.responseType
    }

    if ("beforeSend" in options &&
        typeof options.beforeSend === "function"
    ) {
        options.beforeSend(xhr)
    }

    xhr.send(body)

    return xhr


}

function getXml(xhr) {
    if (xhr.responseType === "document") {
        return xhr.responseXML
    }
    var firefoxBugTakenEffect = xhr.status === 204 && xhr.responseXML && xhr.responseXML.documentElement.nodeName === "parsererror"
    if (xhr.responseType === "" && !firefoxBugTakenEffect) {
        return xhr.responseXML
    }

    return null
}

function noop() {}

},{"global/window":5,"is-function":6,"parse-headers":7,"xtend":11}],11:[function(require,module,exports){
module.exports = extend

var hasOwnProperty = Object.prototype.hasOwnProperty;

function extend() {
    var target = {}

    for (var i = 0; i < arguments.length; i++) {
        var source = arguments[i]

        for (var key in source) {
            if (hasOwnProperty.call(source, key)) {
                target[key] = source[key]
            }
        }
    }

    return target
}

},{}]},{},[1]);
