!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.LivelyUpload=e()}}(function(){var define,module,exports;return function e(t,n,r){function i(o,a){if(!n[o]){if(!t[o]){var u="function"==typeof require&&require;if(!a&&u)return u(o,!0);if(s)return s(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var h=n[o]={exports:{}};t[o][0].call(h.exports,function(e){var n=t[o][1][e];return i(n?n:e)},h,h.exports,e,t,n,r)}return n[o].exports}for(var s="function"==typeof require&&require,o=0;o<r.length;o++)i(r[o]);return i}({1:[function(require,module,exports){!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.LivelyAuth=t():e.LivelyAuth=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(module,exports,__webpack_require__){eval("'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n	value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _events = __webpack_require__(1);\n\n__webpack_require__(2);\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar defaultOptions = {\n	timeout: 5000,\n	headers: {}\n};\n\nvar defaultHeaders = {\n	Accept: 'application/json'\n};\n\n/**\n * @class Lively Video authorization client\n */\n\nvar Authorization = function (_EventEmitter) {\n	_inherits(Authorization, _EventEmitter);\n\n	/**\n  * @constructs Authorization\n  * @param {string} scope - Scope of the authorization\n  * @param {string} url - Url of your company's authorization endpoint. The expected response is {'token': 'unique token', 'expire': 'RFC3339 expiration time'}\n  * @param {Config} [options] - Configurable options for the Authorization class\n  * @param {string} [options.timeout=5000] - Authenticated request timeout in milliseconds. Timed out errors will return an Error('authorization: timeout')\n  * @param {Object} [options.headers] - Additional headers to use for the request\n  * @throws Will throw an error if no scope or no url is provided\n  */\n	function Authorization(scope, url) {\n		var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n		_classCallCheck(this, Authorization);\n\n		var _this = _possibleConstructorReturn(this, (Authorization.__proto__ || Object.getPrototypeOf(Authorization)).call(this));\n\n		if (!scope) {\n			throw new Error('scope is required');\n		}\n\n		if (!url) {\n			throw new Error('authorization server url is required');\n		}\n\n		// require parameters\n		_this._options = Object.assign({}, defaultOptions, options);\n\n		if (url.indexOf('?') === -1) {\n			_this._url = url + '?scope=' + scope;\n		} else {\n			_this._url = url + '&scope=' + scope;\n		}\n\n		// internal\n		_this._stopped = false;\n		_this._fatalError = null;\n		_this._token = null;\n		_this._retries = [0, // immediate\n		200, // 200ms\n		1000, // 1s\n		3000 // 3s\n		];\n		_this._retry = 0;\n		_this._autorefresh = null;\n\n		_this._headers = Object.assign({}, defaultHeaders, options.headers);\n		_this._retryRequest();\n		return _this;\n	}\n\n	_createClass(Authorization, [{\n		key: 'destroy',\n		value: function destroy() {\n			this._stopped = true;\n		}\n\n		/**\n   * This callback will execute a request which requires the auth token.\n   * @callback cbRequest\n   * @param {Error} e - Returns a timeout error (Error('authorization: timeout')) or a fatal error\n   * @param {string} token - The authorization bearer token to use in Lively Video API requests\n   */\n\n		/**\n   * Execute a request which requires an authorization token when the token is available\n   * @param {cbRequest} cb - The callback that executes the request.\n   */\n\n	}, {\n		key: 'request',\n		value: function request() {\n			var _this2 = this;\n\n			var cb = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : function () {};\n\n			if (this._fatalError) {\n				cb(this._fatalError);\n				return;\n			}\n\n			if (this._token !== null) {\n				cb(null, this._token);\n				return;\n			}\n\n			var done = false;\n			var pass = function pass() {\n				if (!done) {\n					done = true;\n					cb(null, _this2._token);\n				}\n			};\n\n			var timeout = function timeout() {\n				if (!done) {\n					done = true;\n					cb(new Error('authorization: timeout'));\n				}\n			};\n\n			var t = setTimeout(function () {\n				_this2.removeListener('ready', pass);\n				timeout();\n			}, this._options.timeout);\n\n			this.once('ready', function () {\n				clearTimeout(t);\n				pass();\n			});\n		}\n\n		/**\n   * Should be called if a Lively Video endpoint returned an 401 error. A new request will be issued to the authorization server's endpoint to get a new token.\n   */\n\n	}, {\n		key: 'refreshToken',\n		value: function refreshToken() {\n			var _this3 = this;\n\n			if (this._token !== null) {\n				if (this._autorefresh !== null) {\n					clearTimeout(this._autorefresh);\n					this._autorefresh = null;\n				}\n				this._token = null;\n				(function () {\n					_this3._retryRequest();\n				})();\n			}\n		}\n\n		/**\n   * Make a request or retry after the current retry number's delay\n   * @ignore\n   */\n\n	}, {\n		key: '_retryRequest',\n		value: function _retryRequest() {\n			var _this4 = this;\n\n			var retry = this._retries[this._retry];\n			if (retry) {\n				setTimeout(function () {\n					_this4._makeRequest();\n				}, retry);\n				return;\n			}\n			this._makeRequest();\n		}\n\n		/**\n   * Make a request to the authorization server.\n   * @ignore\n   */\n\n	}, {\n		key: '_makeRequest',\n		value: function _makeRequest() {\n			var _this5 = this;\n\n			fetch(this._url, {\n				credentials: 'same-origin',\n				headers: this._headers\n			}).then(function (response) {\n				if (response.status >= 200 && response.status < 300) {\n					return response.json();\n				}\n				if (response.status === 401) {\n					var e = new Error('authorization: unauthorized');\n					e.fatal = true;\n					throw e;\n				}\n				if (response.status === 403) {\n					var _e = new Error('authorization: forbidden');\n					_e.fatal = true;\n					throw _e;\n				}\n				throw new Error('authorization: non-200 response code from auth server');\n			}).then(function (json) {\n				_this5._token = json.token;\n				_this5._retry = 0;\n				_this5.emit('ready', {\n					token: json.token\n				});\n\n				// re-request a minute before expiration\n				var retryAfter = new Date(json.expire).getTime() - Date.now() - 60 * 1000;\n				_this5._autorefresh = setTimeout(function () {\n					_this5._autorefresh = null;\n					if (!_this5._stopped) {\n						_this5._retryRequest();\n					}\n				}, retryAfter);\n			}).catch(function (e) {\n				_this5._token = null;\n\n				if (e.fatal) {\n					_this5._fatalError = e;\n					return;\n				}\n\n				_this5._retryRequest();\n				if (_this5._retry < _this5._retries.length - 1) {\n					_this5._retry++;\n				}\n			});\n		}\n	}]);\n\n	return Authorization;\n}(_events.EventEmitter);\n\nexports.default = Authorization;\nmodule.exports = exports['default'];\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/index.js\n// module id = 0\n// module chunks = 0\n//# sourceURL=webpack:///./src/index.js?")},function(module,exports){eval("// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nfunction EventEmitter() {\n  this._events = this._events || {};\n  this._maxListeners = this._maxListeners || undefined;\n}\nmodule.exports = EventEmitter;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nEventEmitter.defaultMaxListeners = 10;\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function(n) {\n  if (!isNumber(n) || n < 0 || isNaN(n))\n    throw TypeError('n must be a positive number');\n  this._maxListeners = n;\n  return this;\n};\n\nEventEmitter.prototype.emit = function(type) {\n  var er, handler, len, args, i, listeners;\n\n  if (!this._events)\n    this._events = {};\n\n  // If there is no 'error' event listener then throw.\n  if (type === 'error') {\n    if (!this._events.error ||\n        (isObject(this._events.error) && !this._events.error.length)) {\n      er = arguments[1];\n      if (er instanceof Error) {\n        throw er; // Unhandled 'error' event\n      } else {\n        // At least give some kind of context to the user\n        var err = new Error('Uncaught, unspecified \"error\" event. (' + er + ')');\n        err.context = er;\n        throw err;\n      }\n    }\n  }\n\n  handler = this._events[type];\n\n  if (isUndefined(handler))\n    return false;\n\n  if (isFunction(handler)) {\n    switch (arguments.length) {\n      // fast cases\n      case 1:\n        handler.call(this);\n        break;\n      case 2:\n        handler.call(this, arguments[1]);\n        break;\n      case 3:\n        handler.call(this, arguments[1], arguments[2]);\n        break;\n      // slower\n      default:\n        args = Array.prototype.slice.call(arguments, 1);\n        handler.apply(this, args);\n    }\n  } else if (isObject(handler)) {\n    args = Array.prototype.slice.call(arguments, 1);\n    listeners = handler.slice();\n    len = listeners.length;\n    for (i = 0; i < len; i++)\n      listeners[i].apply(this, args);\n  }\n\n  return true;\n};\n\nEventEmitter.prototype.addListener = function(type, listener) {\n  var m;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events)\n    this._events = {};\n\n  // To avoid recursion in the case that type === \"newListener\"! Before\n  // adding it to the listeners, first emit \"newListener\".\n  if (this._events.newListener)\n    this.emit('newListener', type,\n              isFunction(listener.listener) ?\n              listener.listener : listener);\n\n  if (!this._events[type])\n    // Optimize the case of one listener. Don't need the extra array object.\n    this._events[type] = listener;\n  else if (isObject(this._events[type]))\n    // If we've already got an array, just append.\n    this._events[type].push(listener);\n  else\n    // Adding the second element, need to change to array.\n    this._events[type] = [this._events[type], listener];\n\n  // Check for listener leak\n  if (isObject(this._events[type]) && !this._events[type].warned) {\n    if (!isUndefined(this._maxListeners)) {\n      m = this._maxListeners;\n    } else {\n      m = EventEmitter.defaultMaxListeners;\n    }\n\n    if (m && m > 0 && this._events[type].length > m) {\n      this._events[type].warned = true;\n      console.error('(node) warning: possible EventEmitter memory ' +\n                    'leak detected. %d listeners added. ' +\n                    'Use emitter.setMaxListeners() to increase limit.',\n                    this._events[type].length);\n      if (typeof console.trace === 'function') {\n        // not supported in IE 10\n        console.trace();\n      }\n    }\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.once = function(type, listener) {\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  var fired = false;\n\n  function g() {\n    this.removeListener(type, g);\n\n    if (!fired) {\n      fired = true;\n      listener.apply(this, arguments);\n    }\n  }\n\n  g.listener = listener;\n  this.on(type, g);\n\n  return this;\n};\n\n// emits a 'removeListener' event iff the listener was removed\nEventEmitter.prototype.removeListener = function(type, listener) {\n  var list, position, length, i;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events || !this._events[type])\n    return this;\n\n  list = this._events[type];\n  length = list.length;\n  position = -1;\n\n  if (list === listener ||\n      (isFunction(list.listener) && list.listener === listener)) {\n    delete this._events[type];\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n\n  } else if (isObject(list)) {\n    for (i = length; i-- > 0;) {\n      if (list[i] === listener ||\n          (list[i].listener && list[i].listener === listener)) {\n        position = i;\n        break;\n      }\n    }\n\n    if (position < 0)\n      return this;\n\n    if (list.length === 1) {\n      list.length = 0;\n      delete this._events[type];\n    } else {\n      list.splice(position, 1);\n    }\n\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.removeAllListeners = function(type) {\n  var key, listeners;\n\n  if (!this._events)\n    return this;\n\n  // not listening for removeListener, no need to emit\n  if (!this._events.removeListener) {\n    if (arguments.length === 0)\n      this._events = {};\n    else if (this._events[type])\n      delete this._events[type];\n    return this;\n  }\n\n  // emit removeListener for all listeners on all events\n  if (arguments.length === 0) {\n    for (key in this._events) {\n      if (key === 'removeListener') continue;\n      this.removeAllListeners(key);\n    }\n    this.removeAllListeners('removeListener');\n    this._events = {};\n    return this;\n  }\n\n  listeners = this._events[type];\n\n  if (isFunction(listeners)) {\n    this.removeListener(type, listeners);\n  } else if (listeners) {\n    // LIFO order\n    while (listeners.length)\n      this.removeListener(type, listeners[listeners.length - 1]);\n  }\n  delete this._events[type];\n\n  return this;\n};\n\nEventEmitter.prototype.listeners = function(type) {\n  var ret;\n  if (!this._events || !this._events[type])\n    ret = [];\n  else if (isFunction(this._events[type]))\n    ret = [this._events[type]];\n  else\n    ret = this._events[type].slice();\n  return ret;\n};\n\nEventEmitter.prototype.listenerCount = function(type) {\n  if (this._events) {\n    var evlistener = this._events[type];\n\n    if (isFunction(evlistener))\n      return 1;\n    else if (evlistener)\n      return evlistener.length;\n  }\n  return 0;\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  return emitter.listenerCount(type);\n};\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/events/events.js\n// module id = 1\n// module chunks = 0\n//# sourceURL=webpack:///./~/events/events.js?")},function(module,exports){eval("(function(self) {\n  'use strict';\n\n  if (self.fetch) {\n    return\n  }\n\n  var support = {\n    searchParams: 'URLSearchParams' in self,\n    iterable: 'Symbol' in self && 'iterator' in Symbol,\n    blob: 'FileReader' in self && 'Blob' in self && (function() {\n      try {\n        new Blob()\n        return true\n      } catch(e) {\n        return false\n      }\n    })(),\n    formData: 'FormData' in self,\n    arrayBuffer: 'ArrayBuffer' in self\n  }\n\n  function normalizeName(name) {\n    if (typeof name !== 'string') {\n      name = String(name)\n    }\n    if (/[^a-z0-9\\-#$%&'*+.\\^_`|~]/i.test(name)) {\n      throw new TypeError('Invalid character in header field name')\n    }\n    return name.toLowerCase()\n  }\n\n  function normalizeValue(value) {\n    if (typeof value !== 'string') {\n      value = String(value)\n    }\n    return value\n  }\n\n  // Build a destructive iterator for the value list\n  function iteratorFor(items) {\n    var iterator = {\n      next: function() {\n        var value = items.shift()\n        return {done: value === undefined, value: value}\n      }\n    }\n\n    if (support.iterable) {\n      iterator[Symbol.iterator] = function() {\n        return iterator\n      }\n    }\n\n    return iterator\n  }\n\n  function Headers(headers) {\n    this.map = {}\n\n    if (headers instanceof Headers) {\n      headers.forEach(function(value, name) {\n        this.append(name, value)\n      }, this)\n\n    } else if (headers) {\n      Object.getOwnPropertyNames(headers).forEach(function(name) {\n        this.append(name, headers[name])\n      }, this)\n    }\n  }\n\n  Headers.prototype.append = function(name, value) {\n    name = normalizeName(name)\n    value = normalizeValue(value)\n    var list = this.map[name]\n    if (!list) {\n      list = []\n      this.map[name] = list\n    }\n    list.push(value)\n  }\n\n  Headers.prototype['delete'] = function(name) {\n    delete this.map[normalizeName(name)]\n  }\n\n  Headers.prototype.get = function(name) {\n    var values = this.map[normalizeName(name)]\n    return values ? values[0] : null\n  }\n\n  Headers.prototype.getAll = function(name) {\n    return this.map[normalizeName(name)] || []\n  }\n\n  Headers.prototype.has = function(name) {\n    return this.map.hasOwnProperty(normalizeName(name))\n  }\n\n  Headers.prototype.set = function(name, value) {\n    this.map[normalizeName(name)] = [normalizeValue(value)]\n  }\n\n  Headers.prototype.forEach = function(callback, thisArg) {\n    Object.getOwnPropertyNames(this.map).forEach(function(name) {\n      this.map[name].forEach(function(value) {\n        callback.call(thisArg, value, name, this)\n      }, this)\n    }, this)\n  }\n\n  Headers.prototype.keys = function() {\n    var items = []\n    this.forEach(function(value, name) { items.push(name) })\n    return iteratorFor(items)\n  }\n\n  Headers.prototype.values = function() {\n    var items = []\n    this.forEach(function(value) { items.push(value) })\n    return iteratorFor(items)\n  }\n\n  Headers.prototype.entries = function() {\n    var items = []\n    this.forEach(function(value, name) { items.push([name, value]) })\n    return iteratorFor(items)\n  }\n\n  if (support.iterable) {\n    Headers.prototype[Symbol.iterator] = Headers.prototype.entries\n  }\n\n  function consumed(body) {\n    if (body.bodyUsed) {\n      return Promise.reject(new TypeError('Already read'))\n    }\n    body.bodyUsed = true\n  }\n\n  function fileReaderReady(reader) {\n    return new Promise(function(resolve, reject) {\n      reader.onload = function() {\n        resolve(reader.result)\n      }\n      reader.onerror = function() {\n        reject(reader.error)\n      }\n    })\n  }\n\n  function readBlobAsArrayBuffer(blob) {\n    var reader = new FileReader()\n    reader.readAsArrayBuffer(blob)\n    return fileReaderReady(reader)\n  }\n\n  function readBlobAsText(blob) {\n    var reader = new FileReader()\n    reader.readAsText(blob)\n    return fileReaderReady(reader)\n  }\n\n  function Body() {\n    this.bodyUsed = false\n\n    this._initBody = function(body) {\n      this._bodyInit = body\n      if (typeof body === 'string') {\n        this._bodyText = body\n      } else if (support.blob && Blob.prototype.isPrototypeOf(body)) {\n        this._bodyBlob = body\n      } else if (support.formData && FormData.prototype.isPrototypeOf(body)) {\n        this._bodyFormData = body\n      } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {\n        this._bodyText = body.toString()\n      } else if (!body) {\n        this._bodyText = ''\n      } else if (support.arrayBuffer && ArrayBuffer.prototype.isPrototypeOf(body)) {\n        // Only support ArrayBuffers for POST method.\n        // Receiving ArrayBuffers happens via Blobs, instead.\n      } else {\n        throw new Error('unsupported BodyInit type')\n      }\n\n      if (!this.headers.get('content-type')) {\n        if (typeof body === 'string') {\n          this.headers.set('content-type', 'text/plain;charset=UTF-8')\n        } else if (this._bodyBlob && this._bodyBlob.type) {\n          this.headers.set('content-type', this._bodyBlob.type)\n        } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {\n          this.headers.set('content-type', 'application/x-www-form-urlencoded;charset=UTF-8')\n        }\n      }\n    }\n\n    if (support.blob) {\n      this.blob = function() {\n        var rejected = consumed(this)\n        if (rejected) {\n          return rejected\n        }\n\n        if (this._bodyBlob) {\n          return Promise.resolve(this._bodyBlob)\n        } else if (this._bodyFormData) {\n          throw new Error('could not read FormData body as blob')\n        } else {\n          return Promise.resolve(new Blob([this._bodyText]))\n        }\n      }\n\n      this.arrayBuffer = function() {\n        return this.blob().then(readBlobAsArrayBuffer)\n      }\n\n      this.text = function() {\n        var rejected = consumed(this)\n        if (rejected) {\n          return rejected\n        }\n\n        if (this._bodyBlob) {\n          return readBlobAsText(this._bodyBlob)\n        } else if (this._bodyFormData) {\n          throw new Error('could not read FormData body as text')\n        } else {\n          return Promise.resolve(this._bodyText)\n        }\n      }\n    } else {\n      this.text = function() {\n        var rejected = consumed(this)\n        return rejected ? rejected : Promise.resolve(this._bodyText)\n      }\n    }\n\n    if (support.formData) {\n      this.formData = function() {\n        return this.text().then(decode)\n      }\n    }\n\n    this.json = function() {\n      return this.text().then(JSON.parse)\n    }\n\n    return this\n  }\n\n  // HTTP methods whose capitalization should be normalized\n  var methods = ['DELETE', 'GET', 'HEAD', 'OPTIONS', 'POST', 'PUT']\n\n  function normalizeMethod(method) {\n    var upcased = method.toUpperCase()\n    return (methods.indexOf(upcased) > -1) ? upcased : method\n  }\n\n  function Request(input, options) {\n    options = options || {}\n    var body = options.body\n    if (Request.prototype.isPrototypeOf(input)) {\n      if (input.bodyUsed) {\n        throw new TypeError('Already read')\n      }\n      this.url = input.url\n      this.credentials = input.credentials\n      if (!options.headers) {\n        this.headers = new Headers(input.headers)\n      }\n      this.method = input.method\n      this.mode = input.mode\n      if (!body) {\n        body = input._bodyInit\n        input.bodyUsed = true\n      }\n    } else {\n      this.url = input\n    }\n\n    this.credentials = options.credentials || this.credentials || 'omit'\n    if (options.headers || !this.headers) {\n      this.headers = new Headers(options.headers)\n    }\n    this.method = normalizeMethod(options.method || this.method || 'GET')\n    this.mode = options.mode || this.mode || null\n    this.referrer = null\n\n    if ((this.method === 'GET' || this.method === 'HEAD') && body) {\n      throw new TypeError('Body not allowed for GET or HEAD requests')\n    }\n    this._initBody(body)\n  }\n\n  Request.prototype.clone = function() {\n    return new Request(this)\n  }\n\n  function decode(body) {\n    var form = new FormData()\n    body.trim().split('&').forEach(function(bytes) {\n      if (bytes) {\n        var split = bytes.split('=')\n        var name = split.shift().replace(/\\+/g, ' ')\n        var value = split.join('=').replace(/\\+/g, ' ')\n        form.append(decodeURIComponent(name), decodeURIComponent(value))\n      }\n    })\n    return form\n  }\n\n  function headers(xhr) {\n    var head = new Headers()\n    var pairs = (xhr.getAllResponseHeaders() || '').trim().split('\\n')\n    pairs.forEach(function(header) {\n      var split = header.trim().split(':')\n      var key = split.shift().trim()\n      var value = split.join(':').trim()\n      head.append(key, value)\n    })\n    return head\n  }\n\n  Body.call(Request.prototype)\n\n  function Response(bodyInit, options) {\n    if (!options) {\n      options = {}\n    }\n\n    this.type = 'default'\n    this.status = options.status\n    this.ok = this.status >= 200 && this.status < 300\n    this.statusText = options.statusText\n    this.headers = options.headers instanceof Headers ? options.headers : new Headers(options.headers)\n    this.url = options.url || ''\n    this._initBody(bodyInit)\n  }\n\n  Body.call(Response.prototype)\n\n  Response.prototype.clone = function() {\n    return new Response(this._bodyInit, {\n      status: this.status,\n      statusText: this.statusText,\n      headers: new Headers(this.headers),\n      url: this.url\n    })\n  }\n\n  Response.error = function() {\n    var response = new Response(null, {status: 0, statusText: ''})\n    response.type = 'error'\n    return response\n  }\n\n  var redirectStatuses = [301, 302, 303, 307, 308]\n\n  Response.redirect = function(url, status) {\n    if (redirectStatuses.indexOf(status) === -1) {\n      throw new RangeError('Invalid status code')\n    }\n\n    return new Response(null, {status: status, headers: {location: url}})\n  }\n\n  self.Headers = Headers\n  self.Request = Request\n  self.Response = Response\n\n  self.fetch = function(input, init) {\n    return new Promise(function(resolve, reject) {\n      var request\n      if (Request.prototype.isPrototypeOf(input) && !init) {\n        request = input\n      } else {\n        request = new Request(input, init)\n      }\n\n      var xhr = new XMLHttpRequest()\n\n      function responseURL() {\n        if ('responseURL' in xhr) {\n          return xhr.responseURL\n        }\n\n        // Avoid security warnings on getResponseHeader when not allowed by CORS\n        if (/^X-Request-URL:/m.test(xhr.getAllResponseHeaders())) {\n          return xhr.getResponseHeader('X-Request-URL')\n        }\n\n        return\n      }\n\n      xhr.onload = function() {\n        var options = {\n          status: xhr.status,\n          statusText: xhr.statusText,\n          headers: headers(xhr),\n          url: responseURL()\n        }\n        var body = 'response' in xhr ? xhr.response : xhr.responseText\n        resolve(new Response(body, options))\n      }\n\n      xhr.onerror = function() {\n        reject(new TypeError('Network request failed'))\n      }\n\n      xhr.ontimeout = function() {\n        reject(new TypeError('Network request failed'))\n      }\n\n      xhr.open(request.method, request.url, true)\n\n      if (request.credentials === 'include') {\n        xhr.withCredentials = true\n      }\n\n      if ('responseType' in xhr && support.blob) {\n        xhr.responseType = 'blob'\n      }\n\n      request.headers.forEach(function(value, name) {\n        xhr.setRequestHeader(name, value)\n      })\n\n      xhr.send(typeof request._bodyInit === 'undefined' ? null : request._bodyInit)\n    })\n  }\n  self.fetch.polyfill = true\n})(typeof self !== 'undefined' ? self : this);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/whatwg-fetch/fetch.js\n// module id = 2\n// module chunks = 0\n//# sourceURL=webpack:///./~/whatwg-fetch/fetch.js?")}])})},{}],2:[function(e,t,n){!function(e,r){"object"==typeof n&&"object"==typeof t?t.exports=r():"function"==typeof define&&define.amd?define([],r):"object"==typeof n?n.LivelyLocales=r():e.LivelyLocales=r()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(t){if("object"!==("undefined"==typeof t?"undefined":s(t)))throw new Error("Lively Localization instantiated with something other than a messages object",{messages:t});return new l(e,t)}return e&&u[e]?u[e]:c}Object.defineProperty(t,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();"function"!=typeof Object.assign&&(Object.assign=function(e){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1;n<arguments.length;n++){var r=arguments[n];if(null!=r)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t});var a={},u={},l=function(){function e(t,n){return r(this,e),t&&a[t]||n?(this.name=t,this.data=a[t]||{},void(n&&Object.assign(this.data,n))):void(this.localize=function(e){return e})}return o(e,[{key:"localize",value:function(e){var t=void 0;return(t=this.data[e])?t:(console.warn(this.name?"'"+e+"' has no translation in the provided '"+this.name+"' locale files or localization messages":"'"+e+"' has no translation in the provided localization messages."),e)}}]),e}(),h=n(1);h.keys().forEach(function(e){
var t=e.split("/");3===t.length&&(a[t[1]]||(a[t[1]]={}),a[t[1]]=Object.assign(a[t[1]],h(e)))});var c=new l;Object.keys(a).forEach(function(e){u[e]=new l(e)}),t["default"]=i,e.exports=t["default"]},function(e){function t(e){throw new Error("Cannot find module '"+e+"'.")}t.keys=function(){return[]},t.resolve=t,e.exports=t,t.id=1}])})},{}],3:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r={UPLOAD_START:"start",UPLOAD_SUCCESS:"success",UPLOAD_FAILURE:"failure",UPLOAD_ADDEDFILE:"addedfile",UPLOAD_CONFIG:"config",UPLOAD_PROGRESS:"progress",UPLOAD_THUMBNAIL:"thumbnail",UPLOAD_RECONNECTING:"reconnecting",UPLOAD_CONNECTED:"connected"};n["default"]=r,t.exports=n["default"]},{}],4:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();e("classlist-polyfill"),e("es6-promise/auto"),e("whatwg-fetch");var h=e("@livelyvideo/auth-core"),c=r(h),d=e("events"),f=r(d),p=e("./upload-chunked"),m=r(p),y=e("./upload-legacy"),v=r(y),b=e("./utils/createElement"),_=r(b),g=e("./events"),E=r(g),w={host:null,authUrl:null,token:null,redirect:null,accept:null,bemPrefix:"upload",supportLegacy:!0,forceLegacy:!1,autoSubmit:!0,chunkSize:102400,chunkConnections:3,version:"v2"},T=function(e){function t(e,n){i(this,t);var r=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));if(r.options=u({},w,n),r.options.url="https://"+r.options.host+"/api/upload/"+r.options.version,!r.options.host)throw new Error('No "host" option provided. Option "url" has been deprecated.');if(!r.options.authUrl)throw new Error('No "authUrl" option provided.');return r.selectFileChange=r.selectFileChange.bind(r),r.eventListeners=[],r.currentFile=null,r.isCurrentlyUploading=!1,r.options.token||(r.auth=new c["default"]("upload",r.options.authUrl),r.auth.on("ready",function(e){r.options.token=e.token,r.uploadAuth&&(r.uploadAuth.value="Bearer "+r.options.token)})),r.mount(e),r.browserSupported=r.isBrowserSupported(),r.legacyMode=r.options.supportLegacy&&!r.browserSupported||r.options.forceLegacy,r.browserSupported||r.legacyMode?(r.render(),r):s(r)}return o(t,e),l(t,[{key:"mount",value:function(e){switch("undefined"==typeof e?"undefined":a(e)){case"string":this.el=document.querySelector(e);break;case"object":this.el=e;break;default:throw new Error("The constructor has not been given a valid element or selector.")}}},{key:"isBrowserSupported",value:function(){var e=!1;return window.File&&window.FileReader&&window.FileList&&window.Blob&&window.FormData&&document.querySelector&&(e=!0),e}},{key:"render",value:function(){this.uploadForm=_["default"]({tagName:"form",className:this.options.bemPrefix+"__form",attributes:{action:this.options.url+"/multipart",method:"POST",encoding:"multipart/form-data",enctype:"multipart/form-data",target:"postform",file:this.file}}),this.uploadInput=_["default"]({tagName:"input",className:this.options.bemPrefix+"__input",attributes:{name:"fileBegin",type:"file"}}),this.options.accept&&this.uploadInput.setAttribute("accept",this.options.accept),this.uploadAuth=_["default"]({tagName:"input",attributes:{type:"hidden",name:"Authorization",value:"Bearer "+this.options.token}}),this.uploadName=_["default"]({tagName:"input",attributes:{type:"hidden",name:"files"}}),this.uploadRedirect=_["default"]({tagName:"input",attributes:{type:"hidden",name:"redirect",value:this.options.redirect}}),this.uploadForm.appendChild(this.uploadInput),this.uploadForm.appendChild(this.uploadAuth),this.uploadForm.appendChild(this.uploadName),this.uploadForm.appendChild(this.uploadRedirect),this.el.appendChild(this.uploadForm),this.eventHelper(this.uploadInput,"change",this.selectFileChange)}},{key:"getConfig",value:function(){var e=this;fetch(this.options.url+"/config",{method:"GET",mode:"cors",headers:{Authorization:"Bearer "+this.options.token}}).then(function(t){return t.ok?t.json():e.emit(E["default"].UPLOAD_FAILURE,e.file,{message:"Network Error."})}).then(function(t){e.emit(E["default"].UPLOAD_CONFIG,t),e.options.maxFileSize=t.maxFileSize})["catch"](function(){return e.emit(E["default"].UPLOAD_FAILURE,e.file,{message:"Network Error."})})}},{key:"selectFile",value:function(){this.uploadInput.click()}},{key:"selectFileChange",value:function(e){this.uploadName.setAttribute("value",e.target.files[0]?e.target.files[0].name:"");var t=e.target.files[0];this.addFile(t)}},{key:"addFile",value:function(e){this.currentFile=e,this.readFile(e),this.uploadFile(e),this.emit(E["default"].UPLOAD_ADDEDFILE,e)}},{key:"uploadFile",value:function(e){this.currentUploader&&(this.currentUploader.destroy(),this.currentUploader=!1),this.currentUploader=this.legacyMode?new v["default"](e,this):new m["default"](e,this),this.options.autoSubmit&&this.currentUploader.start()}},{key:"startUpload",value:function(){this.currentUploader&&this.currentUploader.start()}},{key:"toggleUpload",value:function(){this.currentUploader&&this.currentUploader.toggle()}},{key:"cancelUpload",value:function(){this.currentUploader&&this.currentUploader.cancel()}},{key:"readFile",value:function(e){if(this.browserSupported&&""!==e.type){var t=new FileReader,n=function(t){this.emit(E["default"].UPLOAD_THUMBNAIL,e,t.target.result)}.bind(this);t.onload=n,t.readAsDataURL(e)}}},{key:"eventHelper",value:function(e,t,n){e.addEventListener(t,n);var r=function(){e.removeEventListener(t,n)};this.eventListeners.push(r)}},{key:"destroy",value:function(){for(var e=0;e<this.eventListeners.length;e++)this.eventListeners.splice(e,1)[0]();this.el.parentNode.removeChild(this.el)}}]),t}(f["default"]);n["default"]=T,t.exports=n["default"]},{"./events":3,"./upload-chunked":6,"./upload-legacy":7,"./utils/createElement":8,"@livelyvideo/auth-core":1,"classlist-polyfill":9,"es6-promise/auto":10,events:12,"whatwg-fetch":14}],5:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r={ERROR_DUP_FILE:"This file has already been uploaded.",ERROR_FILE_NAME:"This file does not have a name.",ERROR_FILE_EXT:"This file extension is not supported.",ERROR_MISSING_BODY:"This file does not have any data.",ERROR_FILE_SIZE:"This file exceeds max file size.",ERROR_UNAUTH:"The user is not authorized to perform this action."};n["default"]=r,t.exports=n["default"]},{}],6:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=e("./events"),a=r(o),u=e("./legacy-messages"),l=r(u),h=function(){function e(t,n){i(this,e),this.file=t,this.Upload=n,this.options=n.options,this.fileID=void 0,this.fileURI=void 0,this.fileSize=this.file.size,this.fileIdentifier=this.generateUniqueIdentifier(),this.chunkSize=this.options.chunkSize,this.is_paused=!1,this._handleFetchError=this._handleFetchError.bind(this),this.sliceMethod="mozSlice"in this.file?"mozSlice":"webkitSlice"in this.file?"webkitSlice":"slice",this.chunkTotal=Math.ceil(this.fileSize/this.chunkSize,this.chunkSize)-1,this.currentChunk=0,this.chunks=this.sliceFileToChunks()}return s(e,[{key:"sliceFileToChunks",value:function(){for(var e=[],t=0;t<=this.chunkTotal;){var n=t*this.chunkSize,r=this.file[this.sliceMethod](n,(t+1)*this.chunkSize),i={chunkIndex:t,chunkOffset:n,chunkTotal:this.chunkTotal,chunkData:r,chunkSize:r.size,chunkLast:t===this.chunkTotal,totalSize:this.fileSize,processing:!1,processed:!1};e.push(i),t++}return e}},{key:"trimChunks",value:function(e){for(var t=0;t<e.length;t++)t!==this.chunkTotal&&(this.chunks[e[t]].processed=!0);for(var n=this.chunks.length;n--;)this.chunks[n].processed&&this.chunks.splice(n,1);this.calculateProgress()}},{key:"sendOptions",value:function(){var e=this;fetch(""+this.options.url,{method:"post",mode:"cors",headers:{Authorization:"Bearer "+this.options.token,"X-File-Name":this.file.name,"X-File-Size":this.file.size,"X-File-Identifier":this.fileIdentifier,"X-File-Status":!0,"X-Chunk-Total":this.chunkTotal}}).then(function(t){if(!t.ok)return e._parseJSON(t);e.Upload.emit(a["default"].UPLOAD_PROGRESS,0,e.fileSize),e.Upload.emit(a["default"].UPLOAD_START,e.file);var n=JSON.parse(t.headers.get("X-Chunks-Completed"));return n&&e.trimChunks(n),e.sendChunks()}).then(this._handleFetchError)}},{key:"sendChunks",value:function(){for(var e=0;e<this.options.chunkConnections;e++)this.spawnChunkConnection()}},{key:"generateUniqueIdentifier",value:function(){var e=this.file.relativePath||this.file.webkitRelativePath||this.file.fileName||this.file.name;return this.fileSize+"-"+e.replace(/[^0-9a-zA-Z_-]/gim,"")}},{key:"spawnChunkConnection",value:function(e){var t=this,n=this.getUnprocessedChunk()||e;return n&&!this.is_paused?(n.processing=!0,n.chunkLast&&this.chunks.length>1?setTimeout(function(){return t.spawnChunkConnection(n)},500):void this.foreverFetch(this.options.url,{method:"POST",mode:"cors",body:n.chunkData,headers:{Authorization:"Bearer "+this.options.token,"Content-Type":"application/octet-stream","X-File-Name":this.file.name,"X-File-Size":this.file.size,"X-File-Identifier":this.fileIdentifier,"X-Chunk-Last":n.chunkLast,"X-Chunk-Index":n.chunkIndex,"X-Chunk-Total":n.chunkTotal}}).then(function(e){return e.ok?(t.chunks.splice(t.chunks.indexOf(n),1),t.calculateProgress(n.chunkLast),n.chunkLast&&(t.fileURI=e.headers.get("X-File-Retrieve-URL"),t.fileID=e.headers.get("X-File-ID"),t.Upload.emit(a["default"].UPLOAD_SUCCESS,t.file,t.fileURI,t.fileID)),t.spawnChunkConnection()):503===e.status?(n.processing=!1,setTimeout(function(){return t.spawnChunkConnection()},100)):t._parseJSON(e)}).then(this._handleFetchError)):void 0}},{key:"calculateProgress",value:function(e){var t=this.chunkTotal+1,n=100-Math.round(this.chunks.length/t*100),r=(t-this.chunks.length)*this.chunkSize;e&&(r=this.fileSize),this.Upload.emit(a["default"].UPLOAD_PROGRESS,r,this.fileSize,n)}},{key:"getUnprocessedChunk",value:function(){for(var e=0;e<this.chunks.length;e++){var t=this.chunks[e];if(!t.processing&&!t.processed)return t}return!1}},{key:"_handleFetchError",value:function(e){e&&e.message&&(l["default"][e.message]&&(e.message=l["default"][e.message]),this.Upload.emit(a["default"].UPLOAD_FAILURE,this.file,e))}},{key:"_parseJSON",value:function(e){return e.text().then(function(e){return e?JSON.parse(e):{}})}},{key:"foreverFetch",value:function(e,t){var n=this,r=1e3,i=!1;return new Promise(function(s){function o(n){var u=this;n>2?r=3e4:2===n&&(r=5e3),fetch(e,t).then(function(e){i&&u.Upload.emit(a["default"].UPLOAD_CONNECTED,u.file),s(e)})["catch"](function(){u.Upload.emit(a["default"].UPLOAD_RECONNECTING,u.file,n),i=!0,setTimeout(function(){o(++n)},r)})}(o=o.bind(n))(1)})}},{key:"start",value:function(){this.sendOptions()}},{key:"toggle",value:function(){this.is_paused=!this.is_paused,this.Upload.emit(a["default"].UPLOAD_PAUSE,this.file,this.is_paused),this.is_paused||this.sendChunk()}},{key:"cancel",value:function(){this.Upload.emit(a["default"].UPLOAD_FAILURE,this.file,{message:"Network Error."}),this.destroy()}},{key:"destroy",value:function(){this.is_paused=!0,this.file=!1}}]),e}();n["default"]=h,t.exports=n["default"]},{"./events":3,"./legacy-messages":5}],7:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=e("./utils/createElement"),a=r(o),u=e("./events"),l=r(u),h=e("./legacy-messages"),c=r(h),d=function(){function e(t,n){i(this,e),this.file=t,this.Upload=n,this.options=n.options,this.responseHandler=this.responseHandler.bind(this),this.firstLoad=!0,this.renderIframe()}return s(e,[{key:"renderIframe",value:function(){this.iframe=a["default"]({tagName:"iframe",className:"upload__iframe",attributes:{name:"postform",src:"about:none;",style:"display:none;"}}),this.iframe.onload=this.responseHandler,this.Upload.el.appendChild(this.iframe)}},{key:"start",value:function(){this.Upload.uploadForm.submit(),this.Upload.emit(l["default"].UPLOAD_START,this.file)}},{key:"responseHandler",value:function(){if(this.firstLoad)return void(this.firstLoad=!1);try{var e=JSON.parse(this.iframe.contentWindow.document.body.innerText);if(200===e.status)return void this.Upload.emit(l["default"].UPLOAD_SUCCESS,this.file);c["default"][e.message]&&(e.message=c["default"][e.message]),this.Upload.emit(l["default"].UPLOAD_FAILURE,this.file,e)}catch(t){this.Upload.emit(l["default"].UPLOAD_FAILURE,this.file,{message:"Network Error."})}}},{key:"destroy",value:function(){this.iframe.parentNode.removeChild(this.iframe)}}]),e}();n["default"]=d,t.exports=n["default"]},{"./events":3,"./legacy-messages":5,"./utils/createElement":8}],8:[function(e,t,n){"use strict";function r(e){var t=void 0,n=void 0,i=void 0;if(e.tagName){if(t=document.createElement(e.tagName),e.className&&(t.className=e.className),e.attributes)for(n in e.attributes)t.setAttribute(n,e.attributes[n]);void 0!==e.html&&(t.innerHTML=e.html)}else t=document.createDocumentFragment();if(e.text&&t.appendChild(document.createTextNode(e.text)),void 0===window.HTMLElement&&(window.HTMLElement=Element),e.childs&&e.childs.length)for(i=0;i<e.childs.length;i++)t.appendChild(e.childs[i]instanceof window.HTMLElement?e.childs[i]:r(e.childs[i]));return t}Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=r,t.exports=n["default"]},{}],9:[function(){"document"in window.self&&("classList"in document.createElement("_")&&(!document.createElementNS||"classList"in document.createElementNS("http://www.w3.org/2000/svg","g"))?!function(){"use strict";var e=document.createElement("_");if(e.classList.add("c1","c2"),!e.classList.contains("c2")){var t=function(e){var t=DOMTokenList.prototype[e];DOMTokenList.prototype[e]=function(e){var n,r=arguments.length;for(n=0;r>n;n++)e=arguments[n],t.call(this,e)}};t("add"),t("remove")}if(e.classList.toggle("c3",!1),e.classList.contains("c3")){var n=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(e,t){return 1 in arguments&&!this.contains(e)==!t?t:n.call(this,e)}}e=null}():!function(e){"use strict";if("Element"in e){var t="classList",n="prototype",r=e.Element[n],i=Object,s=String[n].trim||function(){return this.replace(/^\s+|\s+$/g,"")},o=Array[n].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1},a=function(e,t){this.name=e,this.code=DOMException[e],this.message=t},u=function(e,t){if(""===t)throw new a("SYNTAX_ERR","An invalid or illegal string was specified");if(/\s/.test(t))throw new a("INVALID_CHARACTER_ERR","String contains an invalid character");return o.call(e,t)},l=function(e){for(var t=s.call(e.getAttribute("class")||""),n=t?t.split(/\s+/):[],r=0,i=n.length;i>r;r++)this.push(n[r]);this._updateClassName=function(){e.setAttribute("class",this.toString())}},h=l[n]=[],c=function(){return new l(this)};if(a[n]=Error[n],h.item=function(e){return this[e]||null},h.contains=function(e){return e+="",-1!==u(this,e)},h.add=function(){var e,t=arguments,n=0,r=t.length,i=!1;do e=t[n]+"",-1===u(this,e)&&(this.push(e),i=!0);while(++n<r);i&&this._updateClassName()},h.remove=function(){var e,t,n=arguments,r=0,i=n.length,s=!1;do for(e=n[r]+"",t=u(this,e);-1!==t;)this.splice(t,1),s=!0,t=u(this,e);while(++r<i);s&&this._updateClassName()},h.toggle=function(e,t){e+="";var n=this.contains(e),r=n?t!==!0&&"remove":t!==!1&&"add";return r&&this[r](e),t===!0||t===!1?t:!n},h.toString=function(){return this.join(" ")},i.defineProperty){var d={get:c,enumerable:!0,configurable:!0};try{i.defineProperty(r,t,d)}catch(f){-2146823252===f.number&&(d.enumerable=!1,i.defineProperty(r,t,d))}}else i[n].__defineGetter__&&r.__defineGetter__(t,c)}}(window.self))},{}],10:[function(e,t){"use strict";t.exports=e("./").polyfill()},{"./":11}],11:[function(e,t,n){(function(r,i){!function(e,r){"object"==typeof n&&"undefined"!=typeof t?t.exports=r():"function"==typeof define&&define.amd?define(r):e.ES6Promise=r()}(this,function(){"use strict";function t(e){return"function"==typeof e||"object"==typeof e&&null!==e}function n(e){return"function"==typeof e}function s(e){J=e}function o(e){K=e}function a(){return function(){return r.nextTick(d)}}function u(){return"undefined"!=typeof Y?function(){Y(d)}:c()}function l(){var e=0,t=new Q(d),n=document.createTextNode("");return t.observe(n,{characterData:!0}),function(){n.data=e=++e%2}}function h(){var e=new MessageChannel;return e.port1.onmessage=d,function(){return e.port2.postMessage(0)}}function c(){var e=setTimeout;return function(){return e(d,1)}}function d(){for(var e=0;W>e;e+=2){var t=ne[e],n=ne[e+1];t(n),ne[e]=void 0,ne[e+1]=void 0}W=0}function f(){try{var t=e,n=t("vertx");return Y=n.runOnLoop||n.runOnContext,u()}catch(r){return c()}}function p(e,t){var n=arguments,r=this,i=new this.constructor(y);void 0===i[ie]&&F(i);var s=r._state;return s?!function(){var e=n[s-1];K(function(){return C(s,i,e,r._result)})}():k(r,i,e,t),i}function m(e){var t=this;if(e&&"object"==typeof e&&e.constructor===t)return e;var n=new t(y);return O(n,e),n}function y(){}function v(){return new TypeError("You cannot resolve a promise with itself")}function b(){return new TypeError("A promises callback cannot return that same promise.")}function _(e){try{return e.then}catch(t){return ue.error=t,ue}}function g(e,t,n,r){try{e.call(t,n,r)}catch(i){return i}}function E(e,t,n){K(function(e){var r=!1,i=g(n,t,function(n){r||(r=!0,t!==n?O(e,n):A(e,n))},function(t){r||(r=!0,P(e,t))},"Settle: "+(e._label||" unknown promise"));!r&&i&&(r=!0,P(e,i))},e)}function w(e,t){t._state===oe?A(e,t._result):t._state===ae?P(e,t._result):k(t,void 0,function(t){return O(e,t)},function(t){return P(e,t)})}function T(e,t,r){t.constructor===e.constructor&&r===p&&t.constructor.resolve===m?w(e,t):r===ue?(P(e,ue.error),ue.error=null):void 0===r?A(e,t):n(r)?E(e,t,r):A(e,t)}function O(e,n){e===n?P(e,v()):t(n)?T(e,n,_(n)):A(e,n)}function L(e){e._onerror&&e._onerror(e._result),R(e)}function A(e,t){e._state===se&&(e._result=t,e._state=oe,0!==e._subscribers.length&&K(R,e))}function P(e,t){e._state===se&&(e._state=ae,e._result=t,K(L,e))}function k(e,t,n,r){var i=e._subscribers,s=i.length;e._onerror=null,i[s]=t,i[s+oe]=n,i[s+ae]=r,0===s&&e._state&&K(R,e)}function R(e){var t=e._subscribers,n=e._state;if(0!==t.length){for(var r=void 0,i=void 0,s=e._result,o=0;o<t.length;o+=3)r=t[o],i=t[o+n],r?C(n,r,i,s):i(s);e._subscribers.length=0}}function S(){this.error=null}function x(e,t){try{return e(t)}catch(n){return le.error=n,le}}function C(e,t,r,i){var s=n(r),o=void 0,a=void 0,u=void 0,l=void 0;if(s){if(o=x(r,i),o===le?(l=!0,a=o.error,o.error=null):u=!0,t===o)return void P(t,b())}else o=i,u=!0;t._state!==se||(s&&u?O(t,o):l?P(t,a):e===oe?A(t,o):e===ae&&P(t,o))}function U(e,t){try{t(function(t){O(e,t)},function(t){P(e,t)})}catch(n){P(e,n)}}function N(){return he++}function F(e){e[ie]=he++,e._state=void 0,e._result=void 0,e._subscribers=[]}function D(e,t){this._instanceConstructor=e,this.promise=new e(y),this.promise[ie]||F(this.promise),X(t)?(this._input=t,this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?A(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&A(this.promise,this._result))):P(this.promise,B())}function B(){return new Error("Array Methods must be provided an Array")}function j(e){return new D(this,e).promise}function H(e){var t=this;return new t(X(e)?function(n,r){for(var i=e.length,s=0;i>s;s++)t.resolve(e[s]).then(n,r)}:function(e,t){return t(new TypeError("You must pass an array to race."))})}function I(e){var t=this,n=new t(y);return P(n,e),n}function M(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function z(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function q(e){this[ie]=N(),this._result=this._state=void 0,this._subscribers=[],y!==e&&("function"!=typeof e&&M(),this instanceof q?U(this,e):z())}function G(){var e=void 0;if("undefined"!=typeof i)e=i;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var n=e.Promise;if(n){var r=null;try{r=Object.prototype.toString.call(n.resolve())}catch(t){}if("[object Promise]"===r&&!n.cast)return}e.Promise=q}var V=void 0;V=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)};var X=V,W=0,Y=void 0,J=void 0,K=function(e,t){ne[W]=e,ne[W+1]=t,W+=2,2===W&&(J?J(d):re())},Z="undefined"!=typeof window?window:void 0,$=Z||{},Q=$.MutationObserver||$.WebKitMutationObserver,ee="undefined"==typeof self&&"undefined"!=typeof r&&"[object process]"==={}.toString.call(r),te="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,ne=new Array(1e3),re=void 0;re=ee?a():Q?l():te?h():void 0===Z&&"function"==typeof e?f():c();var ie=Math.random().toString(36).substring(16),se=void 0,oe=1,ae=2,ue=new S,le=new S,he=0;return D.prototype._enumerate=function(){for(var e=this.length,t=this._input,n=0;this._state===se&&e>n;n++)this._eachEntry(t[n],n)},D.prototype._eachEntry=function(e,t){var n=this._instanceConstructor,r=n.resolve;if(r===m){var i=_(e);if(i===p&&e._state!==se)this._settledAt(e._state,t,e._result);else if("function"!=typeof i)this._remaining--,this._result[t]=e;else if(n===q){var s=new n(y);T(s,e,i),this._willSettleAt(s,t)}else this._willSettleAt(new n(function(t){return t(e)}),t)}else this._willSettleAt(r(e),t)},D.prototype._settledAt=function(e,t,n){var r=this.promise;r._state===se&&(this._remaining--,e===ae?P(r,n):this._result[t]=n),0===this._remaining&&A(r,this._result)},D.prototype._willSettleAt=function(e,t){var n=this;k(e,void 0,function(e){return n._settledAt(oe,t,e)},function(e){return n._settledAt(ae,t,e)})},q.all=j,q.race=H,q.resolve=m,q.reject=I,q._setScheduler=s,q._setAsap=o,q._asap=K,q.prototype={constructor:q,then:p,"catch":function(e){return this.then(null,e)}},q.polyfill=G,q.Promise=q,q})}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:13}],12:[function(e,t){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function r(e){return"function"==typeof e}function i(e){return"number"==typeof e}function s(e){return"object"==typeof e&&null!==e}function o(e){return void 0===e}t.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if(!i(e)||0>e||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,n,i,a,u,l;if(this._events||(this._events={}),"error"===e&&(!this._events.error||s(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;var h=new Error('Uncaught, unspecified "error" event. ('+t+")");throw h.context=t,h}if(n=this._events[e],o(n))return!1;if(r(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:a=Array.prototype.slice.call(arguments,1),n.apply(this,a)}else if(s(n))for(a=Array.prototype.slice.call(arguments,1),l=n.slice(),i=l.length,u=0;i>u;u++)l[u].apply(this,a);return!0},n.prototype.addListener=function(e,t){var i;if(!r(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,r(t.listener)?t.listener:t),this._events[e]?s(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,s(this._events[e])&&!this._events[e].warned&&(i=o(this._maxListeners)?n.defaultMaxListeners:this._maxListeners,i&&i>0&&this._events[e].length>i&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())),this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(e,t){function n(){this.removeListener(e,n),i||(i=!0,t.apply(this,arguments))}if(!r(t))throw TypeError("listener must be a function");var i=!1;return n.listener=t,this.on(e,n),this},n.prototype.removeListener=function(e,t){var n,i,o,a;if(!r(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],o=n.length,i=-1,n===t||r(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(s(n)){for(a=o;a-->0;)if(n[a]===t||n[a].listener&&n[a].listener===t){i=a;break}if(0>i)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(i,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],r(n))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?r(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(r(t))return 1;if(t)return t.length}return 0},n.listenerCount=function(e,t){return e.listenerCount(t)}},{}],13:[function(e,t){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function i(e){if(h===setTimeout)return setTimeout(e,0);if((h===n||!h)&&setTimeout)return h=setTimeout,setTimeout(e,0);try{return h(e,0)}catch(t){try{return h.call(null,e,0)}catch(t){return h.call(this,e,0)}}}function s(e){if(c===clearTimeout)return clearTimeout(e);if((c===r||!c)&&clearTimeout)return c=clearTimeout,clearTimeout(e);try{return c(e)}catch(t){try{return c.call(null,e)}catch(t){return c.call(this,e)}}}function o(){m&&f&&(m=!1,f.length?p=f.concat(p):y=-1,p.length&&a())}function a(){if(!m){var e=i(o);m=!0;for(var t=p.length;t;){for(f=p,p=[];++y<t;)f&&f[y].run();y=-1,t=p.length}f=null,m=!1,s(e)}}function u(e,t){this.fun=e,this.array=t}function l(){}var h,c,d=t.exports={};!function(){try{h="function"==typeof setTimeout?setTimeout:n}catch(e){h=n}try{c="function"==typeof clearTimeout?clearTimeout:r}catch(e){c=r}}();var f,p=[],m=!1,y=-1;d.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];p.push(new u(e,t)),1!==p.length||m||i(a)},u.prototype.run=function(){this.fun.apply(null,this.array)},d.title="browser",d.browser=!0,d.env={},d.argv=[],d.version="",d.versions={},d.on=l,d.addListener=l,d.once=l,d.off=l,d.removeListener=l,d.removeAllListeners=l,d.emit=l,d.binding=function(){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(){throw new Error("process.chdir is not supported")},d.umask=function(){return 0}},{}],14:[function(){!function(e){"use strict";function t(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function n(e){return"string"!=typeof e&&(e=String(e)),e}function r(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return v.iterable&&(t[Symbol.iterator]=function(){return t}),t}function i(e){this.map={},e instanceof i?e.forEach(function(e,t){this.append(t,e)},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function s(e){return e.bodyUsed?Promise.reject(new TypeError("Already read")):void(e.bodyUsed=!0)}function o(e){return new Promise(function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}})}function a(e){var t=new FileReader,n=o(t);return t.readAsArrayBuffer(e),n}function u(e){var t=new FileReader,n=o(t);return t.readAsText(e),n}function l(e){for(var t=new Uint8Array(e),n=new Array(t.length),r=0;r<t.length;r++)n[r]=String.fromCharCode(t[r]);return n.join("")}function h(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function c(){return this.bodyUsed=!1,this._initBody=function(e){if(this._bodyInit=e,e)if("string"==typeof e)this._bodyText=e;else if(v.blob&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(v.formData&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(v.searchParams&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else if(v.arrayBuffer&&v.blob&&_(e))this._bodyArrayBuffer=h(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!v.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(e)&&!g(e))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=h(e)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):v.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},v.blob&&(this.blob=function(){var e=s(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?s(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(a)}),this.text=function(){var e=s(this);if(e)return e;if(this._bodyBlob)return u(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(l(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");

return Promise.resolve(this._bodyText)},v.formData&&(this.formData=function(){return this.text().then(p)}),this.json=function(){return this.text().then(JSON.parse)},this}function d(e){var t=e.toUpperCase();return E.indexOf(t)>-1?t:e}function f(e,t){t=t||{};var n=t.body;if("string"==typeof e)this.url=e;else{if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new i(e.headers)),this.method=e.method,this.mode=e.mode,n||null==e._bodyInit||(n=e._bodyInit,e.bodyUsed=!0)}if(this.credentials=t.credentials||this.credentials||"omit",(t.headers||!this.headers)&&(this.headers=new i(t.headers)),this.method=d(t.method||this.method||"GET"),this.mode=t.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&n)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(n)}function p(e){var t=new FormData;return e.trim().split("&").forEach(function(e){if(e){var n=e.split("="),r=n.shift().replace(/\+/g," "),i=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(i))}}),t}function m(e){var t=new i;return e.split("\r\n").forEach(function(e){var n=e.split(":"),r=n.shift().trim();if(r){var i=n.join(":").trim();t.append(r,i)}}),t}function y(e,t){t||(t={}),this.type="default",this.status="status"in t?t.status:200,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new i(t.headers),this.url=t.url||"",this._initBody(e)}if(!e.fetch){var v={searchParams:"URLSearchParams"in e,iterable:"Symbol"in e&&"iterator"in Symbol,blob:"FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:"FormData"in e,arrayBuffer:"ArrayBuffer"in e};if(v.arrayBuffer)var b=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],_=function(e){return e&&DataView.prototype.isPrototypeOf(e)},g=ArrayBuffer.isView||function(e){return e&&b.indexOf(Object.prototype.toString.call(e))>-1};i.prototype.append=function(e,r){e=t(e),r=n(r);var i=this.map[e];i||(i=[],this.map[e]=i),i.push(r)},i.prototype["delete"]=function(e){delete this.map[t(e)]},i.prototype.get=function(e){var n=this.map[t(e)];return n?n[0]:null},i.prototype.getAll=function(e){return this.map[t(e)]||[]},i.prototype.has=function(e){return this.map.hasOwnProperty(t(e))},i.prototype.set=function(e,r){this.map[t(e)]=[n(r)]},i.prototype.forEach=function(e,t){Object.getOwnPropertyNames(this.map).forEach(function(n){this.map[n].forEach(function(r){e.call(t,r,n,this)},this)},this)},i.prototype.keys=function(){var e=[];return this.forEach(function(t,n){e.push(n)}),r(e)},i.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),r(e)},i.prototype.entries=function(){var e=[];return this.forEach(function(t,n){e.push([n,t])}),r(e)},v.iterable&&(i.prototype[Symbol.iterator]=i.prototype.entries);var E=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];f.prototype.clone=function(){return new f(this,{body:this._bodyInit})},c.call(f.prototype),c.call(y.prototype),y.prototype.clone=function(){return new y(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new i(this.headers),url:this.url})},y.error=function(){var e=new y(null,{status:0,statusText:""});return e.type="error",e};var w=[301,302,303,307,308];y.redirect=function(e,t){if(-1===w.indexOf(t))throw new RangeError("Invalid status code");return new y(null,{status:t,headers:{location:e}})},e.Headers=i,e.Request=f,e.Response=y,e.fetch=function(e,t){return new Promise(function(n,r){var i=new f(e,t),s=new XMLHttpRequest;s.onload=function(){var e={status:s.status,statusText:s.statusText,headers:m(s.getAllResponseHeaders()||"")};e.url="responseURL"in s?s.responseURL:e.headers.get("X-Request-URL");var t="response"in s?s.response:s.responseText;n(new y(t,e))},s.onerror=function(){r(new TypeError("Network request failed"))},s.ontimeout=function(){r(new TypeError("Network request failed"))},s.open(i.method,i.url,!0),"include"===i.credentials&&(s.withCredentials=!0),"responseType"in s&&v.blob&&(s.responseType="blob"),i.headers.forEach(function(e,t){s.setRequestHeader(t,e)}),s.send("undefined"==typeof i._bodyInit?null:i._bodyInit)})},e.fetch.polyfill=!0}}("undefined"!=typeof self?self:this)},{}],15:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.EVENTS={UPLOAD_START:"start",UPLOAD_SUCCESS:"success",UPLOAD_FAILURE:"failure",UPLOAD_ADDEDFILE:"addedfile",UPLOAD_CONFIG:"config",UPLOAD_PROGRESS:"progress",UPLOAD_THUMBNAIL:"thumbnail",FORM_DROP:"drop",FORM_DRAG:"drag",FORM_DRAGSTART:"dragstart",FORM_DRAGEND:"dragend",FORM_DRAGENTER:"dragenter",FORM_DRAGOVER:"dragover",FORM_DRAGLEAVE:"dragleave"}},{}],16:[function(e,t){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();e("classlist-polyfill"),e("es6-promise/auto");var l=e("@livelyvideo/upload-core/lib"),h=n(l),c=e("@livelyvideo/localization"),d=n(c),f=e("events"),p=n(f),m=e("./utils/createElement"),y=n(m),v=e("./utils/formatBytes"),b=n(v),_=e("./utils/forwardEvents"),g=n(_),E=e("./constants"),w={host:null,authUrl:null,token:null,redirect:null,accept:null,bemPrefix:"upload",supportLegacy:!0,forceLegacy:!1,autoSubmit:!0,pause:!1,cancel:!1,messages:null,chunkSize:102400,chunkConnections:3,version:"v2"},T=function(e){function t(e,n){r(this,t);var s=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));if(s.options=a({},w,n),!s.options.host)throw new Error('No "host" option provided. Option "url" has been deprecated.');if(!s.options.authUrl)throw new Error('No "authUrl" option provided.');s.options.MESSAGES&&(s.options.messages=s.options.MESSAGES);var o=new d["default"](s.options.locale,s.options.messages);return s.localize=o.localize.bind(o),s.mount(e),s.eventListeners=[],s.upload=new h["default"](s.el,s.options),g["default"](s.upload,s),s.upload.browserSupported||s.upload.legacyMode?s.upload.legacyMode?(s.initLegacy(),s.legacyStartHandler=s.legacyStartHandler.bind(s),s.legacySuccessHandler=s.legacySuccessHandler.bind(s),s.legacyFailureHandler=s.legacyFailureHandler.bind(s),s.upload.on(E.EVENTS.UPLOAD_START,s.legacyStartHandler),s.upload.on(E.EVENTS.UPLOAD_SUCCESS,s.legacySuccessHandler),s.upload.on(E.EVENTS.UPLOAD_FAILURE,s.legacyFailureHandler),s):(s.initModern(),s.startHandler=s.startHandler.bind(s),s.progressHandler=s.progressHandler.bind(s),s.successHandler=s.successHandler.bind(s),s.failureHandler=s.failureHandler.bind(s),s.thumbnailHandler=s.thumbnailHandler.bind(s),s.addedfileHandler=s.addedfileHandler.bind(s),s.pauseHandler=s.pauseHandler.bind(s),s.upload.on(E.EVENTS.UPLOAD_START,s.startHandler),s.upload.on(E.EVENTS.UPLOAD_PROGRESS,s.progressHandler),s.upload.on(E.EVENTS.UPLOAD_SUCCESS,s.successHandler),s.upload.on(E.EVENTS.UPLOAD_FAILURE,s.failureHandler),s.upload.on(E.EVENTS.UPLOAD_THUMBNAIL,s.thumbnailHandler),s.upload.on(E.EVENTS.UPLOAD_ADDEDFILE,s.addedfileHandler),s.upload.on(E.EVENTS.UPLOAD_PAUSE,s.pauseHandler),i(s)):(s.renderUnsupported(),i(s))}return s(t,e),u(t,[{key:"mount",value:function(e){switch("undefined"==typeof e?"undefined":o(e)){case"string":this.el=document.querySelector(e);break;case"object":this.el=e;break;default:throw new Error("The constructor has not been given a valid element or selector.")}this.el.classList.add(this.options.bemPrefix)}},{key:"renderUnsupported",value:function(){this.uploadUnsupported=y["default"]({tagName:"p",className:this.options.bemPrefix+"__unsupported",text:this.localize("Your browser does not support HTML5 upload. We recommend upgrading your browser.")}),this.el.appendChild(this.uploadUnsupported)}},{key:"render",value:function(e){this.uploadContainer=y["default"]({tagName:"div",className:this.options.bemPrefix+"__container"}),this.uploadPreview=y["default"]({tagName:"div",className:this.options.bemPrefix+"__preview"}),this.uploadTitle=y["default"]({tagName:"label",className:this.options.bemPrefix+"__title",text:this.localize(e?"Click to upload.":"Drop files here or click to upload.")}),this.uploadSubTitle=y["default"]({tagName:"label",className:this.options.bemPrefix+"__sub-title",text:this.localize(e?"File preview and drag and drop unavailable. Please upgrade your browser for a better experience.":"Max file size 48Mb.")}),this.uploadError=y["default"]({tagName:"div",className:this.options.bemPrefix+"__error"}),this.uploadContainer.appendChild(this.uploadPreview),this.uploadContainer.appendChild(this.uploadTitle),this.uploadContainer.appendChild(this.uploadSubTitle),this.uploadContainer.appendChild(this.uploadError),this.el.appendChild(this.uploadContainer)}},{key:"renderControls",value:function(){var e=this;(this.options.pause||this.options.cancel)&&(this.uploadControls=y["default"]({tagName:"div",className:this.options.bemPrefix+"__controls"}),this.options.pause&&(this.uploadPauseButton=y["default"]({tagName:"button",className:this.options.bemPrefix+"__pause-button",text:"Pause Upload",attributes:{disabled:!0}}),this.eventHelper(this.uploadPauseButton,"click",function(t){t.preventDefault(),t.stopPropagation(),e.upload.toggleUpload()}),this.uploadControls.appendChild(this.uploadPauseButton)),this.options.cancel&&(this.uploadCancelButton=y["default"]({tagName:"button",className:this.options.bemPrefix+"__cancel-button",text:"Cancel Upload",attributes:{disabled:!0}}),this.eventHelper(this.uploadCancelButton,"click",function(t){t.preventDefault(),t.stopPropagation(),e.upload.cancelUpload()}),this.uploadControls.appendChild(this.uploadCancelButton)),this.uploadContainer.appendChild(this.uploadControls))}},{key:"renderProgress",value:function(){this.uploadProgress&&this.uploadProgress.parentNode.removeChild(this.uploadProgress),this.uploadProgress=y["default"]({tagName:"div",className:this.options.bemPrefix+"__progress"}),this.uploadPreview.appendChild(this.uploadProgress)}},{key:"initModern",value:function(){var e=this;this.render(),this.renderControls(),this.eventHelper(this.el,E.EVENTS.FORM_DROP,function(t){t.preventDefault(),t.stopPropagation(),e.emit(E.EVENTS.FORM_DROP,t),e.el.classList.remove(e.options.bemPrefix+"--is-dragover"),e.upload.addFile(t.dataTransfer.files[0])}),this.eventHelper(this.el,E.EVENTS.FORM_DRAG,function(t){t.preventDefault(),t.stopPropagation(),e.emit(E.EVENTS.FORM_DRAG,t)}),this.eventHelper(this.el,E.EVENTS.FORM_DRAGSTART,function(t){t.preventDefault(),t.stopPropagation(),e.emit(E.EVENTS.FORM_DRAGSTART,t)}),this.eventHelper(this.el,E.EVENTS.FORM_DRAGEND,function(t){t.preventDefault(),t.stopPropagation(),e.emit(E.EVENTS.FORM_DRAGEND,t),e.el.classList.remove(e.options.bemPrefix+"--is-dragover")}),this.eventHelper(this.el,E.EVENTS.FORM_DRAGENTER,function(t){t.preventDefault(),t.stopPropagation(),e.emit(E.EVENTS.FORM_DRAGENTER,t),e.el.classList.add(e.options.bemPrefix+"--is-dragover")}),this.eventHelper(this.el,E.EVENTS.FORM_DRAGOVER,function(t){t.preventDefault(),t.stopPropagation(),e.emit(E.EVENTS.FORM_DRAGOVER,t),e.el.classList.add(e.options.bemPrefix+"--is-dragover")}),this.eventHelper(this.el,E.EVENTS.FORM_DRAGLEAVE,function(t){t.preventDefault(),t.stopPropagation(),e.emit(E.EVENTS.FORM_DRAGLEAVE,t),e.el.classList.remove(e.options.bemPrefix+"--is-dragover")}),this.eventHelper(this.el,"click",function(){e.upload.selectFile()})}},{key:"initLegacy",value:function(){var e=this;this.render(!0),this.el.classList.add("upload--is-legacy"),this.eventHelper(this.el,"click",function(){e.upload.selectFile()})}},{key:"startHandler",value:function(){this.renderProgress(),this.uploadError.innerText="",this.uploadError.classList.remove("upload__error--active"),this.uploadPauseButton&&(this.uploadPauseButton.classList.add("upload__pause-button--is-enabled"),this.uploadPauseButton.disabled=!1),this.uploadCancelButton&&(this.uploadCancelButton.classList.add("upload__cancel-button--is-enabled"),this.uploadCancelButton.disabled=!1)}},{key:"progressHandler",value:function(e,t){this.uploadProgress&&(this.uploadProgress.style.paddingBottom=parseFloat(Math.round(e/t*100))+"%")}},{key:"successHandler",value:function(){var e=this;setTimeout(function(){e.uploadProgress.classList.add(e.options.bemPrefix+"__progress--complete"),e.uploadPauseButton&&(e.uploadPauseButton.classList.remove("upload__pause-button--is-enabled"),e.uploadPauseButton.disabled=!0),e.uploadCancelButton&&(e.uploadCancelButton.classList.remove("upload__cancel-button--is-enabled"),e.uploadCancelButton.disabled=!0)},1e3)}},{key:"failureHandler",value:function(e,t){this.renderProgress(),this.uploadError.innerText=this.localize(t.message),this.uploadError.classList.add("upload__error--active"),this.uploadProgress.classList.add("upload__progress--error"),this.uploadPauseButton&&(this.uploadPauseButton.classList.remove("upload__pause-button--is-enabled"),this.uploadPauseButton.disabled=!0),this.uploadCancelButton&&(this.uploadCancelButton.classList.remove("upload__cancel-button--is-enabled"),this.uploadCancelButton.disabled=!0)}},{key:"thumbnailHandler",value:function(e,t){this.uploadPreview.style.backgroundImage=t?"url("+(t?t:"")+")":null,this.uploadPreview.style.backgroundSize=t?"cover":null}},{key:"addedfileHandler",value:function(e){this.uploadTitle.innerText=e.name,this.uploadSubTitle.innerText=b["default"](e.size)}},{key:"pauseHandler",value:function(e,t){return t?(this.uploadPauseButton.classList.add("upload__pause-button--paused"),void this.uploadProgress.classList.add("upload__progress--paused")):(this.uploadPauseButton.classList.remove("upload__pause-button--paused"),void this.uploadProgress.classList.remove("upload__progress--paused"))}},{key:"legacyStartHandler",value:function(){this.renderProgress(),this.uploadProgress.classList.add(this.options.bemPrefix+"__progress--loading"),this.uploadError.innerText=""}},{key:"legacySuccessHandler",value:function(){var e=this;setTimeout(function(){e.uploadProgress.classList.remove(e.options.bemPrefix+"__progress--loading"),e.uploadProgress.classList.add(e.options.bemPrefix+"__progress--complete")},1e3)}},{key:"legacyFailureHandler",value:function(e,t){this.renderProgress(),this.uploadError.innerText=this.localize(t.message),this.uploadError.classList.add("upload__error--active"),this.uploadProgress.classList.add("upload__progress--error")}},{key:"eventHelper",value:function(e,t,n){e.addEventListener(t,n);var r=function(){e.removeEventListener(t,n)};this.eventListeners.push(r)}},{key:"destroy",value:function(){for(var e=0;e<this.eventListeners.length;e++)this.eventListeners.splice(e,1)[0]();this.el.parentNode.removeChild(this.el)}}]),t}(p["default"]);t.exports=T},{"./constants":15,"./utils/createElement":17,"./utils/formatBytes":18,"./utils/forwardEvents":19,"@livelyvideo/localization":2,"@livelyvideo/upload-core/lib":4,"classlist-polyfill":9,"es6-promise/auto":10,events:12}],17:[function(e,t,n){"use strict";function r(e){var t=void 0,n=void 0,i=void 0;if(e.tagName){if(t=document.createElement(e.tagName),e.className&&(t.className=e.className),e.attributes)for(n in e.attributes)t.setAttribute(n,e.attributes[n]);void 0!==e.html&&(t.innerHTML=e.html)}else t=document.createDocumentFragment();if(e.text&&t.appendChild(document.createTextNode(e.text)),void 0===window.HTMLElement&&(window.HTMLElement=Element),e.childs&&e.childs.length)for(i=0;i<e.childs.length;i++)t.appendChild(e.childs[i]instanceof window.HTMLElement?e.childs[i]:r(e.childs[i]));return t}Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=r},{}],18:[function(e,t,n){"use strict";function r(e,t){if(0===e)return"0 Byte";var n=1e3,r=t+1||3,i=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],s=Math.floor(Math.log(e)/Math.log(n));return parseFloat((e/Math.pow(n,s)).toFixed(r))+" "+i[s]}Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=r},{}],19:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(e instanceof o["default"]&&t instanceof o["default"]){var n=e.emit;e.emit=function(){return t.emit.apply(t,arguments),n.apply(this,arguments)}.bind(e)}}Object.defineProperty(n,"__esModule",{value:!0});var s=e("events"),o=r(s);n["default"]=i},{events:12}]},{},[16])(16)});